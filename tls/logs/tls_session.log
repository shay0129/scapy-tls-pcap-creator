2024-12-31 01:24:26,072 - INFO - [logging.py:83] - Logging configured successfully
2024-12-31 01:24:26,073 - INFO - [logging.py:90] - === Logging Configuration ===
2024-12-31 01:24:26,073 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2024-12-31 01:24:26,074 - INFO - [logging.py:92] - Log level: 20
2024-12-31 01:24:26,074 - INFO - [logging.py:93] - Timestamp: 2024-12-31T01:24:26.074348
2024-12-31 01:24:26,074 - INFO - [logging.py:94] - ==========================
2024-12-31 01:24:26,075 - INFO - [main.py:122] - Starting TLS session simulation
2024-12-31 01:24:26,076 - INFO - [main.py:87] - 
--- Client Session (certificate) ---
2024-12-31 01:24:26,077 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2024-12-31 01:24:26,077 - INFO - [cert.py:108] - File exists: True
2024-12-31 01:24:26,078 - INFO - [cert.py:109] - File size: 1912 bytes
2024-12-31 01:24:26,079 - INFO - [cert.py:113] - Read 1912 bytes
2024-12-31 01:24:26,079 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2024-12-31 01:24:26,080 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2024-12-31 01:24:26,083 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 01:24:26,085 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2024-12-31 01:24:26,087 - INFO - [cert.py:108] - File exists: True
2024-12-31 01:24:26,088 - INFO - [cert.py:109] - File size: 1643 bytes
2024-12-31 01:24:26,090 - INFO - [cert.py:113] - Read 1643 bytes
2024-12-31 01:24:26,091 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2024-12-31 01:24:26,093 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2024-12-31 01:24:26,096 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 01:24:26,171 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2024-12-31 01:24:26,171 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2024-12-31 01:24:26,172 - INFO - [cert.py:215] - Key size: 2048 bits
2024-12-31 01:24:26,172 - INFO - [cert.py:217] - Public exponent: 65537
2024-12-31 01:24:26,175 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2024-12-31 01:24:26,176 - INFO - [verify.py:58] - Public key comparison results:
2024-12-31 01:24:26,176 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2024-12-31 01:24:26,178 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2024-12-31 01:24:26,179 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2024-12-31 01:24:26,179 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2024-12-31 01:24:26,182 - INFO - [verify.py:136] - Certificate chain verification successful
2024-12-31 01:24:26,183 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2024-12-31 01:24:26,183 - INFO - [chain.py:109] - Certificate chain verification passed
2024-12-31 01:24:26,184 - INFO - [chain.py:116] - Certificate chain loaded successfully
2024-12-31 01:24:26,184 - INFO - [chain.py:117] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2024-12-31 01:24:26,185 - INFO - [chain.py:118] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2024-12-31 01:24:26,186 - INFO - [chain.py:122] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2024-12-31 01:24:26,186 - INFO - [session.py:119] - Starting TLS session
2024-12-31 01:24:26,187 - INFO - [client.py:95] - Generated client_random: 67732baa6c6c6144b0375264c934ff3148fa7d77b948816ea6b427f6fc633fba
2024-12-31 01:24:26,189 - INFO - [client.py:135] - Client Hello sent from 192.168.1.1
2024-12-31 01:24:26,192 - INFO - [server.py:89] - Generated server_random: 67732baaf1fb992879f70e117fae07fdf88e536586168d2ae58fb9186bee82cc
2024-12-31 01:24:26,198 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2024-12-31 01:24:26,199 - INFO - [cert.py:108] - File exists: True
2024-12-31 01:24:26,199 - INFO - [cert.py:109] - File size: 1915 bytes
2024-12-31 01:24:26,200 - INFO - [cert.py:113] - Read 1915 bytes
2024-12-31 01:24:26,200 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2024-12-31 01:24:26,201 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2024-12-31 01:24:26,201 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 01:24:26,201 - INFO - [client.py:178] - Client certificate prepared
2024-12-31 01:24:26,202 - INFO - [client.py:190] - Encrypted pre_master_secret length: 256
2024-12-31 01:24:26,204 - INFO - [chain.py:182] - Decrypted pre_master_secret: 03034f6d464ee0bb699f4e57408c619e100052f74fac8a03e073888abc5f3717343c943c46d20d508879ec5278bb8c7b
2024-12-31 01:24:26,204 - INFO - [chain.py:193] - Generated master secret: 8de37dd057c8cdd5f84078a5b41a60ced6054ebb6f672b3cf3f297f8762fafd0b1ba380cc076171c5061b7ea9aa59ba4
2024-12-31 01:24:26,205 - INFO - [client.py:252] - Client ChangeCipherSpec and Finished messages sent
2024-12-31 01:24:26,207 - INFO - [server.py:239] - Pre-master secret validated successfully
2024-12-31 01:24:26,208 - INFO - [server.py:257] - Generated digital signature: 9b1e5ea778a04555eb5491408f5e34243c23770ac69db80c7269f373b5b65529eb14b074955ad35bb432f8318ba816111ba1f6bb6f0606797d002039349df82fdc1a431018f55503085cdf3a8a6f2a61e63433e2792844e64548c366b94f58144676618b66760002966380a07b13426f2de13f73ba9d807675a0de9842ea8aee38472ac7a8fa87f8f2ea5fe3362b92cf58768f92de8c7e48c195a6666c2325862530d71ce4e04361af37f9986ad5fc61930dcb302cefca3f5f47e3fe6582c9d8f06416ce2d2ffe7dc2b3d1fb7c7950349d2a77bdfbf0f5fbec10d29cb7ca144889aceddda115a34108af66a20c35c37f969fd45910c23b2ddbe0acb353e01bcc
2024-12-31 01:24:26,209 - INFO - [server.py:271] - Server ChangeCipherSpec and Finished messages sent
2024-12-31 01:24:26,211 - INFO - [keys.py:193] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2024-12-31 01:24:26,212 - INFO - [session.py:103] - TLS Handshake completed successfully
2024-12-31 01:24:26,212 - INFO - [session.py:130] - Found file to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2024-12-31 01:24:26,213 - INFO - [session.py:148] - Handshake completed: True
2024-12-31 01:24:26,214 - INFO - [session.py:149] - Use client cert: True
2024-12-31 01:24:26,214 - INFO - [session.py:150] - File to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2024-12-31 01:24:26,215 - INFO - [session.py:153] - Using encrypted exchange
2024-12-31 01:24:26,215 - INFO - [session.py:168] - Sending encrypted request data
2024-12-31 01:24:26,219 - INFO - [keys.py:173] - TLS Application Data sent from 192.168.1.1:12345 to 10.0.0.1:443
2024-12-31 01:24:26,219 - INFO - [session.py:179] - Sending encrypted response data
2024-12-31 01:24:26,221 - INFO - [keys.py:173] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2024-12-31 01:24:26,221 - INFO - [session.py:191] - Attempting to send file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2024-12-31 01:24:26,221 - INFO - [session.py:202] - Opening file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2024-12-31 01:24:26,222 - INFO - [session.py:209] - Read 1103 bytes from file
2024-12-31 01:24:26,223 - INFO - [keys.py:173] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2024-12-31 01:24:26,223 - INFO - [session.py:218] - File sent successfully
2024-12-31 01:24:26,224 - INFO - [session.py:193] - File sent successfully
2024-12-31 01:24:26,224 - INFO - [main.py:95] - Session completed successfully for 192.168.1.1
2024-12-31 01:24:26,224 - INFO - [main.py:87] - 
--- Client Session (no certificate) ---
2024-12-31 01:24:26,226 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2024-12-31 01:24:26,227 - INFO - [cert.py:108] - File exists: True
2024-12-31 01:24:26,227 - INFO - [cert.py:109] - File size: 1912 bytes
2024-12-31 01:24:26,228 - INFO - [cert.py:113] - Read 1912 bytes
2024-12-31 01:24:26,228 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2024-12-31 01:24:26,229 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2024-12-31 01:24:26,230 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 01:24:26,231 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2024-12-31 01:24:26,231 - INFO - [cert.py:108] - File exists: True
2024-12-31 01:24:26,232 - INFO - [cert.py:109] - File size: 1643 bytes
2024-12-31 01:24:26,232 - INFO - [cert.py:113] - Read 1643 bytes
2024-12-31 01:24:26,233 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2024-12-31 01:24:26,233 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2024-12-31 01:24:26,234 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 01:24:26,262 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2024-12-31 01:24:26,263 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2024-12-31 01:24:26,263 - INFO - [cert.py:215] - Key size: 2048 bits
2024-12-31 01:24:26,263 - INFO - [cert.py:217] - Public exponent: 65537
2024-12-31 01:24:26,264 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2024-12-31 01:24:26,264 - INFO - [verify.py:58] - Public key comparison results:
2024-12-31 01:24:26,264 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2024-12-31 01:24:26,265 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2024-12-31 01:24:26,265 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2024-12-31 01:24:26,265 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2024-12-31 01:24:26,266 - INFO - [verify.py:136] - Certificate chain verification successful
2024-12-31 01:24:26,266 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2024-12-31 01:24:26,266 - INFO - [chain.py:109] - Certificate chain verification passed
2024-12-31 01:24:26,266 - INFO - [chain.py:116] - Certificate chain loaded successfully
2024-12-31 01:24:26,267 - INFO - [chain.py:117] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2024-12-31 01:24:26,267 - INFO - [chain.py:118] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2024-12-31 01:24:26,268 - INFO - [chain.py:122] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2024-12-31 01:24:26,268 - INFO - [session.py:119] - Starting TLS session
2024-12-31 01:24:26,268 - INFO - [client.py:95] - Generated client_random: 67732baa38af464fa8b89f5f62046727fd1697181ee9ea8198ab876bb386f8b7
2024-12-31 01:24:26,271 - INFO - [client.py:135] - Client Hello sent from 192.168.1.2
2024-12-31 01:24:26,273 - INFO - [server.py:89] - Generated server_random: 67732baa19d0c2942945e2799a5c812c5b3e437c388def8fdf2c66eb24e036bd
2024-12-31 01:24:26,276 - INFO - [client.py:166] - Sending empty certificate
2024-12-31 01:24:26,277 - INFO - [client.py:178] - Client certificate prepared
2024-12-31 01:24:26,278 - INFO - [client.py:190] - Encrypted pre_master_secret length: 256
2024-12-31 01:24:26,280 - INFO - [chain.py:182] - Decrypted pre_master_secret: 03030e0c0c8d88ffef97507f46537887f40618e0ee38a1abfacae93b6b22928c738912417a589f9e05ace851657efe51
2024-12-31 01:24:26,281 - INFO - [chain.py:193] - Generated master secret: 29fde1dd6814b45d5f4bdbb980612c2937612510feed1756d01700b66754bfef8fa8eb6b7bf973261d6ee9782d934ee4
2024-12-31 01:24:26,282 - INFO - [client.py:252] - Client ChangeCipherSpec and Finished messages sent
2024-12-31 01:24:26,283 - INFO - [server.py:239] - Pre-master secret validated successfully
2024-12-31 01:24:26,285 - INFO - [server.py:257] - Generated digital signature: c5aaa9b98ae94adf9fbef3b082b379e4f18eb1b6f064c9899877fccd9ca211d1aa07b80be36f40f5aa06dea29c152022e3c2975863cfe6c45dceb5ff9af03b601db46cd0f27bd587dc3a8a024c73295dd6d4bc8035758ea57a06e96ece1b896e1d2292c45f31dd91c3826722c28d5908ee4d43a10336b1582c08c898f17ca71ac5775877d5afcc0ad61f321dfc7c14fcaf95b24ae908b416ac8e734d7b460753ca60fa2c2c5990ff5a19d11de9181a47d895c482d0c716caf3c2d731bd80011bfc4ddd6e800bd6b037f300c3cc48324342c14074c65027a90e6422c7545ede5c4892097b0cd998c587e18da61fcce3bf3e805bfdf57151a23d2eebe03adde579
2024-12-31 01:24:26,287 - INFO - [server.py:271] - Server ChangeCipherSpec and Finished messages sent
2024-12-31 01:24:26,291 - INFO - [keys.py:193] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2024-12-31 01:24:26,292 - INFO - [session.py:103] - TLS Handshake completed successfully
2024-12-31 01:24:26,292 - INFO - [session.py:148] - Handshake completed: True
2024-12-31 01:24:26,293 - INFO - [session.py:149] - Use client cert: False
2024-12-31 01:24:26,294 - INFO - [session.py:150] - File to send: None
2024-12-31 01:24:26,294 - INFO - [session.py:156] - Using unencrypted exchange
2024-12-31 01:24:26,296 - INFO - [session.py:256] - Added request packet
2024-12-31 01:24:26,298 - INFO - [session.py:256] - Added response packet
2024-12-31 01:24:26,298 - WARNING - [session.py:233] - Using unencrypted communication
2024-12-31 01:24:26,298 - INFO - [main.py:95] - Session completed successfully for 192.168.1.2
2024-12-31 01:24:26,299 - INFO - [pcap_writer.py:232] - Packet 13: Valid HTTP message
2024-12-31 01:24:26,300 - INFO - [pcap_writer.py:232] - Packet 14: Valid HTTP message
2024-12-31 01:24:26,310 - INFO - [pcap_writer.py:387] - Saved 15 valid packets to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2024-12-31 01:24:26,310 - INFO - [pcap_writer.py:409] - Verifying 15 packets...
2024-12-31 01:24:26,311 - INFO - [pcap_writer.py:413] - Packet 1: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2024-12-31 01:24:26,311 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2024-12-31 01:24:26,312 - INFO - [pcap_writer.py:413] - Packet 2: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2024-12-31 01:24:26,312 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2775
2024-12-31 01:24:26,313 - INFO - [pcap_writer.py:413] - Packet 3: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2024-12-31 01:24:26,313 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 1646
2024-12-31 01:24:26,314 - INFO - [pcap_writer.py:413] - Packet 4: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2024-12-31 01:24:26,314 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2024-12-31 01:24:26,314 - INFO - [pcap_writer.py:413] - Packet 5: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2024-12-31 01:24:26,315 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2024-12-31 01:24:26,315 - INFO - [pcap_writer.py:413] - Packet 6: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2024-12-31 01:24:26,316 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 165
2024-12-31 01:24:26,316 - INFO - [pcap_writer.py:413] - Packet 7: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2024-12-31 01:24:26,316 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 133
2024-12-31 01:24:26,317 - INFO - [pcap_writer.py:413] - Packet 8: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2024-12-31 01:24:26,317 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 1157
2024-12-31 01:24:26,318 - INFO - [pcap_writer.py:413] - Packet 9: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2024-12-31 01:24:26,318 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2024-12-31 01:24:26,319 - INFO - [pcap_writer.py:413] - Packet 10: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2024-12-31 01:24:26,319 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2775
2024-12-31 01:24:26,319 - INFO - [pcap_writer.py:413] - Packet 11: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2024-12-31 01:24:26,319 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 269
2024-12-31 01:24:26,320 - INFO - [pcap_writer.py:413] - Packet 12: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2024-12-31 01:24:26,320 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2024-12-31 01:24:26,321 - INFO - [pcap_writer.py:413] - Packet 13: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2024-12-31 01:24:26,321 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2024-12-31 01:24:26,321 - INFO - [pcap_writer.py:413] - Packet 14: IP / TCP 192.168.1.2:12346 > 10.0.0.1:http PA / Raw
2024-12-31 01:24:26,321 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2024-12-31 01:24:26,322 - INFO - [pcap_writer.py:413] - Packet 15: IP / TCP 10.0.0.1:http > 192.168.1.2:12346 PA / Raw
2024-12-31 01:24:26,322 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2024-12-31 01:24:26,322 - INFO - [pcap_writer.py:427] - Verification complete: 15 valid packets, 15 TLS records
2024-12-31 01:24:26,322 - INFO - [main.py:106] - Results saved to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2024-12-31 01:24:26,322 - INFO - [main.py:160] - TLS session simulation completed successfully
2024-12-31 14:51:48,233 - INFO - [logging.py:83] - Logging configured successfully
2024-12-31 14:51:48,234 - INFO - [logging.py:90] - === Logging Configuration ===
2024-12-31 14:51:48,234 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2024-12-31 14:51:48,235 - INFO - [logging.py:92] - Log level: 20
2024-12-31 14:51:48,235 - INFO - [logging.py:93] - Timestamp: 2024-12-31T14:51:48.235809
2024-12-31 14:51:48,236 - INFO - [logging.py:94] - ==========================
2024-12-31 14:51:48,236 - INFO - [main.py:122] - Starting TLS session simulation
2024-12-31 14:51:48,236 - INFO - [main.py:87] - 
--- Client Session (certificate) ---
2024-12-31 14:51:48,238 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2024-12-31 14:51:48,238 - INFO - [cert.py:108] - File exists: True
2024-12-31 14:51:48,238 - INFO - [cert.py:109] - File size: 1912 bytes
2024-12-31 14:51:48,239 - INFO - [cert.py:113] - Read 1912 bytes
2024-12-31 14:51:48,240 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2024-12-31 14:51:48,240 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2024-12-31 14:51:48,243 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 14:51:48,244 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2024-12-31 14:51:48,245 - INFO - [cert.py:108] - File exists: True
2024-12-31 14:51:48,246 - INFO - [cert.py:109] - File size: 1643 bytes
2024-12-31 14:51:48,247 - INFO - [cert.py:113] - Read 1643 bytes
2024-12-31 14:51:48,248 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2024-12-31 14:51:48,249 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2024-12-31 14:51:48,250 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 14:51:48,282 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2024-12-31 14:51:48,283 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2024-12-31 14:51:48,283 - INFO - [cert.py:215] - Key size: 2048 bits
2024-12-31 14:51:48,284 - INFO - [cert.py:217] - Public exponent: 65537
2024-12-31 14:51:48,287 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2024-12-31 14:51:48,288 - INFO - [verify.py:58] - Public key comparison results:
2024-12-31 14:51:48,289 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2024-12-31 14:51:48,290 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2024-12-31 14:51:48,291 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2024-12-31 14:51:48,292 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2024-12-31 14:51:48,295 - INFO - [verify.py:136] - Certificate chain verification successful
2024-12-31 14:51:48,298 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2024-12-31 14:51:48,298 - INFO - [chain.py:109] - Certificate chain verification passed
2024-12-31 14:51:48,299 - INFO - [chain.py:116] - Certificate chain loaded successfully
2024-12-31 14:51:48,299 - INFO - [chain.py:117] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2024-12-31 14:51:48,300 - INFO - [chain.py:118] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2024-12-31 14:51:48,300 - INFO - [chain.py:122] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2024-12-31 14:51:48,301 - INFO - [session.py:119] - Starting TLS session
2024-12-31 14:51:48,301 - INFO - [client.py:95] - Generated client_random: 6773e8e48a79cf073487a6afbd361748d34574e41bf689979b624aea413854f0
2024-12-31 14:51:48,304 - INFO - [client.py:135] - Client Hello sent from 192.168.1.1
2024-12-31 14:51:48,306 - INFO - [server.py:93] - Generated server_random: 6773e8e47a6dc05cd4361a5fdf780c2b5615528ea1f0c2bf9ddbffee15048456
2024-12-31 14:51:48,310 - ERROR - [main.py:27] - Session error: Session failed for 192.168.1.1: Session failed: send_client_handshake_messages() missing 2 required positional arguments: 'client_certificate' and 'client_key_exchange'
2024-12-31 15:02:36,169 - INFO - [logging.py:83] - Logging configured successfully
2024-12-31 15:02:36,170 - INFO - [logging.py:90] - === Logging Configuration ===
2024-12-31 15:02:36,170 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2024-12-31 15:02:36,170 - INFO - [logging.py:92] - Log level: 20
2024-12-31 15:02:36,171 - INFO - [logging.py:93] - Timestamp: 2024-12-31T15:02:36.171408
2024-12-31 15:02:36,171 - INFO - [logging.py:94] - ==========================
2024-12-31 15:02:36,172 - INFO - [main.py:122] - Starting TLS session simulation
2024-12-31 15:02:36,172 - INFO - [main.py:87] - 
--- Client Session (certificate) ---
2024-12-31 15:02:36,173 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2024-12-31 15:02:36,174 - INFO - [cert.py:108] - File exists: True
2024-12-31 15:02:36,175 - INFO - [cert.py:109] - File size: 1912 bytes
2024-12-31 15:02:36,175 - INFO - [cert.py:113] - Read 1912 bytes
2024-12-31 15:02:36,176 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2024-12-31 15:02:36,177 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2024-12-31 15:02:36,178 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 15:02:36,179 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2024-12-31 15:02:36,179 - INFO - [cert.py:108] - File exists: True
2024-12-31 15:02:36,180 - INFO - [cert.py:109] - File size: 1643 bytes
2024-12-31 15:02:36,180 - INFO - [cert.py:113] - Read 1643 bytes
2024-12-31 15:02:36,181 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2024-12-31 15:02:36,181 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2024-12-31 15:02:36,182 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 15:02:36,223 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2024-12-31 15:02:36,224 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2024-12-31 15:02:36,225 - INFO - [cert.py:215] - Key size: 2048 bits
2024-12-31 15:02:36,226 - INFO - [cert.py:217] - Public exponent: 65537
2024-12-31 15:02:36,229 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2024-12-31 15:02:36,230 - INFO - [verify.py:58] - Public key comparison results:
2024-12-31 15:02:36,231 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2024-12-31 15:02:36,232 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2024-12-31 15:02:36,234 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2024-12-31 15:02:36,234 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2024-12-31 15:02:36,239 - INFO - [verify.py:136] - Certificate chain verification successful
2024-12-31 15:02:36,253 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2024-12-31 15:02:36,255 - INFO - [chain.py:109] - Certificate chain verification passed
2024-12-31 15:02:36,257 - INFO - [chain.py:116] - Certificate chain loaded successfully
2024-12-31 15:02:36,258 - INFO - [chain.py:117] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2024-12-31 15:02:36,260 - INFO - [chain.py:118] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2024-12-31 15:02:36,262 - INFO - [chain.py:122] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2024-12-31 15:02:36,264 - INFO - [session.py:119] - Starting TLS session
2024-12-31 15:02:36,266 - INFO - [client.py:95] - Generated client_random: 6773eb6ce41e39d3d452afc05efe12e82b09d9cbd924bc4eb5cdac04258fe916
2024-12-31 15:02:36,273 - INFO - [client.py:135] - Client Hello sent from 192.168.1.1
2024-12-31 15:02:36,276 - INFO - [server.py:93] - Generated server_random: 6773eb6cc9ca89c98ea641a45237e8d382fde1da640aa832f23d321581626d87
2024-12-31 15:02:36,281 - ERROR - [main.py:27] - Session error: Session failed for 192.168.1.1: Session failed: send_client_handshake_messages() missing 2 required positional arguments: 'client_certificate' and 'client_key_exchange'
2024-12-31 15:03:07,873 - INFO - [logging.py:83] - Logging configured successfully
2024-12-31 15:03:07,874 - INFO - [logging.py:90] - === Logging Configuration ===
2024-12-31 15:03:07,874 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2024-12-31 15:03:07,874 - INFO - [logging.py:92] - Log level: 20
2024-12-31 15:03:07,875 - INFO - [logging.py:93] - Timestamp: 2024-12-31T15:03:07.875082
2024-12-31 15:03:07,875 - INFO - [logging.py:94] - ==========================
2024-12-31 15:03:07,875 - INFO - [main.py:122] - Starting TLS session simulation
2024-12-31 15:03:07,876 - INFO - [main.py:87] - 
--- Client Session (certificate) ---
2024-12-31 15:03:07,876 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2024-12-31 15:03:07,877 - INFO - [cert.py:108] - File exists: True
2024-12-31 15:03:07,877 - INFO - [cert.py:109] - File size: 1912 bytes
2024-12-31 15:03:07,877 - INFO - [cert.py:113] - Read 1912 bytes
2024-12-31 15:03:07,877 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2024-12-31 15:03:07,878 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2024-12-31 15:03:07,878 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 15:03:07,879 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2024-12-31 15:03:07,879 - INFO - [cert.py:108] - File exists: True
2024-12-31 15:03:07,880 - INFO - [cert.py:109] - File size: 1643 bytes
2024-12-31 15:03:07,880 - INFO - [cert.py:113] - Read 1643 bytes
2024-12-31 15:03:07,880 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2024-12-31 15:03:07,881 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2024-12-31 15:03:07,882 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 15:03:07,910 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2024-12-31 15:03:07,911 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2024-12-31 15:03:07,911 - INFO - [cert.py:215] - Key size: 2048 bits
2024-12-31 15:03:07,912 - INFO - [cert.py:217] - Public exponent: 65537
2024-12-31 15:03:07,914 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2024-12-31 15:03:07,914 - INFO - [verify.py:58] - Public key comparison results:
2024-12-31 15:03:07,914 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2024-12-31 15:03:07,915 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2024-12-31 15:03:07,915 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2024-12-31 15:03:07,916 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2024-12-31 15:03:07,917 - INFO - [verify.py:136] - Certificate chain verification successful
2024-12-31 15:03:07,917 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2024-12-31 15:03:07,917 - INFO - [chain.py:109] - Certificate chain verification passed
2024-12-31 15:03:07,917 - INFO - [chain.py:116] - Certificate chain loaded successfully
2024-12-31 15:03:07,918 - INFO - [chain.py:117] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2024-12-31 15:03:07,918 - INFO - [chain.py:118] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2024-12-31 15:03:07,919 - INFO - [chain.py:122] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2024-12-31 15:03:07,919 - INFO - [session.py:119] - Starting TLS session
2024-12-31 15:03:07,919 - INFO - [client.py:95] - Generated client_random: 6773eb8b1919fc5663f6490bbb48d9c27af25ddafd9e3ec155bdc569eb6c0bf8
2024-12-31 15:03:07,924 - INFO - [client.py:135] - Client Hello sent from 192.168.1.1
2024-12-31 15:03:07,926 - INFO - [server.py:93] - Generated server_random: 6773eb8bbf8e51a6a355c0cf3469d9ca08f5902f2a384b581d6828407dccbc5b
2024-12-31 15:03:07,930 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2024-12-31 15:03:07,931 - INFO - [cert.py:108] - File exists: True
2024-12-31 15:03:07,931 - INFO - [cert.py:109] - File size: 1915 bytes
2024-12-31 15:03:07,939 - INFO - [cert.py:113] - Read 1915 bytes
2024-12-31 15:03:07,940 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2024-12-31 15:03:07,941 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2024-12-31 15:03:07,942 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 15:03:07,943 - INFO - [client.py:167] - Prepared client certificate
2024-12-31 15:03:07,945 - INFO - [client.py:182] - Encrypted pre_master_secret length: 256
2024-12-31 15:03:07,948 - INFO - [chain.py:182] - Decrypted pre_master_secret: 0303b52775962ff837c7b7d49a3343009c35b4ee40641190dbb5e20c4e99a17a6e1c87df08ad94f83af650374e6c6558
2024-12-31 15:03:07,949 - INFO - [chain.py:193] - Generated master secret: 6b05dc45a158c2b6b0400cb7395ca008c772a0b0f9e50d4e0a0e533f14eeb373a4d3d7b9007bf4cd1dc6c3f5d85ca3ff
2024-12-31 15:03:07,950 - INFO - [client.py:272] - Client ChangeCipherSpec and Finished messages sent
2024-12-31 15:03:07,951 - INFO - [server.py:254] - Pre-master secret validated successfully
2024-12-31 15:03:07,952 - INFO - [server.py:272] - Generated digital signature: 42ab15777a1d91a806cfe5585fb58656e66746773443a76b54014b2116f8aca7de61f8078a71143548eea62d95f9c33cf4c5b58187248fa54225048ecc716f576cb49c0766c5c751078bcc81c5967932efa4ba36dd46b8deb1780b7bc985afb8d2cafd44047093bca0d66fec819ce8675730892486fe6526bc7b86551fb52704a4acf082dec033351ce9905b260da7d81170ba801e6d61c0a972ccc69ffde0291a201e85fb4b1b0202897e761cd0f028eb73c6f2b6fd31c70dfb2a74250201c37951e60830a4ad429b41a9bd52fa0de1b4f0eae37a279f0fe5be26400f65910eb48ac52f6351e0ba3e4c9da155f040e79dd7795af1ff84d6e81d31d2eb18aeff
2024-12-31 15:03:07,953 - INFO - [server.py:286] - Server ChangeCipherSpec and Finished messages sent
2024-12-31 15:03:07,955 - INFO - [keys.py:193] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2024-12-31 15:03:07,955 - INFO - [session.py:103] - TLS Handshake completed successfully
2024-12-31 15:03:07,956 - INFO - [session.py:130] - Found file to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2024-12-31 15:03:07,957 - INFO - [session.py:148] - Handshake completed: True
2024-12-31 15:03:07,957 - INFO - [session.py:149] - Use client cert: True
2024-12-31 15:03:07,958 - INFO - [session.py:150] - File to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2024-12-31 15:03:07,958 - INFO - [session.py:153] - Using encrypted exchange
2024-12-31 15:03:07,958 - INFO - [session.py:168] - Sending encrypted request data
2024-12-31 15:03:07,962 - INFO - [keys.py:173] - TLS Application Data sent from 192.168.1.1:12345 to 10.0.0.1:443
2024-12-31 15:03:07,962 - INFO - [session.py:179] - Sending encrypted response data
2024-12-31 15:03:07,963 - INFO - [keys.py:173] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2024-12-31 15:03:07,964 - INFO - [session.py:191] - Attempting to send file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2024-12-31 15:03:07,965 - INFO - [session.py:202] - Opening file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2024-12-31 15:03:07,966 - INFO - [session.py:209] - Read 1103 bytes from file
2024-12-31 15:03:07,967 - INFO - [keys.py:173] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2024-12-31 15:03:07,967 - INFO - [session.py:218] - File sent successfully
2024-12-31 15:03:07,967 - INFO - [session.py:193] - File sent successfully
2024-12-31 15:03:07,968 - INFO - [main.py:95] - Session completed successfully for 192.168.1.1
2024-12-31 15:03:07,968 - INFO - [main.py:87] - 
--- Client Session (no certificate) ---
2024-12-31 15:03:07,969 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2024-12-31 15:03:07,969 - INFO - [cert.py:108] - File exists: True
2024-12-31 15:03:07,970 - INFO - [cert.py:109] - File size: 1912 bytes
2024-12-31 15:03:07,970 - INFO - [cert.py:113] - Read 1912 bytes
2024-12-31 15:03:07,971 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2024-12-31 15:03:07,971 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2024-12-31 15:03:07,972 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 15:03:07,972 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2024-12-31 15:03:07,972 - INFO - [cert.py:108] - File exists: True
2024-12-31 15:03:07,973 - INFO - [cert.py:109] - File size: 1643 bytes
2024-12-31 15:03:07,974 - INFO - [cert.py:113] - Read 1643 bytes
2024-12-31 15:03:07,974 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2024-12-31 15:03:07,975 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2024-12-31 15:03:07,976 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 15:03:08,006 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2024-12-31 15:03:08,007 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2024-12-31 15:03:08,007 - INFO - [cert.py:215] - Key size: 2048 bits
2024-12-31 15:03:08,008 - INFO - [cert.py:217] - Public exponent: 65537
2024-12-31 15:03:08,008 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2024-12-31 15:03:08,009 - INFO - [verify.py:58] - Public key comparison results:
2024-12-31 15:03:08,009 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2024-12-31 15:03:08,010 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2024-12-31 15:03:08,011 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2024-12-31 15:03:08,011 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2024-12-31 15:03:08,012 - INFO - [verify.py:136] - Certificate chain verification successful
2024-12-31 15:03:08,012 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2024-12-31 15:03:08,013 - INFO - [chain.py:109] - Certificate chain verification passed
2024-12-31 15:03:08,013 - INFO - [chain.py:116] - Certificate chain loaded successfully
2024-12-31 15:03:08,014 - INFO - [chain.py:117] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2024-12-31 15:03:08,015 - INFO - [chain.py:118] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2024-12-31 15:03:08,017 - INFO - [chain.py:122] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2024-12-31 15:03:08,017 - INFO - [session.py:119] - Starting TLS session
2024-12-31 15:03:08,017 - INFO - [client.py:95] - Generated client_random: 6773eb8c92210db29304ff25c5a2581f5d7f0dd8c0ad03f93cac6b9e4be89210
2024-12-31 15:03:08,019 - INFO - [client.py:135] - Client Hello sent from 192.168.1.2
2024-12-31 15:03:08,022 - INFO - [server.py:93] - Generated server_random: 6773eb8c893d47a702300bdbf66739f1a8ac8c32f0c3d970d93d8f0d3eb24aef
2024-12-31 15:03:08,027 - INFO - [client.py:170] - Prepared empty certificate
2024-12-31 15:03:08,029 - INFO - [client.py:182] - Encrypted pre_master_secret length: 256
2024-12-31 15:03:08,031 - INFO - [chain.py:182] - Decrypted pre_master_secret: 0303a67fd7541f335361cc98fca9ac5081d6da16375ebe82c4197466f933773eab8f3e537c0fd85d13c31dffa07ae6c4
2024-12-31 15:03:08,031 - INFO - [chain.py:193] - Generated master secret: 0595e618da2a66b9d13bfeba7fed380867077760918c60a9b9a4ff410d9fa956706281fa287d03a3a2bd149859cdeaf3
2024-12-31 15:03:08,032 - INFO - [client.py:272] - Client ChangeCipherSpec and Finished messages sent
2024-12-31 15:03:08,034 - INFO - [server.py:254] - Pre-master secret validated successfully
2024-12-31 15:03:08,034 - INFO - [server.py:272] - Generated digital signature: b64dbf62d33ed79aff0d76bdf89d902d4eb34e6757cc849df990468f15e3a990e6772dc7017a29b124116cff3a4208d0aece7a39977f2f394ddd2d800161f33d36171287a17ad7c4c0c33a8980c5b2aa272c9cb08e9547133f137ea3101655b3b8af7b3fe3cc83f62facfa1cd0e9fc50dfeafd8a9f8c54851f2a27dd7ae90acb4beb20c26bd0f6bf59ca1c312789734fcaad060d9707e8f961970c63af5d0d6d8a4123a8a4cc1e8597ebf5673e35fc7c051cd4017912b2a7f546b59d045f27b5009cd783e00e9541925dc773e65fc8aa8fe22347a56c29b3253ca1e0b0fab5bbe43f67c78306920a5e261e62145800a345ddba23f275a0940fbf6176a0e22c79
2024-12-31 15:03:08,036 - INFO - [server.py:286] - Server ChangeCipherSpec and Finished messages sent
2024-12-31 15:03:08,037 - INFO - [keys.py:193] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2024-12-31 15:03:08,038 - INFO - [session.py:103] - TLS Handshake completed successfully
2024-12-31 15:03:08,038 - INFO - [session.py:148] - Handshake completed: True
2024-12-31 15:03:08,038 - INFO - [session.py:149] - Use client cert: False
2024-12-31 15:03:08,038 - INFO - [session.py:150] - File to send: None
2024-12-31 15:03:08,039 - INFO - [session.py:156] - Using unencrypted exchange
2024-12-31 15:03:08,040 - INFO - [session.py:256] - Added request packet
2024-12-31 15:03:08,040 - INFO - [session.py:256] - Added response packet
2024-12-31 15:03:08,041 - WARNING - [session.py:233] - Using unencrypted communication
2024-12-31 15:03:08,041 - INFO - [main.py:95] - Session completed successfully for 192.168.1.2
2024-12-31 15:03:08,042 - INFO - [pcap_writer.py:232] - Packet 13: Valid HTTP message
2024-12-31 15:03:08,042 - INFO - [pcap_writer.py:232] - Packet 14: Valid HTTP message
2024-12-31 15:03:08,048 - INFO - [pcap_writer.py:387] - Saved 15 valid packets to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2024-12-31 15:03:08,049 - INFO - [pcap_writer.py:409] - Verifying 15 packets...
2024-12-31 15:03:08,049 - INFO - [pcap_writer.py:413] - Packet 1: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2024-12-31 15:03:08,050 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2024-12-31 15:03:08,050 - INFO - [pcap_writer.py:413] - Packet 2: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2024-12-31 15:03:08,050 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2775
2024-12-31 15:03:08,050 - INFO - [pcap_writer.py:413] - Packet 3: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2024-12-31 15:03:08,051 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 1646
2024-12-31 15:03:08,051 - INFO - [pcap_writer.py:413] - Packet 4: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2024-12-31 15:03:08,051 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2024-12-31 15:03:08,052 - INFO - [pcap_writer.py:413] - Packet 5: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2024-12-31 15:03:08,052 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2024-12-31 15:03:08,052 - INFO - [pcap_writer.py:413] - Packet 6: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2024-12-31 15:03:08,052 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 165
2024-12-31 15:03:08,053 - INFO - [pcap_writer.py:413] - Packet 7: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2024-12-31 15:03:08,053 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 133
2024-12-31 15:03:08,053 - INFO - [pcap_writer.py:413] - Packet 8: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2024-12-31 15:03:08,053 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 1157
2024-12-31 15:03:08,054 - INFO - [pcap_writer.py:413] - Packet 9: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2024-12-31 15:03:08,054 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2024-12-31 15:03:08,054 - INFO - [pcap_writer.py:413] - Packet 10: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2024-12-31 15:03:08,054 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2775
2024-12-31 15:03:08,055 - INFO - [pcap_writer.py:413] - Packet 11: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2024-12-31 15:03:08,055 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 269
2024-12-31 15:03:08,055 - INFO - [pcap_writer.py:413] - Packet 12: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2024-12-31 15:03:08,056 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2024-12-31 15:03:08,056 - INFO - [pcap_writer.py:413] - Packet 13: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2024-12-31 15:03:08,057 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2024-12-31 15:03:08,057 - INFO - [pcap_writer.py:413] - Packet 14: IP / TCP 192.168.1.2:12346 > 10.0.0.1:http PA / Raw
2024-12-31 15:03:08,057 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2024-12-31 15:03:08,058 - INFO - [pcap_writer.py:413] - Packet 15: IP / TCP 10.0.0.1:http > 192.168.1.2:12346 PA / Raw
2024-12-31 15:03:08,058 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2024-12-31 15:03:08,058 - INFO - [pcap_writer.py:427] - Verification complete: 15 valid packets, 15 TLS records
2024-12-31 15:03:08,059 - INFO - [main.py:106] - Results saved to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2024-12-31 15:03:08,059 - INFO - [main.py:160] - TLS session simulation completed successfully
2024-12-31 15:15:46,447 - INFO - [logging.py:83] - Logging configured successfully
2024-12-31 15:15:46,448 - INFO - [logging.py:90] - === Logging Configuration ===
2024-12-31 15:15:46,448 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2024-12-31 15:15:46,448 - INFO - [logging.py:92] - Log level: 20
2024-12-31 15:15:46,449 - INFO - [logging.py:93] - Timestamp: 2024-12-31T15:15:46.449484
2024-12-31 15:15:46,450 - INFO - [logging.py:94] - ==========================
2024-12-31 15:15:46,450 - INFO - [main.py:122] - Starting TLS session simulation
2024-12-31 15:15:46,451 - INFO - [main.py:87] - 
--- Client Session (certificate) ---
2024-12-31 15:15:46,451 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2024-12-31 15:15:46,452 - INFO - [cert.py:108] - File exists: True
2024-12-31 15:15:46,453 - INFO - [cert.py:109] - File size: 1912 bytes
2024-12-31 15:15:46,453 - INFO - [cert.py:113] - Read 1912 bytes
2024-12-31 15:15:46,454 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2024-12-31 15:15:46,454 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2024-12-31 15:15:46,455 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 15:15:46,456 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2024-12-31 15:15:46,457 - INFO - [cert.py:108] - File exists: True
2024-12-31 15:15:46,457 - INFO - [cert.py:109] - File size: 1643 bytes
2024-12-31 15:15:46,458 - INFO - [cert.py:113] - Read 1643 bytes
2024-12-31 15:15:46,458 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2024-12-31 15:15:46,458 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2024-12-31 15:15:46,459 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 15:15:46,490 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2024-12-31 15:15:46,491 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2024-12-31 15:15:46,492 - INFO - [cert.py:215] - Key size: 2048 bits
2024-12-31 15:15:46,493 - INFO - [cert.py:217] - Public exponent: 65537
2024-12-31 15:15:46,496 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2024-12-31 15:15:46,497 - INFO - [verify.py:58] - Public key comparison results:
2024-12-31 15:15:46,498 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2024-12-31 15:15:46,499 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2024-12-31 15:15:46,500 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2024-12-31 15:15:46,500 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2024-12-31 15:15:46,501 - INFO - [verify.py:136] - Certificate chain verification successful
2024-12-31 15:15:46,502 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2024-12-31 15:15:46,502 - INFO - [chain.py:109] - Certificate chain verification passed
2024-12-31 15:15:46,503 - INFO - [chain.py:116] - Certificate chain loaded successfully
2024-12-31 15:15:46,503 - INFO - [chain.py:117] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2024-12-31 15:15:46,504 - INFO - [chain.py:118] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2024-12-31 15:15:46,505 - INFO - [chain.py:122] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2024-12-31 15:15:46,505 - INFO - [session.py:119] - Starting TLS session
2024-12-31 15:15:46,505 - INFO - [client.py:95] - Generated client_random: 6773ee827e22fc262fd1dc1a68dcafe177b227f1dddfd64f1f903923e311c9b9
2024-12-31 15:15:46,511 - INFO - [client.py:135] - Client Hello sent from 192.168.1.1
2024-12-31 15:15:46,514 - INFO - [server.py:93] - Generated server_random: 6773ee82e339f46d9342557b46e9dddaadbb46043b640f0161c755ceb7715de8
2024-12-31 15:15:46,517 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2024-12-31 15:15:46,518 - INFO - [cert.py:108] - File exists: True
2024-12-31 15:15:46,518 - INFO - [cert.py:109] - File size: 1915 bytes
2024-12-31 15:15:46,519 - INFO - [cert.py:113] - Read 1915 bytes
2024-12-31 15:15:46,519 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2024-12-31 15:15:46,520 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2024-12-31 15:15:46,521 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 15:15:46,521 - INFO - [client.py:169] - Prepared client certificate
2024-12-31 15:15:46,522 - INFO - [client.py:184] - Encrypted pre_master_secret length: 256
2024-12-31 15:15:46,524 - INFO - [chain.py:182] - Decrypted pre_master_secret: 03036e26379818d4f75f3ee735f739fa9e53c5ff47d55b55d4f7ee83164293638745d2d3e89da941f97c7b0d8d4baea6
2024-12-31 15:15:46,524 - INFO - [chain.py:193] - Generated master secret: d0b972351fdd81dba1f01c5d022cddf4606d931ed5cd67844dae707d7aaa4171cbd61257d07fa0fcd850bffeae59205b
2024-12-31 15:15:46,526 - INFO - [client.py:345] - Client ChangeCipherSpec and Finished messages sent
2024-12-31 15:15:46,529 - INFO - [server.py:254] - Pre-master secret validated successfully
2024-12-31 15:15:46,531 - INFO - [server.py:272] - Generated digital signature: 62f04fcd38134bc6a0d7ad5f7727be925f83fdefd047e0bace06b09105cdb6f91edaa762bfec803b88239e286fa85105f833bdbcc95b268094f31ff005b79a68aa66291903105e9244f2c068ff416104bf14cb096f7d33490b25d0031004bb280f5f0cd3e1b645d34c654ac3116e5c034abbc630f0693b94215e654360e8802e12e523b154780dc11c8f659c1d6fddc6680ddc0dc6eb694c5eafbc7e29539577722a621a31ccf1aabbabdf6d652d766725577df221f98de4df71d569bc64f12a8a53f6173d8db5e0fc40717f5df3d33d3bf479aab921d48cff29269a98b0594048f41d6f15379b2a11285baafb4d2014787c4e6146fe34bc8320acd4c12b8732
2024-12-31 15:15:46,532 - INFO - [server.py:309] - Server ChangeCipherSpec and Finished messages sent
2024-12-31 15:15:46,534 - INFO - [keys.py:193] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2024-12-31 15:15:46,534 - INFO - [session.py:103] - TLS Handshake completed successfully
2024-12-31 15:15:46,535 - INFO - [session.py:130] - Found file to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2024-12-31 15:15:46,535 - INFO - [session.py:148] - Handshake completed: True
2024-12-31 15:15:46,536 - INFO - [session.py:149] - Use client cert: True
2024-12-31 15:15:46,536 - INFO - [session.py:150] - File to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2024-12-31 15:15:46,537 - INFO - [session.py:153] - Using encrypted exchange
2024-12-31 15:15:46,537 - INFO - [session.py:168] - Sending encrypted request data
2024-12-31 15:15:46,538 - INFO - [keys.py:173] - TLS Application Data sent from 192.168.1.1:12345 to 10.0.0.1:443
2024-12-31 15:15:46,539 - INFO - [session.py:179] - Sending encrypted response data
2024-12-31 15:15:46,540 - INFO - [keys.py:173] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2024-12-31 15:15:46,541 - INFO - [session.py:191] - Attempting to send file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2024-12-31 15:15:46,541 - INFO - [session.py:202] - Opening file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2024-12-31 15:15:46,542 - INFO - [session.py:209] - Read 1103 bytes from file
2024-12-31 15:15:46,545 - INFO - [keys.py:173] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2024-12-31 15:15:46,545 - INFO - [session.py:218] - File sent successfully
2024-12-31 15:15:46,546 - INFO - [session.py:193] - File sent successfully
2024-12-31 15:15:46,546 - INFO - [main.py:95] - Session completed successfully for 192.168.1.1
2024-12-31 15:15:46,547 - INFO - [main.py:87] - 
--- Client Session (no certificate) ---
2024-12-31 15:15:46,547 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2024-12-31 15:15:46,548 - INFO - [cert.py:108] - File exists: True
2024-12-31 15:15:46,548 - INFO - [cert.py:109] - File size: 1912 bytes
2024-12-31 15:15:46,549 - INFO - [cert.py:113] - Read 1912 bytes
2024-12-31 15:15:46,549 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2024-12-31 15:15:46,550 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2024-12-31 15:15:46,550 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 15:15:46,551 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2024-12-31 15:15:46,552 - INFO - [cert.py:108] - File exists: True
2024-12-31 15:15:46,552 - INFO - [cert.py:109] - File size: 1643 bytes
2024-12-31 15:15:46,553 - INFO - [cert.py:113] - Read 1643 bytes
2024-12-31 15:15:46,553 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2024-12-31 15:15:46,553 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2024-12-31 15:15:46,554 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 15:15:46,581 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2024-12-31 15:15:46,582 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2024-12-31 15:15:46,583 - INFO - [cert.py:215] - Key size: 2048 bits
2024-12-31 15:15:46,583 - INFO - [cert.py:217] - Public exponent: 65537
2024-12-31 15:15:46,583 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2024-12-31 15:15:46,584 - INFO - [verify.py:58] - Public key comparison results:
2024-12-31 15:15:46,584 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2024-12-31 15:15:46,584 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2024-12-31 15:15:46,585 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2024-12-31 15:15:46,585 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2024-12-31 15:15:46,586 - INFO - [verify.py:136] - Certificate chain verification successful
2024-12-31 15:15:46,586 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2024-12-31 15:15:46,586 - INFO - [chain.py:109] - Certificate chain verification passed
2024-12-31 15:15:46,586 - INFO - [chain.py:116] - Certificate chain loaded successfully
2024-12-31 15:15:46,587 - INFO - [chain.py:117] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2024-12-31 15:15:46,587 - INFO - [chain.py:118] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2024-12-31 15:15:46,588 - INFO - [chain.py:122] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2024-12-31 15:15:46,589 - INFO - [session.py:119] - Starting TLS session
2024-12-31 15:15:46,589 - INFO - [client.py:95] - Generated client_random: 6773ee82eb227570edac386b11a4204d49d0f4bdbfb095a3e51edaddbb5a1ad4
2024-12-31 15:15:46,591 - INFO - [client.py:135] - Client Hello sent from 192.168.1.2
2024-12-31 15:15:46,592 - INFO - [server.py:93] - Generated server_random: 6773ee822b54da3dd64f6857f5a02aa2f885f5bf7c95929080f8a71460be4460
2024-12-31 15:15:46,597 - INFO - [client.py:172] - Prepared empty certificate
2024-12-31 15:15:46,598 - INFO - [client.py:184] - Encrypted pre_master_secret length: 256
2024-12-31 15:15:46,600 - INFO - [chain.py:182] - Decrypted pre_master_secret: 0303acb0f29d933658eb8ee5557c7147eba1b28673f4ebcacd5fa85f03d83c96c8b3d42905f99158d854ff047f397c90
2024-12-31 15:15:46,600 - INFO - [chain.py:193] - Generated master secret: 3046ea99855b15d9efb47ccc23b5ae42c94370b9ca72d3fdf72fe398b72448823a702924582d301ed0c7a2b791bc6b82
2024-12-31 15:15:46,601 - INFO - [client.py:345] - Client ChangeCipherSpec and Finished messages sent
2024-12-31 15:15:46,602 - INFO - [server.py:254] - Pre-master secret validated successfully
2024-12-31 15:15:46,603 - INFO - [server.py:272] - Generated digital signature: 2ff443e829b5308f203b2e5c5b71fa7af47f6ff4a0060306242d7ac573353f62fe7e9b847b257f3db952c668dc0d2299fc3f36930170fada07c591ee651642a0a31e4465fd5e94b62339c410aa86f0c1a6eb1f54468421a2b496f5ec03eaa34a6fe4a060c304908dbfaf2f85658ae66c29e58b8dad8c56d780197237e4529220f917d27bf9cb53c2d1216c677919519837e47550b7ce7f51b4f45ef767abda7f912c410b029e20022acefa8af493a40493e79ee2282e43246ff0b539e14aeea384b00138e59e2e05078847cd29e848a17a72539c4d9c905d83179af696acf9bb5f11a615cfb53d3fea06afe102d11045a6230f887194f677ec41aea3d0011b62
2024-12-31 15:15:46,604 - INFO - [server.py:309] - Server ChangeCipherSpec and Finished messages sent
2024-12-31 15:15:46,606 - INFO - [keys.py:193] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2024-12-31 15:15:46,606 - INFO - [session.py:103] - TLS Handshake completed successfully
2024-12-31 15:15:46,607 - INFO - [session.py:148] - Handshake completed: True
2024-12-31 15:15:46,607 - INFO - [session.py:149] - Use client cert: False
2024-12-31 15:15:46,607 - INFO - [session.py:150] - File to send: None
2024-12-31 15:15:46,607 - INFO - [session.py:156] - Using unencrypted exchange
2024-12-31 15:15:46,608 - INFO - [session.py:256] - Added request packet
2024-12-31 15:15:46,609 - INFO - [session.py:256] - Added response packet
2024-12-31 15:15:46,610 - WARNING - [session.py:233] - Using unencrypted communication
2024-12-31 15:15:46,611 - INFO - [main.py:95] - Session completed successfully for 192.168.1.2
2024-12-31 15:15:46,612 - INFO - [pcap_writer.py:232] - Packet 13: Valid HTTP message
2024-12-31 15:15:46,612 - INFO - [pcap_writer.py:232] - Packet 14: Valid HTTP message
2024-12-31 15:15:46,616 - INFO - [pcap_writer.py:387] - Saved 15 valid packets to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2024-12-31 15:15:46,617 - INFO - [pcap_writer.py:409] - Verifying 15 packets...
2024-12-31 15:15:46,617 - INFO - [pcap_writer.py:413] - Packet 1: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2024-12-31 15:15:46,617 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2024-12-31 15:15:46,618 - INFO - [pcap_writer.py:413] - Packet 2: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2024-12-31 15:15:46,618 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2775
2024-12-31 15:15:46,618 - INFO - [pcap_writer.py:413] - Packet 3: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2024-12-31 15:15:46,619 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 1646
2024-12-31 15:15:46,619 - INFO - [pcap_writer.py:413] - Packet 4: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2024-12-31 15:15:46,619 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2024-12-31 15:15:46,619 - INFO - [pcap_writer.py:413] - Packet 5: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2024-12-31 15:15:46,620 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2024-12-31 15:15:46,620 - INFO - [pcap_writer.py:413] - Packet 6: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2024-12-31 15:15:46,620 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 165
2024-12-31 15:15:46,621 - INFO - [pcap_writer.py:413] - Packet 7: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2024-12-31 15:15:46,621 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 133
2024-12-31 15:15:46,621 - INFO - [pcap_writer.py:413] - Packet 8: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2024-12-31 15:15:46,621 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 1157
2024-12-31 15:15:46,622 - INFO - [pcap_writer.py:413] - Packet 9: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2024-12-31 15:15:46,622 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2024-12-31 15:15:46,622 - INFO - [pcap_writer.py:413] - Packet 10: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2024-12-31 15:15:46,623 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2775
2024-12-31 15:15:46,623 - INFO - [pcap_writer.py:413] - Packet 11: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2024-12-31 15:15:46,623 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 269
2024-12-31 15:15:46,623 - INFO - [pcap_writer.py:413] - Packet 12: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2024-12-31 15:15:46,624 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2024-12-31 15:15:46,624 - INFO - [pcap_writer.py:413] - Packet 13: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2024-12-31 15:15:46,624 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2024-12-31 15:15:46,625 - INFO - [pcap_writer.py:413] - Packet 14: IP / TCP 192.168.1.2:12346 > 10.0.0.1:http PA / Raw
2024-12-31 15:15:46,625 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2024-12-31 15:15:46,626 - INFO - [pcap_writer.py:413] - Packet 15: IP / TCP 10.0.0.1:http > 192.168.1.2:12346 PA / Raw
2024-12-31 15:15:46,626 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2024-12-31 15:15:46,627 - INFO - [pcap_writer.py:427] - Verification complete: 15 valid packets, 15 TLS records
2024-12-31 15:15:46,627 - INFO - [main.py:106] - Results saved to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2024-12-31 15:15:46,628 - INFO - [main.py:160] - TLS session simulation completed successfully
2024-12-31 15:16:56,053 - INFO - [logging.py:83] - Logging configured successfully
2024-12-31 15:16:56,053 - INFO - [logging.py:90] - === Logging Configuration ===
2024-12-31 15:16:56,054 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2024-12-31 15:16:56,054 - INFO - [logging.py:92] - Log level: 20
2024-12-31 15:16:56,055 - INFO - [logging.py:93] - Timestamp: 2024-12-31T15:16:56.055046
2024-12-31 15:16:56,055 - INFO - [logging.py:94] - ==========================
2024-12-31 15:16:56,055 - INFO - [main.py:122] - Starting TLS session simulation
2024-12-31 15:16:56,056 - INFO - [main.py:87] - 
--- Client Session (certificate) ---
2024-12-31 15:16:56,057 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2024-12-31 15:16:56,058 - INFO - [cert.py:108] - File exists: True
2024-12-31 15:16:56,059 - INFO - [cert.py:109] - File size: 1912 bytes
2024-12-31 15:16:56,059 - INFO - [cert.py:113] - Read 1912 bytes
2024-12-31 15:16:56,060 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2024-12-31 15:16:56,061 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2024-12-31 15:16:56,062 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 15:16:56,063 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2024-12-31 15:16:56,064 - INFO - [cert.py:108] - File exists: True
2024-12-31 15:16:56,065 - INFO - [cert.py:109] - File size: 1643 bytes
2024-12-31 15:16:56,065 - INFO - [cert.py:113] - Read 1643 bytes
2024-12-31 15:16:56,066 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2024-12-31 15:16:56,066 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2024-12-31 15:16:56,067 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 15:16:56,097 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2024-12-31 15:16:56,098 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2024-12-31 15:16:56,099 - INFO - [cert.py:215] - Key size: 2048 bits
2024-12-31 15:16:56,100 - INFO - [cert.py:217] - Public exponent: 65537
2024-12-31 15:16:56,103 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2024-12-31 15:16:56,104 - INFO - [verify.py:58] - Public key comparison results:
2024-12-31 15:16:56,104 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2024-12-31 15:16:56,106 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2024-12-31 15:16:56,107 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2024-12-31 15:16:56,108 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2024-12-31 15:16:56,112 - INFO - [verify.py:136] - Certificate chain verification successful
2024-12-31 15:16:56,113 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2024-12-31 15:16:56,114 - INFO - [chain.py:109] - Certificate chain verification passed
2024-12-31 15:16:56,114 - INFO - [chain.py:116] - Certificate chain loaded successfully
2024-12-31 15:16:56,115 - INFO - [chain.py:117] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2024-12-31 15:16:56,116 - INFO - [chain.py:118] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2024-12-31 15:16:56,118 - INFO - [chain.py:122] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2024-12-31 15:16:56,119 - INFO - [session.py:119] - Starting TLS session
2024-12-31 15:16:56,119 - INFO - [client.py:95] - Generated client_random: 6773eec896bd4b0683e2060fefa4a8b93707b7627b0bc2885cd115e82d99c8a9
2024-12-31 15:16:56,122 - INFO - [client.py:135] - Client Hello sent from 192.168.1.1
2024-12-31 15:16:56,124 - INFO - [server.py:93] - Generated server_random: 6773eec846b0bbfdfe5d92f4535b683f000e04c1f1d945984dacb401d91c5a56
2024-12-31 15:16:56,129 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2024-12-31 15:16:56,130 - INFO - [cert.py:108] - File exists: True
2024-12-31 15:16:56,131 - INFO - [cert.py:109] - File size: 1915 bytes
2024-12-31 15:16:56,132 - INFO - [cert.py:113] - Read 1915 bytes
2024-12-31 15:16:56,133 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2024-12-31 15:16:56,134 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2024-12-31 15:16:56,135 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 15:16:56,135 - INFO - [client.py:169] - Prepared client certificate
2024-12-31 15:16:56,136 - INFO - [client.py:184] - Encrypted pre_master_secret length: 256
2024-12-31 15:16:56,138 - INFO - [chain.py:182] - Decrypted pre_master_secret: 03038f03e3018f8b7c34992ba8aafa370144d07cef1a7296174195a1db3d2bbb66b094688cf8f1cb9e04b62f15554ad8
2024-12-31 15:16:56,139 - INFO - [chain.py:193] - Generated master secret: b8f6f2198ccf8b3f061b432dfa913ade14ca32ece9d6dc4b7e9e0d1a8c83bb35d4f35dc74f447ee80f11d737df746d40
2024-12-31 15:16:56,140 - INFO - [client.py:345] - Client ChangeCipherSpec and Finished messages sent
2024-12-31 15:16:56,142 - INFO - [server.py:254] - Pre-master secret validated successfully
2024-12-31 15:16:56,144 - INFO - [server.py:272] - Generated digital signature: 07cd6e8a4e021a532ced6ca3a9513aede8af44217d7a9bc94a929620c0c46be1f51681a4f89d83f6af592a8276487c690a2d4543b857d4d091787cc24bf10eb0ecc41d875e367f522d04aed1bebba6e97bb2674bd8f1ae50e1631e1f173c6983d5ebf36cf4cebd9047cdbee41759bb99c05bd0bd2b4f7eff0c56ccda1cf23ad44b5724baf96f166ba9bf304747dc367ff77467806a3a792a29cfc7ac1d29d41f2807dfc11d4ab9f2c2f7a9e61d75c2404ce6e3ea425181d2ccdde52fc33a6474ad1e0bd0a9a5d966f4361c9842cdf8f2e7e3918eca26cf797f9fa855d1e76e7469852929e93f2e2dea027c5621508434db96b37633e8a9c4e0b2be29484d74cc
2024-12-31 15:16:56,145 - INFO - [server.py:309] - Server ChangeCipherSpec and Finished messages sent
2024-12-31 15:16:56,147 - INFO - [keys.py:193] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2024-12-31 15:16:56,147 - INFO - [session.py:103] - TLS Handshake completed successfully
2024-12-31 15:16:56,148 - INFO - [session.py:130] - Found file to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2024-12-31 15:16:56,148 - INFO - [session.py:148] - Handshake completed: True
2024-12-31 15:16:56,148 - INFO - [session.py:149] - Use client cert: True
2024-12-31 15:16:56,148 - INFO - [session.py:150] - File to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2024-12-31 15:16:56,149 - INFO - [session.py:153] - Using encrypted exchange
2024-12-31 15:16:56,149 - INFO - [session.py:168] - Sending encrypted request data
2024-12-31 15:16:56,150 - INFO - [keys.py:173] - TLS Application Data sent from 192.168.1.1:12345 to 10.0.0.1:443
2024-12-31 15:16:56,151 - INFO - [session.py:179] - Sending encrypted response data
2024-12-31 15:16:56,152 - INFO - [keys.py:173] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2024-12-31 15:16:56,152 - INFO - [session.py:191] - Attempting to send file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2024-12-31 15:16:56,153 - INFO - [session.py:202] - Opening file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2024-12-31 15:16:56,153 - INFO - [session.py:209] - Read 1103 bytes from file
2024-12-31 15:16:56,154 - INFO - [keys.py:173] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2024-12-31 15:16:56,155 - INFO - [session.py:218] - File sent successfully
2024-12-31 15:16:56,156 - INFO - [session.py:193] - File sent successfully
2024-12-31 15:16:56,156 - INFO - [main.py:95] - Session completed successfully for 192.168.1.1
2024-12-31 15:16:56,156 - INFO - [main.py:87] - 
--- Client Session (no certificate) ---
2024-12-31 15:16:56,158 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2024-12-31 15:16:56,158 - INFO - [cert.py:108] - File exists: True
2024-12-31 15:16:56,159 - INFO - [cert.py:109] - File size: 1912 bytes
2024-12-31 15:16:56,159 - INFO - [cert.py:113] - Read 1912 bytes
2024-12-31 15:16:56,160 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2024-12-31 15:16:56,160 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2024-12-31 15:16:56,161 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 15:16:56,162 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2024-12-31 15:16:56,162 - INFO - [cert.py:108] - File exists: True
2024-12-31 15:16:56,163 - INFO - [cert.py:109] - File size: 1643 bytes
2024-12-31 15:16:56,163 - INFO - [cert.py:113] - Read 1643 bytes
2024-12-31 15:16:56,164 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2024-12-31 15:16:56,164 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2024-12-31 15:16:56,164 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 15:16:56,195 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2024-12-31 15:16:56,195 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2024-12-31 15:16:56,196 - INFO - [cert.py:215] - Key size: 2048 bits
2024-12-31 15:16:56,196 - INFO - [cert.py:217] - Public exponent: 65537
2024-12-31 15:16:56,197 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2024-12-31 15:16:56,197 - INFO - [verify.py:58] - Public key comparison results:
2024-12-31 15:16:56,198 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2024-12-31 15:16:56,198 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2024-12-31 15:16:56,199 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2024-12-31 15:16:56,200 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2024-12-31 15:16:56,200 - INFO - [verify.py:136] - Certificate chain verification successful
2024-12-31 15:16:56,201 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2024-12-31 15:16:56,201 - INFO - [chain.py:109] - Certificate chain verification passed
2024-12-31 15:16:56,201 - INFO - [chain.py:116] - Certificate chain loaded successfully
2024-12-31 15:16:56,202 - INFO - [chain.py:117] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2024-12-31 15:16:56,202 - INFO - [chain.py:118] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2024-12-31 15:16:56,203 - INFO - [chain.py:122] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2024-12-31 15:16:56,203 - INFO - [session.py:119] - Starting TLS session
2024-12-31 15:16:56,203 - INFO - [client.py:95] - Generated client_random: 6773eec8fb93e54a915b7168a8b123d971098f903c8c600c91b8268fbf9a45e6
2024-12-31 15:16:56,205 - INFO - [client.py:135] - Client Hello sent from 192.168.1.2
2024-12-31 15:16:56,208 - INFO - [server.py:93] - Generated server_random: 6773eec85bdf2fef9e77133aa9889f5b12273d0c4a274f1a5da30e438dd96f31
2024-12-31 15:16:56,213 - INFO - [client.py:172] - Prepared empty certificate
2024-12-31 15:16:56,213 - INFO - [client.py:184] - Encrypted pre_master_secret length: 256
2024-12-31 15:16:56,216 - INFO - [chain.py:182] - Decrypted pre_master_secret: 03033b3ec4d8b51a802b37a53afb3ad2b1f08e7daec025dc0ce3f74bad7d75389649da412b48c2cb4d06720fc50d992a
2024-12-31 15:16:56,216 - INFO - [chain.py:193] - Generated master secret: f502434868003c0fb43ac3bd81806b26a110ad96cde35626abce2289d4dc7f29dac8275eeb8a55614f81d77047e27c5e
2024-12-31 15:16:56,217 - INFO - [client.py:345] - Client ChangeCipherSpec and Finished messages sent
2024-12-31 15:16:56,219 - INFO - [server.py:254] - Pre-master secret validated successfully
2024-12-31 15:16:56,220 - INFO - [server.py:272] - Generated digital signature: 1a068b25aae999161d2ad4f6ecaf2e8be2197689176e9513bfa5d3ef3669b3ae5279376b85ce7119629a70cfa99f96350c0cb42f6e9cd7cdf5e70690b0aab721dd89ce3f5c23b3493d9a18f13357b030cac95820309a399c4ef890970a2f7e643e24971da1dfee2af9382262781925b040fa484be0f61cb51aa0f55d13a63041dfb8d838bb6fff87ce3d06cb9a513d1ab87c2c11644c761a23b9256f9308e267a556b7ad4198f9841d15584f829163c9e779b84cbcac65ad5ce19f8267fddd1f63d6619c34935e878c14ded26248819c05567139f7a3fad819531f7d8737f80e479d8d1f0e7935f6df96e5f2281e2b1791d1391fa857d2d3cb8a4e9302299fc1
2024-12-31 15:16:56,222 - INFO - [server.py:309] - Server ChangeCipherSpec and Finished messages sent
2024-12-31 15:16:56,224 - INFO - [keys.py:193] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2024-12-31 15:16:56,225 - INFO - [session.py:103] - TLS Handshake completed successfully
2024-12-31 15:16:56,225 - INFO - [session.py:148] - Handshake completed: True
2024-12-31 15:16:56,226 - INFO - [session.py:149] - Use client cert: False
2024-12-31 15:16:56,226 - INFO - [session.py:150] - File to send: None
2024-12-31 15:16:56,227 - INFO - [session.py:156] - Using unencrypted exchange
2024-12-31 15:16:56,228 - INFO - [session.py:256] - Added request packet
2024-12-31 15:16:56,228 - INFO - [session.py:256] - Added response packet
2024-12-31 15:16:56,229 - WARNING - [session.py:233] - Using unencrypted communication
2024-12-31 15:16:56,229 - INFO - [main.py:95] - Session completed successfully for 192.168.1.2
2024-12-31 15:16:56,230 - INFO - [pcap_writer.py:232] - Packet 13: Valid HTTP message
2024-12-31 15:16:56,231 - INFO - [pcap_writer.py:232] - Packet 14: Valid HTTP message
2024-12-31 15:16:56,235 - INFO - [pcap_writer.py:387] - Saved 15 valid packets to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2024-12-31 15:16:56,235 - INFO - [pcap_writer.py:409] - Verifying 15 packets...
2024-12-31 15:16:56,236 - INFO - [pcap_writer.py:413] - Packet 1: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2024-12-31 15:16:56,236 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2024-12-31 15:16:56,237 - INFO - [pcap_writer.py:413] - Packet 2: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2024-12-31 15:16:56,237 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2775
2024-12-31 15:16:56,238 - INFO - [pcap_writer.py:413] - Packet 3: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2024-12-31 15:16:56,238 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 1646
2024-12-31 15:16:56,239 - INFO - [pcap_writer.py:413] - Packet 4: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2024-12-31 15:16:56,239 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2024-12-31 15:16:56,240 - INFO - [pcap_writer.py:413] - Packet 5: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2024-12-31 15:16:56,240 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2024-12-31 15:16:56,241 - INFO - [pcap_writer.py:413] - Packet 6: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2024-12-31 15:16:56,241 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 165
2024-12-31 15:16:56,242 - INFO - [pcap_writer.py:413] - Packet 7: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2024-12-31 15:16:56,242 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 133
2024-12-31 15:16:56,243 - INFO - [pcap_writer.py:413] - Packet 8: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2024-12-31 15:16:56,244 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 1157
2024-12-31 15:16:56,244 - INFO - [pcap_writer.py:413] - Packet 9: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2024-12-31 15:16:56,244 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2024-12-31 15:16:56,245 - INFO - [pcap_writer.py:413] - Packet 10: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2024-12-31 15:16:56,245 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2775
2024-12-31 15:16:56,245 - INFO - [pcap_writer.py:413] - Packet 11: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2024-12-31 15:16:56,246 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 269
2024-12-31 15:16:56,246 - INFO - [pcap_writer.py:413] - Packet 12: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2024-12-31 15:16:56,246 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2024-12-31 15:16:56,247 - INFO - [pcap_writer.py:413] - Packet 13: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2024-12-31 15:16:56,247 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2024-12-31 15:16:56,247 - INFO - [pcap_writer.py:413] - Packet 14: IP / TCP 192.168.1.2:12346 > 10.0.0.1:http PA / Raw
2024-12-31 15:16:56,248 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2024-12-31 15:16:56,248 - INFO - [pcap_writer.py:413] - Packet 15: IP / TCP 10.0.0.1:http > 192.168.1.2:12346 PA / Raw
2024-12-31 15:16:56,248 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2024-12-31 15:16:56,248 - INFO - [pcap_writer.py:427] - Verification complete: 15 valid packets, 15 TLS records
2024-12-31 15:16:56,248 - INFO - [main.py:106] - Results saved to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2024-12-31 15:16:56,248 - INFO - [main.py:160] - TLS session simulation completed successfully
2024-12-31 20:58:08,695 - INFO - [logging.py:83] - Logging configured successfully
2024-12-31 20:58:08,697 - INFO - [logging.py:90] - === Logging Configuration ===
2024-12-31 20:58:08,697 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2024-12-31 20:58:08,698 - INFO - [logging.py:92] - Log level: 20
2024-12-31 20:58:08,699 - INFO - [logging.py:93] - Timestamp: 2024-12-31T20:58:08.699003
2024-12-31 20:58:08,700 - INFO - [logging.py:94] - ==========================
2024-12-31 20:58:08,700 - INFO - [main.py:122] - Starting TLS session simulation
2024-12-31 20:58:08,702 - INFO - [main.py:87] - 
--- Client Session (certificate) ---
2024-12-31 20:58:08,707 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2024-12-31 20:58:08,709 - INFO - [cert.py:108] - File exists: True
2024-12-31 20:58:08,710 - INFO - [cert.py:109] - File size: 1912 bytes
2024-12-31 20:58:08,712 - INFO - [cert.py:113] - Read 1912 bytes
2024-12-31 20:58:08,713 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2024-12-31 20:58:08,714 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2024-12-31 20:58:08,731 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 20:58:08,733 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2024-12-31 20:58:08,735 - INFO - [cert.py:108] - File exists: True
2024-12-31 20:58:08,736 - INFO - [cert.py:109] - File size: 1643 bytes
2024-12-31 20:58:08,739 - INFO - [cert.py:113] - Read 1643 bytes
2024-12-31 20:58:08,740 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2024-12-31 20:58:08,744 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2024-12-31 20:58:08,748 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 20:58:08,843 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2024-12-31 20:58:08,844 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2024-12-31 20:58:08,845 - INFO - [cert.py:215] - Key size: 2048 bits
2024-12-31 20:58:08,845 - INFO - [cert.py:217] - Public exponent: 65537
2024-12-31 20:58:08,848 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2024-12-31 20:58:08,848 - INFO - [verify.py:58] - Public key comparison results:
2024-12-31 20:58:08,848 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2024-12-31 20:58:08,849 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2024-12-31 20:58:08,850 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2024-12-31 20:58:08,851 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2024-12-31 20:58:08,866 - INFO - [verify.py:136] - Certificate chain verification successful
2024-12-31 20:58:08,867 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2024-12-31 20:58:08,868 - INFO - [chain.py:109] - Certificate chain verification passed
2024-12-31 20:58:08,869 - INFO - [chain.py:116] - Certificate chain loaded successfully
2024-12-31 20:58:08,869 - INFO - [chain.py:117] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2024-12-31 20:58:08,870 - INFO - [chain.py:118] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2024-12-31 20:58:08,872 - INFO - [chain.py:122] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2024-12-31 20:58:08,873 - INFO - [session.py:119] - Starting TLS session
2024-12-31 20:58:08,875 - INFO - [client.py:95] - Generated client_random: 67743ec0159f5ead8df30427bf8866c897db22b14ba584268293c2a2d369adc9
2024-12-31 20:58:08,885 - INFO - [client.py:135] - Client Hello sent from 192.168.1.1
2024-12-31 20:58:08,890 - INFO - [server.py:93] - Generated server_random: 67743ec04fa9b3768a7581c1ee2cecc87770db1e40d63acc6748d2735581a15b
2024-12-31 20:58:08,902 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2024-12-31 20:58:08,904 - INFO - [cert.py:108] - File exists: True
2024-12-31 20:58:08,905 - INFO - [cert.py:109] - File size: 1915 bytes
2024-12-31 20:58:08,907 - INFO - [cert.py:113] - Read 1915 bytes
2024-12-31 20:58:08,909 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2024-12-31 20:58:08,911 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2024-12-31 20:58:08,914 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 20:58:08,916 - INFO - [client.py:169] - Prepared client certificate
2024-12-31 20:58:08,917 - INFO - [client.py:184] - Encrypted pre_master_secret length: 256
2024-12-31 20:58:08,923 - INFO - [chain.py:182] - Decrypted pre_master_secret: 0303be543e1c8522dee1b02c21bbc733746c89b0def843e78684e02e35c08105685962801f811697daa194cd88196e9d
2024-12-31 20:58:08,925 - INFO - [chain.py:193] - Generated master secret: c456471a7b6c64b3f4cffda8a14e2e99929cf344b315bd19554f63defddb29eae191a90f374f435259696ccf38ad20d1
2024-12-31 20:58:08,929 - INFO - [client.py:345] - Client ChangeCipherSpec and Finished messages sent
2024-12-31 20:58:08,933 - INFO - [server.py:254] - Pre-master secret validated successfully
2024-12-31 20:58:08,936 - INFO - [server.py:272] - Generated digital signature: 54a32a8b92f97eedf953ed211e4467504ec171a9cd80c6aa0b15cb3a28ca91d523255692f72150ebee61fe789b7e0c61b9fea1acb6f93c747b9d82d2d9bf71dd11ae32db1d7c0a984186ecdf493ecb6b593b9388a28114d8966b4100a842965ce51447aee0e215ef464324cb0c16d0ebd66d72aa3f75b3b75686845260e9cf2292dc30993cc94a3b48ef886d04e1da12edb85b76386dbc55908a87761e0b104d3377abadf5ceb64249885d7cf3b8824065c480a63e683fe60fbe5b85b9f7175341caa3967713d1df5ba3dab05db1c7cfd1a3fcf7d79359b1aba76d2235b669518f0fad139679f30ea073b5e6a5284764f1869a50e835a3a344a89f9a5bf9edf7
2024-12-31 20:58:08,939 - INFO - [server.py:309] - Server ChangeCipherSpec and Finished messages sent
2024-12-31 20:58:08,950 - INFO - [keys.py:206] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2024-12-31 20:58:08,951 - INFO - [session.py:103] - TLS Handshake completed successfully
2024-12-31 20:58:08,953 - INFO - [session.py:130] - Found file to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2024-12-31 20:58:08,955 - INFO - [session.py:148] - Handshake completed: True
2024-12-31 20:58:08,957 - INFO - [session.py:149] - Use client cert: True
2024-12-31 20:58:08,958 - INFO - [session.py:150] - File to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2024-12-31 20:58:08,960 - INFO - [session.py:153] - Using encrypted exchange
2024-12-31 20:58:08,962 - INFO - [session.py:168] - Sending encrypted request data
2024-12-31 20:58:08,966 - ERROR - [keys.py:190] - Error in encrypt_and_send_application_data: name 'explicit_iv' is not defined
2024-12-31 20:58:08,969 - ERROR - [session.py:196] - Encrypted exchange failed: Failed to encrypt and send data: name 'explicit_iv' is not defined
2024-12-31 20:58:08,973 - ERROR - [main.py:27] - Session error: Session failed for 192.168.1.1: Session failed: Encrypted exchange failed: Failed to encrypt and send data: name 'explicit_iv' is not defined
2024-12-31 20:58:14,111 - INFO - [logging.py:83] - Logging configured successfully
2024-12-31 20:58:14,111 - INFO - [logging.py:90] - === Logging Configuration ===
2024-12-31 20:58:14,112 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2024-12-31 20:58:14,112 - INFO - [logging.py:92] - Log level: 20
2024-12-31 20:58:14,113 - INFO - [logging.py:93] - Timestamp: 2024-12-31T20:58:14.113160
2024-12-31 20:58:14,113 - INFO - [logging.py:94] - ==========================
2024-12-31 20:58:14,113 - INFO - [main.py:122] - Starting TLS session simulation
2024-12-31 20:58:14,114 - INFO - [main.py:87] - 
--- Client Session (certificate) ---
2024-12-31 20:58:14,114 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2024-12-31 20:58:14,115 - INFO - [cert.py:108] - File exists: True
2024-12-31 20:58:14,115 - INFO - [cert.py:109] - File size: 1912 bytes
2024-12-31 20:58:14,115 - INFO - [cert.py:113] - Read 1912 bytes
2024-12-31 20:58:14,116 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2024-12-31 20:58:14,116 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2024-12-31 20:58:14,117 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 20:58:14,118 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2024-12-31 20:58:14,119 - INFO - [cert.py:108] - File exists: True
2024-12-31 20:58:14,119 - INFO - [cert.py:109] - File size: 1643 bytes
2024-12-31 20:58:14,120 - INFO - [cert.py:113] - Read 1643 bytes
2024-12-31 20:58:14,120 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2024-12-31 20:58:14,121 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2024-12-31 20:58:14,122 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 20:58:14,153 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2024-12-31 20:58:14,154 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2024-12-31 20:58:14,154 - INFO - [cert.py:215] - Key size: 2048 bits
2024-12-31 20:58:14,154 - INFO - [cert.py:217] - Public exponent: 65537
2024-12-31 20:58:14,157 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2024-12-31 20:58:14,158 - INFO - [verify.py:58] - Public key comparison results:
2024-12-31 20:58:14,158 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2024-12-31 20:58:14,160 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2024-12-31 20:58:14,161 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2024-12-31 20:58:14,161 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2024-12-31 20:58:14,168 - INFO - [verify.py:136] - Certificate chain verification successful
2024-12-31 20:58:14,168 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2024-12-31 20:58:14,169 - INFO - [chain.py:109] - Certificate chain verification passed
2024-12-31 20:58:14,169 - INFO - [chain.py:116] - Certificate chain loaded successfully
2024-12-31 20:58:14,170 - INFO - [chain.py:117] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2024-12-31 20:58:14,170 - INFO - [chain.py:118] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2024-12-31 20:58:14,170 - INFO - [chain.py:122] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2024-12-31 20:58:14,171 - INFO - [session.py:119] - Starting TLS session
2024-12-31 20:58:14,171 - INFO - [client.py:95] - Generated client_random: 67743ec6a90d8e4ae2a6ab497e09310ca7da40f84c3a3fe7671fba8789b19977
2024-12-31 20:58:14,174 - INFO - [client.py:135] - Client Hello sent from 192.168.1.1
2024-12-31 20:58:14,177 - INFO - [server.py:93] - Generated server_random: 67743ec6a2e1ecb5f55d9406caca0efdbf6e890676d9538d33fa3234db521db4
2024-12-31 20:58:14,181 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2024-12-31 20:58:14,182 - INFO - [cert.py:108] - File exists: True
2024-12-31 20:58:14,182 - INFO - [cert.py:109] - File size: 1915 bytes
2024-12-31 20:58:14,182 - INFO - [cert.py:113] - Read 1915 bytes
2024-12-31 20:58:14,183 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2024-12-31 20:58:14,183 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2024-12-31 20:58:14,184 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 20:58:14,184 - INFO - [client.py:169] - Prepared client certificate
2024-12-31 20:58:14,185 - INFO - [client.py:184] - Encrypted pre_master_secret length: 256
2024-12-31 20:58:14,187 - INFO - [chain.py:182] - Decrypted pre_master_secret: 0303685949552358b425b734a2e0ac7fe26ec8e801a545d56cb551f0a206e127174d84fa7248aa2be509e06128e2120b
2024-12-31 20:58:14,187 - INFO - [chain.py:193] - Generated master secret: a56bb4e26edfc73cb9d4f68b4e331055121d15dc33d0ac20f04984101733a39923a95fe482420a7c2eeb59a2b788beed
2024-12-31 20:58:14,188 - INFO - [client.py:345] - Client ChangeCipherSpec and Finished messages sent
2024-12-31 20:58:14,190 - INFO - [server.py:254] - Pre-master secret validated successfully
2024-12-31 20:58:14,192 - INFO - [server.py:272] - Generated digital signature: 304b8a6728b43fbb52b28e9548fc7c854030bacac23ae47376fdb2643aaa1531eecd1a4365dc31f91e68b12c7343ff743f11449ad6e407b56aa08bf28c10ac31995712498374ad4b0a2d2a840fe4cb76dce251e3dc717b2e6798a402588151aaf00385af2ad458c6c74c9eb69f349d3f7e1fdde210f328b3ec19000ec4fbdcc7f36eb766c9cc167509cdb176e06007058c63af050d71283a1d3ff1b0e58e5529b04884278d57fd315acfda3c84bb0b3c8f6fb4c316fd244ccac0abeadb1ce3550e80d4d8e074ae63e10f4d82e024801e9c2e0d18cf7445658765c02c550408d0f547269ff67836ab6db15dcdcc6e179c86f1ccca1ef2d786c042b531bd09c293
2024-12-31 20:58:14,194 - INFO - [server.py:309] - Server ChangeCipherSpec and Finished messages sent
2024-12-31 20:58:14,196 - INFO - [keys.py:206] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2024-12-31 20:58:14,196 - INFO - [session.py:103] - TLS Handshake completed successfully
2024-12-31 20:58:14,197 - INFO - [session.py:130] - Found file to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2024-12-31 20:58:14,197 - INFO - [session.py:148] - Handshake completed: True
2024-12-31 20:58:14,198 - INFO - [session.py:149] - Use client cert: True
2024-12-31 20:58:14,198 - INFO - [session.py:150] - File to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2024-12-31 20:58:14,198 - INFO - [session.py:153] - Using encrypted exchange
2024-12-31 20:58:14,198 - INFO - [session.py:168] - Sending encrypted request data
2024-12-31 20:58:14,199 - ERROR - [keys.py:190] - Error in encrypt_and_send_application_data: name 'explicit_iv' is not defined
2024-12-31 20:58:14,199 - ERROR - [session.py:196] - Encrypted exchange failed: Failed to encrypt and send data: name 'explicit_iv' is not defined
2024-12-31 20:58:14,200 - ERROR - [main.py:27] - Session error: Session failed for 192.168.1.1: Session failed: Encrypted exchange failed: Failed to encrypt and send data: name 'explicit_iv' is not defined
2024-12-31 20:59:46,745 - INFO - [logging.py:83] - Logging configured successfully
2024-12-31 20:59:46,746 - INFO - [logging.py:90] - === Logging Configuration ===
2024-12-31 20:59:46,746 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2024-12-31 20:59:46,747 - INFO - [logging.py:92] - Log level: 20
2024-12-31 20:59:46,747 - INFO - [logging.py:93] - Timestamp: 2024-12-31T20:59:46.747416
2024-12-31 20:59:46,747 - INFO - [logging.py:94] - ==========================
2024-12-31 20:59:46,748 - INFO - [main.py:122] - Starting TLS session simulation
2024-12-31 20:59:46,749 - INFO - [main.py:87] - 
--- Client Session (certificate) ---
2024-12-31 20:59:46,750 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2024-12-31 20:59:46,751 - INFO - [cert.py:108] - File exists: True
2024-12-31 20:59:46,751 - INFO - [cert.py:109] - File size: 1912 bytes
2024-12-31 20:59:46,752 - INFO - [cert.py:113] - Read 1912 bytes
2024-12-31 20:59:46,752 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2024-12-31 20:59:46,754 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2024-12-31 20:59:46,755 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 20:59:46,755 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2024-12-31 20:59:46,756 - INFO - [cert.py:108] - File exists: True
2024-12-31 20:59:46,756 - INFO - [cert.py:109] - File size: 1643 bytes
2024-12-31 20:59:46,757 - INFO - [cert.py:113] - Read 1643 bytes
2024-12-31 20:59:46,757 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2024-12-31 20:59:46,758 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2024-12-31 20:59:46,759 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 20:59:46,790 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2024-12-31 20:59:46,792 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2024-12-31 20:59:46,792 - INFO - [cert.py:215] - Key size: 2048 bits
2024-12-31 20:59:46,792 - INFO - [cert.py:217] - Public exponent: 65537
2024-12-31 20:59:46,795 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2024-12-31 20:59:46,795 - INFO - [verify.py:58] - Public key comparison results:
2024-12-31 20:59:46,796 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2024-12-31 20:59:46,797 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2024-12-31 20:59:46,798 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2024-12-31 20:59:46,798 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2024-12-31 20:59:46,801 - INFO - [verify.py:136] - Certificate chain verification successful
2024-12-31 20:59:46,802 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2024-12-31 20:59:46,802 - INFO - [chain.py:109] - Certificate chain verification passed
2024-12-31 20:59:46,803 - INFO - [chain.py:116] - Certificate chain loaded successfully
2024-12-31 20:59:46,803 - INFO - [chain.py:117] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2024-12-31 20:59:46,804 - INFO - [chain.py:118] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2024-12-31 20:59:46,805 - INFO - [chain.py:122] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2024-12-31 20:59:46,806 - INFO - [session.py:119] - Starting TLS session
2024-12-31 20:59:46,806 - INFO - [client.py:95] - Generated client_random: 67743f22ca9eba6f88d19e4ac3a9dcf7beded0e6da2c6065a0383199c190eb82
2024-12-31 20:59:46,811 - INFO - [client.py:135] - Client Hello sent from 192.168.1.1
2024-12-31 20:59:46,815 - INFO - [server.py:93] - Generated server_random: 67743f22b2c893a905b8571a15b74bd46ab88dcb8df9c508404ac35da9c02661
2024-12-31 20:59:46,819 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2024-12-31 20:59:46,820 - INFO - [cert.py:108] - File exists: True
2024-12-31 20:59:46,820 - INFO - [cert.py:109] - File size: 1915 bytes
2024-12-31 20:59:46,821 - INFO - [cert.py:113] - Read 1915 bytes
2024-12-31 20:59:46,821 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2024-12-31 20:59:46,822 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2024-12-31 20:59:46,824 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 20:59:46,824 - INFO - [client.py:169] - Prepared client certificate
2024-12-31 20:59:46,825 - INFO - [client.py:184] - Encrypted pre_master_secret length: 256
2024-12-31 20:59:46,832 - INFO - [chain.py:182] - Decrypted pre_master_secret: 03038b025e4b288179635c2ca158f240632dbd1980c40a8ad0b94cdba0fa462fb3c9e6919c9a8b6efe436b22f78384ce
2024-12-31 20:59:46,833 - INFO - [chain.py:193] - Generated master secret: ff6863353add7758e3dcd72490f356b87bf91d5076a486b5ceac64e260472bba51a756eb83f97e7a6f3a174046a5823d
2024-12-31 20:59:46,834 - INFO - [client.py:345] - Client ChangeCipherSpec and Finished messages sent
2024-12-31 20:59:46,837 - INFO - [server.py:254] - Pre-master secret validated successfully
2024-12-31 20:59:46,839 - INFO - [server.py:272] - Generated digital signature: 401e18d3897eb6f1acfa39f45edb0cf506616db7458579e8766c64b1751412271d91dc97d3b1ddc3e37a74f33f51e8783cf18487095b1a665685ffd848d76b0d25d1732cf7b0ef94cce36e1a34fff34f2b789392c9017cdc805b6d49b6dc83220688a976d77928f1cc221e33cbd84c2c3cd788aaf5a93e093f8cb7a8b5a8cd96fbfa73d6ca3b5e2e5bb592473cf159fe3e0c03e2a59a29ae3b9a23780b0f46fbd73c779232f057044d82d83488daea4080ae81799b71133228ff52582ac84b294b84a5e339abdfcd7166f569b2ab30dccd3e045fd189f05fe74cdf947942fd311e965a843029cf3c5843ab956ae45665148e281f4b6ad4784676f4d6872955cb
2024-12-31 20:59:46,845 - INFO - [server.py:309] - Server ChangeCipherSpec and Finished messages sent
2024-12-31 20:59:46,876 - INFO - [keys.py:198] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2024-12-31 20:59:46,877 - INFO - [session.py:103] - TLS Handshake completed successfully
2024-12-31 20:59:46,878 - INFO - [session.py:130] - Found file to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2024-12-31 20:59:46,880 - INFO - [session.py:148] - Handshake completed: True
2024-12-31 20:59:46,881 - INFO - [session.py:149] - Use client cert: True
2024-12-31 20:59:46,885 - INFO - [session.py:150] - File to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2024-12-31 20:59:46,886 - INFO - [session.py:153] - Using encrypted exchange
2024-12-31 20:59:46,889 - INFO - [session.py:168] - Sending encrypted request data
2024-12-31 20:59:46,914 - INFO - [keys.py:178] - TLS Application Data sent from 192.168.1.1:12345 to 10.0.0.1:443
2024-12-31 20:59:46,922 - INFO - [session.py:179] - Sending encrypted response data
2024-12-31 20:59:46,946 - INFO - [keys.py:178] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2024-12-31 20:59:46,951 - INFO - [session.py:191] - Attempting to send file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2024-12-31 20:59:46,955 - INFO - [session.py:202] - Opening file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2024-12-31 20:59:46,962 - INFO - [session.py:209] - Read 1103 bytes from file
2024-12-31 20:59:46,977 - INFO - [keys.py:178] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2024-12-31 20:59:46,982 - INFO - [session.py:218] - File sent successfully
2024-12-31 20:59:46,983 - INFO - [session.py:193] - File sent successfully
2024-12-31 20:59:46,984 - INFO - [main.py:95] - Session completed successfully for 192.168.1.1
2024-12-31 20:59:46,985 - INFO - [main.py:87] - 
--- Client Session (no certificate) ---
2024-12-31 20:59:46,989 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2024-12-31 20:59:46,996 - INFO - [cert.py:108] - File exists: True
2024-12-31 20:59:46,998 - INFO - [cert.py:109] - File size: 1912 bytes
2024-12-31 20:59:47,000 - INFO - [cert.py:113] - Read 1912 bytes
2024-12-31 20:59:47,001 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2024-12-31 20:59:47,003 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2024-12-31 20:59:47,006 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 20:59:47,010 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2024-12-31 20:59:47,013 - INFO - [cert.py:108] - File exists: True
2024-12-31 20:59:47,015 - INFO - [cert.py:109] - File size: 1643 bytes
2024-12-31 20:59:47,016 - INFO - [cert.py:113] - Read 1643 bytes
2024-12-31 20:59:47,018 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2024-12-31 20:59:47,019 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2024-12-31 20:59:47,022 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 20:59:47,067 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2024-12-31 20:59:47,067 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2024-12-31 20:59:47,067 - INFO - [cert.py:215] - Key size: 2048 bits
2024-12-31 20:59:47,068 - INFO - [cert.py:217] - Public exponent: 65537
2024-12-31 20:59:47,068 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2024-12-31 20:59:47,068 - INFO - [verify.py:58] - Public key comparison results:
2024-12-31 20:59:47,069 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2024-12-31 20:59:47,070 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2024-12-31 20:59:47,071 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2024-12-31 20:59:47,071 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2024-12-31 20:59:47,072 - INFO - [verify.py:136] - Certificate chain verification successful
2024-12-31 20:59:47,072 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2024-12-31 20:59:47,073 - INFO - [chain.py:109] - Certificate chain verification passed
2024-12-31 20:59:47,073 - INFO - [chain.py:116] - Certificate chain loaded successfully
2024-12-31 20:59:47,073 - INFO - [chain.py:117] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2024-12-31 20:59:47,074 - INFO - [chain.py:118] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2024-12-31 20:59:47,074 - INFO - [chain.py:122] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2024-12-31 20:59:47,074 - INFO - [session.py:119] - Starting TLS session
2024-12-31 20:59:47,074 - INFO - [client.py:95] - Generated client_random: 67743f23fc15afab8115dd81723ea2bd48b8b8592763624ec538725f4ba40555
2024-12-31 20:59:47,076 - INFO - [client.py:135] - Client Hello sent from 192.168.1.2
2024-12-31 20:59:47,078 - INFO - [server.py:93] - Generated server_random: 67743f23ff06ed2a178bc5a591b7cfcb67117f3fe04845e2332c058f8e5f9c84
2024-12-31 20:59:47,081 - INFO - [client.py:172] - Prepared empty certificate
2024-12-31 20:59:47,082 - INFO - [client.py:184] - Encrypted pre_master_secret length: 256
2024-12-31 20:59:47,083 - INFO - [chain.py:182] - Decrypted pre_master_secret: 030324909392c11e971b96abf733c7420c64841bc94e0414e40d34f5221962cf74a1f0f5bca919bc984f5608c32cf05b
2024-12-31 20:59:47,084 - INFO - [chain.py:193] - Generated master secret: 1e089f369f9b768c0c05b573038b5e3942ad94d1b0f9acef853664a95e0c8f990428199bf8877bf4b2edf24828c0505d
2024-12-31 20:59:47,084 - INFO - [client.py:345] - Client ChangeCipherSpec and Finished messages sent
2024-12-31 20:59:47,088 - INFO - [server.py:254] - Pre-master secret validated successfully
2024-12-31 20:59:47,089 - INFO - [server.py:272] - Generated digital signature: 72e5772359cff677a3376122abf6f8d8957f9d17d600b48ef7ef4364f48e765b76bac98c1870ff270daf6e295d333d1043449bff511a1e34f208558f88cb81f99e627818f644463100dd0bedbffe16cea3f81b1a35e66dce54ff4605bb5ccfc20130f037ec4188ad93bf16442151b57f89a6d097bfc9c7ed7928eeac533abec5c83248bb8cb506b44bca2138efd870019a744f13a476de7075520f279892bfbcf6d6344298dfd723501dfe69fa01fe35f26f99c151ea0b662963f21d70143342ac6646998d41a639a9b698f5d5994f7d302dbdbff99fcfdb3bb944b6ce2f748c5695c8954b8e8d89a578c2bde029441fc48668b985b1df643ca3e8a8d1930457
2024-12-31 20:59:47,090 - INFO - [server.py:309] - Server ChangeCipherSpec and Finished messages sent
2024-12-31 20:59:47,091 - INFO - [keys.py:198] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2024-12-31 20:59:47,092 - INFO - [session.py:103] - TLS Handshake completed successfully
2024-12-31 20:59:47,092 - INFO - [session.py:148] - Handshake completed: True
2024-12-31 20:59:47,092 - INFO - [session.py:149] - Use client cert: False
2024-12-31 20:59:47,093 - INFO - [session.py:150] - File to send: None
2024-12-31 20:59:47,093 - INFO - [session.py:156] - Using unencrypted exchange
2024-12-31 20:59:47,093 - INFO - [session.py:256] - Added request packet
2024-12-31 20:59:47,094 - INFO - [session.py:256] - Added response packet
2024-12-31 20:59:47,094 - WARNING - [session.py:233] - Using unencrypted communication
2024-12-31 20:59:47,095 - INFO - [main.py:95] - Session completed successfully for 192.168.1.2
2024-12-31 20:59:47,095 - INFO - [pcap_writer.py:232] - Packet 13: Valid HTTP message
2024-12-31 20:59:47,095 - INFO - [pcap_writer.py:232] - Packet 14: Valid HTTP message
2024-12-31 20:59:47,100 - INFO - [pcap_writer.py:387] - Saved 15 valid packets to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2024-12-31 20:59:47,101 - INFO - [pcap_writer.py:409] - Verifying 15 packets...
2024-12-31 20:59:47,101 - INFO - [pcap_writer.py:413] - Packet 1: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2024-12-31 20:59:47,102 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2024-12-31 20:59:47,102 - INFO - [pcap_writer.py:413] - Packet 2: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2024-12-31 20:59:47,103 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2775
2024-12-31 20:59:47,104 - INFO - [pcap_writer.py:413] - Packet 3: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2024-12-31 20:59:47,105 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 1646
2024-12-31 20:59:47,105 - INFO - [pcap_writer.py:413] - Packet 4: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2024-12-31 20:59:47,106 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2024-12-31 20:59:47,106 - INFO - [pcap_writer.py:413] - Packet 5: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2024-12-31 20:59:47,107 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2024-12-31 20:59:47,107 - INFO - [pcap_writer.py:413] - Packet 6: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2024-12-31 20:59:47,107 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 165
2024-12-31 20:59:47,108 - INFO - [pcap_writer.py:413] - Packet 7: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2024-12-31 20:59:47,108 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 133
2024-12-31 20:59:47,108 - INFO - [pcap_writer.py:413] - Packet 8: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2024-12-31 20:59:47,108 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 1157
2024-12-31 20:59:47,109 - INFO - [pcap_writer.py:413] - Packet 9: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2024-12-31 20:59:47,109 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2024-12-31 20:59:47,109 - INFO - [pcap_writer.py:413] - Packet 10: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2024-12-31 20:59:47,109 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2775
2024-12-31 20:59:47,109 - INFO - [pcap_writer.py:413] - Packet 11: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2024-12-31 20:59:47,110 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 269
2024-12-31 20:59:47,110 - INFO - [pcap_writer.py:413] - Packet 12: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2024-12-31 20:59:47,110 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2024-12-31 20:59:47,110 - INFO - [pcap_writer.py:413] - Packet 13: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2024-12-31 20:59:47,110 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2024-12-31 20:59:47,110 - INFO - [pcap_writer.py:413] - Packet 14: IP / TCP 192.168.1.2:12346 > 10.0.0.1:http PA / Raw
2024-12-31 20:59:47,111 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2024-12-31 20:59:47,111 - INFO - [pcap_writer.py:413] - Packet 15: IP / TCP 10.0.0.1:http > 192.168.1.2:12346 PA / Raw
2024-12-31 20:59:47,112 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2024-12-31 20:59:47,112 - INFO - [pcap_writer.py:427] - Verification complete: 15 valid packets, 15 TLS records
2024-12-31 20:59:47,112 - INFO - [main.py:106] - Results saved to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2024-12-31 20:59:47,112 - INFO - [main.py:160] - TLS session simulation completed successfully
2024-12-31 22:08:41,424 - INFO - [logging.py:83] - Logging configured successfully
2024-12-31 22:08:41,425 - INFO - [logging.py:90] - === Logging Configuration ===
2024-12-31 22:08:41,426 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2024-12-31 22:08:41,426 - INFO - [logging.py:92] - Log level: 20
2024-12-31 22:08:41,427 - INFO - [logging.py:93] - Timestamp: 2024-12-31T22:08:41.427104
2024-12-31 22:08:41,427 - INFO - [logging.py:94] - ==========================
2024-12-31 22:08:41,428 - INFO - [main.py:122] - Starting TLS session simulation
2024-12-31 22:08:41,429 - INFO - [main.py:87] - 
--- Client Session (certificate) ---
2024-12-31 22:08:41,432 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2024-12-31 22:08:41,433 - INFO - [cert.py:108] - File exists: True
2024-12-31 22:08:41,433 - INFO - [cert.py:109] - File size: 1912 bytes
2024-12-31 22:08:41,435 - INFO - [cert.py:113] - Read 1912 bytes
2024-12-31 22:08:41,436 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2024-12-31 22:08:41,437 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2024-12-31 22:08:41,442 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 22:08:41,442 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2024-12-31 22:08:41,444 - INFO - [cert.py:108] - File exists: True
2024-12-31 22:08:41,445 - INFO - [cert.py:109] - File size: 1643 bytes
2024-12-31 22:08:41,446 - INFO - [cert.py:113] - Read 1643 bytes
2024-12-31 22:08:41,446 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2024-12-31 22:08:41,446 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2024-12-31 22:08:41,447 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 22:08:41,498 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2024-12-31 22:08:41,498 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2024-12-31 22:08:41,499 - INFO - [cert.py:215] - Key size: 2048 bits
2024-12-31 22:08:41,500 - INFO - [cert.py:217] - Public exponent: 65537
2024-12-31 22:08:41,505 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2024-12-31 22:08:41,505 - INFO - [verify.py:58] - Public key comparison results:
2024-12-31 22:08:41,506 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2024-12-31 22:08:41,506 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2024-12-31 22:08:41,507 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2024-12-31 22:08:41,507 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2024-12-31 22:08:41,513 - INFO - [verify.py:136] - Certificate chain verification successful
2024-12-31 22:08:41,515 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2024-12-31 22:08:41,515 - INFO - [chain.py:110] - Certificate chain verification passed
2024-12-31 22:08:41,515 - INFO - [chain.py:117] - Certificate chain loaded successfully
2024-12-31 22:08:41,516 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2024-12-31 22:08:41,516 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2024-12-31 22:08:41,517 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2024-12-31 22:08:41,518 - INFO - [session.py:120] - Starting TLS session
2024-12-31 22:08:41,518 - INFO - [client.py:95] - Generated client_random: 67744f4916b384d16d6b4b50f6898c5414f56bdef7384ccd3622f0ccab3d7294
2024-12-31 22:08:41,521 - INFO - [client.py:135] - Client Hello sent from 192.168.1.1
2024-12-31 22:08:41,524 - INFO - [server.py:93] - Generated server_random: 67744f495861356c03c371db70a968295ee7cc23afb40dfa2418c1f8e82bf848
2024-12-31 22:08:41,531 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2024-12-31 22:08:41,532 - INFO - [cert.py:108] - File exists: True
2024-12-31 22:08:41,532 - INFO - [cert.py:109] - File size: 1915 bytes
2024-12-31 22:08:41,534 - INFO - [cert.py:113] - Read 1915 bytes
2024-12-31 22:08:41,534 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2024-12-31 22:08:41,535 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2024-12-31 22:08:41,536 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 22:08:41,537 - INFO - [client.py:169] - Prepared client certificate
2024-12-31 22:08:41,538 - INFO - [client.py:184] - Encrypted pre_master_secret length: 256
2024-12-31 22:08:41,541 - INFO - [chain.py:185] - Decrypted pre_master_secret: 0303d3dac765e0c55bfd2ac98130bdd4cb36c689fa75403d842a47194218611ce8b03650cd5fb0129b4382f847142234
2024-12-31 22:08:41,543 - INFO - [chain.py:195] - Generated master secret: df1613bb0218447c85d6444ad26d5e1a7069d0c710ef4a7a4a9c02ebcb4af11bafee1ed0a21a24f3aab275e4c3c0a4be
2024-12-31 22:08:41,544 - INFO - [chain.py:196] - Master secret length: 48 bytes
2024-12-31 22:08:41,546 - INFO - [client.py:345] - Client ChangeCipherSpec and Finished messages sent
2024-12-31 22:08:41,548 - INFO - [server.py:254] - Pre-master secret validated successfully
2024-12-31 22:08:41,549 - INFO - [server.py:272] - Generated digital signature: 8887bb93f08b6c60a5bd843182c2fd365ea26a91091dcf608ef1e1e14969bf8553764eaa90a782c7f54ea216808c0602576c4b31314b5fc6f7889e0b1fc6bcda64afdb7f5398185a25a4613e26c8043e5683776ce1ee427d75629ff4d1b88ba8587e1106afa0f50489a492cf82516f015202f30039f19c8130f4abd64c8d61bdc57083ee91d3e412e994b5644bf406013fb169ffd61da7f472f211c0a222acff2cb06ba4c358537926f802fa2dceaad311a6b88858e0b34245f3e390ef1cc0fcf22bc4bd926cf5029434b562a66f3dd02aeb1c7c04bfe2be0b3f07b215e7a0805af719e275e38aab3ebfadd1bcfbc92935eddb4d7c4e744c5973027a3709903d
2024-12-31 22:08:41,551 - INFO - [server.py:309] - Server ChangeCipherSpec and Finished messages sent
2024-12-31 22:08:41,554 - INFO - [keys.py:200] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2024-12-31 22:08:41,555 - INFO - [session.py:104] - TLS Handshake completed successfully
2024-12-31 22:08:41,556 - INFO - [session.py:131] - Found file to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2024-12-31 22:08:41,557 - INFO - [session.py:149] - Handshake completed: True
2024-12-31 22:08:41,559 - INFO - [session.py:150] - Use client cert: True
2024-12-31 22:08:41,560 - INFO - [session.py:151] - File to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2024-12-31 22:08:41,560 - INFO - [session.py:154] - Using encrypted exchange
2024-12-31 22:08:41,561 - INFO - [session.py:169] - Sending encrypted request data
2024-12-31 22:08:41,563 - INFO - [keys.py:180] - TLS Application Data sent from 192.168.1.1:12345 to 10.0.0.1:443
2024-12-31 22:08:41,564 - INFO - [session.py:180] - Sending encrypted response data
2024-12-31 22:08:41,566 - INFO - [keys.py:180] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2024-12-31 22:08:41,567 - INFO - [session.py:192] - Attempting to send file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2024-12-31 22:08:41,567 - INFO - [session.py:203] - Opening file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2024-12-31 22:08:41,568 - INFO - [session.py:210] - Read 1103 bytes from file
2024-12-31 22:08:41,570 - INFO - [keys.py:180] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2024-12-31 22:08:41,571 - INFO - [session.py:219] - File sent successfully
2024-12-31 22:08:41,572 - INFO - [session.py:194] - File sent successfully
2024-12-31 22:08:41,572 - INFO - [main.py:95] - Session completed successfully for 192.168.1.1
2024-12-31 22:08:41,573 - INFO - [main.py:87] - 
--- Client Session (no certificate) ---
2024-12-31 22:08:41,576 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2024-12-31 22:08:41,578 - INFO - [cert.py:108] - File exists: True
2024-12-31 22:08:41,579 - INFO - [cert.py:109] - File size: 1912 bytes
2024-12-31 22:08:41,579 - INFO - [cert.py:113] - Read 1912 bytes
2024-12-31 22:08:41,580 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2024-12-31 22:08:41,581 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2024-12-31 22:08:41,582 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 22:08:41,582 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2024-12-31 22:08:41,583 - INFO - [cert.py:108] - File exists: True
2024-12-31 22:08:41,583 - INFO - [cert.py:109] - File size: 1643 bytes
2024-12-31 22:08:41,584 - INFO - [cert.py:113] - Read 1643 bytes
2024-12-31 22:08:41,585 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2024-12-31 22:08:41,585 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2024-12-31 22:08:41,587 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 22:08:41,623 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2024-12-31 22:08:41,624 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2024-12-31 22:08:41,625 - INFO - [cert.py:215] - Key size: 2048 bits
2024-12-31 22:08:41,625 - INFO - [cert.py:217] - Public exponent: 65537
2024-12-31 22:08:41,625 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2024-12-31 22:08:41,626 - INFO - [verify.py:58] - Public key comparison results:
2024-12-31 22:08:41,626 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2024-12-31 22:08:41,627 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2024-12-31 22:08:41,628 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2024-12-31 22:08:41,628 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2024-12-31 22:08:41,628 - INFO - [verify.py:136] - Certificate chain verification successful
2024-12-31 22:08:41,629 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2024-12-31 22:08:41,629 - INFO - [chain.py:110] - Certificate chain verification passed
2024-12-31 22:08:41,629 - INFO - [chain.py:117] - Certificate chain loaded successfully
2024-12-31 22:08:41,630 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2024-12-31 22:08:41,630 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2024-12-31 22:08:41,631 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2024-12-31 22:08:41,631 - INFO - [session.py:120] - Starting TLS session
2024-12-31 22:08:41,632 - INFO - [client.py:95] - Generated client_random: 67744f49600418751b823fcfab8bb5893c831e65f9f634ee1196aa13f79fb844
2024-12-31 22:08:41,634 - INFO - [client.py:135] - Client Hello sent from 192.168.1.2
2024-12-31 22:08:41,637 - INFO - [server.py:93] - Generated server_random: 67744f49b76a72ac8a0e85f339d6777fc684474da97529ab5898801043f3631c
2024-12-31 22:08:41,643 - INFO - [client.py:172] - Prepared empty certificate
2024-12-31 22:08:41,647 - INFO - [client.py:184] - Encrypted pre_master_secret length: 256
2024-12-31 22:08:41,649 - INFO - [chain.py:185] - Decrypted pre_master_secret: 03030c7a4d8020ced3ef450282981fae45b6ed6529fcbc3b0282d2eb34c9b61abb4ed4c2856afd156f98d8a66e3dd0b4
2024-12-31 22:08:41,650 - INFO - [chain.py:195] - Generated master secret: 17f4a955c21dda17523d245cbb28f2efa49e9757c34c4610e510f49baeabd2ce59316f67f0265ec5958e49d9523e50a7
2024-12-31 22:08:41,650 - INFO - [chain.py:196] - Master secret length: 48 bytes
2024-12-31 22:08:41,652 - INFO - [client.py:345] - Client ChangeCipherSpec and Finished messages sent
2024-12-31 22:08:41,654 - INFO - [server.py:254] - Pre-master secret validated successfully
2024-12-31 22:08:41,655 - INFO - [server.py:272] - Generated digital signature: 09fe35dd287031e84c07c93488d15be282a4fb49196c704b6c538cdda26529c80c532392e2f48a127ab2cd3d8c7a135f39eb2bf27ef1d10a6b63c44c06ba637e7b9f1729af4aa909d4f80e8bd57a5cf9ad467b5ce859a3cd58da2aaa0178e971e5aca9f300a454fa4b0b65f5f524cdd037eee93d151ac173109773b0c0502dc2abd91c4023ddea651453de14c4209e4fc2b80a2bd48b2dab3206560397d58b3adb8525d04c8b2b097c5b99191427a26361daf485661c669d2dbac9ff464d2987029f0b1162126001d226dde41294ccfedf3036bfbed1975d8f18d564bb4b0d87e9f02c73a3897e9e507ab43dc5642221cee3b389ae71b7bcd52387e691e275cf
2024-12-31 22:08:41,659 - INFO - [server.py:309] - Server ChangeCipherSpec and Finished messages sent
2024-12-31 22:08:41,661 - INFO - [keys.py:200] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2024-12-31 22:08:41,662 - INFO - [session.py:104] - TLS Handshake completed successfully
2024-12-31 22:08:41,662 - INFO - [session.py:149] - Handshake completed: True
2024-12-31 22:08:41,662 - INFO - [session.py:150] - Use client cert: False
2024-12-31 22:08:41,663 - INFO - [session.py:151] - File to send: None
2024-12-31 22:08:41,663 - INFO - [session.py:157] - Using unencrypted exchange
2024-12-31 22:08:41,664 - INFO - [session.py:257] - Added request packet
2024-12-31 22:08:41,664 - INFO - [session.py:257] - Added response packet
2024-12-31 22:08:41,665 - WARNING - [session.py:234] - Using unencrypted communication
2024-12-31 22:08:41,665 - INFO - [main.py:95] - Session completed successfully for 192.168.1.2
2024-12-31 22:08:41,666 - INFO - [pcap_writer.py:232] - Packet 13: Valid HTTP message
2024-12-31 22:08:41,666 - INFO - [pcap_writer.py:232] - Packet 14: Valid HTTP message
2024-12-31 22:08:41,672 - INFO - [pcap_writer.py:387] - Saved 15 valid packets to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2024-12-31 22:08:41,673 - INFO - [pcap_writer.py:409] - Verifying 15 packets...
2024-12-31 22:08:41,674 - INFO - [pcap_writer.py:413] - Packet 1: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2024-12-31 22:08:41,675 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2024-12-31 22:08:41,676 - INFO - [pcap_writer.py:413] - Packet 2: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2024-12-31 22:08:41,676 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2775
2024-12-31 22:08:41,677 - INFO - [pcap_writer.py:413] - Packet 3: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2024-12-31 22:08:41,677 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 1646
2024-12-31 22:08:41,677 - INFO - [pcap_writer.py:413] - Packet 4: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2024-12-31 22:08:41,678 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2024-12-31 22:08:41,678 - INFO - [pcap_writer.py:413] - Packet 5: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2024-12-31 22:08:41,678 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2024-12-31 22:08:41,679 - INFO - [pcap_writer.py:413] - Packet 6: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2024-12-31 22:08:41,679 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 165
2024-12-31 22:08:41,680 - INFO - [pcap_writer.py:413] - Packet 7: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2024-12-31 22:08:41,680 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 133
2024-12-31 22:08:41,680 - INFO - [pcap_writer.py:413] - Packet 8: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2024-12-31 22:08:41,680 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 1157
2024-12-31 22:08:41,681 - INFO - [pcap_writer.py:413] - Packet 9: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2024-12-31 22:08:41,681 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2024-12-31 22:08:41,681 - INFO - [pcap_writer.py:413] - Packet 10: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2024-12-31 22:08:41,682 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2775
2024-12-31 22:08:41,682 - INFO - [pcap_writer.py:413] - Packet 11: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2024-12-31 22:08:41,683 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 269
2024-12-31 22:08:41,683 - INFO - [pcap_writer.py:413] - Packet 12: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2024-12-31 22:08:41,684 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2024-12-31 22:08:41,684 - INFO - [pcap_writer.py:413] - Packet 13: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2024-12-31 22:08:41,685 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2024-12-31 22:08:41,685 - INFO - [pcap_writer.py:413] - Packet 14: IP / TCP 192.168.1.2:12346 > 10.0.0.1:http PA / Raw
2024-12-31 22:08:41,686 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2024-12-31 22:08:41,686 - INFO - [pcap_writer.py:413] - Packet 15: IP / TCP 10.0.0.1:http > 192.168.1.2:12346 PA / Raw
2024-12-31 22:08:41,687 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2024-12-31 22:08:41,687 - INFO - [pcap_writer.py:427] - Verification complete: 15 valid packets, 15 TLS records
2024-12-31 22:08:41,688 - INFO - [main.py:106] - Results saved to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2024-12-31 22:08:41,688 - INFO - [main.py:160] - TLS session simulation completed successfully
2024-12-31 22:16:04,446 - INFO - [logging.py:83] - Logging configured successfully
2024-12-31 22:16:04,447 - INFO - [logging.py:90] - === Logging Configuration ===
2024-12-31 22:16:04,448 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2024-12-31 22:16:04,448 - INFO - [logging.py:92] - Log level: 20
2024-12-31 22:16:04,449 - INFO - [logging.py:93] - Timestamp: 2024-12-31T22:16:04.449291
2024-12-31 22:16:04,449 - INFO - [logging.py:94] - ==========================
2024-12-31 22:16:04,450 - INFO - [main.py:122] - Starting TLS session simulation
2024-12-31 22:16:04,451 - INFO - [main.py:87] - 
--- Client Session (certificate) ---
2024-12-31 22:16:04,453 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2024-12-31 22:16:04,454 - INFO - [cert.py:108] - File exists: True
2024-12-31 22:16:04,454 - INFO - [cert.py:109] - File size: 1912 bytes
2024-12-31 22:16:04,456 - INFO - [cert.py:113] - Read 1912 bytes
2024-12-31 22:16:04,456 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2024-12-31 22:16:04,457 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2024-12-31 22:16:04,462 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 22:16:04,464 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2024-12-31 22:16:04,465 - INFO - [cert.py:108] - File exists: True
2024-12-31 22:16:04,465 - INFO - [cert.py:109] - File size: 1643 bytes
2024-12-31 22:16:04,467 - INFO - [cert.py:113] - Read 1643 bytes
2024-12-31 22:16:04,468 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2024-12-31 22:16:04,469 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2024-12-31 22:16:04,472 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 22:16:04,661 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2024-12-31 22:16:04,663 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2024-12-31 22:16:04,663 - INFO - [cert.py:215] - Key size: 2048 bits
2024-12-31 22:16:04,664 - INFO - [cert.py:217] - Public exponent: 65537
2024-12-31 22:16:04,669 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2024-12-31 22:16:04,670 - INFO - [verify.py:58] - Public key comparison results:
2024-12-31 22:16:04,670 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2024-12-31 22:16:04,671 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2024-12-31 22:16:04,672 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2024-12-31 22:16:04,672 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2024-12-31 22:16:04,677 - INFO - [verify.py:136] - Certificate chain verification successful
2024-12-31 22:16:04,678 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2024-12-31 22:16:04,678 - INFO - [chain.py:110] - Certificate chain verification passed
2024-12-31 22:16:04,678 - INFO - [chain.py:117] - Certificate chain loaded successfully
2024-12-31 22:16:04,679 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2024-12-31 22:16:04,679 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2024-12-31 22:16:04,680 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2024-12-31 22:16:04,681 - INFO - [session.py:120] - Starting TLS session
2024-12-31 22:16:04,681 - INFO - [client.py:95] - Generated client_random: 6774510420a4e3addaae43cb39ca630be3b48fff53725bba68748c31d2283293
2024-12-31 22:16:04,691 - INFO - [client.py:135] - Client Hello sent from 192.168.1.1
2024-12-31 22:16:04,695 - INFO - [server.py:93] - Generated server_random: 67745104b89fc3234e5db9af08594179e971628c137b5ebed8939103748d51ef
2024-12-31 22:16:04,702 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2024-12-31 22:16:04,704 - INFO - [cert.py:108] - File exists: True
2024-12-31 22:16:04,705 - INFO - [cert.py:109] - File size: 1915 bytes
2024-12-31 22:16:04,706 - INFO - [cert.py:113] - Read 1915 bytes
2024-12-31 22:16:04,707 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2024-12-31 22:16:04,708 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2024-12-31 22:16:04,710 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 22:16:04,711 - INFO - [client.py:169] - Prepared client certificate
2024-12-31 22:16:04,712 - INFO - [client.py:184] - Encrypted pre_master_secret length: 256
2024-12-31 22:16:04,716 - INFO - [chain.py:185] - Decrypted pre_master_secret: 03034b08a31dbe6da443f7176f5472769bd3c50eb3423ee3415b412cc28dd369437d732def7ca7553aee8a9ba03ab4f3
2024-12-31 22:16:04,717 - INFO - [chain.py:195] - Generated master secret: affbfd13760499e4f2f309b57d7d131240d2e1bcbf6758262f210086449a761987873e31f6410aa17ebba75f2e6a5d24
2024-12-31 22:16:04,719 - INFO - [chain.py:196] - Master secret length: 48 bytes
2024-12-31 22:16:04,722 - INFO - [client.py:345] - Client ChangeCipherSpec and Finished messages sent
2024-12-31 22:16:04,726 - INFO - [server.py:254] - Pre-master secret validated successfully
2024-12-31 22:16:04,728 - INFO - [server.py:272] - Generated digital signature: 5b296c46a03d4fcd12b435046c06df053378e1bbcada099f4cfae08675c3d9571b7519ad0a12091a97d8500e812812a0689aa331b8a753cb0866a6b392e83e0fb7ef823d68b80ee565a3b65683b012c624e38bef26cb599bb00b24f6db6195356426dfcfd681d8a8d35a4278df4519246d70944a956b854e7af066c4cda8fc5c1f2473dbbcf8e2a840204cf9ded0f6833efd05657c657ecb201c3c5decc8cea8c34b1b23ec491204d8fb679b79cb2fe45eb5dd6be477ac2f67c7a1d1feb86e7c19c9f763902da2ce5de3ecf5331cbd6b094d7ebd632ed28665e2da06fb6a738d7571115534e8cc8afe2c29d9814a9c6a92014014fa52f02bec54360fcc8f2bcd
2024-12-31 22:16:04,731 - INFO - [server.py:309] - Server ChangeCipherSpec and Finished messages sent
2024-12-31 22:16:04,734 - INFO - [keys.py:200] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2024-12-31 22:16:04,736 - INFO - [session.py:104] - TLS Handshake completed successfully
2024-12-31 22:16:04,738 - INFO - [session.py:131] - Found file to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2024-12-31 22:16:04,740 - INFO - [session.py:149] - Handshake completed: True
2024-12-31 22:16:04,742 - INFO - [session.py:150] - Use client cert: True
2024-12-31 22:16:04,743 - INFO - [session.py:151] - File to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2024-12-31 22:16:04,745 - INFO - [session.py:154] - Using encrypted exchange
2024-12-31 22:16:04,746 - INFO - [session.py:169] - Sending encrypted request data
2024-12-31 22:16:04,750 - INFO - [keys.py:180] - TLS Application Data sent from 192.168.1.1:12345 to 10.0.0.1:443
2024-12-31 22:16:04,752 - INFO - [session.py:180] - Sending encrypted response data
2024-12-31 22:16:04,758 - INFO - [keys.py:180] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2024-12-31 22:16:04,760 - INFO - [session.py:192] - Attempting to send file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2024-12-31 22:16:04,761 - INFO - [session.py:203] - Opening file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2024-12-31 22:16:04,762 - INFO - [session.py:210] - Read 1103 bytes from file
2024-12-31 22:16:04,764 - INFO - [keys.py:180] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2024-12-31 22:16:04,766 - INFO - [session.py:219] - File sent successfully
2024-12-31 22:16:04,766 - INFO - [session.py:194] - File sent successfully
2024-12-31 22:16:04,767 - INFO - [main.py:95] - Session completed successfully for 192.168.1.1
2024-12-31 22:16:04,767 - INFO - [main.py:87] - 
--- Client Session (no certificate) ---
2024-12-31 22:16:04,770 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2024-12-31 22:16:04,772 - INFO - [cert.py:108] - File exists: True
2024-12-31 22:16:04,774 - INFO - [cert.py:109] - File size: 1912 bytes
2024-12-31 22:16:04,777 - INFO - [cert.py:113] - Read 1912 bytes
2024-12-31 22:16:04,778 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2024-12-31 22:16:04,779 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2024-12-31 22:16:04,781 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 22:16:04,782 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2024-12-31 22:16:04,783 - INFO - [cert.py:108] - File exists: True
2024-12-31 22:16:04,784 - INFO - [cert.py:109] - File size: 1643 bytes
2024-12-31 22:16:04,786 - INFO - [cert.py:113] - Read 1643 bytes
2024-12-31 22:16:04,787 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2024-12-31 22:16:04,789 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2024-12-31 22:16:04,792 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 22:16:04,853 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2024-12-31 22:16:04,853 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2024-12-31 22:16:04,854 - INFO - [cert.py:215] - Key size: 2048 bits
2024-12-31 22:16:04,854 - INFO - [cert.py:217] - Public exponent: 65537
2024-12-31 22:16:04,854 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2024-12-31 22:16:04,855 - INFO - [verify.py:58] - Public key comparison results:
2024-12-31 22:16:04,855 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2024-12-31 22:16:04,856 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2024-12-31 22:16:04,857 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2024-12-31 22:16:04,857 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2024-12-31 22:16:04,858 - INFO - [verify.py:136] - Certificate chain verification successful
2024-12-31 22:16:04,859 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2024-12-31 22:16:04,859 - INFO - [chain.py:110] - Certificate chain verification passed
2024-12-31 22:16:04,859 - INFO - [chain.py:117] - Certificate chain loaded successfully
2024-12-31 22:16:04,860 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2024-12-31 22:16:04,860 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2024-12-31 22:16:04,862 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2024-12-31 22:16:04,862 - INFO - [session.py:120] - Starting TLS session
2024-12-31 22:16:04,863 - INFO - [client.py:95] - Generated client_random: 67745104ef718a202b3a35bb2554f430b2bb65eaefe1e964203dcc4260c433f5
2024-12-31 22:16:04,866 - INFO - [client.py:135] - Client Hello sent from 192.168.1.2
2024-12-31 22:16:04,871 - INFO - [server.py:93] - Generated server_random: 677451048fef8ee38cd9017b78f16466e476285e9423aa8ea8a9bab295e8b941
2024-12-31 22:16:04,877 - INFO - [client.py:172] - Prepared empty certificate
2024-12-31 22:16:04,878 - INFO - [client.py:184] - Encrypted pre_master_secret length: 256
2024-12-31 22:16:04,882 - INFO - [chain.py:185] - Decrypted pre_master_secret: 0303fde77fedafee8148cb3ef8515c2622359dc304da12cc783c8d32e1392b1d8bc54c89b65ba16066c1273b4ab4d6a8
2024-12-31 22:16:04,883 - INFO - [chain.py:195] - Generated master secret: 43e658f50aa193d036c2d0bbabdb2a826240c5b1e8cebc141141ee441d8499b747e59410b562290cd174fd1757474b4d
2024-12-31 22:16:04,883 - INFO - [chain.py:196] - Master secret length: 48 bytes
2024-12-31 22:16:04,885 - INFO - [client.py:345] - Client ChangeCipherSpec and Finished messages sent
2024-12-31 22:16:04,893 - INFO - [server.py:254] - Pre-master secret validated successfully
2024-12-31 22:16:04,896 - INFO - [server.py:272] - Generated digital signature: 12b12fe507d61f497e6f8cd918cbe6ea178f26c50da7810b123e8a62b0811af89075989180e28e0c699ce127a9415d75caf3116413deb1ce1f08b1e322512b87bfe9b9c1e32a4df93d5b0cce81db5fb0766bdd349eed7969e47c6414bece02d535989328457096180b941e3df11153b3cbfe709b826900897a812184bbf91d80ce6a8056bfe88cada238ce8244d8a1f3fee1098e8c6dd9ce494e8cd664618c3b761ceb04862f8cfd43e7bd1d0b5b1e68cc789c903119fc8bef9a9a9b943cfa4df52e2802b68a6ac33644506f242ab04a1e54d82735dad6368b19739447128376ba61943f49d69c0c03c087043f94f580187f385d6098cc11b51a9ebe5c848de6
2024-12-31 22:16:04,898 - INFO - [server.py:309] - Server ChangeCipherSpec and Finished messages sent
2024-12-31 22:16:04,901 - INFO - [keys.py:200] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2024-12-31 22:16:04,901 - INFO - [session.py:104] - TLS Handshake completed successfully
2024-12-31 22:16:04,903 - INFO - [session.py:149] - Handshake completed: True
2024-12-31 22:16:04,904 - INFO - [session.py:150] - Use client cert: False
2024-12-31 22:16:04,906 - INFO - [session.py:151] - File to send: None
2024-12-31 22:16:04,907 - INFO - [session.py:157] - Using unencrypted exchange
2024-12-31 22:16:04,909 - INFO - [session.py:257] - Added request packet
2024-12-31 22:16:04,911 - INFO - [session.py:257] - Added response packet
2024-12-31 22:16:04,912 - WARNING - [session.py:234] - Using unencrypted communication
2024-12-31 22:16:04,913 - INFO - [main.py:95] - Session completed successfully for 192.168.1.2
2024-12-31 22:16:04,914 - INFO - [pcap_writer.py:232] - Packet 13: Valid HTTP message
2024-12-31 22:16:04,914 - INFO - [pcap_writer.py:232] - Packet 14: Valid HTTP message
2024-12-31 22:16:04,924 - INFO - [pcap_writer.py:387] - Saved 15 valid packets to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2024-12-31 22:16:04,925 - INFO - [pcap_writer.py:409] - Verifying 15 packets...
2024-12-31 22:16:04,927 - INFO - [pcap_writer.py:413] - Packet 1: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2024-12-31 22:16:04,927 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2024-12-31 22:16:04,928 - INFO - [pcap_writer.py:413] - Packet 2: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2024-12-31 22:16:04,928 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2775
2024-12-31 22:16:04,929 - INFO - [pcap_writer.py:413] - Packet 3: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2024-12-31 22:16:04,929 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 1646
2024-12-31 22:16:04,930 - INFO - [pcap_writer.py:413] - Packet 4: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2024-12-31 22:16:04,930 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2024-12-31 22:16:04,930 - INFO - [pcap_writer.py:413] - Packet 5: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2024-12-31 22:16:04,930 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2024-12-31 22:16:04,931 - INFO - [pcap_writer.py:413] - Packet 6: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2024-12-31 22:16:04,931 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 165
2024-12-31 22:16:04,932 - INFO - [pcap_writer.py:413] - Packet 7: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2024-12-31 22:16:04,932 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 133
2024-12-31 22:16:04,933 - INFO - [pcap_writer.py:413] - Packet 8: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2024-12-31 22:16:04,933 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 1157
2024-12-31 22:16:04,934 - INFO - [pcap_writer.py:413] - Packet 9: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2024-12-31 22:16:04,934 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2024-12-31 22:16:04,935 - INFO - [pcap_writer.py:413] - Packet 10: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2024-12-31 22:16:04,935 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2775
2024-12-31 22:16:04,936 - INFO - [pcap_writer.py:413] - Packet 11: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2024-12-31 22:16:04,937 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 269
2024-12-31 22:16:04,937 - INFO - [pcap_writer.py:413] - Packet 12: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2024-12-31 22:16:04,938 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2024-12-31 22:16:04,938 - INFO - [pcap_writer.py:413] - Packet 13: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2024-12-31 22:16:04,939 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2024-12-31 22:16:04,940 - INFO - [pcap_writer.py:413] - Packet 14: IP / TCP 192.168.1.2:12346 > 10.0.0.1:http PA / Raw
2024-12-31 22:16:04,941 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2024-12-31 22:16:04,942 - INFO - [pcap_writer.py:413] - Packet 15: IP / TCP 10.0.0.1:http > 192.168.1.2:12346 PA / Raw
2024-12-31 22:16:04,942 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2024-12-31 22:16:04,943 - INFO - [pcap_writer.py:427] - Verification complete: 15 valid packets, 15 TLS records
2024-12-31 22:16:04,943 - INFO - [main.py:106] - Results saved to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2024-12-31 22:16:04,943 - INFO - [main.py:160] - TLS session simulation completed successfully
2024-12-31 22:19:13,433 - INFO - [logging.py:83] - Logging configured successfully
2024-12-31 22:19:13,435 - INFO - [logging.py:90] - === Logging Configuration ===
2024-12-31 22:19:13,435 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2024-12-31 22:19:13,436 - INFO - [logging.py:92] - Log level: 20
2024-12-31 22:19:13,437 - INFO - [logging.py:93] - Timestamp: 2024-12-31T22:19:13.437568
2024-12-31 22:19:13,438 - INFO - [logging.py:94] - ==========================
2024-12-31 22:19:13,438 - INFO - [main.py:122] - Starting TLS session simulation
2024-12-31 22:19:13,440 - INFO - [main.py:87] - 
--- Client Session (certificate) ---
2024-12-31 22:19:13,442 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2024-12-31 22:19:13,444 - INFO - [cert.py:108] - File exists: True
2024-12-31 22:19:13,445 - INFO - [cert.py:109] - File size: 1912 bytes
2024-12-31 22:19:13,446 - INFO - [cert.py:113] - Read 1912 bytes
2024-12-31 22:19:13,447 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2024-12-31 22:19:13,447 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2024-12-31 22:19:13,456 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 22:19:13,457 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2024-12-31 22:19:13,458 - INFO - [cert.py:108] - File exists: True
2024-12-31 22:19:13,461 - INFO - [cert.py:109] - File size: 1643 bytes
2024-12-31 22:19:13,462 - INFO - [cert.py:113] - Read 1643 bytes
2024-12-31 22:19:13,463 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2024-12-31 22:19:13,467 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2024-12-31 22:19:13,469 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 22:19:13,515 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2024-12-31 22:19:13,516 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2024-12-31 22:19:13,517 - INFO - [cert.py:215] - Key size: 2048 bits
2024-12-31 22:19:13,519 - INFO - [cert.py:217] - Public exponent: 65537
2024-12-31 22:19:13,526 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2024-12-31 22:19:13,527 - INFO - [verify.py:58] - Public key comparison results:
2024-12-31 22:19:13,528 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2024-12-31 22:19:13,530 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2024-12-31 22:19:13,532 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2024-12-31 22:19:13,533 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2024-12-31 22:19:13,540 - INFO - [verify.py:136] - Certificate chain verification successful
2024-12-31 22:19:13,543 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2024-12-31 22:19:13,545 - INFO - [chain.py:110] - Certificate chain verification passed
2024-12-31 22:19:13,545 - INFO - [chain.py:117] - Certificate chain loaded successfully
2024-12-31 22:19:13,546 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2024-12-31 22:19:13,547 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2024-12-31 22:19:13,549 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2024-12-31 22:19:13,550 - INFO - [session.py:120] - Starting TLS session
2024-12-31 22:19:13,551 - INFO - [client.py:95] - Generated client_random: 677451c137dca901fdeb859070950f5827c5717eb1e60926aacbec45cbb0f184
2024-12-31 22:19:13,567 - INFO - [client.py:135] - Client Hello sent from 192.168.1.1
2024-12-31 22:19:13,576 - INFO - [server.py:93] - Generated server_random: 677451c1e0c5e1ee626f776289b04838e37ea90d2612fc5d098f160b1800ab18
2024-12-31 22:19:13,585 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2024-12-31 22:19:13,587 - INFO - [cert.py:108] - File exists: True
2024-12-31 22:19:13,589 - INFO - [cert.py:109] - File size: 1915 bytes
2024-12-31 22:19:13,592 - INFO - [cert.py:113] - Read 1915 bytes
2024-12-31 22:19:13,594 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2024-12-31 22:19:13,596 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2024-12-31 22:19:13,598 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 22:19:13,600 - INFO - [client.py:169] - Prepared client certificate
2024-12-31 22:19:13,604 - INFO - [client.py:184] - Encrypted pre_master_secret length: 256
2024-12-31 22:19:13,614 - INFO - [chain.py:185] - Decrypted pre_master_secret: 030355d7ca9cb00242619414ff89f5f9e10b59824dd000b00acbe4f135fc8c8fc78856bc0dd8bd3870f53a36458f6ae7
2024-12-31 22:19:13,616 - INFO - [chain.py:195] - Generated master secret: 2e0e9e49cddfc943d8c38c574d6d0234559742ffb155a6a44e01577ffdb551cc62d6246e0a7a3fd7460f64a586f3456b
2024-12-31 22:19:13,617 - INFO - [chain.py:196] - Master secret length: 48 bytes
2024-12-31 22:19:13,623 - INFO - [client.py:345] - Client ChangeCipherSpec and Finished messages sent
2024-12-31 22:19:13,627 - INFO - [server.py:254] - Pre-master secret validated successfully
2024-12-31 22:19:13,631 - INFO - [server.py:272] - Generated digital signature: cbaee375506cf0b81f82f53a3afe007c7e46ee2add273d5e57eef8dec109325eb764afa4180c2a3632fb48ed3faa82e33e6fbef0e5849595bb063057f7c22260126f26cc4355d7f2f4533de95d3136fddf61f36f6f7608ee1b01c9896f2949f5d048b3f00aa865d9ae7d3dfe68eb669b0506d33d07fd61c97d131877dfcb51d4be23a601c1ebb5203cdd5949deb7b31ade793c8cec54146db67658f72f8031f0ad9dcaac1bb21da8febd06b6f225fa8be23750bb41ee26f21172b4c6ebcfa53a440cbe2e07881372c6975bd2ae132fa05106f11b7788f11eb8a374424bbf143798a10091aa9e79407eccfe3a4ad3c6e7a18d49b34e8b31b16ffb38a4eaf3f026
2024-12-31 22:19:13,634 - INFO - [server.py:309] - Server ChangeCipherSpec and Finished messages sent
2024-12-31 22:19:13,638 - INFO - [keys.py:200] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2024-12-31 22:19:13,640 - INFO - [session.py:104] - TLS Handshake completed successfully
2024-12-31 22:19:13,642 - INFO - [session.py:131] - Found file to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2024-12-31 22:19:13,645 - INFO - [session.py:149] - Handshake completed: True
2024-12-31 22:19:13,646 - INFO - [session.py:150] - Use client cert: True
2024-12-31 22:19:13,648 - INFO - [session.py:151] - File to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2024-12-31 22:19:13,650 - INFO - [session.py:154] - Using encrypted exchange
2024-12-31 22:19:13,651 - INFO - [session.py:169] - Sending encrypted request data
2024-12-31 22:19:13,659 - INFO - [keys.py:180] - TLS Application Data sent from 192.168.1.1:12345 to 10.0.0.1:443
2024-12-31 22:19:13,662 - INFO - [session.py:180] - Sending encrypted response data
2024-12-31 22:19:13,668 - INFO - [keys.py:180] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2024-12-31 22:19:13,670 - INFO - [session.py:192] - Attempting to send file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2024-12-31 22:19:13,673 - INFO - [session.py:203] - Opening file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2024-12-31 22:19:13,678 - INFO - [session.py:210] - Read 1103 bytes from file
2024-12-31 22:19:13,684 - INFO - [keys.py:180] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2024-12-31 22:19:13,686 - INFO - [session.py:219] - File sent successfully
2024-12-31 22:19:13,688 - INFO - [session.py:194] - File sent successfully
2024-12-31 22:19:13,689 - INFO - [main.py:95] - Session completed successfully for 192.168.1.1
2024-12-31 22:19:13,691 - INFO - [main.py:87] - 
--- Client Session (no certificate) ---
2024-12-31 22:19:13,695 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2024-12-31 22:19:13,698 - INFO - [cert.py:108] - File exists: True
2024-12-31 22:19:13,700 - INFO - [cert.py:109] - File size: 1912 bytes
2024-12-31 22:19:13,701 - INFO - [cert.py:113] - Read 1912 bytes
2024-12-31 22:19:13,703 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2024-12-31 22:19:13,706 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2024-12-31 22:19:13,711 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 22:19:13,713 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2024-12-31 22:19:13,716 - INFO - [cert.py:108] - File exists: True
2024-12-31 22:19:13,718 - INFO - [cert.py:109] - File size: 1643 bytes
2024-12-31 22:19:13,721 - INFO - [cert.py:113] - Read 1643 bytes
2024-12-31 22:19:13,723 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2024-12-31 22:19:13,725 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2024-12-31 22:19:13,728 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 22:19:13,778 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2024-12-31 22:19:13,779 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2024-12-31 22:19:13,780 - INFO - [cert.py:215] - Key size: 2048 bits
2024-12-31 22:19:13,780 - INFO - [cert.py:217] - Public exponent: 65537
2024-12-31 22:19:13,781 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2024-12-31 22:19:13,783 - INFO - [verify.py:58] - Public key comparison results:
2024-12-31 22:19:13,783 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2024-12-31 22:19:13,784 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2024-12-31 22:19:13,786 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2024-12-31 22:19:13,786 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2024-12-31 22:19:13,787 - INFO - [verify.py:136] - Certificate chain verification successful
2024-12-31 22:19:13,788 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2024-12-31 22:19:13,788 - INFO - [chain.py:110] - Certificate chain verification passed
2024-12-31 22:19:13,789 - INFO - [chain.py:117] - Certificate chain loaded successfully
2024-12-31 22:19:13,789 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2024-12-31 22:19:13,790 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2024-12-31 22:19:13,791 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2024-12-31 22:19:13,792 - INFO - [session.py:120] - Starting TLS session
2024-12-31 22:19:13,792 - INFO - [client.py:95] - Generated client_random: 677451c1f5c5e97cc3802da649fd8f37151b6c52775a41bccc77ebff1e5c2e76
2024-12-31 22:19:13,795 - INFO - [client.py:135] - Client Hello sent from 192.168.1.2
2024-12-31 22:19:13,800 - INFO - [server.py:93] - Generated server_random: 677451c1bf4f3c048d3df546bb282436af00637959863e965f8de9db7feaeeac
2024-12-31 22:19:13,805 - INFO - [client.py:172] - Prepared empty certificate
2024-12-31 22:19:13,805 - INFO - [client.py:184] - Encrypted pre_master_secret length: 256
2024-12-31 22:19:13,808 - INFO - [chain.py:185] - Decrypted pre_master_secret: 0303e3f821ff675279fd943e79d957fcf19e7da0a4bbf4ee85a0432fcbf9ec165db327848de53c6331e1191cef18e41d
2024-12-31 22:19:13,808 - INFO - [chain.py:195] - Generated master secret: 38be1b9f6a5df01ce41d6787febfef1b79f4b29c086aa9156877223cd36b9fa01997207e15e013c3f5c00991b99ffe90
2024-12-31 22:19:13,809 - INFO - [chain.py:196] - Master secret length: 48 bytes
2024-12-31 22:19:13,810 - INFO - [client.py:345] - Client ChangeCipherSpec and Finished messages sent
2024-12-31 22:19:13,814 - INFO - [server.py:254] - Pre-master secret validated successfully
2024-12-31 22:19:13,817 - INFO - [server.py:272] - Generated digital signature: ac929a14db24f67517fb51aaa8c3e79dd47bb4108aab36d3c564070696e7cfe0fdc8860c92f8520cb635e8672186d60b1f96f4b4e2ac4425f5232ac3a11cbe590cfb8aa928dd5cd49e8a9090cd0b415a36f14d8133a1c36024e18ef9d60ee52b6216e0907b875d190a77aaab2c54a5effa847291c21b65e404bf6084e5afdfa406d71cf7f402993e2a781b8c5492c89824836dc6e793833f2c2ec290e432cc878cacb95ead9fa7ace6cb322cd0f8e91c8cd470c2d9f28ebb4dfadcf145362805a105e6e416cd8b639a4113093d15946c6ff3121aea8375b2d1888717be65bec390ad54d4698403d71e5a099274649be238f8f28d281713a5f7deff4a66e1a281
2024-12-31 22:19:13,819 - INFO - [server.py:309] - Server ChangeCipherSpec and Finished messages sent
2024-12-31 22:19:13,821 - INFO - [keys.py:200] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2024-12-31 22:19:13,821 - INFO - [session.py:104] - TLS Handshake completed successfully
2024-12-31 22:19:13,822 - INFO - [session.py:149] - Handshake completed: True
2024-12-31 22:19:13,822 - INFO - [session.py:150] - Use client cert: False
2024-12-31 22:19:13,822 - INFO - [session.py:151] - File to send: None
2024-12-31 22:19:13,823 - INFO - [session.py:157] - Using unencrypted exchange
2024-12-31 22:19:13,824 - INFO - [session.py:257] - Added request packet
2024-12-31 22:19:13,825 - INFO - [session.py:257] - Added response packet
2024-12-31 22:19:13,825 - WARNING - [session.py:234] - Using unencrypted communication
2024-12-31 22:19:13,826 - INFO - [main.py:95] - Session completed successfully for 192.168.1.2
2024-12-31 22:19:13,826 - INFO - [pcap_writer.py:232] - Packet 13: Valid HTTP message
2024-12-31 22:19:13,827 - INFO - [pcap_writer.py:232] - Packet 14: Valid HTTP message
2024-12-31 22:19:13,836 - INFO - [pcap_writer.py:387] - Saved 15 valid packets to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2024-12-31 22:19:13,837 - INFO - [pcap_writer.py:409] - Verifying 15 packets...
2024-12-31 22:19:13,837 - INFO - [pcap_writer.py:413] - Packet 1: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2024-12-31 22:19:13,838 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2024-12-31 22:19:13,838 - INFO - [pcap_writer.py:413] - Packet 2: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2024-12-31 22:19:13,839 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2775
2024-12-31 22:19:13,839 - INFO - [pcap_writer.py:413] - Packet 3: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2024-12-31 22:19:13,840 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 1646
2024-12-31 22:19:13,840 - INFO - [pcap_writer.py:413] - Packet 4: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2024-12-31 22:19:13,841 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2024-12-31 22:19:13,841 - INFO - [pcap_writer.py:413] - Packet 5: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2024-12-31 22:19:13,842 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2024-12-31 22:19:13,842 - INFO - [pcap_writer.py:413] - Packet 6: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2024-12-31 22:19:13,842 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 165
2024-12-31 22:19:13,843 - INFO - [pcap_writer.py:413] - Packet 7: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2024-12-31 22:19:13,843 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 133
2024-12-31 22:19:13,844 - INFO - [pcap_writer.py:413] - Packet 8: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2024-12-31 22:19:13,844 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 1157
2024-12-31 22:19:13,845 - INFO - [pcap_writer.py:413] - Packet 9: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2024-12-31 22:19:13,846 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2024-12-31 22:19:13,849 - INFO - [pcap_writer.py:413] - Packet 10: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2024-12-31 22:19:13,851 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2775
2024-12-31 22:19:13,852 - INFO - [pcap_writer.py:413] - Packet 11: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2024-12-31 22:19:13,853 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 269
2024-12-31 22:19:13,854 - INFO - [pcap_writer.py:413] - Packet 12: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2024-12-31 22:19:13,854 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2024-12-31 22:19:13,855 - INFO - [pcap_writer.py:413] - Packet 13: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2024-12-31 22:19:13,855 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2024-12-31 22:19:13,856 - INFO - [pcap_writer.py:413] - Packet 14: IP / TCP 192.168.1.2:12346 > 10.0.0.1:http PA / Raw
2024-12-31 22:19:13,856 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2024-12-31 22:19:13,857 - INFO - [pcap_writer.py:413] - Packet 15: IP / TCP 10.0.0.1:http > 192.168.1.2:12346 PA / Raw
2024-12-31 22:19:13,857 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2024-12-31 22:19:13,858 - INFO - [pcap_writer.py:427] - Verification complete: 15 valid packets, 15 TLS records
2024-12-31 22:19:13,858 - INFO - [main.py:106] - Results saved to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2024-12-31 22:19:13,859 - INFO - [main.py:160] - TLS session simulation completed successfully
2024-12-31 22:46:04,156 - INFO - [logging.py:83] - Logging configured successfully
2024-12-31 22:46:04,157 - INFO - [logging.py:90] - === Logging Configuration ===
2024-12-31 22:46:04,158 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2024-12-31 22:46:04,158 - INFO - [logging.py:92] - Log level: 20
2024-12-31 22:46:04,158 - INFO - [logging.py:93] - Timestamp: 2024-12-31T22:46:04.158529
2024-12-31 22:46:04,158 - INFO - [logging.py:94] - ==========================
2024-12-31 22:46:04,159 - INFO - [main.py:122] - Starting TLS session simulation
2024-12-31 22:46:04,159 - INFO - [main.py:87] - 
--- Client Session (certificate) ---
2024-12-31 22:46:04,160 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2024-12-31 22:46:04,161 - INFO - [cert.py:108] - File exists: True
2024-12-31 22:46:04,161 - INFO - [cert.py:109] - File size: 1912 bytes
2024-12-31 22:46:04,162 - INFO - [cert.py:113] - Read 1912 bytes
2024-12-31 22:46:04,162 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2024-12-31 22:46:04,163 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2024-12-31 22:46:04,168 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 22:46:04,169 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2024-12-31 22:46:04,169 - INFO - [cert.py:108] - File exists: True
2024-12-31 22:46:04,170 - INFO - [cert.py:109] - File size: 1643 bytes
2024-12-31 22:46:04,171 - INFO - [cert.py:113] - Read 1643 bytes
2024-12-31 22:46:04,171 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2024-12-31 22:46:04,172 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2024-12-31 22:46:04,173 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 22:46:04,220 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2024-12-31 22:46:04,221 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2024-12-31 22:46:04,221 - INFO - [cert.py:215] - Key size: 2048 bits
2024-12-31 22:46:04,222 - INFO - [cert.py:217] - Public exponent: 65537
2024-12-31 22:46:04,226 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2024-12-31 22:46:04,228 - INFO - [verify.py:58] - Public key comparison results:
2024-12-31 22:46:04,228 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2024-12-31 22:46:04,229 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2024-12-31 22:46:04,230 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2024-12-31 22:46:04,231 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2024-12-31 22:46:04,234 - INFO - [verify.py:136] - Certificate chain verification successful
2024-12-31 22:46:04,235 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2024-12-31 22:46:04,235 - INFO - [chain.py:110] - Certificate chain verification passed
2024-12-31 22:46:04,236 - INFO - [chain.py:117] - Certificate chain loaded successfully
2024-12-31 22:46:04,237 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2024-12-31 22:46:04,238 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2024-12-31 22:46:04,240 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2024-12-31 22:46:04,243 - INFO - [session.py:120] - Starting TLS session
2024-12-31 22:46:04,243 - INFO - [client.py:95] - Generated client_random: 6774580c8337f550f70d3b313179da561ac22f2669ec310e23d1eae70c353f4d
2024-12-31 22:46:04,248 - INFO - [client.py:135] - Client Hello sent from 192.168.1.1
2024-12-31 22:46:04,254 - INFO - [server.py:93] - Generated server_random: 6774580c37e264a6d78be9b6b29062833c5ac6e35264364405038dc951ff8864
2024-12-31 22:46:04,276 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2024-12-31 22:46:04,278 - INFO - [cert.py:108] - File exists: True
2024-12-31 22:46:04,279 - INFO - [cert.py:109] - File size: 1915 bytes
2024-12-31 22:46:04,282 - INFO - [cert.py:113] - Read 1915 bytes
2024-12-31 22:46:04,283 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2024-12-31 22:46:04,284 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2024-12-31 22:46:04,287 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 22:46:04,290 - INFO - [client.py:169] - Prepared client certificate
2024-12-31 22:46:04,293 - INFO - [client.py:184] - Encrypted pre_master_secret length: 256
2024-12-31 22:46:04,301 - INFO - [chain.py:185] - Decrypted pre_master_secret: 030319890f943abfc7f0b102c064834e46e205909f25c9f94a2c238c6b47dfcf47d53a1cd1da2b52510d5d164761bd46
2024-12-31 22:46:04,302 - INFO - [chain.py:195] - Generated master secret: b4b0b9b978a5a76cb39e6a92d7bcfbb9ec67ab45c871a534e2f2417cc6c67e88cbcfbeae01f3c7d50712e9616741452a
2024-12-31 22:46:04,304 - INFO - [chain.py:196] - Master secret length: 48 bytes
2024-12-31 22:46:04,307 - INFO - [client.py:345] - Client ChangeCipherSpec and Finished messages sent
2024-12-31 22:46:04,314 - INFO - [server.py:254] - Pre-master secret validated successfully
2024-12-31 22:46:04,316 - INFO - [server.py:272] - Generated digital signature: 161cbf730260eca4966c72581991e6cb860c320905bbbf4968ec77ee2a9d7b7aa4d73a0286351ee8428e9bedc117270ea22369c07dc2343b6840206ba39944f70e3c89423d117987dd48aaddb4269291918f7646bc6dbd597f067615f6e0de0470fdfc92ccca8e785e1febdd6bf074b28517d39aec557ddf0334450d5c5805992d8e52fc772b46262bb5c77ee9ecc7ecee680e31ec1aac7fdc8650dee45e7dda1b91ed854dbea8c1f3892b98935fd46399fe777ad2706572f9663d2026117d9694c60c1005b0d63fb57191b456cc2bdd8f3c0578cad2781244c75426dda62e6d4958bab7a291708cd9846ba7fc649082372ed9457c6190cf08426713ddcac35e
2024-12-31 22:46:04,319 - INFO - [server.py:309] - Server ChangeCipherSpec and Finished messages sent
2024-12-31 22:46:04,325 - INFO - [keys.py:200] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2024-12-31 22:46:04,326 - INFO - [session.py:104] - TLS Handshake completed successfully
2024-12-31 22:46:04,326 - INFO - [session.py:131] - Found file to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2024-12-31 22:46:04,327 - INFO - [session.py:149] - Handshake completed: True
2024-12-31 22:46:04,328 - INFO - [session.py:150] - Use client cert: True
2024-12-31 22:46:04,328 - INFO - [session.py:151] - File to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2024-12-31 22:46:04,329 - INFO - [session.py:154] - Using encrypted exchange
2024-12-31 22:46:04,329 - INFO - [session.py:169] - Sending encrypted request data
2024-12-31 22:46:04,331 - INFO - [keys.py:180] - TLS Application Data sent from 192.168.1.1:12345 to 10.0.0.1:443
2024-12-31 22:46:04,332 - INFO - [session.py:180] - Sending encrypted response data
2024-12-31 22:46:04,334 - INFO - [keys.py:180] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2024-12-31 22:46:04,334 - INFO - [session.py:192] - Attempting to send file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2024-12-31 22:46:04,335 - INFO - [session.py:203] - Opening file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2024-12-31 22:46:04,338 - INFO - [session.py:210] - Read 1103 bytes from file
2024-12-31 22:46:04,342 - INFO - [keys.py:180] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2024-12-31 22:46:04,343 - INFO - [session.py:219] - File sent successfully
2024-12-31 22:46:04,343 - INFO - [session.py:194] - File sent successfully
2024-12-31 22:46:04,344 - INFO - [main.py:95] - Session completed successfully for 192.168.1.1
2024-12-31 22:46:04,345 - INFO - [main.py:87] - 
--- Client Session (no certificate) ---
2024-12-31 22:46:04,345 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2024-12-31 22:46:04,346 - INFO - [cert.py:108] - File exists: True
2024-12-31 22:46:04,347 - INFO - [cert.py:109] - File size: 1912 bytes
2024-12-31 22:46:04,347 - INFO - [cert.py:113] - Read 1912 bytes
2024-12-31 22:46:04,348 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2024-12-31 22:46:04,348 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2024-12-31 22:46:04,350 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 22:46:04,350 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2024-12-31 22:46:04,351 - INFO - [cert.py:108] - File exists: True
2024-12-31 22:46:04,352 - INFO - [cert.py:109] - File size: 1643 bytes
2024-12-31 22:46:04,353 - INFO - [cert.py:113] - Read 1643 bytes
2024-12-31 22:46:04,353 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2024-12-31 22:46:04,354 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2024-12-31 22:46:04,357 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 22:46:04,391 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2024-12-31 22:46:04,392 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2024-12-31 22:46:04,393 - INFO - [cert.py:215] - Key size: 2048 bits
2024-12-31 22:46:04,393 - INFO - [cert.py:217] - Public exponent: 65537
2024-12-31 22:46:04,394 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2024-12-31 22:46:04,394 - INFO - [verify.py:58] - Public key comparison results:
2024-12-31 22:46:04,395 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2024-12-31 22:46:04,395 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2024-12-31 22:46:04,396 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2024-12-31 22:46:04,396 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2024-12-31 22:46:04,397 - INFO - [verify.py:136] - Certificate chain verification successful
2024-12-31 22:46:04,397 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2024-12-31 22:46:04,398 - INFO - [chain.py:110] - Certificate chain verification passed
2024-12-31 22:46:04,398 - INFO - [chain.py:117] - Certificate chain loaded successfully
2024-12-31 22:46:04,398 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2024-12-31 22:46:04,399 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2024-12-31 22:46:04,400 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2024-12-31 22:46:04,400 - INFO - [session.py:120] - Starting TLS session
2024-12-31 22:46:04,400 - INFO - [client.py:95] - Generated client_random: 6774580c69a94c481ce779da7e8eaa6d890800e16c4c93d1f9ca610eba2b0b8a
2024-12-31 22:46:04,404 - INFO - [client.py:135] - Client Hello sent from 192.168.1.2
2024-12-31 22:46:04,410 - INFO - [server.py:93] - Generated server_random: 6774580c63ddb8e3be157bc16ee7aa01724d34706e1f2ea92e30a88ee61ab62a
2024-12-31 22:46:04,413 - INFO - [client.py:172] - Prepared empty certificate
2024-12-31 22:46:04,414 - INFO - [client.py:184] - Encrypted pre_master_secret length: 256
2024-12-31 22:46:04,416 - INFO - [chain.py:185] - Decrypted pre_master_secret: 0303ef378ff09e7ef0e73b62e8d9b8f0b69490e78c19afe5ae53ab3ba614dfd17502fc01bd8bf013582392b17917cd35
2024-12-31 22:46:04,416 - INFO - [chain.py:195] - Generated master secret: 9ef245c2f5d6b12511a19d8fc813c5292b749c3496b73b9ecd46237654661374661600954ba89d60f6d755175e63def0
2024-12-31 22:46:04,417 - INFO - [chain.py:196] - Master secret length: 48 bytes
2024-12-31 22:46:04,418 - INFO - [client.py:345] - Client ChangeCipherSpec and Finished messages sent
2024-12-31 22:46:04,421 - INFO - [server.py:254] - Pre-master secret validated successfully
2024-12-31 22:46:04,424 - INFO - [server.py:272] - Generated digital signature: a729cbd7be1a0f3d0985ff2229d6ce58ad7006944c8deca324681b26ce4518be8a390c29f21606925ecad660f61efd74970567b9ec10c1e2044736a4981029d07cfe1d4535ee22cf12390c691f088b3c7255d8ed058b26854c958233bb7b52da9e5c9a78a3232b30184db318041bab3f40a154aa5f06e2ca01dbba4d26091ae85e4518264a7019ad83e8b3f9b1db31e3c5cf17a51ddcce42380c0b3aa24930d3f394dc9e1eb84d048075499c2dbfc36c49e99f4ead88cd3ab7d57f2b2ec1d38405d0ebd4b58f518c62857e5dae2ff1fe5bb856e2c8e905f4633ebb07bdcd6e07d850448b0a814c097cf043b280c75a16c8fb700a25e4053ce01e40995ed4de11
2024-12-31 22:46:04,425 - INFO - [server.py:309] - Server ChangeCipherSpec and Finished messages sent
2024-12-31 22:46:04,427 - INFO - [keys.py:200] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2024-12-31 22:46:04,427 - INFO - [session.py:104] - TLS Handshake completed successfully
2024-12-31 22:46:04,428 - INFO - [session.py:149] - Handshake completed: True
2024-12-31 22:46:04,428 - INFO - [session.py:150] - Use client cert: False
2024-12-31 22:46:04,428 - INFO - [session.py:151] - File to send: None
2024-12-31 22:46:04,428 - INFO - [session.py:157] - Using unencrypted exchange
2024-12-31 22:46:04,429 - INFO - [session.py:257] - Added request packet
2024-12-31 22:46:04,429 - INFO - [session.py:257] - Added response packet
2024-12-31 22:46:04,430 - WARNING - [session.py:234] - Using unencrypted communication
2024-12-31 22:46:04,430 - INFO - [main.py:95] - Session completed successfully for 192.168.1.2
2024-12-31 22:46:04,430 - INFO - [pcap_writer.py:232] - Packet 13: Valid HTTP message
2024-12-31 22:46:04,431 - INFO - [pcap_writer.py:232] - Packet 14: Valid HTTP message
2024-12-31 22:46:04,436 - INFO - [pcap_writer.py:387] - Saved 15 valid packets to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2024-12-31 22:46:04,437 - INFO - [pcap_writer.py:409] - Verifying 15 packets...
2024-12-31 22:46:04,438 - INFO - [pcap_writer.py:413] - Packet 1: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2024-12-31 22:46:04,439 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2024-12-31 22:46:04,440 - INFO - [pcap_writer.py:413] - Packet 2: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2024-12-31 22:46:04,441 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2775
2024-12-31 22:46:04,441 - INFO - [pcap_writer.py:413] - Packet 3: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2024-12-31 22:46:04,442 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 1646
2024-12-31 22:46:04,442 - INFO - [pcap_writer.py:413] - Packet 4: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2024-12-31 22:46:04,443 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2024-12-31 22:46:04,443 - INFO - [pcap_writer.py:413] - Packet 5: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2024-12-31 22:46:04,443 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2024-12-31 22:46:04,444 - INFO - [pcap_writer.py:413] - Packet 6: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2024-12-31 22:46:04,444 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 165
2024-12-31 22:46:04,444 - INFO - [pcap_writer.py:413] - Packet 7: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2024-12-31 22:46:04,445 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 133
2024-12-31 22:46:04,445 - INFO - [pcap_writer.py:413] - Packet 8: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2024-12-31 22:46:04,445 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 1157
2024-12-31 22:46:04,445 - INFO - [pcap_writer.py:413] - Packet 9: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2024-12-31 22:46:04,446 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2024-12-31 22:46:04,446 - INFO - [pcap_writer.py:413] - Packet 10: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2024-12-31 22:46:04,446 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2775
2024-12-31 22:46:04,447 - INFO - [pcap_writer.py:413] - Packet 11: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2024-12-31 22:46:04,447 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 269
2024-12-31 22:46:04,447 - INFO - [pcap_writer.py:413] - Packet 12: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2024-12-31 22:46:04,448 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2024-12-31 22:46:04,448 - INFO - [pcap_writer.py:413] - Packet 13: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2024-12-31 22:46:04,448 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2024-12-31 22:46:04,449 - INFO - [pcap_writer.py:413] - Packet 14: IP / TCP 192.168.1.2:12346 > 10.0.0.1:http PA / Raw
2024-12-31 22:46:04,449 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2024-12-31 22:46:04,449 - INFO - [pcap_writer.py:413] - Packet 15: IP / TCP 10.0.0.1:http > 192.168.1.2:12346 PA / Raw
2024-12-31 22:46:04,450 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2024-12-31 22:46:04,450 - INFO - [pcap_writer.py:427] - Verification complete: 15 valid packets, 15 TLS records
2024-12-31 22:46:04,450 - INFO - [main.py:106] - Results saved to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2024-12-31 22:46:04,450 - INFO - [main.py:160] - TLS session simulation completed successfully
2025-01-01 00:10:58,094 - INFO - [logging.py:83] - Logging configured successfully
2025-01-01 00:10:58,097 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-01 00:10:58,098 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-01 00:10:58,099 - INFO - [logging.py:92] - Log level: 20
2025-01-01 00:10:58,099 - INFO - [logging.py:93] - Timestamp: 2025-01-01T00:10:58.099892
2025-01-01 00:10:58,100 - INFO - [logging.py:94] - ==========================
2025-01-01 00:10:58,101 - INFO - [main.py:122] - Starting TLS session simulation
2025-01-01 00:10:58,102 - INFO - [main.py:87] - 
--- Client Session (certificate) ---
2025-01-01 00:10:58,106 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-01 00:10:58,107 - INFO - [cert.py:108] - File exists: True
2025-01-01 00:10:58,108 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-01 00:10:58,110 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-01 00:10:58,111 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-01 00:10:58,113 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-01 00:10:58,126 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 00:10:58,127 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-01 00:10:58,128 - INFO - [cert.py:108] - File exists: True
2025-01-01 00:10:58,129 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-01 00:10:58,131 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-01 00:10:58,132 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-01 00:10:58,134 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-01 00:10:58,136 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 00:10:58,207 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-01 00:10:58,208 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-01 00:10:58,208 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-01 00:10:58,209 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-01 00:10:58,212 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-01 00:10:58,212 - INFO - [verify.py:58] - Public key comparison results:
2025-01-01 00:10:58,213 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 00:10:58,213 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 00:10:58,214 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-01 00:10:58,214 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-01 00:10:58,224 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-01 00:10:58,226 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-01 00:10:58,228 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-01 00:10:58,228 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-01 00:10:58,229 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-01 00:10:58,229 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-01 00:10:58,230 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-01 00:10:58,231 - INFO - [session.py:120] - Starting TLS session
2025-01-01 00:10:58,231 - INFO - [client.py:95] - Generated client_random: 67746bf21c0d5b414be71cb59b7decbd6275fcecf4b48531db4102f0dd256a01
2025-01-01 00:10:58,233 - INFO - [client.py:135] - Client Hello sent from 192.168.1.1
2025-01-01 00:10:58,235 - INFO - [server.py:93] - Generated server_random: 67746bf2aeccc1618f52ab22c92d7c2ba2c9aad94e5f840296a8585c6aff8917
2025-01-01 00:10:58,240 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2025-01-01 00:10:58,241 - INFO - [cert.py:108] - File exists: True
2025-01-01 00:10:58,242 - INFO - [cert.py:109] - File size: 1915 bytes
2025-01-01 00:10:58,245 - INFO - [cert.py:113] - Read 1915 bytes
2025-01-01 00:10:58,245 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2025-01-01 00:10:58,246 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2025-01-01 00:10:58,248 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 00:10:58,248 - INFO - [client.py:169] - Prepared client certificate
2025-01-01 00:10:58,249 - INFO - [client.py:184] - Encrypted pre_master_secret length: 256
2025-01-01 00:10:58,253 - INFO - [chain.py:185] - Decrypted pre_master_secret: 0303217ff8fe2180a40f6af9e4ae2e27b443535eaf1a1c1742e761cf4677ae9cf8c5d4c486f0e8230b414188e8b19a2a
2025-01-01 00:10:58,254 - INFO - [chain.py:195] - Generated master secret: 69f06949e823d81faee639b7ee7c3e5395924520fdf19d279158891606237ec68cc58173221e81236f0fbefb2b6ede59
2025-01-01 00:10:58,254 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-01 00:10:58,255 - INFO - [client.py:274] - Client ChangeCipherSpec and Finished messages sent
2025-01-01 00:10:58,258 - INFO - [server.py:254] - Pre-master secret validated successfully
2025-01-01 00:10:58,259 - INFO - [server.py:272] - Generated digital signature: 21f8f696ac9bd2975aa742c9236a38b11e33d46a92db631d0eb70a07342f2505f2b1d6872efaa3dfe333c7662f3f55924f41bab207630dd2f7d59cd7bf1398ec69995d13700d43c517b9a30723026c108306020905997457c1b33be63e542856854fea34790fd0dc29bef915aa3609a56aa360827abd8753844def10ec7e8b9e3b55a01bfd2076f82857e4992fd9bf9fed80771ad71f782583b347560da35418ff1b28ed9282f5304d30810bab29b7496c83435cc52cc382236de3e224faea4410bdcb1f5952413fc18977122e4dbdf5b6120288681f625f646ef164ed41c3d109dac21866e349d91331695c95135bfff6678c774a6153aecbd700f1fc42f791
2025-01-01 00:10:58,261 - INFO - [server.py:309] - Server ChangeCipherSpec and Finished messages sent
2025-01-01 00:10:58,265 - INFO - [keys.py:200] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-01 00:10:58,266 - INFO - [session.py:104] - TLS Handshake completed successfully
2025-01-01 00:10:58,268 - INFO - [session.py:131] - Found file to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 00:10:58,269 - INFO - [session.py:149] - Handshake completed: True
2025-01-01 00:10:58,270 - INFO - [session.py:150] - Use client cert: True
2025-01-01 00:10:58,271 - INFO - [session.py:151] - File to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 00:10:58,272 - INFO - [session.py:154] - Using encrypted exchange
2025-01-01 00:10:58,272 - INFO - [session.py:169] - Sending encrypted request data
2025-01-01 00:10:58,275 - INFO - [keys.py:180] - TLS Application Data sent from 192.168.1.1:12345 to 10.0.0.1:443
2025-01-01 00:10:58,276 - INFO - [session.py:180] - Sending encrypted response data
2025-01-01 00:10:58,277 - INFO - [keys.py:180] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-01 00:10:58,278 - INFO - [session.py:192] - Attempting to send file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 00:10:58,279 - INFO - [session.py:203] - Opening file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 00:10:58,281 - INFO - [session.py:210] - Read 1103 bytes from file
2025-01-01 00:10:58,286 - INFO - [keys.py:180] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-01 00:10:58,288 - INFO - [session.py:219] - File sent successfully
2025-01-01 00:10:58,289 - INFO - [session.py:194] - File sent successfully
2025-01-01 00:10:58,289 - INFO - [main.py:95] - Session completed successfully for 192.168.1.1
2025-01-01 00:10:58,290 - INFO - [main.py:87] - 
--- Client Session (no certificate) ---
2025-01-01 00:10:58,290 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-01 00:10:58,291 - INFO - [cert.py:108] - File exists: True
2025-01-01 00:10:58,292 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-01 00:10:58,292 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-01 00:10:58,293 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-01 00:10:58,293 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-01 00:10:58,295 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 00:10:58,296 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-01 00:10:58,297 - INFO - [cert.py:108] - File exists: True
2025-01-01 00:10:58,298 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-01 00:10:58,299 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-01 00:10:58,299 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-01 00:10:58,300 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-01 00:10:58,302 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 00:10:58,340 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-01 00:10:58,341 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-01 00:10:58,341 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-01 00:10:58,341 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-01 00:10:58,342 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-01 00:10:58,342 - INFO - [verify.py:58] - Public key comparison results:
2025-01-01 00:10:58,342 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 00:10:58,343 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 00:10:58,343 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-01 00:10:58,344 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-01 00:10:58,344 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-01 00:10:58,344 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-01 00:10:58,345 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-01 00:10:58,345 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-01 00:10:58,345 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-01 00:10:58,345 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-01 00:10:58,346 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-01 00:10:58,346 - INFO - [session.py:120] - Starting TLS session
2025-01-01 00:10:58,347 - INFO - [client.py:95] - Generated client_random: 67746bf29b4fe56242d6b2391b4689ce45d52262ed41f7085d75ec3178ddde2c
2025-01-01 00:10:58,350 - INFO - [client.py:135] - Client Hello sent from 192.168.1.2
2025-01-01 00:10:58,353 - INFO - [server.py:93] - Generated server_random: 67746bf26ce3b47bd2a581e4e42736c8fc22f97dea2e6a3c77bf2ae711e2b87c
2025-01-01 00:10:58,357 - INFO - [client.py:172] - Prepared empty certificate
2025-01-01 00:10:58,358 - INFO - [client.py:184] - Encrypted pre_master_secret length: 256
2025-01-01 00:10:58,361 - INFO - [chain.py:185] - Decrypted pre_master_secret: 0303ec2169ea707737943b2a310b6a06c0d1ac9719fb46825d67dc466d95ac34f83b9bfeaf5ecfe59808e2b8e66a42b1
2025-01-01 00:10:58,361 - INFO - [chain.py:195] - Generated master secret: b133795e882d959407ff0d1dff7bf46e8bfb2d7c39c07ad9552beb29042ffe8441fc24e365f621e4e9876e4805c34a46
2025-01-01 00:10:58,361 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-01 00:10:58,363 - INFO - [client.py:274] - Client ChangeCipherSpec and Finished messages sent
2025-01-01 00:10:58,364 - INFO - [server.py:254] - Pre-master secret validated successfully
2025-01-01 00:10:58,365 - INFO - [server.py:272] - Generated digital signature: 6af0109fe88abc185d4556164b3dccd085c89bff284f4445027f1c7910628ab8ee179a3fa438bab181a2d6982273bd025b33b1caec3f0ae6ba7e443fcf7000feb4cf9acd8be966d23a38a1ef9abfa999594154813caaa71c1ec8a8724aa03a700aa17ee7a2be4e145ead27170d71fd35a32cccfcbd33559d88e2edfc2fbc94b961c41d475f19abcd751db24918a5982433e2f7228e8eaff23ec45c810a7a178918959f99fb56b2fbc0835c38f058133fa037bd20c264bf66e527e1ad228237c7e54f5aa525709319abc9d8aa798f2068720d106b7ff59e4988626553b40c07ec27e44035d6e66aae5d5ddc820834e0d46816316feb787f65e01b2cb82081b6a0
2025-01-01 00:10:58,367 - INFO - [server.py:309] - Server ChangeCipherSpec and Finished messages sent
2025-01-01 00:10:58,369 - INFO - [keys.py:200] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-01 00:10:58,370 - INFO - [session.py:104] - TLS Handshake completed successfully
2025-01-01 00:10:58,370 - INFO - [session.py:149] - Handshake completed: True
2025-01-01 00:10:58,371 - INFO - [session.py:150] - Use client cert: False
2025-01-01 00:10:58,371 - INFO - [session.py:151] - File to send: None
2025-01-01 00:10:58,371 - INFO - [session.py:157] - Using unencrypted exchange
2025-01-01 00:10:58,373 - INFO - [session.py:257] - Added request packet
2025-01-01 00:10:58,373 - INFO - [session.py:257] - Added response packet
2025-01-01 00:10:58,374 - WARNING - [session.py:234] - Using unencrypted communication
2025-01-01 00:10:58,374 - INFO - [main.py:95] - Session completed successfully for 192.168.1.2
2025-01-01 00:10:58,375 - INFO - [pcap_writer.py:232] - Packet 13: Valid HTTP message
2025-01-01 00:10:58,375 - INFO - [pcap_writer.py:232] - Packet 14: Valid HTTP message
2025-01-01 00:10:58,381 - INFO - [pcap_writer.py:387] - Saved 15 valid packets to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-01 00:10:58,382 - INFO - [pcap_writer.py:409] - Verifying 15 packets...
2025-01-01 00:10:58,382 - INFO - [pcap_writer.py:413] - Packet 1: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 00:10:58,382 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2025-01-01 00:10:58,383 - INFO - [pcap_writer.py:413] - Packet 2: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 00:10:58,384 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2775
2025-01-01 00:10:58,384 - INFO - [pcap_writer.py:413] - Packet 3: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 00:10:58,385 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 1646
2025-01-01 00:10:58,385 - INFO - [pcap_writer.py:413] - Packet 4: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 00:10:58,385 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2025-01-01 00:10:58,386 - INFO - [pcap_writer.py:413] - Packet 5: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 00:10:58,386 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2025-01-01 00:10:58,387 - INFO - [pcap_writer.py:413] - Packet 6: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 00:10:58,387 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 165
2025-01-01 00:10:58,388 - INFO - [pcap_writer.py:413] - Packet 7: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 00:10:58,388 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 133
2025-01-01 00:10:58,388 - INFO - [pcap_writer.py:413] - Packet 8: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 00:10:58,389 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 1157
2025-01-01 00:10:58,389 - INFO - [pcap_writer.py:413] - Packet 9: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-01 00:10:58,389 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2025-01-01 00:10:58,389 - INFO - [pcap_writer.py:413] - Packet 10: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-01 00:10:58,390 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2775
2025-01-01 00:10:58,390 - INFO - [pcap_writer.py:413] - Packet 11: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-01 00:10:58,391 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 269
2025-01-01 00:10:58,391 - INFO - [pcap_writer.py:413] - Packet 12: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-01 00:10:58,392 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2025-01-01 00:10:58,392 - INFO - [pcap_writer.py:413] - Packet 13: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-01 00:10:58,392 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2025-01-01 00:10:58,393 - INFO - [pcap_writer.py:413] - Packet 14: IP / TCP 192.168.1.2:12346 > 10.0.0.1:http PA / Raw
2025-01-01 00:10:58,393 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2025-01-01 00:10:58,393 - INFO - [pcap_writer.py:413] - Packet 15: IP / TCP 10.0.0.1:http > 192.168.1.2:12346 PA / Raw
2025-01-01 00:10:58,393 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2025-01-01 00:10:58,394 - INFO - [pcap_writer.py:427] - Verification complete: 15 valid packets, 15 TLS records
2025-01-01 00:10:58,394 - INFO - [main.py:106] - Results saved to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-01 00:10:58,394 - INFO - [main.py:160] - TLS session simulation completed successfully
2025-01-01 00:18:36,427 - INFO - [logging.py:83] - Logging configured successfully
2025-01-01 00:18:36,429 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-01 00:18:36,430 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-01 00:18:36,431 - INFO - [logging.py:92] - Log level: 20
2025-01-01 00:18:36,432 - INFO - [logging.py:93] - Timestamp: 2025-01-01T00:18:36.432055
2025-01-01 00:18:36,432 - INFO - [logging.py:94] - ==========================
2025-01-01 00:18:36,433 - INFO - [main.py:122] - Starting TLS session simulation
2025-01-01 00:18:36,434 - INFO - [main.py:87] - 
--- Client Session (certificate) ---
2025-01-01 00:18:36,437 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-01 00:18:36,438 - INFO - [cert.py:108] - File exists: True
2025-01-01 00:18:36,439 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-01 00:18:36,440 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-01 00:18:36,441 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-01 00:18:36,442 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-01 00:18:36,449 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 00:18:36,450 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-01 00:18:36,451 - INFO - [cert.py:108] - File exists: True
2025-01-01 00:18:36,452 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-01 00:18:36,454 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-01 00:18:36,454 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-01 00:18:36,455 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-01 00:18:36,457 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 00:18:36,511 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-01 00:18:36,512 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-01 00:18:36,513 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-01 00:18:36,514 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-01 00:18:36,519 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-01 00:18:36,520 - INFO - [verify.py:58] - Public key comparison results:
2025-01-01 00:18:36,521 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 00:18:36,523 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 00:18:36,525 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-01 00:18:36,525 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-01 00:18:36,531 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-01 00:18:36,532 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-01 00:18:36,533 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-01 00:18:36,534 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-01 00:18:36,534 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-01 00:18:36,536 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-01 00:18:36,538 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-01 00:18:36,539 - INFO - [session.py:120] - Starting TLS session
2025-01-01 00:18:36,539 - INFO - [client.py:95] - Generated client_random: 67746dbc3de129daf3460c963758c0a15058d153530647a8033d000c73886f20
2025-01-01 00:18:36,549 - INFO - [client.py:135] - Client Hello sent from 192.168.1.1
2025-01-01 00:18:36,553 - INFO - [server.py:93] - Generated server_random: 67746dbc2bd690c0ffdfe64127d18064ac60cdc26adf961f8ad5deaea764cb51
2025-01-01 00:18:36,562 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2025-01-01 00:18:36,563 - INFO - [cert.py:108] - File exists: True
2025-01-01 00:18:36,563 - INFO - [cert.py:109] - File size: 1915 bytes
2025-01-01 00:18:36,565 - INFO - [cert.py:113] - Read 1915 bytes
2025-01-01 00:18:36,565 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2025-01-01 00:18:36,565 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2025-01-01 00:18:36,566 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 00:18:36,567 - INFO - [client.py:169] - Prepared client certificate
2025-01-01 00:18:36,568 - INFO - [client.py:184] - Encrypted pre_master_secret length: 256
2025-01-01 00:18:36,572 - INFO - [chain.py:185] - Decrypted pre_master_secret: 0303ebebd5bf1681e63d19584508f2d2345a5b531f0eeaa3bdb44c3a5efcf07ab15ebf1c490ec3ac683a3254b99cdcbb
2025-01-01 00:18:36,573 - INFO - [chain.py:195] - Generated master secret: 7ff904f0fd40a291850ce0cf8daf235b5e6bfe1c87496571fd13e770d820907ef23509884e9abb893ac7f01ca444c3b6
2025-01-01 00:18:36,574 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-01 00:18:36,576 - INFO - [client.py:274] - Client ChangeCipherSpec and Finished messages sent
2025-01-01 00:18:36,578 - INFO - [server.py:254] - Pre-master secret validated successfully
2025-01-01 00:18:36,580 - INFO - [server.py:272] - Generated digital signature: a37f909c311eb55bba8bd1b1181496fbbef7f60c0a56ebf0109e231c980c056865b501a4fe42c07c9110941e0f4d7a170f2b6cea147a4bedd49930bf53cf2b05c22e91a85bd1ba08f03bbbdbc960f94e97104afa721775f6508635de32829104802b8d1334e290e3ef2a641f86e96f815e29bc0cc42871abd5b7cf75f34be15d8dc0e04b235be54761770878c815ced613122e93c4618a1a876001207dce80bb8bbdb2f15defc8ff3d7fd496cf3719812926bbe90fabaec80ce6d87b2b1d41636f97fae7c7f03b5a13d18528d6145ec20086907ee7621bc924cb1e3ed6d9e819312c9bad42dd6e95eb0909b670a2d83f7c51c59dbd00747fcfe9bcd3ca2890b7
2025-01-01 00:18:36,582 - INFO - [server.py:309] - Server ChangeCipherSpec and Finished messages sent
2025-01-01 00:18:36,585 - INFO - [keys.py:200] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-01 00:18:36,586 - INFO - [session.py:104] - TLS Handshake completed successfully
2025-01-01 00:18:36,587 - INFO - [session.py:131] - Found file to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 00:18:36,588 - INFO - [session.py:149] - Handshake completed: True
2025-01-01 00:18:36,589 - INFO - [session.py:150] - Use client cert: True
2025-01-01 00:18:36,590 - INFO - [session.py:151] - File to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 00:18:36,591 - INFO - [session.py:154] - Using encrypted exchange
2025-01-01 00:18:36,592 - INFO - [session.py:169] - Sending encrypted request data
2025-01-01 00:18:36,596 - INFO - [keys.py:180] - TLS Application Data sent from 192.168.1.1:12345 to 10.0.0.1:443
2025-01-01 00:18:36,597 - INFO - [session.py:180] - Sending encrypted response data
2025-01-01 00:18:36,599 - INFO - [keys.py:180] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-01 00:18:36,600 - INFO - [session.py:192] - Attempting to send file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 00:18:36,601 - INFO - [session.py:203] - Opening file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 00:18:36,603 - INFO - [session.py:210] - Read 1103 bytes from file
2025-01-01 00:18:36,605 - INFO - [keys.py:180] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-01 00:18:36,607 - INFO - [session.py:219] - File sent successfully
2025-01-01 00:18:36,608 - INFO - [session.py:194] - File sent successfully
2025-01-01 00:18:36,608 - INFO - [main.py:95] - Session completed successfully for 192.168.1.1
2025-01-01 00:18:36,609 - INFO - [main.py:87] - 
--- Client Session (no certificate) ---
2025-01-01 00:18:36,610 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-01 00:18:36,610 - INFO - [cert.py:108] - File exists: True
2025-01-01 00:18:36,611 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-01 00:18:36,612 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-01 00:18:36,612 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-01 00:18:36,614 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-01 00:18:36,615 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 00:18:36,616 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-01 00:18:36,617 - INFO - [cert.py:108] - File exists: True
2025-01-01 00:18:36,617 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-01 00:18:36,618 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-01 00:18:36,619 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-01 00:18:36,620 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-01 00:18:36,622 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 00:18:36,674 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-01 00:18:36,674 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-01 00:18:36,674 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-01 00:18:36,675 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-01 00:18:36,675 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-01 00:18:36,675 - INFO - [verify.py:58] - Public key comparison results:
2025-01-01 00:18:36,676 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 00:18:36,676 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 00:18:36,677 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-01 00:18:36,677 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-01 00:18:36,677 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-01 00:18:36,678 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-01 00:18:36,678 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-01 00:18:36,678 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-01 00:18:36,678 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-01 00:18:36,679 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-01 00:18:36,680 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-01 00:18:36,680 - INFO - [session.py:120] - Starting TLS session
2025-01-01 00:18:36,680 - INFO - [client.py:95] - Generated client_random: 67746dbcf37ac191939dda448b15f2536503f4446103c8bfbfeb5042c6e309bd
2025-01-01 00:18:36,682 - INFO - [client.py:135] - Client Hello sent from 192.168.1.2
2025-01-01 00:18:36,684 - INFO - [server.py:93] - Generated server_random: 67746dbc1dc9b9a9e6f1ee323706a12d07586e2dda4c85f0e300dcd3a3702cc8
2025-01-01 00:18:36,690 - INFO - [client.py:172] - Prepared empty certificate
2025-01-01 00:18:36,691 - INFO - [client.py:184] - Encrypted pre_master_secret length: 256
2025-01-01 00:18:36,693 - INFO - [chain.py:185] - Decrypted pre_master_secret: 0303f1914c4e7ae4aac7479fd2d48219a493e75bf0341f28ced07f942bcc3d7daff3120092f3cbb3941eac31685272fd
2025-01-01 00:18:36,693 - INFO - [chain.py:195] - Generated master secret: f909e17fc60b7490a3a3bb97a86dc55d2c2daf388566e6bd79627dcba8617ffcbecee04c040681364dd613ab1aa394f0
2025-01-01 00:18:36,694 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-01 00:18:36,694 - INFO - [client.py:274] - Client ChangeCipherSpec and Finished messages sent
2025-01-01 00:18:36,696 - INFO - [server.py:254] - Pre-master secret validated successfully
2025-01-01 00:18:36,697 - INFO - [server.py:272] - Generated digital signature: 249b382eb3d0ad177293ae0276d652fc6f8715a665cd2d894e5132dd4bbfcf84942e74d9d1f77a6ee1d05f62a8a38b4cf5a580024d211151052dd19374148d17fc0f5194775a467601a7254f81462b0a0db1b372ce70f0d1c1c040323da8593dd875c90ae206853494da28a5df26fe5843d21b43f79668d1367b1ea838d60c3256ea3d0a19c2057139a2ff20f457e86985eac99f4e4ba72caf8a7db350ce4f59ab012c6e1cab6b27e9eff2b97ecd932a6cfa9b57d1d9b668a57e15d540e972d2bc743f21583b403d1cbe24f6606eacbe76db639c4b0b9a0de715cb5d9cc01a3e2259e4cdde1c70fad5011ac2eaa28a18f2505aac0d5944a485b4d00cb1999a10
2025-01-01 00:18:36,698 - INFO - [server.py:309] - Server ChangeCipherSpec and Finished messages sent
2025-01-01 00:18:36,700 - INFO - [keys.py:200] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-01 00:18:36,700 - INFO - [session.py:104] - TLS Handshake completed successfully
2025-01-01 00:18:36,700 - INFO - [session.py:149] - Handshake completed: True
2025-01-01 00:18:36,701 - INFO - [session.py:150] - Use client cert: False
2025-01-01 00:18:36,701 - INFO - [session.py:151] - File to send: None
2025-01-01 00:18:36,702 - INFO - [session.py:157] - Using unencrypted exchange
2025-01-01 00:18:36,702 - INFO - [session.py:257] - Added request packet
2025-01-01 00:18:36,703 - INFO - [session.py:257] - Added response packet
2025-01-01 00:18:36,704 - WARNING - [session.py:234] - Using unencrypted communication
2025-01-01 00:18:36,704 - INFO - [main.py:95] - Session completed successfully for 192.168.1.2
2025-01-01 00:18:36,706 - INFO - [pcap_writer.py:232] - Packet 13: Valid HTTP message
2025-01-01 00:18:36,706 - INFO - [pcap_writer.py:232] - Packet 14: Valid HTTP message
2025-01-01 00:18:36,713 - INFO - [pcap_writer.py:387] - Saved 15 valid packets to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-01 00:18:36,714 - INFO - [pcap_writer.py:409] - Verifying 15 packets...
2025-01-01 00:18:36,715 - INFO - [pcap_writer.py:413] - Packet 1: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 00:18:36,716 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2025-01-01 00:18:36,716 - INFO - [pcap_writer.py:413] - Packet 2: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 00:18:36,717 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2775
2025-01-01 00:18:36,717 - INFO - [pcap_writer.py:413] - Packet 3: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 00:18:36,717 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 1646
2025-01-01 00:18:36,718 - INFO - [pcap_writer.py:413] - Packet 4: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 00:18:36,718 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2025-01-01 00:18:36,719 - INFO - [pcap_writer.py:413] - Packet 5: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 00:18:36,720 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2025-01-01 00:18:36,720 - INFO - [pcap_writer.py:413] - Packet 6: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 00:18:36,721 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 160
2025-01-01 00:18:36,721 - INFO - [pcap_writer.py:413] - Packet 7: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 00:18:36,722 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 128
2025-01-01 00:18:36,723 - INFO - [pcap_writer.py:413] - Packet 8: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 00:18:36,723 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 1152
2025-01-01 00:18:36,724 - INFO - [pcap_writer.py:413] - Packet 9: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-01 00:18:36,724 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2025-01-01 00:18:36,725 - INFO - [pcap_writer.py:413] - Packet 10: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-01 00:18:36,725 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2775
2025-01-01 00:18:36,726 - INFO - [pcap_writer.py:413] - Packet 11: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-01 00:18:36,726 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 269
2025-01-01 00:18:36,727 - INFO - [pcap_writer.py:413] - Packet 12: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-01 00:18:36,727 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2025-01-01 00:18:36,728 - INFO - [pcap_writer.py:413] - Packet 13: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-01 00:18:36,728 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2025-01-01 00:18:36,728 - INFO - [pcap_writer.py:413] - Packet 14: IP / TCP 192.168.1.2:12346 > 10.0.0.1:http PA / Raw
2025-01-01 00:18:36,729 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2025-01-01 00:18:36,729 - INFO - [pcap_writer.py:413] - Packet 15: IP / TCP 10.0.0.1:http > 192.168.1.2:12346 PA / Raw
2025-01-01 00:18:36,730 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2025-01-01 00:18:36,730 - INFO - [pcap_writer.py:427] - Verification complete: 15 valid packets, 15 TLS records
2025-01-01 00:18:36,731 - INFO - [main.py:106] - Results saved to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-01 00:18:36,731 - INFO - [main.py:160] - TLS session simulation completed successfully
2025-01-01 00:26:16,270 - INFO - [logging.py:83] - Logging configured successfully
2025-01-01 00:26:16,272 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-01 00:26:16,272 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-01 00:26:16,273 - INFO - [logging.py:92] - Log level: 20
2025-01-01 00:26:16,274 - INFO - [logging.py:93] - Timestamp: 2025-01-01T00:26:16.273955
2025-01-01 00:26:16,274 - INFO - [logging.py:94] - ==========================
2025-01-01 00:26:16,274 - INFO - [main.py:122] - Starting TLS session simulation
2025-01-01 00:26:16,275 - INFO - [main.py:87] - 
--- Client Session (certificate) ---
2025-01-01 00:26:16,277 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-01 00:26:16,277 - INFO - [cert.py:108] - File exists: True
2025-01-01 00:26:16,278 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-01 00:26:16,279 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-01 00:26:16,280 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-01 00:26:16,281 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-01 00:26:16,283 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 00:26:16,284 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-01 00:26:16,285 - INFO - [cert.py:108] - File exists: True
2025-01-01 00:26:16,285 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-01 00:26:16,286 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-01 00:26:16,287 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-01 00:26:16,288 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-01 00:26:16,290 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 00:26:16,330 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-01 00:26:16,330 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-01 00:26:16,330 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-01 00:26:16,331 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-01 00:26:16,332 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-01 00:26:16,333 - INFO - [verify.py:58] - Public key comparison results:
2025-01-01 00:26:16,333 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 00:26:16,333 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 00:26:16,334 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-01 00:26:16,334 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-01 00:26:16,338 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-01 00:26:16,340 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-01 00:26:16,340 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-01 00:26:16,341 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-01 00:26:16,342 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-01 00:26:16,343 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-01 00:26:16,344 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-01 00:26:16,345 - INFO - [session.py:120] - Starting TLS session
2025-01-01 00:26:16,345 - INFO - [client.py:95] - Generated client_random: 67746f88b2393ee227ab826bf04f19a8bd199a333fb46539b0a61a8b196142b9
2025-01-01 00:26:16,348 - INFO - [client.py:135] - Client Hello sent from 192.168.1.1
2025-01-01 00:26:16,350 - INFO - [server.py:93] - Generated server_random: 67746f88b8f9853dbc0074d3a9df3900a84274cdeb378cc7faf6e0f81b1d27a8
2025-01-01 00:26:16,356 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2025-01-01 00:26:16,357 - INFO - [cert.py:108] - File exists: True
2025-01-01 00:26:16,358 - INFO - [cert.py:109] - File size: 1915 bytes
2025-01-01 00:26:16,359 - INFO - [cert.py:113] - Read 1915 bytes
2025-01-01 00:26:16,360 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2025-01-01 00:26:16,360 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2025-01-01 00:26:16,361 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 00:26:16,362 - INFO - [client.py:169] - Prepared client certificate
2025-01-01 00:26:16,363 - INFO - [client.py:184] - Encrypted pre_master_secret length: 256
2025-01-01 00:26:16,366 - INFO - [chain.py:185] - Decrypted pre_master_secret: 0303b6cd6890aeefcf9209f8a00b1a4f2a79eac9c155c0e6c95af538eaee94b7cf4503f3fb119681049629a2e43065ca
2025-01-01 00:26:16,366 - INFO - [chain.py:195] - Generated master secret: b442dfa3b1c344516b1429434391d48181205d8d5f45cc2dd7083bad53135c32dd2c9e3d63ad62cd0e19f6b73b14fdda
2025-01-01 00:26:16,367 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-01 00:26:16,368 - INFO - [client.py:274] - Client ChangeCipherSpec and Finished messages sent
2025-01-01 00:26:16,370 - INFO - [server.py:254] - Pre-master secret validated successfully
2025-01-01 00:26:16,373 - INFO - [server.py:272] - Generated digital signature: 985a4dde9e3ad938812d0f72422fd2dfb0ecb06e4e126c7ea73de8b0a6712b5d8ae417b3b449e16b713a4cd1641b17c302895245fcf8a479e2bc55d8c6e2e7d7eca2bb07943d16280dd52c946cf4078a43976a60cc39a3d700792837684992c669e1759d0cb48a9cfa9e666c43d542a40c7cecb63a1d369496c675e263a700ab59c6003bf482c123fc9a2158f33c7431c2dfca61622ffcbe74cc8aa487483c65f9ee1d24a0e9b65f981fd8413331c11e76ebaebb350eceb66323c4c92fe0d9280a86d602e70f7d9aae6344df15a94df770c21d0eb13f7f8f6fdb3631b847563194afe94c8d86ba5cf2cd4e4ecd1799ad425911d38e20a48607f6bcb6470637fc
2025-01-01 00:26:16,378 - INFO - [server.py:309] - Server ChangeCipherSpec and Finished messages sent
2025-01-01 00:26:16,384 - INFO - [keys.py:205] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-01 00:26:16,386 - INFO - [session.py:104] - TLS Handshake completed successfully
2025-01-01 00:26:16,388 - INFO - [session.py:131] - Found file to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 00:26:16,391 - INFO - [session.py:149] - Handshake completed: True
2025-01-01 00:26:16,393 - INFO - [session.py:150] - Use client cert: True
2025-01-01 00:26:16,395 - INFO - [session.py:151] - File to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 00:26:16,397 - INFO - [session.py:154] - Using encrypted exchange
2025-01-01 00:26:16,399 - INFO - [session.py:169] - Sending encrypted request data
2025-01-01 00:26:16,406 - INFO - [keys.py:185] - TLS Application Data sent from 192.168.1.1:12345 to 10.0.0.1:443
2025-01-01 00:26:16,410 - INFO - [session.py:180] - Sending encrypted response data
2025-01-01 00:26:16,417 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-01 00:26:16,421 - INFO - [session.py:192] - Attempting to send file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 00:26:16,426 - INFO - [session.py:203] - Opening file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 00:26:16,431 - INFO - [session.py:210] - Read 1103 bytes from file
2025-01-01 00:26:16,441 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-01 00:26:16,443 - INFO - [session.py:219] - File sent successfully
2025-01-01 00:26:16,445 - INFO - [session.py:194] - File sent successfully
2025-01-01 00:26:16,446 - INFO - [main.py:95] - Session completed successfully for 192.168.1.1
2025-01-01 00:26:16,448 - INFO - [main.py:87] - 
--- Client Session (no certificate) ---
2025-01-01 00:26:16,452 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-01 00:26:16,455 - INFO - [cert.py:108] - File exists: True
2025-01-01 00:26:16,458 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-01 00:26:16,462 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-01 00:26:16,464 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-01 00:26:16,466 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-01 00:26:16,470 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 00:26:16,473 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-01 00:26:16,476 - INFO - [cert.py:108] - File exists: True
2025-01-01 00:26:16,478 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-01 00:26:16,480 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-01 00:26:16,482 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-01 00:26:16,484 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-01 00:26:16,488 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 00:26:16,548 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-01 00:26:16,549 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-01 00:26:16,550 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-01 00:26:16,550 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-01 00:26:16,550 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-01 00:26:16,551 - INFO - [verify.py:58] - Public key comparison results:
2025-01-01 00:26:16,551 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 00:26:16,552 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 00:26:16,553 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-01 00:26:16,554 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-01 00:26:16,557 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-01 00:26:16,559 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-01 00:26:16,560 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-01 00:26:16,561 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-01 00:26:16,562 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-01 00:26:16,563 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-01 00:26:16,566 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-01 00:26:16,566 - INFO - [session.py:120] - Starting TLS session
2025-01-01 00:26:16,567 - INFO - [client.py:95] - Generated client_random: 67746f88aadfd0b7a8f1b9af85f75372b3756eb490d025ab1ee0358bac4f689c
2025-01-01 00:26:16,569 - INFO - [client.py:135] - Client Hello sent from 192.168.1.2
2025-01-01 00:26:16,575 - INFO - [server.py:93] - Generated server_random: 67746f8874b1039cf675aa2dc42855d74a66447dbb9291207b5d4f6eed0dee72
2025-01-01 00:26:16,580 - INFO - [client.py:172] - Prepared empty certificate
2025-01-01 00:26:16,581 - INFO - [client.py:184] - Encrypted pre_master_secret length: 256
2025-01-01 00:26:16,583 - INFO - [chain.py:185] - Decrypted pre_master_secret: 030392349424ebff3d956fcee993b681e73b35e46d7e02a8aa67a19347f77fae4653aabaaab77147732d9c35a2560e40
2025-01-01 00:26:16,584 - INFO - [chain.py:195] - Generated master secret: 006cd637cf51684bb6d26f0c4cf370263a5c2a9aa6648d400da7b53a40d17688eea5b71f904650f8ee2949e7cfdc2788
2025-01-01 00:26:16,584 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-01 00:26:16,585 - INFO - [client.py:274] - Client ChangeCipherSpec and Finished messages sent
2025-01-01 00:26:16,587 - INFO - [server.py:254] - Pre-master secret validated successfully
2025-01-01 00:26:16,592 - INFO - [server.py:272] - Generated digital signature: cedb2966fe99d4f1f62a2166f2ccf883fac3c752aefb1883353a2568214c0d15a3a5dd598e4037a3ad273e302223cdcf3595f0247731c69cfccd600a0c0f67e92dc3eb08604d7ad6d2aaaf5e67653d4ae3570163f808a6dcd3501058753897af4f5ea6ae25524a8d15e4261845ef8fec98a7417db6dcd39b8ff4ad6041995a323ff0fac51bf2a1a1ac1cdbee2f86b8fe6e72367f4bf65481289db435413be1b199504d254fb9ac412431d69739c1696951221065ad80eb07f04e3bb2279bbf8efb7b4daf6d92a177e5b12320d8003cccc437d8444dc8e335058190071dcc786e237bd59c927bebe91b09202f569a2d7a3a875cee2103a357b20923ad46812148
2025-01-01 00:26:16,594 - INFO - [server.py:309] - Server ChangeCipherSpec and Finished messages sent
2025-01-01 00:26:16,598 - INFO - [keys.py:205] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-01 00:26:16,598 - INFO - [session.py:104] - TLS Handshake completed successfully
2025-01-01 00:26:16,599 - INFO - [session.py:149] - Handshake completed: True
2025-01-01 00:26:16,600 - INFO - [session.py:150] - Use client cert: False
2025-01-01 00:26:16,600 - INFO - [session.py:151] - File to send: None
2025-01-01 00:26:16,601 - INFO - [session.py:157] - Using unencrypted exchange
2025-01-01 00:26:16,602 - INFO - [session.py:257] - Added request packet
2025-01-01 00:26:16,603 - INFO - [session.py:257] - Added response packet
2025-01-01 00:26:16,603 - WARNING - [session.py:234] - Using unencrypted communication
2025-01-01 00:26:16,604 - INFO - [main.py:95] - Session completed successfully for 192.168.1.2
2025-01-01 00:26:16,606 - INFO - [pcap_writer.py:232] - Packet 13: Valid HTTP message
2025-01-01 00:26:16,608 - INFO - [pcap_writer.py:232] - Packet 14: Valid HTTP message
2025-01-01 00:26:16,616 - INFO - [pcap_writer.py:387] - Saved 15 valid packets to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-01 00:26:16,617 - INFO - [pcap_writer.py:409] - Verifying 15 packets...
2025-01-01 00:26:16,618 - INFO - [pcap_writer.py:413] - Packet 1: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 00:26:16,619 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2025-01-01 00:26:16,621 - INFO - [pcap_writer.py:413] - Packet 2: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 00:26:16,622 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2775
2025-01-01 00:26:16,624 - INFO - [pcap_writer.py:413] - Packet 3: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 00:26:16,626 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 1646
2025-01-01 00:26:16,628 - INFO - [pcap_writer.py:413] - Packet 4: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 00:26:16,629 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2025-01-01 00:26:16,630 - INFO - [pcap_writer.py:413] - Packet 5: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 00:26:16,630 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2025-01-01 00:26:16,631 - INFO - [pcap_writer.py:413] - Packet 6: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 00:26:16,632 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 160
2025-01-01 00:26:16,632 - INFO - [pcap_writer.py:413] - Packet 7: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 00:26:16,633 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 128
2025-01-01 00:26:16,633 - INFO - [pcap_writer.py:413] - Packet 8: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 00:26:16,634 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 1152
2025-01-01 00:26:16,634 - INFO - [pcap_writer.py:413] - Packet 9: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-01 00:26:16,635 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2025-01-01 00:26:16,635 - INFO - [pcap_writer.py:413] - Packet 10: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-01 00:26:16,636 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2775
2025-01-01 00:26:16,636 - INFO - [pcap_writer.py:413] - Packet 11: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-01 00:26:16,637 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 269
2025-01-01 00:26:16,638 - INFO - [pcap_writer.py:413] - Packet 12: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-01 00:26:16,640 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2025-01-01 00:26:16,641 - INFO - [pcap_writer.py:413] - Packet 13: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-01 00:26:16,643 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2025-01-01 00:26:16,644 - INFO - [pcap_writer.py:413] - Packet 14: IP / TCP 192.168.1.2:12346 > 10.0.0.1:http PA / Raw
2025-01-01 00:26:16,646 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2025-01-01 00:26:16,648 - INFO - [pcap_writer.py:413] - Packet 15: IP / TCP 10.0.0.1:http > 192.168.1.2:12346 PA / Raw
2025-01-01 00:26:16,648 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2025-01-01 00:26:16,649 - INFO - [pcap_writer.py:427] - Verification complete: 15 valid packets, 15 TLS records
2025-01-01 00:26:16,650 - INFO - [main.py:106] - Results saved to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-01 00:26:16,650 - INFO - [main.py:160] - TLS session simulation completed successfully
2025-01-01 09:42:57,014 - INFO - [logging.py:83] - Logging configured successfully
2025-01-01 09:42:57,017 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-01 09:42:57,018 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-01 09:42:57,018 - INFO - [logging.py:92] - Log level: 20
2025-01-01 09:42:57,019 - INFO - [logging.py:93] - Timestamp: 2025-01-01T09:42:57.019486
2025-01-01 09:42:57,020 - INFO - [logging.py:94] - ==========================
2025-01-01 09:42:57,020 - INFO - [main.py:122] - Starting TLS session simulation
2025-01-01 09:42:57,022 - INFO - [main.py:87] - 
--- Client Session (certificate) ---
2025-01-01 09:42:57,025 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-01 09:42:57,027 - INFO - [cert.py:108] - File exists: True
2025-01-01 09:42:57,028 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-01 09:42:57,048 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-01 09:42:57,049 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-01 09:42:57,051 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-01 09:42:57,063 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 09:42:57,065 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-01 09:42:57,068 - INFO - [cert.py:108] - File exists: True
2025-01-01 09:42:57,070 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-01 09:42:57,102 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-01 09:42:57,103 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-01 09:42:57,105 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-01 09:42:57,108 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 09:42:57,237 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-01 09:42:57,239 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-01 09:42:57,240 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-01 09:42:57,242 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-01 09:42:57,271 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-01 09:42:57,272 - INFO - [verify.py:58] - Public key comparison results:
2025-01-01 09:42:57,273 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 09:42:57,276 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 09:42:57,279 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-01 09:42:57,280 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-01 09:42:57,294 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-01 09:42:57,297 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-01 09:42:57,298 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-01 09:42:57,300 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-01 09:42:57,301 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-01 09:42:57,304 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-01 09:42:57,308 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-01 09:42:57,310 - INFO - [session.py:120] - Starting TLS session
2025-01-01 09:42:57,311 - INFO - [client.py:97] - Generated client_random: 6774f201e861874a1172e23551b6d428c2fe3ee6b11de6699a2f58006d007179
2025-01-01 09:42:57,320 - INFO - [client.py:137] - Client Hello sent from 192.168.1.1
2025-01-01 09:42:57,328 - INFO - [server.py:93] - Generated server_random: 6774f201c0b5ecb9d47b571582002424280b2e8deca0d621e30fdd3bb230211e
2025-01-01 09:42:57,343 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2025-01-01 09:42:57,345 - INFO - [cert.py:108] - File exists: True
2025-01-01 09:42:57,347 - INFO - [cert.py:109] - File size: 1915 bytes
2025-01-01 09:42:57,368 - INFO - [cert.py:113] - Read 1915 bytes
2025-01-01 09:42:57,370 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2025-01-01 09:42:57,371 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2025-01-01 09:42:57,373 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 09:42:57,374 - INFO - [client.py:171] - Prepared client certificate
2025-01-01 09:42:57,376 - INFO - [client.py:186] - Encrypted pre_master_secret length: 256
2025-01-01 09:42:57,384 - INFO - [chain.py:185] - Decrypted pre_master_secret: 0303bff359a1c17b9e59fcfe54f71d202869c8b1e4386140487d9bf004b56814aa3272202f4f4c341bc0bd6591dbe1f8
2025-01-01 09:42:57,386 - INFO - [chain.py:195] - Generated master secret: 28ed510c8804b14242d7020b8708370cbfe6711875315880f5a480617c418b7a853b84a94e58c7da14fff8f82e410a13
2025-01-01 09:42:57,388 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-01 09:42:57,390 - INFO - [client.py:267] - Pre-master secret validated successfully
2025-01-01 09:42:57,395 - INFO - [client.py:285] - Generated digital signature: 6b9a162b229bfa48c343d306c1ce38c7010cd4f18996c54a2a50c44c261b7ea0b738f910d1dee7fca7d1af57f1acfc1ccffd8bfad9c3f8fa4d7c6f3a8dea0b74db28f985bbc0c6bd7b42a47a9958e7988f5de43d090b71fee8fc2bc798cf6943612da78024492d937ad6ea777abaf5c34b977a376a7af351b029c4b892b76f02e06d0d181718ceabbd8a18194f12e1e7cea4b934a21c5194032c3a827ea6d01fdecc1c1b6f3e712614749ddecee3a014d288ad59b496d729fd1461504b92f93c695890bab26a4936ab9e1ed634c31c79be43eb4a4f79a7ee6f32caeaa093f7ac68b7ed9aa0a6ae43d689e96200812beb05973c2a5cf5fe55e4d4d234ce1ef0d0
2025-01-01 09:42:57,401 - INFO - [client.py:324] - Client ChangeCipherSpec and Finished messages sent
2025-01-01 09:42:57,406 - INFO - [server.py:254] - Pre-master secret validated successfully
2025-01-01 09:42:57,408 - INFO - [server.py:272] - Generated digital signature: 877850396dcedc59bcc9ca306021691d3ed4b63543a67591e53cfa7e68b321a7c6a64578a9c337e75818e96637b193a936d5c7854f04f73fdd2ce09fe77d77b4f564acfa6d31c9e1519415aba3f37c5a58f6b3ca51bc92a7a6d5b63275013579544919c1fbcdc687f4f51f867454bd977a2b28b5b670e81b0b214de3f26d690e4b874bdb976d996c5d9316223b7d2782cc9a0de4bc6004e03f184d87f6b28d794f67c66c751f13d0716b707bbad53625aa46147062449b4401c9bfd583cf12505210624c945744ce4d1100f3157c77b9230e40c2ad6b1e287a3b4ffee2e9f0c23e88eeb9897fb169f9e8ca73cda5b6da9437cfa3e0c94ec5c9b8b4fcd0f45c23
2025-01-01 09:42:57,412 - INFO - [server.py:311] - Server ChangeCipherSpec and Finished messages sent
2025-01-01 09:42:57,418 - INFO - [keys.py:205] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-01 09:42:57,419 - INFO - [session.py:104] - TLS Handshake completed successfully
2025-01-01 09:42:57,421 - INFO - [session.py:131] - Found file to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 09:42:57,422 - INFO - [session.py:149] - Handshake completed: True
2025-01-01 09:42:57,423 - INFO - [session.py:150] - Use client cert: True
2025-01-01 09:42:57,423 - INFO - [session.py:151] - File to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 09:42:57,424 - INFO - [session.py:154] - Using encrypted exchange
2025-01-01 09:42:57,424 - INFO - [session.py:169] - Sending encrypted request data
2025-01-01 09:42:57,432 - INFO - [keys.py:185] - TLS Application Data sent from 192.168.1.1:12345 to 10.0.0.1:443
2025-01-01 09:42:57,434 - INFO - [session.py:180] - Sending encrypted response data
2025-01-01 09:42:57,437 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-01 09:42:57,439 - INFO - [session.py:192] - Attempting to send file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 09:42:57,439 - INFO - [session.py:203] - Opening file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 09:42:57,442 - INFO - [session.py:210] - Read 1103 bytes from file
2025-01-01 09:42:57,447 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-01 09:42:57,449 - INFO - [session.py:219] - File sent successfully
2025-01-01 09:42:57,450 - INFO - [session.py:194] - File sent successfully
2025-01-01 09:42:57,451 - INFO - [main.py:95] - Session completed successfully for 192.168.1.1
2025-01-01 09:42:57,452 - INFO - [main.py:87] - 
--- Client Session (no certificate) ---
2025-01-01 09:42:57,455 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-01 09:42:57,456 - INFO - [cert.py:108] - File exists: True
2025-01-01 09:42:57,457 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-01 09:42:57,458 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-01 09:42:57,458 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-01 09:42:57,479 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-01 09:42:57,482 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 09:42:57,485 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-01 09:42:57,487 - INFO - [cert.py:108] - File exists: True
2025-01-01 09:42:57,488 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-01 09:42:57,489 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-01 09:42:57,490 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-01 09:42:57,492 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-01 09:42:57,493 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 09:42:57,590 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-01 09:42:57,592 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-01 09:42:57,593 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-01 09:42:57,594 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-01 09:42:57,595 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-01 09:42:57,596 - INFO - [verify.py:58] - Public key comparison results:
2025-01-01 09:42:57,597 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 09:42:57,600 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 09:42:57,602 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-01 09:42:57,603 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-01 09:42:57,605 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-01 09:42:57,607 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-01 09:42:57,608 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-01 09:42:57,609 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-01 09:42:57,611 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-01 09:42:57,612 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-01 09:42:57,617 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-01 09:42:57,618 - INFO - [session.py:120] - Starting TLS session
2025-01-01 09:42:57,619 - INFO - [client.py:97] - Generated client_random: 6774f20179b6fe95424874326005a432b4b695df5c3c5deb0741c1a3f285ad48
2025-01-01 09:42:57,626 - INFO - [client.py:137] - Client Hello sent from 192.168.1.2
2025-01-01 09:42:57,632 - INFO - [server.py:93] - Generated server_random: 6774f2011c9edcc11414ab801c7c023e3a6f89763fc2b63a4d9f626ea931eb45
2025-01-01 09:42:57,647 - INFO - [client.py:174] - Prepared empty certificate
2025-01-01 09:42:57,650 - INFO - [client.py:186] - Encrypted pre_master_secret length: 256
2025-01-01 09:42:57,657 - INFO - [chain.py:185] - Decrypted pre_master_secret: 03035f43f94268e7334e8602b26ecd379d84ef2f4c5f5d20ba3202da7fb38fa2ba84cfd18236e87be16622949acbdd47
2025-01-01 09:42:57,659 - INFO - [chain.py:195] - Generated master secret: 003726cd2ff643f20da21d6f59b71e4722d33a3519e6cbef70e7212f2c6980d1b220a8449722de86151a4a89c52ace52
2025-01-01 09:42:57,661 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-01 09:42:57,665 - INFO - [client.py:267] - Pre-master secret validated successfully
2025-01-01 09:42:57,671 - INFO - [client.py:285] - Generated digital signature: a5aaf8bd496d8f97b4ce221cade7da13f842c753083db796f7280b78a03047410b13c6b76e6129c09a86f2c24e565e3cdfd660af42480df0609393fc03a37a9414cf3980873c1150df166bc91959a48f376d4fb16fb67de4ae2e0bc35381680586c62f59fe659ee5d053178606b6d3d4e474f32c7f0fd5a6f4464436989e3939d3a037ed83b90a0e69bc39b4fb7a8f97634c3696c4d33b2b81f271e6888d797e15760f72acf756cdc899d1bb43eae5245bad2425cadd4bf134eef1c6db8fc08240d89204db82e8aa05b905a907940754f30902e0df811a7662daa3f9ad8ee2d936108fa438aedc76f9f5067f6af13e5eef5c986269aa591fd2792129e2616ced
2025-01-01 09:42:57,676 - INFO - [client.py:324] - Client ChangeCipherSpec and Finished messages sent
2025-01-01 09:42:57,685 - INFO - [server.py:254] - Pre-master secret validated successfully
2025-01-01 09:42:57,692 - INFO - [server.py:272] - Generated digital signature: 2da8c3082e69a4b71e369c7831473b507faa5570257881f89548d6759f7da9b911363f49eb97830320efd24c8238fd731cc32a19aefc75585c9463bcb4fc7af712542b4a8b584764c414b26f66f3e6a5062d023fb6377be67753963c788efe11022be9435ef5a16d639ec6efdae3f28217debb690e6e20a97c500f601af93c0bb1826cc1e52391d5ba0ddc4b3b24ac9fd23c38c0272f683fa32dbc694025c09573c87a74c9b1b178b82d7378cb1ada0070b071f4fb903023c80a26fff49ad9f6cee5d782f0e595802c0395ae5c4cb916981e71ecb3387daa559557bbe7eb3c12fe894e142d3e1b50b79834ac570f119e4151f374c846388a225462f029ebb286
2025-01-01 09:42:57,697 - INFO - [server.py:311] - Server ChangeCipherSpec and Finished messages sent
2025-01-01 09:42:57,704 - INFO - [keys.py:205] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-01 09:42:57,705 - INFO - [session.py:104] - TLS Handshake completed successfully
2025-01-01 09:42:57,707 - INFO - [session.py:149] - Handshake completed: True
2025-01-01 09:42:57,708 - INFO - [session.py:150] - Use client cert: False
2025-01-01 09:42:57,709 - INFO - [session.py:151] - File to send: None
2025-01-01 09:42:57,710 - INFO - [session.py:157] - Using unencrypted exchange
2025-01-01 09:42:57,713 - INFO - [session.py:257] - Added request packet
2025-01-01 09:42:57,716 - INFO - [session.py:257] - Added response packet
2025-01-01 09:42:57,718 - WARNING - [session.py:234] - Using unencrypted communication
2025-01-01 09:42:57,719 - INFO - [main.py:95] - Session completed successfully for 192.168.1.2
2025-01-01 09:42:57,721 - INFO - [pcap_writer.py:232] - Packet 13: Valid HTTP message
2025-01-01 09:42:57,722 - INFO - [pcap_writer.py:232] - Packet 14: Valid HTTP message
2025-01-01 09:42:57,741 - INFO - [pcap_writer.py:387] - Saved 15 valid packets to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-01 09:42:57,743 - INFO - [pcap_writer.py:409] - Verifying 15 packets...
2025-01-01 09:42:57,744 - INFO - [pcap_writer.py:413] - Packet 1: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 09:42:57,745 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2025-01-01 09:42:57,747 - INFO - [pcap_writer.py:413] - Packet 2: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 09:42:57,748 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2775
2025-01-01 09:42:57,750 - INFO - [pcap_writer.py:413] - Packet 3: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 09:42:57,752 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 1646
2025-01-01 09:42:57,753 - INFO - [pcap_writer.py:413] - Packet 4: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 09:42:57,754 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2025-01-01 09:42:57,756 - INFO - [pcap_writer.py:413] - Packet 5: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 09:42:57,757 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2025-01-01 09:42:57,759 - INFO - [pcap_writer.py:413] - Packet 6: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 09:42:57,760 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 160
2025-01-01 09:42:57,762 - INFO - [pcap_writer.py:413] - Packet 7: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 09:42:57,763 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 128
2025-01-01 09:42:57,765 - INFO - [pcap_writer.py:413] - Packet 8: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 09:42:57,766 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 1152
2025-01-01 09:42:57,768 - INFO - [pcap_writer.py:413] - Packet 9: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-01 09:42:57,770 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2025-01-01 09:42:57,771 - INFO - [pcap_writer.py:413] - Packet 10: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-01 09:42:57,773 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2775
2025-01-01 09:42:57,774 - INFO - [pcap_writer.py:413] - Packet 11: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-01 09:42:57,776 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 269
2025-01-01 09:42:57,777 - INFO - [pcap_writer.py:413] - Packet 12: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-01 09:42:57,778 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2025-01-01 09:42:57,780 - INFO - [pcap_writer.py:413] - Packet 13: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-01 09:42:57,781 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2025-01-01 09:42:57,783 - INFO - [pcap_writer.py:413] - Packet 14: IP / TCP 192.168.1.2:12346 > 10.0.0.1:http PA / Raw
2025-01-01 09:42:57,784 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2025-01-01 09:42:57,786 - INFO - [pcap_writer.py:413] - Packet 15: IP / TCP 10.0.0.1:http > 192.168.1.2:12346 PA / Raw
2025-01-01 09:42:57,787 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2025-01-01 09:42:57,788 - INFO - [pcap_writer.py:427] - Verification complete: 15 valid packets, 15 TLS records
2025-01-01 09:42:57,790 - INFO - [main.py:106] - Results saved to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-01 09:42:57,791 - INFO - [main.py:160] - TLS session simulation completed successfully
2025-01-01 10:01:35,806 - INFO - [logging.py:83] - Logging configured successfully
2025-01-01 10:01:35,808 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-01 10:01:35,808 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-01 10:01:35,809 - INFO - [logging.py:92] - Log level: 20
2025-01-01 10:01:35,810 - INFO - [logging.py:93] - Timestamp: 2025-01-01T10:01:35.809981
2025-01-01 10:01:35,810 - INFO - [logging.py:94] - ==========================
2025-01-01 10:01:35,811 - INFO - [main.py:122] - Starting TLS session simulation
2025-01-01 10:01:35,812 - INFO - [main.py:87] - 
--- Client Session (certificate) ---
2025-01-01 10:01:35,814 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-01 10:01:35,816 - INFO - [cert.py:108] - File exists: True
2025-01-01 10:01:35,817 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-01 10:01:35,818 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-01 10:01:35,819 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-01 10:01:35,821 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-01 10:01:35,829 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 10:01:35,831 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-01 10:01:35,834 - INFO - [cert.py:108] - File exists: True
2025-01-01 10:01:35,836 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-01 10:01:35,838 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-01 10:01:35,839 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-01 10:01:35,840 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-01 10:01:35,841 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 10:01:35,896 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-01 10:01:35,896 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-01 10:01:35,897 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-01 10:01:35,898 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-01 10:01:35,901 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-01 10:01:35,902 - INFO - [verify.py:58] - Public key comparison results:
2025-01-01 10:01:35,902 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 10:01:35,903 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 10:01:35,904 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-01 10:01:35,905 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-01 10:01:35,911 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-01 10:01:35,912 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-01 10:01:35,912 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-01 10:01:35,912 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-01 10:01:35,913 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-01 10:01:35,913 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-01 10:01:35,914 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-01 10:01:35,915 - INFO - [session.py:120] - Starting TLS session
2025-01-01 10:01:35,915 - INFO - [client.py:99] - Generated client_random: 6774f65f7fd690cb9a05479e0faed88d0cd8dd340acbbfbda876810597a2531d
2025-01-01 10:01:35,918 - INFO - [client.py:139] - Client Hello sent from 192.168.1.1
2025-01-01 10:01:35,921 - INFO - [server.py:95] - Generated server_random: 6774f65fca8c344bfb375514dfbcb8adc257d6c02faa7f14a32120080138fe1f
2025-01-01 10:01:35,928 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2025-01-01 10:01:35,928 - INFO - [cert.py:108] - File exists: True
2025-01-01 10:01:35,929 - INFO - [cert.py:109] - File size: 1915 bytes
2025-01-01 10:01:35,930 - INFO - [cert.py:113] - Read 1915 bytes
2025-01-01 10:01:35,930 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2025-01-01 10:01:35,930 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2025-01-01 10:01:35,931 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 10:01:35,931 - INFO - [client.py:173] - Prepared client certificate
2025-01-01 10:01:35,932 - INFO - [client.py:188] - Encrypted pre_master_secret length: 256
2025-01-01 10:01:35,935 - INFO - [chain.py:185] - Decrypted pre_master_secret: 030318e21f44cb27b6d88947dfe04dfec6265c0d63ac43811de62463b7a5fb6f48928e2295d16b20f51568270ddadaae
2025-01-01 10:01:35,936 - INFO - [chain.py:195] - Generated master secret: 95f5ad37dd17fd25dd7c38fd3a65ce25c48266078bef6f87506076dad01199c5351bd8150d8ec20cd4189a9320928be6
2025-01-01 10:01:35,937 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-01 10:01:35,939 - INFO - [client.py:269] - Pre-master secret validated successfully
2025-01-01 10:01:35,940 - INFO - [client.py:287] - Generated digital signature: 568707c5c4d3689757fe631508be2bdcd9f9affe56638c7232ed770cbeaeecd0f42a437ce6548c3246e26eac6f85597de7f25d2ad5d82ca6befb5697a81cfa9bde8564498770d8ac06f46a91b5ee1133c2f5e1b2484ce8cf2f2590caab610dfdb44af1c37341dd86ed1fd3a9cf8c0b72ca923687cf4751ee53f95e7eb2e3768cd2a97c4eda8aeef37407d6c83d0c2cd645a4b4ab71815de03480f9bf5b64dc55abd34ab2a18dad58b2cf54ac2194dcff3bee666faf1b819fb39a42a169303582c3d6ce17e63eb29ad89a6547d76db7803cc8ae7a8dfa326753fd0994eb94ff306351cbc5b1b389a62bdada588d73b91cbbbe2d2066880e9f42034d8069890627
2025-01-01 10:01:35,944 - ERROR - [main.py:27] - Session error: Session failed for 192.168.1.1: Session failed: Failed to send ChangeCipherSpec: Failed to create finished messages: type object 'KeyBlock' has no attribute 'client_key'
2025-01-01 10:04:06,597 - INFO - [logging.py:83] - Logging configured successfully
2025-01-01 10:04:06,597 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-01 10:04:06,598 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-01 10:04:06,598 - INFO - [logging.py:92] - Log level: 20
2025-01-01 10:04:06,599 - INFO - [logging.py:93] - Timestamp: 2025-01-01T10:04:06.599000
2025-01-01 10:04:06,599 - INFO - [logging.py:94] - ==========================
2025-01-01 10:04:06,599 - INFO - [main.py:122] - Starting TLS session simulation
2025-01-01 10:04:06,600 - INFO - [main.py:87] - 
--- Client Session (certificate) ---
2025-01-01 10:04:06,600 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-01 10:04:06,601 - INFO - [cert.py:108] - File exists: True
2025-01-01 10:04:06,601 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-01 10:04:06,602 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-01 10:04:06,602 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-01 10:04:06,603 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-01 10:04:06,604 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 10:04:06,605 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-01 10:04:06,605 - INFO - [cert.py:108] - File exists: True
2025-01-01 10:04:06,606 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-01 10:04:06,606 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-01 10:04:06,607 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-01 10:04:06,607 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-01 10:04:06,608 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 10:04:06,637 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-01 10:04:06,638 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-01 10:04:06,639 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-01 10:04:06,639 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-01 10:04:06,643 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-01 10:04:06,645 - INFO - [verify.py:58] - Public key comparison results:
2025-01-01 10:04:06,645 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 10:04:06,647 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 10:04:06,648 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-01 10:04:06,648 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-01 10:04:06,652 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-01 10:04:06,653 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-01 10:04:06,653 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-01 10:04:06,654 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-01 10:04:06,654 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-01 10:04:06,655 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-01 10:04:06,657 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-01 10:04:06,658 - INFO - [session.py:120] - Starting TLS session
2025-01-01 10:04:06,659 - INFO - [client.py:99] - Generated client_random: 6774f6f64ad116a8d9a72e818025fac3c647dd9cfd4337af7a8aed47e9d74d90
2025-01-01 10:04:06,662 - INFO - [client.py:139] - Client Hello sent from 192.168.1.1
2025-01-01 10:04:06,664 - INFO - [server.py:95] - Generated server_random: 6774f6f6211b7145320d016d6a04347f1a340a538486fa82dffb005e753573da
2025-01-01 10:04:06,669 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2025-01-01 10:04:06,669 - INFO - [cert.py:108] - File exists: True
2025-01-01 10:04:06,670 - INFO - [cert.py:109] - File size: 1915 bytes
2025-01-01 10:04:06,670 - INFO - [cert.py:113] - Read 1915 bytes
2025-01-01 10:04:06,670 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2025-01-01 10:04:06,671 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2025-01-01 10:04:06,671 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 10:04:06,672 - INFO - [client.py:173] - Prepared client certificate
2025-01-01 10:04:06,672 - INFO - [client.py:188] - Encrypted pre_master_secret length: 256
2025-01-01 10:04:06,675 - INFO - [chain.py:185] - Decrypted pre_master_secret: 030377e95a66f57040d731ae505e251bfc48b78f855d02e821705d06fc35e7afcf6654125f2ea54aaad18804695ddc56
2025-01-01 10:04:06,675 - INFO - [chain.py:195] - Generated master secret: 792f0dbf32316e420836c2aaf76bce5a02640c379d4e5682e1102036120a5a83961469a6cae5e66e7ce32af3863d0213
2025-01-01 10:04:06,677 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-01 10:04:06,678 - INFO - [client.py:269] - Pre-master secret validated successfully
2025-01-01 10:04:06,679 - INFO - [client.py:287] - Generated digital signature: 870b34c10fe81d960774d5e94012c410be055c51dffcbce727d1eaa6b9c41c8aff6d55ae18f016d22d4d624a9638d68fdd9df880413732d22564f2b93f38670314a78b2d516895dca779f102ed170c618712a3abbe67a6c51b8b0808da0bf5661ffcd711dd7e300edfae25325e8260bf36662c9a116be15c82cc37c9c348352ba775ddf0026222f88b5a580f34462b6737308da348c395f03fd54fcad41f239d288787d0b8e1dc9cd78c1123a0fe74c681afa323965f0910158af2778c66c3a2ab8fd0042a76160e0e8b93dee8ac5d5f9e597a18a1894cc7ed87d821f9de5b2d135a5abe747cc96e5cd4076ef1f23415908c76e1e4ca8ceb0b167e5bedebe971
2025-01-01 10:04:06,681 - ERROR - [main.py:27] - Session error: Session failed for 192.168.1.1: Session failed: Failed to send ChangeCipherSpec: Failed to create finished messages: type object 'KeyBlock' has no attribute 'client_key'
2025-01-01 10:04:22,604 - INFO - [logging.py:83] - Logging configured successfully
2025-01-01 10:04:22,605 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-01 10:04:22,605 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-01 10:04:22,606 - INFO - [logging.py:92] - Log level: 20
2025-01-01 10:04:22,607 - INFO - [logging.py:93] - Timestamp: 2025-01-01T10:04:22.607053
2025-01-01 10:04:22,607 - INFO - [logging.py:94] - ==========================
2025-01-01 10:04:22,608 - INFO - [main.py:122] - Starting TLS session simulation
2025-01-01 10:04:22,609 - INFO - [main.py:87] - 
--- Client Session (certificate) ---
2025-01-01 10:04:22,611 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-01 10:04:22,611 - INFO - [cert.py:108] - File exists: True
2025-01-01 10:04:22,612 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-01 10:04:22,613 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-01 10:04:22,613 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-01 10:04:22,614 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-01 10:04:22,616 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 10:04:22,616 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-01 10:04:22,617 - INFO - [cert.py:108] - File exists: True
2025-01-01 10:04:22,618 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-01 10:04:22,618 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-01 10:04:22,618 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-01 10:04:22,619 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-01 10:04:22,620 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 10:04:22,656 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-01 10:04:22,657 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-01 10:04:22,657 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-01 10:04:22,658 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-01 10:04:22,661 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-01 10:04:22,662 - INFO - [verify.py:58] - Public key comparison results:
2025-01-01 10:04:22,663 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 10:04:22,664 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 10:04:22,665 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-01 10:04:22,665 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-01 10:04:22,668 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-01 10:04:22,668 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-01 10:04:22,669 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-01 10:04:22,669 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-01 10:04:22,669 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-01 10:04:22,670 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-01 10:04:22,671 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-01 10:04:22,672 - INFO - [session.py:120] - Starting TLS session
2025-01-01 10:04:22,672 - INFO - [client.py:99] - Generated client_random: 6774f706f16ce2bdc2eae1bf879f899eefdc31cfc9866c8cdb9ef5235ca4dc55
2025-01-01 10:04:22,674 - INFO - [client.py:139] - Client Hello sent from 192.168.1.1
2025-01-01 10:04:22,677 - INFO - [server.py:95] - Generated server_random: 6774f706016926b928eda887ef8258394bec4131ba7a88b6495a96f0c089ee8f
2025-01-01 10:04:22,683 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2025-01-01 10:04:22,683 - INFO - [cert.py:108] - File exists: True
2025-01-01 10:04:22,684 - INFO - [cert.py:109] - File size: 1915 bytes
2025-01-01 10:04:22,685 - INFO - [cert.py:113] - Read 1915 bytes
2025-01-01 10:04:22,685 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2025-01-01 10:04:22,685 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2025-01-01 10:04:22,686 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 10:04:22,686 - INFO - [client.py:173] - Prepared client certificate
2025-01-01 10:04:22,687 - INFO - [client.py:188] - Encrypted pre_master_secret length: 256
2025-01-01 10:04:22,689 - INFO - [chain.py:185] - Decrypted pre_master_secret: 03030e4de891419dcf4287f0775206f99a40f6f4107b580caa058e408972a4e20ca064607cc0fceb1fbe5f6f79d71ec5
2025-01-01 10:04:22,690 - INFO - [chain.py:195] - Generated master secret: c4d0cf3ab2ff1e24c7103e3d143230e55dbb899f7ea623654b18f8039cddae6831bcb47bafd863c80e734262e50a868a
2025-01-01 10:04:22,691 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-01 10:04:22,693 - INFO - [client.py:269] - Pre-master secret validated successfully
2025-01-01 10:04:22,694 - INFO - [client.py:287] - Generated digital signature: 5688609251f9701ba2aa9949e2edd2a91e38e4d9e964ad24ed17c94e114140334f16006b93da45c7c858a48095953ac997f31d1a115c27283044e1c8d2031860229e6e4262dea9d1fb46071eb785bcf811fef8eda6f6c5db98bd3a6970a8c23cc4c84338dc79ed3e46fb6a91b0dcace4c63d8159558d6e24e30e8a2d0b7507fd839f9277781a2df0040b0e152ef42e9d40f21bd1d873a6e589eed3efe3d612ecdba8ee83c131b42ff5fafadc17729f61ccea52931aac9fa2c4e2b707a2a09d2b8eeefa8d922c4016d1fff961ab7991c913bd00bcf5bfb7b0c0567387582ff9865421fa3b349b2a9911748f6e9a6bfe559df4880ea05b204a4cb6082d176d5667
2025-01-01 10:04:22,698 - ERROR - [main.py:27] - Session error: Session failed for 192.168.1.1: Session failed: Failed to send ChangeCipherSpec: Failed to create finished messages: type object 'KeyBlock' has no attribute 'client_key'
2025-01-01 10:07:07,505 - INFO - [logging.py:83] - Logging configured successfully
2025-01-01 10:07:07,506 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-01 10:07:07,507 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-01 10:07:07,507 - INFO - [logging.py:92] - Log level: 20
2025-01-01 10:07:07,508 - INFO - [logging.py:93] - Timestamp: 2025-01-01T10:07:07.508071
2025-01-01 10:07:07,508 - INFO - [logging.py:94] - ==========================
2025-01-01 10:07:07,509 - INFO - [main.py:122] - Starting TLS session simulation
2025-01-01 10:07:07,510 - INFO - [main.py:87] - 
--- Client Session (certificate) ---
2025-01-01 10:07:07,511 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-01 10:07:07,512 - INFO - [cert.py:108] - File exists: True
2025-01-01 10:07:07,513 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-01 10:07:07,514 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-01 10:07:07,514 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-01 10:07:07,515 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-01 10:07:07,518 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 10:07:07,518 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-01 10:07:07,519 - INFO - [cert.py:108] - File exists: True
2025-01-01 10:07:07,520 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-01 10:07:07,520 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-01 10:07:07,521 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-01 10:07:07,522 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-01 10:07:07,523 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 10:07:07,559 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-01 10:07:07,560 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-01 10:07:07,560 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-01 10:07:07,560 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-01 10:07:07,562 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-01 10:07:07,562 - INFO - [verify.py:58] - Public key comparison results:
2025-01-01 10:07:07,562 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 10:07:07,563 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 10:07:07,564 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-01 10:07:07,565 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-01 10:07:07,570 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-01 10:07:07,571 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-01 10:07:07,572 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-01 10:07:07,572 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-01 10:07:07,573 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-01 10:07:07,573 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-01 10:07:07,576 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-01 10:07:07,578 - INFO - [session.py:120] - Starting TLS session
2025-01-01 10:07:07,579 - INFO - [client.py:99] - Generated client_random: 6774f7abe46be6767de686f3df35a542e5be3589972516e6d0883a77f721fe55
2025-01-01 10:07:07,584 - INFO - [client.py:139] - Client Hello sent from 192.168.1.1
2025-01-01 10:07:07,590 - INFO - [server.py:95] - Generated server_random: 6774f7abdbfd15b44ffec2b3919071a4592a3f674089f942abe474d31cbf5566
2025-01-01 10:07:07,594 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2025-01-01 10:07:07,595 - INFO - [cert.py:108] - File exists: True
2025-01-01 10:07:07,595 - INFO - [cert.py:109] - File size: 1915 bytes
2025-01-01 10:07:07,596 - INFO - [cert.py:113] - Read 1915 bytes
2025-01-01 10:07:07,596 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2025-01-01 10:07:07,597 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2025-01-01 10:07:07,597 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 10:07:07,598 - INFO - [client.py:173] - Prepared client certificate
2025-01-01 10:07:07,599 - INFO - [client.py:188] - Encrypted pre_master_secret length: 256
2025-01-01 10:07:07,605 - INFO - [chain.py:185] - Decrypted pre_master_secret: 030335ad1ab6f3c3dfd312ef5b16f1d6bef4e73f9555677718468b3c626b22aca344214f2415978fb3bafeeffa47fbd0
2025-01-01 10:07:07,605 - INFO - [chain.py:195] - Generated master secret: f69b23c0faa28c6991060b411192c11d310a4ace0f1e2b65da32631385a6c5deadc1c3732716c8e46a6d46b216229778
2025-01-01 10:07:07,606 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-01 10:07:07,607 - INFO - [client.py:269] - Pre-master secret validated successfully
2025-01-01 10:07:07,608 - INFO - [client.py:287] - Generated digital signature: 785b84a80b906bce2d0bf3d35768dbda116e6018cdbf93f9f859ba8595904ab8b4c38c9dcbdd5cb062797bed738fb8a2a8c56a865d8ce6e4d1d7ea8401f2848cd880130ac432d332446891516f139aafb81e73cc4672b57a838f008ac935903196a99b7767f9666665145ef22ed0e51800f6543e6ec6d076168ed23ed61135f0013d9b2aee9cde9cb3b55bcb56103d802cc5b1f8459d37b9f5562369deb19b1489f02fb53768b941a1a4cc9e2e8a806f352d8ef9e2f40bdb9372c3e54437d61bce082aeb66175c190090da761019654aa6383d5c78f5ad72f8a06c56460c0d7c21fec1403b6bda5bb0507df7fc024b9513404ffff8fb5cebfdae340defc74eef
2025-01-01 10:07:07,609 - ERROR - [main.py:27] - Session error: Session failed for 192.168.1.1: Session failed: Failed to send ChangeCipherSpec: Failed to create finished messages: type object 'KeyBlock' has no attribute 'client_key'
2025-01-01 10:10:37,155 - INFO - [logging.py:83] - Logging configured successfully
2025-01-01 10:10:37,156 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-01 10:10:37,156 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-01 10:10:37,157 - INFO - [logging.py:92] - Log level: 20
2025-01-01 10:10:37,157 - INFO - [logging.py:93] - Timestamp: 2025-01-01T10:10:37.157476
2025-01-01 10:10:37,157 - INFO - [logging.py:94] - ==========================
2025-01-01 10:10:37,158 - INFO - [main.py:122] - Starting TLS session simulation
2025-01-01 10:10:37,159 - INFO - [main.py:87] - 
--- Client Session (certificate) ---
2025-01-01 10:10:37,160 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-01 10:10:37,160 - INFO - [cert.py:108] - File exists: True
2025-01-01 10:10:37,161 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-01 10:10:37,162 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-01 10:10:37,162 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-01 10:10:37,162 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-01 10:10:37,163 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 10:10:37,163 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-01 10:10:37,164 - INFO - [cert.py:108] - File exists: True
2025-01-01 10:10:37,164 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-01 10:10:37,165 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-01 10:10:37,165 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-01 10:10:37,166 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-01 10:10:37,167 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 10:10:37,206 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-01 10:10:37,207 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-01 10:10:37,207 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-01 10:10:37,208 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-01 10:10:37,210 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-01 10:10:37,211 - INFO - [verify.py:58] - Public key comparison results:
2025-01-01 10:10:37,211 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 10:10:37,213 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 10:10:37,214 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-01 10:10:37,215 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-01 10:10:37,218 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-01 10:10:37,219 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-01 10:10:37,219 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-01 10:10:37,220 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-01 10:10:37,220 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-01 10:10:37,221 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-01 10:10:37,222 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-01 10:10:37,223 - INFO - [session.py:120] - Starting TLS session
2025-01-01 10:10:37,223 - INFO - [client.py:99] - Generated client_random: 6774f87dcbe646b5302d6bc5bb085755992300c43c835e34119f8ffda1c18c0b
2025-01-01 10:10:37,226 - INFO - [client.py:139] - Client Hello sent from 192.168.1.1
2025-01-01 10:10:37,230 - INFO - [server.py:95] - Generated server_random: 6774f87d3caf8112183eb41aeb69ea3f248a03b0ad677324e55e32db74ddc9a6
2025-01-01 10:10:37,235 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2025-01-01 10:10:37,236 - INFO - [cert.py:108] - File exists: True
2025-01-01 10:10:37,237 - INFO - [cert.py:109] - File size: 1915 bytes
2025-01-01 10:10:37,237 - INFO - [cert.py:113] - Read 1915 bytes
2025-01-01 10:10:37,238 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2025-01-01 10:10:37,238 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2025-01-01 10:10:37,239 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 10:10:37,240 - INFO - [client.py:173] - Prepared client certificate
2025-01-01 10:10:37,240 - INFO - [client.py:188] - Encrypted pre_master_secret length: 256
2025-01-01 10:10:37,244 - INFO - [chain.py:185] - Decrypted pre_master_secret: 0303c6b034bd8cc2661ff1d0e1d26fe0dd8f574369aacdac3ca1de2cb4b1eb288ad9f74be4e13582a76cccc6c66d7a62
2025-01-01 10:10:37,246 - INFO - [chain.py:195] - Generated master secret: 5b70da0baf212500ed15df1dce37ab679d6a5dae7feefc919efe8ca42e3e66ec8b408798f0dd5fb413312405eb052383
2025-01-01 10:10:37,247 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-01 10:10:37,249 - INFO - [client.py:269] - Pre-master secret validated successfully
2025-01-01 10:10:37,251 - INFO - [client.py:287] - Generated digital signature: 26a6970797932b7a0f25e40a11a9e3e43965abee61d47fd1e27a21237815e99bf1a92892844e7a40f10508d8a53e401cc5823775e70abcfeb0ca28f5eced265191036fff94a8d80c3b6ec51995253fe6bcc8d367096df0e265bc7d7b9d61016e8426ca1e973ade11317514b36ba8e92c3f3a786d0a760d381ecfb4fe004ab990512d2b62be1472ce33dd179a59356019a7e85a3066c15b165228c01564126c94303aea77314fd0b2007b8ea9e4d770dcbec42750491b5f23b4d488514ec3f35119c3124721be49c8b6b94c449a1de90b91d3842430e8b1d21d132b2d8d2fd3f8ebebd7fc58c5cf1617dc8f3a54348c2ee63210b030ed0ed53f5284e12b0310e7
2025-01-01 10:10:37,256 - INFO - [client.py:333] - Client ChangeCipherSpec and Finished messages sent
2025-01-01 10:10:37,259 - INFO - [server.py:256] - Pre-master secret validated successfully
2025-01-01 10:10:37,262 - INFO - [server.py:274] - Generated digital signature: 8d265ba2c98b3cbd39fb7c113cf729bf6d3eab5e11b9466e7ddbc3898c3be4d74a0234c805cccd9e9a37be50f3a9376437562238b5048907acce41a4f670b0aba58fc441877627506aef2e845d734ebc5ff6fd723e5548e7aa45e3f722e0d8cb93140ff27f88849803c07f32ab1971b308b22c58ad8f0c45e577d35a873d36615d0a07a2ea12af83871449046e4f8d2f7b7d0740e8512f772654a3050cc668ced660f37e316190faa5d87b27ae4b36e0b097f73946e87bb8ba9704dbf1bdb9df9b80a7ade175ff01a0ae23ffb9739141734ce3461af4a644a4506a023c47388d44af27b59bb9917690da3ae98ef12252e6403b86bb2930b09e11c58f65054cbc
2025-01-01 10:10:37,265 - INFO - [server.py:320] - Server ChangeCipherSpec and Finished messages sent
2025-01-01 10:10:37,269 - INFO - [keys.py:205] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-01 10:10:37,269 - INFO - [session.py:104] - TLS Handshake completed successfully
2025-01-01 10:10:37,270 - INFO - [session.py:131] - Found file to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 10:10:37,271 - INFO - [session.py:149] - Handshake completed: True
2025-01-01 10:10:37,272 - INFO - [session.py:150] - Use client cert: True
2025-01-01 10:10:37,273 - INFO - [session.py:151] - File to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 10:10:37,273 - INFO - [session.py:154] - Using encrypted exchange
2025-01-01 10:10:37,274 - INFO - [session.py:169] - Sending encrypted request data
2025-01-01 10:10:37,277 - INFO - [keys.py:185] - TLS Application Data sent from 192.168.1.1:12345 to 10.0.0.1:443
2025-01-01 10:10:37,278 - INFO - [session.py:180] - Sending encrypted response data
2025-01-01 10:10:37,280 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-01 10:10:37,281 - INFO - [session.py:192] - Attempting to send file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 10:10:37,282 - INFO - [session.py:203] - Opening file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 10:10:37,284 - INFO - [session.py:210] - Read 1103 bytes from file
2025-01-01 10:10:37,287 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-01 10:10:37,289 - INFO - [session.py:219] - File sent successfully
2025-01-01 10:10:37,289 - INFO - [session.py:194] - File sent successfully
2025-01-01 10:10:37,290 - INFO - [main.py:95] - Session completed successfully for 192.168.1.1
2025-01-01 10:10:37,291 - INFO - [main.py:87] - 
--- Client Session (no certificate) ---
2025-01-01 10:10:37,292 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-01 10:10:37,293 - INFO - [cert.py:108] - File exists: True
2025-01-01 10:10:37,294 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-01 10:10:37,295 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-01 10:10:37,296 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-01 10:10:37,296 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-01 10:10:37,298 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 10:10:37,299 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-01 10:10:37,300 - INFO - [cert.py:108] - File exists: True
2025-01-01 10:10:37,301 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-01 10:10:37,302 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-01 10:10:37,303 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-01 10:10:37,304 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-01 10:10:37,306 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 10:10:37,341 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-01 10:10:37,341 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-01 10:10:37,342 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-01 10:10:37,342 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-01 10:10:37,343 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-01 10:10:37,344 - INFO - [verify.py:58] - Public key comparison results:
2025-01-01 10:10:37,344 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 10:10:37,345 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 10:10:37,346 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-01 10:10:37,347 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-01 10:10:37,347 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-01 10:10:37,348 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-01 10:10:37,348 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-01 10:10:37,349 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-01 10:10:37,349 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-01 10:10:37,349 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-01 10:10:37,350 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-01 10:10:37,350 - INFO - [session.py:120] - Starting TLS session
2025-01-01 10:10:37,350 - INFO - [client.py:99] - Generated client_random: 6774f87d45376931fa4d684782d57483f5caf730ee66272ffa02a4f3f323a763
2025-01-01 10:10:37,352 - INFO - [client.py:139] - Client Hello sent from 192.168.1.2
2025-01-01 10:10:37,354 - INFO - [server.py:95] - Generated server_random: 6774f87d543fe817581c05c3c115ba3ac4e4c2cadac9779b26b2c799d7490f45
2025-01-01 10:10:37,358 - INFO - [client.py:176] - Prepared empty certificate
2025-01-01 10:10:37,358 - INFO - [client.py:188] - Encrypted pre_master_secret length: 256
2025-01-01 10:10:37,361 - INFO - [chain.py:185] - Decrypted pre_master_secret: 03037f65819164b1b247d702524a636aee078ef36cf915780f9aa7791923ddf38f1ec15c54a9d1e7aeb75870a62f1705
2025-01-01 10:10:37,362 - INFO - [chain.py:195] - Generated master secret: 4b0925f30834093981a9f6021e4e48ac2073df7be2b7490ba4a85ac07fdb124f7282b9bd29c4f1b300eed1672b5544bf
2025-01-01 10:10:37,363 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-01 10:10:37,364 - INFO - [client.py:269] - Pre-master secret validated successfully
2025-01-01 10:10:37,365 - INFO - [client.py:287] - Generated digital signature: 5efbc81f2b36a9cc69eff1c822110cf8db30d595dc7a1fd3682a945e9fd6a049de3a745216f1b5dc6a926b85a4b412ce31e773943a6ef940f80530729f5c432cc14997d04ca03398cad5e2aa53fe39d5916eae6c1d147b28341c9bea76adc4620dfaeabf1a5482732df4e67e91ef98895ab9343c2b377a6fa956f624f7d325714f6efa29575fd6bf0060c86aa6e4d256dc7d362923c1271f14f20095b821b798ff9220d8be37ed33f7fc5243610f149fba433ce862a167fa8d22bd1c183c7b486cbe91c8acbea78cd918efb4a6fbffb883072c4fc4d88ed96817a5c2946f6c1dd54b909e5d97a65681fbbdf9b8b125e59a19fc24db58404a32b232a44bb0691a
2025-01-01 10:10:37,367 - INFO - [client.py:333] - Client ChangeCipherSpec and Finished messages sent
2025-01-01 10:10:37,369 - INFO - [server.py:256] - Pre-master secret validated successfully
2025-01-01 10:10:37,370 - INFO - [server.py:274] - Generated digital signature: 9f6ec06b05677d5c37be71de5b6cf60ff0642babafc21f3b1693191160ed7e88d1bb27c5864ea83f4702703fab7ad6f8e3dfea0274638b184d25644380796e25ebd91a4ad367778f470cf1b38213b88c4fdbbe6a3efe1f5baea5596af4aeac9ea3fd600ef7acd079b6b7617d440bec3edf09987200e62d155ee4e89ecee4d2281ba76b1f7fc70c08a654861090afb9e1d34e6ce8185c3c1aff8e922903c91d29461c21c4639cfcdeeb7cb98636347dde63d5d6fc2f9c16ccf245a472e6b8adcf2fa8dfc07d8a0ee92fd7ab3e975baf75e7fe4c009bf698cd81b2a9e6fe55ef26c000e01d4e637dc0dc1d204c4d0c666447991d686df9eaef026e9b4b1320fb6b
2025-01-01 10:10:37,372 - INFO - [server.py:320] - Server ChangeCipherSpec and Finished messages sent
2025-01-01 10:10:37,374 - INFO - [keys.py:205] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-01 10:10:37,375 - INFO - [session.py:104] - TLS Handshake completed successfully
2025-01-01 10:10:37,376 - INFO - [session.py:149] - Handshake completed: True
2025-01-01 10:10:37,376 - INFO - [session.py:150] - Use client cert: False
2025-01-01 10:10:37,377 - INFO - [session.py:151] - File to send: None
2025-01-01 10:10:37,377 - INFO - [session.py:157] - Using unencrypted exchange
2025-01-01 10:10:37,378 - INFO - [session.py:257] - Added request packet
2025-01-01 10:10:37,379 - INFO - [session.py:257] - Added response packet
2025-01-01 10:10:37,380 - WARNING - [session.py:234] - Using unencrypted communication
2025-01-01 10:10:37,380 - INFO - [main.py:95] - Session completed successfully for 192.168.1.2
2025-01-01 10:10:37,382 - INFO - [pcap_writer.py:232] - Packet 13: Valid HTTP message
2025-01-01 10:10:37,382 - INFO - [pcap_writer.py:232] - Packet 14: Valid HTTP message
2025-01-01 10:10:37,390 - INFO - [pcap_writer.py:387] - Saved 15 valid packets to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-01 10:10:37,391 - INFO - [pcap_writer.py:409] - Verifying 15 packets...
2025-01-01 10:10:37,391 - INFO - [pcap_writer.py:413] - Packet 1: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 10:10:37,392 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2025-01-01 10:10:37,393 - INFO - [pcap_writer.py:413] - Packet 2: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 10:10:37,394 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2775
2025-01-01 10:10:37,395 - INFO - [pcap_writer.py:413] - Packet 3: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 10:10:37,396 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 1646
2025-01-01 10:10:37,397 - INFO - [pcap_writer.py:413] - Packet 4: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 10:10:37,397 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-01 10:10:37,398 - INFO - [pcap_writer.py:413] - Packet 5: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 10:10:37,399 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-01 10:10:37,400 - INFO - [pcap_writer.py:413] - Packet 6: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 10:10:37,401 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 160
2025-01-01 10:10:37,402 - INFO - [pcap_writer.py:413] - Packet 7: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 10:10:37,402 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 128
2025-01-01 10:10:37,403 - INFO - [pcap_writer.py:413] - Packet 8: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 10:10:37,404 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 1152
2025-01-01 10:10:37,405 - INFO - [pcap_writer.py:413] - Packet 9: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-01 10:10:37,406 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2025-01-01 10:10:37,406 - INFO - [pcap_writer.py:413] - Packet 10: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-01 10:10:37,407 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2775
2025-01-01 10:10:37,408 - INFO - [pcap_writer.py:413] - Packet 11: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-01 10:10:37,408 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 269
2025-01-01 10:10:37,409 - INFO - [pcap_writer.py:413] - Packet 12: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-01 10:10:37,410 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-01 10:10:37,411 - INFO - [pcap_writer.py:413] - Packet 13: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-01 10:10:37,412 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-01 10:10:37,413 - INFO - [pcap_writer.py:413] - Packet 14: IP / TCP 192.168.1.2:12346 > 10.0.0.1:http PA / Raw
2025-01-01 10:10:37,414 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2025-01-01 10:10:37,416 - INFO - [pcap_writer.py:413] - Packet 15: IP / TCP 10.0.0.1:http > 192.168.1.2:12346 PA / Raw
2025-01-01 10:10:37,417 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2025-01-01 10:10:37,418 - INFO - [pcap_writer.py:427] - Verification complete: 15 valid packets, 15 TLS records
2025-01-01 10:10:37,418 - INFO - [main.py:106] - Results saved to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-01 10:10:37,419 - INFO - [main.py:160] - TLS session simulation completed successfully
2025-01-01 12:41:59,541 - INFO - [logging.py:83] - Logging configured successfully
2025-01-01 12:41:59,542 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-01 12:41:59,542 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-01 12:41:59,543 - INFO - [logging.py:92] - Log level: 20
2025-01-01 12:41:59,543 - INFO - [logging.py:93] - Timestamp: 2025-01-01T12:41:59.543453
2025-01-01 12:41:59,543 - INFO - [logging.py:94] - ==========================
2025-01-01 12:41:59,543 - INFO - [main.py:122] - Starting TLS session simulation
2025-01-01 12:41:59,544 - INFO - [main.py:87] - 
--- Client Session (certificate) ---
2025-01-01 12:41:59,545 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-01 12:41:59,545 - INFO - [cert.py:108] - File exists: True
2025-01-01 12:41:59,546 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-01 12:41:59,546 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-01 12:41:59,546 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-01 12:41:59,547 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-01 12:41:59,551 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 12:41:59,552 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-01 12:41:59,552 - INFO - [cert.py:108] - File exists: True
2025-01-01 12:41:59,553 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-01 12:41:59,553 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-01 12:41:59,553 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-01 12:41:59,554 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-01 12:41:59,555 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 12:41:59,593 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-01 12:41:59,594 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-01 12:41:59,595 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-01 12:41:59,596 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-01 12:41:59,598 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-01 12:41:59,598 - INFO - [verify.py:58] - Public key comparison results:
2025-01-01 12:41:59,598 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 12:41:59,599 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 12:41:59,599 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-01 12:41:59,600 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-01 12:41:59,606 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-01 12:41:59,608 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-01 12:41:59,608 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-01 12:41:59,608 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-01 12:41:59,609 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-01 12:41:59,610 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-01 12:41:59,611 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-01 12:41:59,612 - INFO - [session.py:134] - Starting TLS session
2025-01-01 12:41:59,612 - INFO - [client.py:99] - Generated client_random: 67751bf7541096e74d12090a50d71952bfcc8cae689439d6819936a3c0c5132f
2025-01-01 12:41:59,614 - INFO - [client.py:139] - Client Hello sent from 192.168.1.1
2025-01-01 12:41:59,616 - INFO - [server.py:95] - Generated server_random: 67751bf7e390ffb99ac82a655f1c620cb7b5a1e7598fd7c99f6647d5bb02aafe
2025-01-01 12:41:59,619 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2025-01-01 12:41:59,620 - INFO - [cert.py:108] - File exists: True
2025-01-01 12:41:59,620 - INFO - [cert.py:109] - File size: 1915 bytes
2025-01-01 12:41:59,621 - INFO - [cert.py:113] - Read 1915 bytes
2025-01-01 12:41:59,621 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2025-01-01 12:41:59,621 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2025-01-01 12:41:59,622 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 12:41:59,622 - INFO - [client.py:173] - Prepared client certificate
2025-01-01 12:41:59,623 - INFO - [client.py:188] - Encrypted pre_master_secret length: 256
2025-01-01 12:41:59,626 - INFO - [chain.py:185] - Decrypted pre_master_secret: 03039b572ee00582c5a4241ce405d6b15e705d082a32683023a9e3682fb7de73b4a49453f574fc699a83bd59bf13add8
2025-01-01 12:41:59,627 - INFO - [chain.py:195] - Generated master secret: f85aa61af0e06946ab649cad785029a7f85ba0a5d70d684d6039062b74dcf558c0afeaeba17890f3c06904c202e0b09e
2025-01-01 12:41:59,627 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-01 12:41:59,628 - ERROR - [session.py:121] - TLS Handshake failed: Failed to handle Master Secret
2025-01-01 12:41:59,629 - ERROR - [main.py:27] - Session error: Session failed for 192.168.1.1: Session failed: Handshake failed
2025-01-01 12:45:58,433 - INFO - [logging.py:83] - Logging configured successfully
2025-01-01 12:45:58,434 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-01 12:45:58,435 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-01 12:45:58,435 - INFO - [logging.py:92] - Log level: 20
2025-01-01 12:45:58,435 - INFO - [logging.py:93] - Timestamp: 2025-01-01T12:45:58.435466
2025-01-01 12:45:58,435 - INFO - [logging.py:94] - ==========================
2025-01-01 12:45:58,435 - INFO - [main.py:122] - Starting TLS session simulation
2025-01-01 12:45:58,436 - INFO - [main.py:87] - 
--- Client Session (certificate) ---
2025-01-01 12:45:58,436 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-01 12:45:58,437 - INFO - [cert.py:108] - File exists: True
2025-01-01 12:45:58,437 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-01 12:45:58,437 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-01 12:45:58,437 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-01 12:45:58,438 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-01 12:45:58,438 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 12:45:58,439 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-01 12:45:58,439 - INFO - [cert.py:108] - File exists: True
2025-01-01 12:45:58,439 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-01 12:45:58,440 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-01 12:45:58,440 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-01 12:45:58,440 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-01 12:45:58,441 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 12:45:58,470 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-01 12:45:58,470 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-01 12:45:58,471 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-01 12:45:58,471 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-01 12:45:58,473 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-01 12:45:58,473 - INFO - [verify.py:58] - Public key comparison results:
2025-01-01 12:45:58,473 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 12:45:58,474 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 12:45:58,474 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-01 12:45:58,475 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-01 12:45:58,478 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-01 12:45:58,479 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-01 12:45:58,479 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-01 12:45:58,479 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-01 12:45:58,480 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-01 12:45:58,480 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-01 12:45:58,481 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-01 12:45:58,482 - INFO - [session.py:152] - Starting TLS session
2025-01-01 12:45:58,482 - INFO - [session.py:95] - Starting TLS Handshake...
2025-01-01 12:45:58,483 - INFO - [client.py:99] - Generated client_random: 67751ce6aa8139990c0ba96e6578f4d5763f482475121c15cc04ca52d990486b
2025-01-01 12:45:58,486 - INFO - [client.py:139] - Client Hello sent from 192.168.1.1
2025-01-01 12:45:58,488 - INFO - [session.py:100] - Client Hello sent successfully
2025-01-01 12:45:58,488 - INFO - [server.py:95] - Generated server_random: 67751ce60edd7f6679f6bb539f8398b71d40334c22595eb827933dc62012cd6c
2025-01-01 12:45:58,491 - INFO - [session.py:105] - Server Hello received successfully
2025-01-01 12:45:58,492 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2025-01-01 12:45:58,492 - INFO - [cert.py:108] - File exists: True
2025-01-01 12:45:58,492 - INFO - [cert.py:109] - File size: 1915 bytes
2025-01-01 12:45:58,493 - INFO - [cert.py:113] - Read 1915 bytes
2025-01-01 12:45:58,493 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2025-01-01 12:45:58,493 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2025-01-01 12:45:58,494 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 12:45:58,494 - INFO - [client.py:173] - Prepared client certificate
2025-01-01 12:45:58,495 - INFO - [client.py:188] - Encrypted pre_master_secret length: 256
2025-01-01 12:45:58,496 - INFO - [session.py:110] - Client handshake messages sent successfully
2025-01-01 12:45:58,496 - INFO - [chain.py:227] - Generating Master Secret...
2025-01-01 12:45:58,497 - INFO - [chain.py:185] - Decrypted pre_master_secret: 0303a6751c9fb88b486176be7296fe9b24869f2942774ce0daa8ac89cd7154d2b0ee0d87ad22b7e91a46ea3897bd0961
2025-01-01 12:45:58,498 - INFO - [chain.py:195] - Generated master secret: 4174a7030d9c2d851a8fef62e607c67ac893aac5139d0997a9005bc34bdb93f527a44ba0643e0ac7b595dede0f520d1d
2025-01-01 12:45:58,498 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-01 12:45:58,499 - INFO - [chain.py:241] - Master Secret generated successfully
2025-01-01 12:45:58,499 - ERROR - [session.py:138] - TLS Handshake failed: Failed to handle Master Secret
2025-01-01 12:45:58,499 - ERROR - [main.py:27] - Session error: Session failed for 192.168.1.1: Session failed: Handshake failed
2025-01-01 12:47:33,801 - INFO - [logging.py:83] - Logging configured successfully
2025-01-01 12:47:33,802 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-01 12:47:33,802 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-01 12:47:33,802 - INFO - [logging.py:92] - Log level: 20
2025-01-01 12:47:33,802 - INFO - [logging.py:93] - Timestamp: 2025-01-01T12:47:33.802753
2025-01-01 12:47:33,802 - INFO - [logging.py:94] - ==========================
2025-01-01 12:47:33,803 - INFO - [main.py:132] - Starting TLS session simulation
2025-01-01 12:47:33,803 - INFO - [main.py:87] - 
--- Client Session (certificate) ---
2025-01-01 12:47:33,804 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-01 12:47:33,804 - INFO - [cert.py:108] - File exists: True
2025-01-01 12:47:33,804 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-01 12:47:33,805 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-01 12:47:33,806 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-01 12:47:33,807 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-01 12:47:33,808 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 12:47:33,809 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-01 12:47:33,809 - INFO - [cert.py:108] - File exists: True
2025-01-01 12:47:33,809 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-01 12:47:33,810 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-01 12:47:33,810 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-01 12:47:33,810 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-01 12:47:33,810 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 12:47:33,839 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-01 12:47:33,840 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-01 12:47:33,840 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-01 12:47:33,841 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-01 12:47:33,843 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-01 12:47:33,843 - INFO - [verify.py:58] - Public key comparison results:
2025-01-01 12:47:33,843 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 12:47:33,845 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 12:47:33,845 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-01 12:47:33,846 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-01 12:47:33,854 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-01 12:47:33,854 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-01 12:47:33,855 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-01 12:47:33,855 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-01 12:47:33,855 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-01 12:47:33,857 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-01 12:47:33,857 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-01 12:47:33,857 - ERROR - [main.py:107] - Unexpected error for 192.168.1.1: 'UnifiedTLSSession' object has no attribute 'encrypted_pre_master_secret'
2025-01-01 12:47:33,858 - ERROR - [main.py:27] - Session error: Session failed for 192.168.1.1: 'UnifiedTLSSession' object has no attribute 'encrypted_pre_master_secret'
2025-01-01 12:48:06,398 - INFO - [logging.py:83] - Logging configured successfully
2025-01-01 12:48:06,399 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-01 12:48:06,399 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-01 12:48:06,400 - INFO - [logging.py:92] - Log level: 20
2025-01-01 12:48:06,400 - INFO - [logging.py:93] - Timestamp: 2025-01-01T12:48:06.400435
2025-01-01 12:48:06,400 - INFO - [logging.py:94] - ==========================
2025-01-01 12:48:06,400 - INFO - [main.py:122] - Starting TLS session simulation
2025-01-01 12:48:06,401 - INFO - [main.py:87] - 
--- Client Session (certificate) ---
2025-01-01 12:48:06,401 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-01 12:48:06,402 - INFO - [cert.py:108] - File exists: True
2025-01-01 12:48:06,402 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-01 12:48:06,403 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-01 12:48:06,403 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-01 12:48:06,403 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-01 12:48:06,404 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 12:48:06,405 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-01 12:48:06,405 - INFO - [cert.py:108] - File exists: True
2025-01-01 12:48:06,406 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-01 12:48:06,406 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-01 12:48:06,407 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-01 12:48:06,407 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-01 12:48:06,407 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 12:48:06,437 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-01 12:48:06,439 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-01 12:48:06,440 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-01 12:48:06,440 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-01 12:48:06,441 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-01 12:48:06,442 - INFO - [verify.py:58] - Public key comparison results:
2025-01-01 12:48:06,447 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 12:48:06,448 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 12:48:06,449 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-01 12:48:06,450 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-01 12:48:06,453 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-01 12:48:06,453 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-01 12:48:06,454 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-01 12:48:06,454 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-01 12:48:06,455 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-01 12:48:06,455 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-01 12:48:06,456 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-01 12:48:06,456 - INFO - [session.py:152] - Starting TLS session
2025-01-01 12:48:06,457 - INFO - [session.py:95] - Starting TLS Handshake...
2025-01-01 12:48:06,457 - INFO - [client.py:99] - Generated client_random: 67751d66d403f988851223676ae2e8e9865fb99334296b8a355536200a27defa
2025-01-01 12:48:06,460 - INFO - [client.py:139] - Client Hello sent from 192.168.1.1
2025-01-01 12:48:06,464 - INFO - [session.py:100] - Client Hello sent successfully
2025-01-01 12:48:06,465 - INFO - [server.py:95] - Generated server_random: 67751d6620750b62cf009f3a6db0122a535c355bfe184db37c8eff1eb22ad7e1
2025-01-01 12:48:06,468 - INFO - [session.py:105] - Server Hello received successfully
2025-01-01 12:48:06,469 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2025-01-01 12:48:06,470 - INFO - [cert.py:108] - File exists: True
2025-01-01 12:48:06,470 - INFO - [cert.py:109] - File size: 1915 bytes
2025-01-01 12:48:06,471 - INFO - [cert.py:113] - Read 1915 bytes
2025-01-01 12:48:06,471 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2025-01-01 12:48:06,471 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2025-01-01 12:48:06,472 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 12:48:06,473 - INFO - [client.py:173] - Prepared client certificate
2025-01-01 12:48:06,473 - INFO - [client.py:188] - Encrypted pre_master_secret length: 256
2025-01-01 12:48:06,474 - INFO - [session.py:110] - Client handshake messages sent successfully
2025-01-01 12:48:06,475 - INFO - [chain.py:227] - Generating Master Secret...
2025-01-01 12:48:06,476 - INFO - [chain.py:185] - Decrypted pre_master_secret: 0303e4da534f6b228d6a44acc74daf8638b1cbb04b788a55cf05ff5b723a35ac5a7e31d4e7306ab7c710cfc98ce86f14
2025-01-01 12:48:06,476 - INFO - [chain.py:195] - Generated master secret: 603d2639bfb52d61a6fe7924f6f5cdbc2540aafe5a6b318ba32fa25f775553b75216cb4b6c9fa963c818c28a35449a95
2025-01-01 12:48:06,477 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-01 12:48:06,477 - INFO - [chain.py:241] - Master Secret generated successfully
2025-01-01 12:48:06,478 - ERROR - [session.py:138] - TLS Handshake failed: Failed to handle Master Secret
2025-01-01 12:48:06,478 - ERROR - [main.py:27] - Session error: Session failed for 192.168.1.1: Session failed: Handshake failed
2025-01-01 12:50:49,998 - INFO - [logging.py:83] - Logging configured successfully
2025-01-01 12:50:49,998 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-01 12:50:49,998 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-01 12:50:49,999 - INFO - [logging.py:92] - Log level: 20
2025-01-01 12:50:49,999 - INFO - [logging.py:93] - Timestamp: 2025-01-01T12:50:49.999203
2025-01-01 12:50:49,999 - INFO - [logging.py:94] - ==========================
2025-01-01 12:50:49,999 - INFO - [main.py:122] - Starting TLS session simulation
2025-01-01 12:50:49,999 - INFO - [main.py:87] - 
--- Client Session (certificate) ---
2025-01-01 12:50:50,000 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-01 12:50:50,000 - INFO - [cert.py:108] - File exists: True
2025-01-01 12:50:50,000 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-01 12:50:50,001 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-01 12:50:50,001 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-01 12:50:50,001 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-01 12:50:50,002 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 12:50:50,002 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-01 12:50:50,003 - INFO - [cert.py:108] - File exists: True
2025-01-01 12:50:50,003 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-01 12:50:50,004 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-01 12:50:50,004 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-01 12:50:50,005 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-01 12:50:50,005 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 12:50:50,038 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-01 12:50:50,039 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-01 12:50:50,039 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-01 12:50:50,040 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-01 12:50:50,041 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-01 12:50:50,042 - INFO - [verify.py:58] - Public key comparison results:
2025-01-01 12:50:50,042 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 12:50:50,042 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 12:50:50,043 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-01 12:50:50,043 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-01 12:50:50,046 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-01 12:50:50,047 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-01 12:50:50,047 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-01 12:50:50,047 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-01 12:50:50,047 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-01 12:50:50,048 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-01 12:50:50,049 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-01 12:50:50,049 - INFO - [session.py:152] - Starting TLS session
2025-01-01 12:50:50,049 - INFO - [session.py:95] - Starting TLS Handshake...
2025-01-01 12:50:50,050 - INFO - [client.py:99] - Generated client_random: 67751e0af6ec3e49d265ac8fc42fcd6197275b5d9e77ca82f32b739c9cd97fe6
2025-01-01 12:50:50,052 - INFO - [client.py:139] - Client Hello sent from 192.168.1.1
2025-01-01 12:50:50,054 - INFO - [session.py:100] - Client Hello sent successfully
2025-01-01 12:50:50,055 - INFO - [server.py:95] - Generated server_random: 67751e0abd5fa4dc443a7fe804d4c00e162f2cc70e3813fc199388a83f4f450c
2025-01-01 12:50:50,060 - INFO - [session.py:105] - Server Hello received successfully
2025-01-01 12:50:50,060 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2025-01-01 12:50:50,061 - INFO - [cert.py:108] - File exists: True
2025-01-01 12:50:50,061 - INFO - [cert.py:109] - File size: 1915 bytes
2025-01-01 12:50:50,062 - INFO - [cert.py:113] - Read 1915 bytes
2025-01-01 12:50:50,062 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2025-01-01 12:50:50,062 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2025-01-01 12:50:50,062 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 12:50:50,063 - INFO - [client.py:173] - Prepared client certificate
2025-01-01 12:50:50,063 - INFO - [client.py:188] - Encrypted pre_master_secret length: 256
2025-01-01 12:50:50,064 - INFO - [session.py:110] - Client handshake messages sent successfully
2025-01-01 12:50:50,064 - INFO - [chain.py:231] - Starting Master Secret generation.
2025-01-01 12:50:50,066 - INFO - [chain.py:185] - Decrypted pre_master_secret: 03038b4eb17fc5e02b4a4380798f239c1063e9f67ab79d5a400fe30747effe2e464c9ef19630afbf8331b36117ea32ac
2025-01-01 12:50:50,067 - INFO - [chain.py:195] - Generated master secret: 43a1488b143160d3ed4a1d9b8bada2c4b74df31709a0afff5a4b30490acae034d140ee52144873ec6d9a01e64f6fcb4b
2025-01-01 12:50:50,067 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-01 12:50:50,067 - INFO - [chain.py:245] - Master Secret generation completed successfully.
2025-01-01 12:50:50,068 - ERROR - [session.py:138] - TLS Handshake failed: Failed to handle Master Secret
2025-01-01 12:50:50,068 - ERROR - [main.py:27] - Session error: Session failed for 192.168.1.1: Session failed: Handshake failed
2025-01-01 13:13:13,885 - INFO - [logging.py:83] - Logging configured successfully
2025-01-01 13:13:13,885 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-01 13:13:13,886 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-01 13:13:13,886 - INFO - [logging.py:92] - Log level: 20
2025-01-01 13:13:13,886 - INFO - [logging.py:93] - Timestamp: 2025-01-01T13:13:13.886550
2025-01-01 13:13:13,886 - INFO - [logging.py:94] - ==========================
2025-01-01 13:13:13,887 - INFO - [main.py:122] - Starting TLS session simulation
2025-01-01 13:13:13,887 - INFO - [main.py:87] - 
--- Client Session (certificate) ---
2025-01-01 13:13:13,888 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-01 13:13:13,888 - INFO - [cert.py:108] - File exists: True
2025-01-01 13:13:13,889 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-01 13:13:13,889 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-01 13:13:13,889 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-01 13:13:13,890 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-01 13:13:13,893 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 13:13:13,894 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-01 13:13:13,894 - INFO - [cert.py:108] - File exists: True
2025-01-01 13:13:13,895 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-01 13:13:13,895 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-01 13:13:13,896 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-01 13:13:13,896 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-01 13:13:13,897 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 13:13:13,935 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-01 13:13:13,935 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-01 13:13:13,935 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-01 13:13:13,936 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-01 13:13:13,939 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-01 13:13:13,939 - INFO - [verify.py:58] - Public key comparison results:
2025-01-01 13:13:13,939 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 13:13:13,940 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 13:13:13,941 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-01 13:13:13,941 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-01 13:13:13,945 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-01 13:13:13,945 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-01 13:13:13,946 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-01 13:13:13,946 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-01 13:13:13,946 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-01 13:13:13,947 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-01 13:13:13,947 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-01 13:13:13,948 - INFO - [session.py:152] - Starting TLS session
2025-01-01 13:13:13,948 - INFO - [session.py:95] - Starting TLS Handshake...
2025-01-01 13:13:13,948 - INFO - [client.py:99] - Generated client_random: 677523493fce236c31126f31af4813857a95ab9bead42b875b3d82986ed1fb72
2025-01-01 13:13:13,953 - INFO - [client.py:139] - Client Hello sent from 192.168.1.1
2025-01-01 13:13:13,955 - INFO - [session.py:100] - Client Hello sent successfully
2025-01-01 13:13:13,956 - INFO - [server.py:95] - Generated server_random: 67752349d54398bac9bd89f7dd38e9abd7a78a667213c16c9b86492b5c481b14
2025-01-01 13:13:13,960 - INFO - [session.py:105] - Server Hello received successfully
2025-01-01 13:13:13,960 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2025-01-01 13:13:13,961 - INFO - [cert.py:108] - File exists: True
2025-01-01 13:13:13,961 - INFO - [cert.py:109] - File size: 1915 bytes
2025-01-01 13:13:13,962 - INFO - [cert.py:113] - Read 1915 bytes
2025-01-01 13:13:13,963 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2025-01-01 13:13:13,963 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2025-01-01 13:13:13,963 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 13:13:13,964 - INFO - [client.py:173] - Prepared client certificate
2025-01-01 13:13:13,964 - INFO - [client.py:188] - Encrypted pre_master_secret length: 256
2025-01-01 13:13:13,965 - INFO - [session.py:110] - Client handshake messages sent successfully
2025-01-01 13:13:13,966 - INFO - [chain.py:231] - Starting Master Secret generation.
2025-01-01 13:13:13,967 - INFO - [chain.py:185] - Decrypted pre_master_secret: 0303e8a362a15226d4834584bd7735a13173bbf6519470314e3f57afce6a47214ea8dd59960ce1d8909d527c54a3171c
2025-01-01 13:13:13,968 - INFO - [chain.py:195] - Generated master secret: 0bd86a56b3d5f66db585aea8ef13f82f073a0433625c8f084f15b893a53fd725c6ea28ccda593f72babd3cc65ca4dd65
2025-01-01 13:13:13,968 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-01 13:13:13,968 - INFO - [chain.py:245] - Master Secret generation completed successfully.
2025-01-01 13:13:13,969 - ERROR - [session.py:138] - TLS Handshake failed: Failed to handle Master Secret
2025-01-01 13:13:13,969 - ERROR - [main.py:27] - Session error: Session failed for 192.168.1.1: Session failed: Handshake failed
2025-01-01 13:18:06,176 - INFO - [logging.py:83] - Logging configured successfully
2025-01-01 13:18:06,176 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-01 13:18:06,177 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-01 13:18:06,177 - INFO - [logging.py:92] - Log level: 20
2025-01-01 13:18:06,177 - INFO - [logging.py:93] - Timestamp: 2025-01-01T13:18:06.177700
2025-01-01 13:18:06,178 - INFO - [logging.py:94] - ==========================
2025-01-01 13:18:06,178 - INFO - [main.py:122] - Starting TLS session simulation
2025-01-01 13:18:06,179 - INFO - [main.py:87] - 
--- Client Session (certificate) ---
2025-01-01 13:18:06,180 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-01 13:18:06,180 - INFO - [cert.py:108] - File exists: True
2025-01-01 13:18:06,181 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-01 13:18:06,181 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-01 13:18:06,182 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-01 13:18:06,182 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-01 13:18:06,183 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 13:18:06,184 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-01 13:18:06,185 - INFO - [cert.py:108] - File exists: True
2025-01-01 13:18:06,185 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-01 13:18:06,185 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-01 13:18:06,186 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-01 13:18:06,186 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-01 13:18:06,187 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 13:18:06,244 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-01 13:18:06,247 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-01 13:18:06,257 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-01 13:18:06,262 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-01 13:18:06,268 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-01 13:18:06,270 - INFO - [verify.py:58] - Public key comparison results:
2025-01-01 13:18:06,271 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 13:18:06,272 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 13:18:06,275 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-01 13:18:06,277 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-01 13:18:06,297 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-01 13:18:06,300 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-01 13:18:06,301 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-01 13:18:06,301 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-01 13:18:06,302 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-01 13:18:06,302 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-01 13:18:06,304 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-01 13:18:06,305 - INFO - [session.py:157] - Starting TLS session
2025-01-01 13:18:06,305 - INFO - [session.py:96] - Starting TLS Handshake...
2025-01-01 13:18:06,306 - INFO - [client.py:99] - Generated client_random: 6775246e09354647408a2638902e8f5efc37e387d43b9d7204200838abee3e2b
2025-01-01 13:18:06,309 - INFO - [client.py:139] - Client Hello sent from 192.168.1.1
2025-01-01 13:18:06,313 - INFO - [session.py:101] - Client Hello sent successfully
2025-01-01 13:18:06,314 - INFO - [server.py:95] - Generated server_random: 6775246e68fe14e4d5adec9f67be31ba16db9e7b38fc416659ba632555c04c15
2025-01-01 13:18:06,318 - INFO - [session.py:106] - Server Hello received successfully
2025-01-01 13:18:06,319 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2025-01-01 13:18:06,320 - INFO - [cert.py:108] - File exists: True
2025-01-01 13:18:06,321 - INFO - [cert.py:109] - File size: 1915 bytes
2025-01-01 13:18:06,322 - INFO - [cert.py:113] - Read 1915 bytes
2025-01-01 13:18:06,322 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2025-01-01 13:18:06,323 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2025-01-01 13:18:06,324 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 13:18:06,325 - INFO - [client.py:173] - Prepared client certificate
2025-01-01 13:18:06,333 - INFO - [client.py:188] - Encrypted pre_master_secret length: 256
2025-01-01 13:18:06,340 - INFO - [session.py:111] - Client handshake messages sent successfully
2025-01-01 13:18:06,343 - INFO - [session.py:116] - Server key pair verified successfully
2025-01-01 13:18:06,344 - INFO - [chain.py:231] - Starting Master Secret generation.
2025-01-01 13:18:06,346 - INFO - [chain.py:185] - Decrypted pre_master_secret: 0303121105067b9eaa8b12d73cd9a55dfe6c12a1e6ae81a5be5bdb641a3dc09839b3262d4d1c2f232b7e3635e29c32a7
2025-01-01 13:18:06,346 - INFO - [chain.py:195] - Generated master secret: c12cd1944dfc944196cb8943400faaccbee0feb6283f5c5b03c82741a323a4032ef0fc284afb1371e3aca47721aadc92
2025-01-01 13:18:06,346 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-01 13:18:06,347 - INFO - [chain.py:245] - Master Secret generation completed successfully.
2025-01-01 13:18:06,347 - ERROR - [session.py:143] - TLS Handshake failed: Failed to handle Master Secret
2025-01-01 13:18:06,348 - ERROR - [main.py:27] - Session error: Session failed for 192.168.1.1: Session failed: Handshake failed
2025-01-01 13:24:01,420 - INFO - [logging.py:83] - Logging configured successfully
2025-01-01 13:24:01,420 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-01 13:24:01,421 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-01 13:24:01,421 - INFO - [logging.py:92] - Log level: 20
2025-01-01 13:24:01,422 - INFO - [logging.py:93] - Timestamp: 2025-01-01T13:24:01.422281
2025-01-01 13:24:01,422 - INFO - [logging.py:94] - ==========================
2025-01-01 13:24:01,422 - INFO - [main.py:122] - Starting TLS session simulation
2025-01-01 13:24:01,423 - INFO - [main.py:87] - 
--- Client Session (certificate) ---
2025-01-01 13:24:01,424 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-01 13:24:01,424 - INFO - [cert.py:108] - File exists: True
2025-01-01 13:24:01,425 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-01 13:24:01,425 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-01 13:24:01,425 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-01 13:24:01,426 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-01 13:24:01,430 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 13:24:01,431 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-01 13:24:01,432 - INFO - [cert.py:108] - File exists: True
2025-01-01 13:24:01,432 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-01 13:24:01,433 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-01 13:24:01,433 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-01 13:24:01,433 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-01 13:24:01,434 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 13:24:01,471 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-01 13:24:01,472 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-01 13:24:01,472 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-01 13:24:01,473 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-01 13:24:01,476 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-01 13:24:01,476 - INFO - [verify.py:58] - Public key comparison results:
2025-01-01 13:24:01,476 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 13:24:01,477 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 13:24:01,477 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-01 13:24:01,477 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-01 13:24:01,487 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-01 13:24:01,488 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-01 13:24:01,489 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-01 13:24:01,489 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-01 13:24:01,490 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-01 13:24:01,490 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-01 13:24:01,491 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-01 13:24:01,492 - INFO - [session.py:157] - Starting TLS session
2025-01-01 13:24:01,492 - INFO - [session.py:96] - Starting TLS Handshake...
2025-01-01 13:24:01,492 - INFO - [client.py:99] - Generated client_random: 677525d107bf2d1b79b3ea92f6f8cc5626f153983c18042d2358c7a17132926c
2025-01-01 13:24:01,494 - INFO - [client.py:139] - Client Hello sent from 192.168.1.1
2025-01-01 13:24:01,497 - INFO - [session.py:101] - Client Hello sent successfully
2025-01-01 13:24:01,497 - INFO - [server.py:95] - Generated server_random: 677525d1ef978f32283f25ad0c60c7b6c4f5e634e68a2de25d19c75a2f0f3b85
2025-01-01 13:24:01,503 - INFO - [session.py:106] - Server Hello received successfully
2025-01-01 13:24:01,503 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2025-01-01 13:24:01,504 - INFO - [cert.py:108] - File exists: True
2025-01-01 13:24:01,504 - INFO - [cert.py:109] - File size: 1915 bytes
2025-01-01 13:24:01,505 - INFO - [cert.py:113] - Read 1915 bytes
2025-01-01 13:24:01,505 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2025-01-01 13:24:01,506 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2025-01-01 13:24:01,506 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 13:24:01,507 - INFO - [client.py:173] - Prepared client certificate
2025-01-01 13:24:01,508 - INFO - [client.py:188] - Encrypted pre_master_secret length: 256
2025-01-01 13:24:01,509 - INFO - [session.py:111] - Client handshake messages sent successfully
2025-01-01 13:24:01,510 - INFO - [session.py:116] - Server key pair verified successfully
2025-01-01 13:24:01,510 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-01 13:24:01,511 - INFO - [chain.py:185] - Decrypted pre_master_secret: 030361e7b380a1162489103f4787e5136ed3ece9b73d3998b7e658d657ed29acd3426a0e093f5c6cba7b540778bf4cbf
2025-01-01 13:24:01,512 - INFO - [chain.py:195] - Generated master secret: 69ffc47235c6629abc659df640764b6f9a00f502d5b07aee929bdc0eca9295804d7fa3c8fd30cf25b86f5afa97677bf7
2025-01-01 13:24:01,512 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-01 13:24:01,512 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-01 13:24:01,513 - INFO - [session.py:120] - Master Secret handled successfully
2025-01-01 13:24:01,514 - INFO - [client.py:269] - Pre-master secret validated successfully
2025-01-01 13:24:01,516 - INFO - [client.py:287] - Generated digital signature: 505be67c9375110a5dfeddc127f8fd93b8286f7bce0f69b7a697e1bca6a5a65c22d70d94301fcd2cdf59875c71b5cdb8131f8a42f164ae38adf230916b1fc6182667648896ff416591ec5271a9a329385432a7554093ec8804651b209072d292f05618da8df1bd7a92ba65089440b1754285f3381470682671ddce5eeeec038ea1245b9c2d364dc6d0fb3012cc6d8716115a980d20eedd6ef42f800740bdd87ca9bb4ccafc0be0b13666cda4a3e551323ab278ca3b7e28bce5ca9544699431f9b5f1a22d5c4a1651f6f98144289dbdad649cc699672f046b866f63217b6da1960879241a8c9c550ca39f16b84e16e4de42e0fe3fa58cfb92ea26cedd6b1060cb
2025-01-01 13:24:01,519 - INFO - [client.py:333] - Client ChangeCipherSpec and Finished messages sent
2025-01-01 13:24:01,520 - INFO - [session.py:125] - Client Change Cipher Spec sent successfully
2025-01-01 13:24:01,521 - INFO - [server.py:256] - Pre-master secret validated successfully
2025-01-01 13:24:01,522 - INFO - [server.py:274] - Generated digital signature: 5383f45d6c21f55fd1721811b11c6cb3c6d1899747d09ee3c74e0004296edb710b8e398bad1e2106ff31325ddc72e28511a69cc503ae200cc75baa918432a4afefc902b5eeace09ddf8087a20a7665ddf766863ac5751211703b05e327d141b1263af45653c0c66c0cbc6548e28b9716e9f5471b485235586870eeb25b2c118cbec25e63ebe53edbe439a8084d76617659ce6600fd0ade8c7167436057c10f9335fd19b4fde2f8448421ef7893cf2e22b2635a2f0324e643dd749f2d79244d436a5d014157355a680c5f17fc611b23a0b5c8e824386131df3a8eb3fd63b34aa8cd0d682c6e76711abd701049aad6bb6f7b4b056384a2c115de617d418fb0a245
2025-01-01 13:24:01,523 - INFO - [server.py:320] - Server ChangeCipherSpec and Finished messages sent
2025-01-01 13:24:01,524 - INFO - [session.py:130] - Server Change Cipher Spec received successfully
2025-01-01 13:24:01,525 - INFO - [keys.py:205] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-01 13:24:01,525 - ERROR - [session.py:143] - TLS Handshake failed: Failed to handle SSL Key Log
2025-01-01 13:24:01,526 - ERROR - [main.py:27] - Session error: Session failed for 192.168.1.1: Session failed: Handshake failed
2025-01-01 13:25:59,303 - INFO - [logging.py:83] - Logging configured successfully
2025-01-01 13:25:59,304 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-01 13:25:59,304 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-01 13:25:59,304 - INFO - [logging.py:92] - Log level: 20
2025-01-01 13:25:59,305 - INFO - [logging.py:93] - Timestamp: 2025-01-01T13:25:59.305245
2025-01-01 13:25:59,305 - INFO - [logging.py:94] - ==========================
2025-01-01 13:25:59,305 - INFO - [main.py:122] - Starting TLS session simulation
2025-01-01 13:25:59,306 - INFO - [main.py:87] - 
--- Client Session (certificate) ---
2025-01-01 13:25:59,306 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-01 13:25:59,307 - INFO - [cert.py:108] - File exists: True
2025-01-01 13:25:59,307 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-01 13:25:59,307 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-01 13:25:59,308 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-01 13:25:59,308 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-01 13:25:59,308 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 13:25:59,309 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-01 13:25:59,309 - INFO - [cert.py:108] - File exists: True
2025-01-01 13:25:59,309 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-01 13:25:59,310 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-01 13:25:59,310 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-01 13:25:59,310 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-01 13:25:59,311 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 13:25:59,340 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-01 13:25:59,341 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-01 13:25:59,342 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-01 13:25:59,342 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-01 13:25:59,344 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-01 13:25:59,345 - INFO - [verify.py:58] - Public key comparison results:
2025-01-01 13:25:59,345 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 13:25:59,345 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 13:25:59,346 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-01 13:25:59,347 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-01 13:25:59,354 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-01 13:25:59,355 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-01 13:25:59,355 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-01 13:25:59,355 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-01 13:25:59,356 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-01 13:25:59,356 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-01 13:25:59,356 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-01 13:25:59,357 - INFO - [session.py:157] - Starting TLS session
2025-01-01 13:25:59,357 - INFO - [session.py:96] - Starting TLS Handshake...
2025-01-01 13:25:59,357 - INFO - [client.py:99] - Generated client_random: 67752647098419b68638e1444469e9259269656690d39ad443eec1b8496e1e18
2025-01-01 13:25:59,360 - INFO - [client.py:139] - Client Hello sent from 192.168.1.1
2025-01-01 13:25:59,363 - INFO - [session.py:101] - Client Hello sent successfully
2025-01-01 13:25:59,363 - INFO - [server.py:95] - Generated server_random: 67752647b1842d593504c1d820f40aeb2fdd469bebfa7e108835e01ee53db238
2025-01-01 13:25:59,369 - INFO - [session.py:106] - Server Hello received successfully
2025-01-01 13:25:59,370 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2025-01-01 13:25:59,371 - INFO - [cert.py:108] - File exists: True
2025-01-01 13:25:59,371 - INFO - [cert.py:109] - File size: 1915 bytes
2025-01-01 13:25:59,372 - INFO - [cert.py:113] - Read 1915 bytes
2025-01-01 13:25:59,372 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2025-01-01 13:25:59,372 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2025-01-01 13:25:59,373 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 13:25:59,373 - INFO - [client.py:173] - Prepared client certificate
2025-01-01 13:25:59,374 - INFO - [client.py:188] - Encrypted pre_master_secret length: 256
2025-01-01 13:25:59,375 - INFO - [session.py:111] - Client handshake messages sent successfully
2025-01-01 13:25:59,376 - INFO - [session.py:116] - Server key pair verified successfully
2025-01-01 13:25:59,376 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-01 13:25:59,378 - INFO - [chain.py:185] - Decrypted pre_master_secret: 03039287111dcdbd585fd6bb2a26437fe9644ab73f4cfefbdd5a37fb7e8fa2328dd070a8dfaf17128361c9b30ddde7b6
2025-01-01 13:25:59,378 - INFO - [chain.py:195] - Generated master secret: 615e6cdaa0c22a10d893ece7199e54cf2941340dc910bee5587ce6e5bcc3e437dd0cc0b57d8cde73fba96e2207555689
2025-01-01 13:25:59,379 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-01 13:25:59,379 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-01 13:25:59,379 - INFO - [session.py:120] - Master Secret handled successfully
2025-01-01 13:25:59,380 - INFO - [client.py:269] - Pre-master secret validated successfully
2025-01-01 13:25:59,381 - INFO - [client.py:287] - Generated digital signature: d4ed665e68b9238dde0223759b885e0996e4275c86aaa00583c2be3bf4c31a64ad4157dc5e831321fbc67431cb96b93a2ed0adeb5dd39f4c975d19c53ce03f659b80a2ed5254aa67dcc378a464768ceca453d90b67458d6207f40ce145d39ede30c3a4685731deec19708e8a52608717404bea4491aef7f37949e62ef39c2c42d5dfde3cbd3580040140574f7ee805e66cdeb70dfdfd30a404c2e2cd7a526ecbc1c9b7f638dab182571bb04dd66d9ae1ad14a9086c30bee197f0b51bb6fbf0862ec41d928be3f2cdf69242c475e36d2436ab108238e677156bdc00ae281e595b8f8e610b5d05b65ad3ecccb36cf50668dc08fa1750aee748f31e12295b53f5ca
2025-01-01 13:25:59,385 - INFO - [client.py:333] - Client ChangeCipherSpec and Finished messages sent
2025-01-01 13:25:59,386 - INFO - [session.py:125] - Client Change Cipher Spec sent successfully
2025-01-01 13:25:59,387 - INFO - [server.py:256] - Pre-master secret validated successfully
2025-01-01 13:25:59,388 - INFO - [server.py:274] - Generated digital signature: 7b953073bda1d18d483881b5337db01ce906be6205cb2ba3289d82cd5f978b56ff856a34f1cd5c6dc09b4a7a17b09c234d85addcf2d14a208180e94e751171797a268820a006fabf2bdef197270f7060285d22c37340a2258e211e6ee01efb1afd2d5cd45facb38db9300a5094191c067e5918cc3bb40198d96f291201388cf4672a3580de37403d7d4aa479f2372adbb689c8f48b431aa407f8ea646a161f18dce985c4d4ddf9c316edab01b3a4f13a7bf7c84f504eea7be25a6b34c40436242435b30963c7a92b2583ca1da1ad32ea1499d8783e23392dccf790241ac372c98ff938d30e182f7cf7a573c96b8eedc241e601fb82a2c1ab8bbc262b1d5c8384
2025-01-01 13:25:59,389 - INFO - [server.py:320] - Server ChangeCipherSpec and Finished messages sent
2025-01-01 13:25:59,391 - INFO - [session.py:130] - Server Change Cipher Spec received successfully
2025-01-01 13:25:59,392 - INFO - [keys.py:218] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-01 13:25:59,392 - INFO - [session.py:135] - SSL Key Log handled successfully
2025-01-01 13:25:59,392 - INFO - [session.py:139] - TLS Handshake completed successfully
2025-01-01 13:25:59,393 - INFO - [session.py:168] - Found file to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 13:25:59,393 - INFO - [session.py:186] - Handshake completed: True
2025-01-01 13:25:59,393 - INFO - [session.py:187] - Use client cert: True
2025-01-01 13:25:59,394 - INFO - [session.py:188] - File to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 13:25:59,394 - INFO - [session.py:191] - Using encrypted exchange
2025-01-01 13:25:59,395 - INFO - [session.py:206] - Sending encrypted request data
2025-01-01 13:25:59,397 - INFO - [keys.py:185] - TLS Application Data sent from 192.168.1.1:12345 to 10.0.0.1:443
2025-01-01 13:25:59,398 - INFO - [session.py:217] - Sending encrypted response data
2025-01-01 13:25:59,401 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-01 13:25:59,402 - INFO - [session.py:229] - Attempting to send file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 13:25:59,402 - INFO - [session.py:240] - Opening file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 13:25:59,404 - INFO - [session.py:247] - Read 1103 bytes from file
2025-01-01 13:25:59,405 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-01 13:25:59,405 - INFO - [session.py:256] - File sent successfully
2025-01-01 13:25:59,406 - INFO - [session.py:231] - File sent successfully
2025-01-01 13:25:59,406 - INFO - [main.py:95] - Session completed successfully for 192.168.1.1
2025-01-01 13:25:59,406 - INFO - [main.py:87] - 
--- Client Session (no certificate) ---
2025-01-01 13:25:59,407 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-01 13:25:59,407 - INFO - [cert.py:108] - File exists: True
2025-01-01 13:25:59,407 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-01 13:25:59,407 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-01 13:25:59,408 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-01 13:25:59,408 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-01 13:25:59,408 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 13:25:59,408 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-01 13:25:59,409 - INFO - [cert.py:108] - File exists: True
2025-01-01 13:25:59,409 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-01 13:25:59,409 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-01 13:25:59,410 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-01 13:25:59,410 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-01 13:25:59,411 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 13:25:59,440 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-01 13:25:59,441 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-01 13:25:59,441 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-01 13:25:59,441 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-01 13:25:59,442 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-01 13:25:59,442 - INFO - [verify.py:58] - Public key comparison results:
2025-01-01 13:25:59,442 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 13:25:59,443 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 13:25:59,444 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-01 13:25:59,445 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-01 13:25:59,446 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-01 13:25:59,446 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-01 13:25:59,446 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-01 13:25:59,447 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-01 13:25:59,447 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-01 13:25:59,448 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-01 13:25:59,449 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-01 13:25:59,450 - INFO - [session.py:157] - Starting TLS session
2025-01-01 13:25:59,450 - INFO - [session.py:96] - Starting TLS Handshake...
2025-01-01 13:25:59,450 - INFO - [client.py:99] - Generated client_random: 67752647471cf1c708417880a95abbb5c3bdc30aaa12ddb66540eaa309613ece
2025-01-01 13:25:59,452 - INFO - [client.py:139] - Client Hello sent from 192.168.1.2
2025-01-01 13:25:59,455 - INFO - [session.py:101] - Client Hello sent successfully
2025-01-01 13:25:59,456 - INFO - [server.py:95] - Generated server_random: 67752647cb370f2f18401b421b33758aec478b5366a6ecc378431b4f1dbc64c9
2025-01-01 13:25:59,460 - INFO - [session.py:106] - Server Hello received successfully
2025-01-01 13:25:59,461 - INFO - [client.py:176] - Prepared empty certificate
2025-01-01 13:25:59,461 - INFO - [client.py:188] - Encrypted pre_master_secret length: 256
2025-01-01 13:25:59,463 - INFO - [session.py:111] - Client handshake messages sent successfully
2025-01-01 13:25:59,464 - INFO - [session.py:116] - Server key pair verified successfully
2025-01-01 13:25:59,465 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-01 13:25:59,467 - INFO - [chain.py:185] - Decrypted pre_master_secret: 0303c4ffc1f1905576a3af9d4470f1a73de5e9dd92bdd517a375da73186606eb84b4cc22723b22a28ae0cb42191863e5
2025-01-01 13:25:59,468 - INFO - [chain.py:195] - Generated master secret: c89320888bd5da13b21367c3743b8c61d743995d9f4bfe4e1186033d8b70c669308e13b94ea41b661ed28a2a402ad9d6
2025-01-01 13:25:59,469 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-01 13:25:59,469 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-01 13:25:59,470 - INFO - [session.py:120] - Master Secret handled successfully
2025-01-01 13:25:59,471 - INFO - [client.py:269] - Pre-master secret validated successfully
2025-01-01 13:25:59,471 - INFO - [client.py:287] - Generated digital signature: 20944a5c46d6d97c9317162d87137cae8c2c0c2bc0fd68fb6724cffed3ff4da91008b4d442518183d1ac244782a3218878be3af365290a75b126903c1b54d2c2f142391afccb79a9e41db98a14280cf2fd89b9aef00e5ae1d9a780388cb363a8f74bc33093f9709beb43aa83fb017c1ba6fc29af6203ce3be36573b8bca0613e875c8c8a3f55806bb4cde6a02fc51ee27041cbc5d5fa3f232f5ba881b18313951cab27cc390ee5cc9312d95416cce582f5d3c5d3aea3dd71c4639a2bbab3d7a4e9599b64ede5224e329103bedd9b001fe0849618b104e8e94e2ba01b9d4b680a49b238044f6aa7e25987e7f53f16f2d214d51b9d1484bd9c8649cf8f808dc954
2025-01-01 13:25:59,473 - INFO - [client.py:333] - Client ChangeCipherSpec and Finished messages sent
2025-01-01 13:25:59,474 - INFO - [session.py:125] - Client Change Cipher Spec sent successfully
2025-01-01 13:25:59,475 - INFO - [server.py:256] - Pre-master secret validated successfully
2025-01-01 13:25:59,476 - INFO - [server.py:274] - Generated digital signature: 550f0839030e99e41157965d80462c7d4d13a39882ec3f46cd1de4aa598ff5867f15eea2aa0e5cbb1f33cd4f2692a7b52871f7e958f7431f2e1f575db5e9cfac413d1922b989559fb9120d4a9ec1211755260f3b4af46ffcddfb658779cd583e01d4e4dda9c8c96432e15ddd3ee13758e602d06f328efc1cfac74cb56b72325333c8bf95c1ff5e67f76ea49e0439656db03d63d62296ecfab7f3af6dac838d1fba1cf7b50302d0f7060f258ad98f37442da77ef95368bba323ca86de604b6b6e6275a7181feb64aca22d8a46e8610442cc5c8b05417cac7e14994246325f2e7a2afa71652020bca19efcd455a5418b86e6eaef29d2d5539df7d9338620670bef
2025-01-01 13:25:59,478 - INFO - [server.py:320] - Server ChangeCipherSpec and Finished messages sent
2025-01-01 13:25:59,479 - INFO - [session.py:130] - Server Change Cipher Spec received successfully
2025-01-01 13:25:59,480 - INFO - [keys.py:218] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-01 13:25:59,480 - INFO - [session.py:135] - SSL Key Log handled successfully
2025-01-01 13:25:59,481 - INFO - [session.py:139] - TLS Handshake completed successfully
2025-01-01 13:25:59,481 - INFO - [session.py:186] - Handshake completed: True
2025-01-01 13:25:59,481 - INFO - [session.py:187] - Use client cert: False
2025-01-01 13:25:59,482 - INFO - [session.py:188] - File to send: None
2025-01-01 13:25:59,482 - INFO - [session.py:194] - Using unencrypted exchange
2025-01-01 13:25:59,483 - INFO - [session.py:294] - Added request packet
2025-01-01 13:25:59,484 - INFO - [session.py:294] - Added response packet
2025-01-01 13:25:59,485 - WARNING - [session.py:271] - Using unencrypted communication
2025-01-01 13:25:59,485 - INFO - [main.py:95] - Session completed successfully for 192.168.1.2
2025-01-01 13:25:59,486 - INFO - [pcap_writer.py:232] - Packet 13: Valid HTTP message
2025-01-01 13:25:59,486 - INFO - [pcap_writer.py:232] - Packet 14: Valid HTTP message
2025-01-01 13:25:59,492 - INFO - [pcap_writer.py:387] - Saved 15 valid packets to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-01 13:25:59,493 - INFO - [pcap_writer.py:409] - Verifying 15 packets...
2025-01-01 13:25:59,494 - INFO - [pcap_writer.py:413] - Packet 1: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 13:25:59,494 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2025-01-01 13:25:59,495 - INFO - [pcap_writer.py:413] - Packet 2: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 13:25:59,495 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2775
2025-01-01 13:25:59,495 - INFO - [pcap_writer.py:413] - Packet 3: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 13:25:59,496 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 1646
2025-01-01 13:25:59,496 - INFO - [pcap_writer.py:413] - Packet 4: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 13:25:59,497 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-01 13:25:59,497 - INFO - [pcap_writer.py:413] - Packet 5: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 13:25:59,497 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-01 13:25:59,498 - INFO - [pcap_writer.py:413] - Packet 6: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 13:25:59,498 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 160
2025-01-01 13:25:59,499 - INFO - [pcap_writer.py:413] - Packet 7: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 13:25:59,499 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 128
2025-01-01 13:25:59,500 - INFO - [pcap_writer.py:413] - Packet 8: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 13:25:59,500 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 1152
2025-01-01 13:25:59,500 - INFO - [pcap_writer.py:413] - Packet 9: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-01 13:25:59,501 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2025-01-01 13:25:59,501 - INFO - [pcap_writer.py:413] - Packet 10: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-01 13:25:59,501 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2775
2025-01-01 13:25:59,501 - INFO - [pcap_writer.py:413] - Packet 11: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-01 13:25:59,501 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 269
2025-01-01 13:25:59,502 - INFO - [pcap_writer.py:413] - Packet 12: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-01 13:25:59,502 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-01 13:25:59,502 - INFO - [pcap_writer.py:413] - Packet 13: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-01 13:25:59,503 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-01 13:25:59,503 - INFO - [pcap_writer.py:413] - Packet 14: IP / TCP 192.168.1.2:12346 > 10.0.0.1:http PA / Raw
2025-01-01 13:25:59,503 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2025-01-01 13:25:59,504 - INFO - [pcap_writer.py:413] - Packet 15: IP / TCP 10.0.0.1:http > 192.168.1.2:12346 PA / Raw
2025-01-01 13:25:59,504 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2025-01-01 13:25:59,504 - INFO - [pcap_writer.py:427] - Verification complete: 15 valid packets, 15 TLS records
2025-01-01 13:25:59,504 - INFO - [main.py:106] - Results saved to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-01 13:25:59,505 - INFO - [main.py:160] - TLS session simulation completed successfully
2025-01-01 13:31:30,147 - INFO - [logging.py:83] - Logging configured successfully
2025-01-01 13:31:30,148 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-01 13:31:30,149 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-01 13:31:30,149 - INFO - [logging.py:92] - Log level: 20
2025-01-01 13:31:30,149 - INFO - [logging.py:93] - Timestamp: 2025-01-01T13:31:30.149721
2025-01-01 13:31:30,149 - INFO - [logging.py:94] - ==========================
2025-01-01 13:31:30,150 - INFO - [main.py:122] - Starting TLS session simulation
2025-01-01 13:31:30,150 - INFO - [main.py:87] - 
--- Client Session (certificate) ---
2025-01-01 13:31:30,151 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-01 13:31:30,152 - INFO - [cert.py:108] - File exists: True
2025-01-01 13:31:30,152 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-01 13:31:30,153 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-01 13:31:30,153 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-01 13:31:30,154 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-01 13:31:30,158 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 13:31:30,158 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-01 13:31:30,159 - INFO - [cert.py:108] - File exists: True
2025-01-01 13:31:30,159 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-01 13:31:30,160 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-01 13:31:30,160 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-01 13:31:30,160 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-01 13:31:30,161 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 13:31:30,199 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-01 13:31:30,200 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-01 13:31:30,200 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-01 13:31:30,202 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-01 13:31:30,205 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-01 13:31:30,206 - INFO - [verify.py:58] - Public key comparison results:
2025-01-01 13:31:30,206 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 13:31:30,206 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 13:31:30,207 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-01 13:31:30,207 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-01 13:31:30,213 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-01 13:31:30,214 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-01 13:31:30,215 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-01 13:31:30,215 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-01 13:31:30,216 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-01 13:31:30,216 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-01 13:31:30,217 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-01 13:31:30,218 - INFO - [session.py:157] - Starting TLS session
2025-01-01 13:31:30,219 - INFO - [session.py:96] - Starting TLS Handshake...
2025-01-01 13:31:30,219 - INFO - [client.py:99] - Generated client_random: 677527923801c73c1e8fc25845dde3a71f2c2f995bcab1062f008ce697c748d1
2025-01-01 13:31:30,222 - INFO - [client.py:139] - Client Hello sent from 192.168.1.1
2025-01-01 13:31:30,224 - INFO - [session.py:101] - Client Hello sent successfully
2025-01-01 13:31:30,225 - INFO - [server.py:95] - Generated server_random: 6775279241c728cbb788cc4b34bed16279a32144ff9ea7357dc7830af56008a7
2025-01-01 13:31:30,229 - INFO - [session.py:106] - Server Hello received successfully
2025-01-01 13:31:30,229 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2025-01-01 13:31:30,230 - INFO - [cert.py:108] - File exists: True
2025-01-01 13:31:30,230 - INFO - [cert.py:109] - File size: 1915 bytes
2025-01-01 13:31:30,231 - INFO - [cert.py:113] - Read 1915 bytes
2025-01-01 13:31:30,231 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2025-01-01 13:31:30,232 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2025-01-01 13:31:30,233 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 13:31:30,233 - INFO - [client.py:173] - Prepared client certificate
2025-01-01 13:31:30,234 - INFO - [client.py:188] - Encrypted pre_master_secret length: 256
2025-01-01 13:31:30,236 - INFO - [session.py:111] - Client handshake messages sent successfully
2025-01-01 13:31:30,237 - INFO - [session.py:116] - Server key pair verified successfully
2025-01-01 13:31:30,237 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-01 13:31:30,238 - INFO - [chain.py:185] - Decrypted pre_master_secret: 0303b7b69c1fc229c4031929f7997b3766435a1054d972641689cb4fc1c02bbef42ec01a28f24c6404d8588d43a981d9
2025-01-01 13:31:30,238 - INFO - [chain.py:195] - Generated master secret: 15aca1b8198d2c61ba9c5e58657d45aae94b3c42b67157da6fe363f370794cdc984e969d2ff849e907a5d703549d3d3f
2025-01-01 13:31:30,239 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-01 13:31:30,239 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-01 13:31:30,239 - INFO - [session.py:120] - Master Secret handled successfully
2025-01-01 13:31:30,240 - INFO - [client.py:269] - Pre-master secret validated successfully
2025-01-01 13:31:30,241 - INFO - [client.py:287] - Generated digital signature: c0fb289cd79e48ad7cde7eb7d7b6c78244bab1073b58331e888c5d1bd2de6647a7a53224fec77eadae83dda5da934b4cbe1980fe9a10a056d187f9d8571029cbdcd788e1d9c45ff39339eb539f95cde1e88569f9e804b20abda70d11689619400ad813a5d6dbc90c474877a50b2c0319d12bcea2b082de03b0596f8419f80d6f24602ad5cc2e21ea6182954cccfebb57c020af798f562001406b75e0e7479e8b7047442c0845fabdb6432ba6a3ed581945207e9f4f06c57b129f87b0243b800c7860988cb800d825e0aa1a1ecd42efa1966effd7a7a3eac8981cd1182a98940fbac222c6a9a36e1803c3fd36e9f20c5872b59254632a8fbd08dcff5d3a7d7d4c
2025-01-01 13:31:30,242 - INFO - [client.py:333] - Client ChangeCipherSpec and Finished messages sent
2025-01-01 13:31:30,243 - INFO - [session.py:125] - Client Change Cipher Spec sent successfully
2025-01-01 13:31:30,244 - INFO - [server.py:256] - Pre-master secret validated successfully
2025-01-01 13:31:30,245 - INFO - [server.py:274] - Generated digital signature: 4d7ca3d6b0706f262f2fe1db4b12dd7bb9341be362ebfc26b37d534ddca725b32274a00fb0d637c027a42d5d80adf05e2273dd6d6e93c89bd41d22c00f0b7c3d9200d0050686fd370b4457c87a2e072615480831581e62e8dcbe334b308db55a4740a312fcd68001f377a8fc3e006d6c32c79cad31af3af64aaf2c75eda20aec2f575ae7ee00f031e519dd5d9aac05207fd97e7589f54a2247de01b6aafdc064ee309e991ebf0454cb65af310f0acbe4399eea713af8ec64baba5222c112764ba09810afa818bb32aba330f7b0196a9473926e0f26bf4efb9f9c9d2bb44b779942fcf3a80402619c2f1260bf2d7b2b572487ba6ad5c7e63a85b757872294c0dc
2025-01-01 13:31:30,246 - INFO - [server.py:320] - Server ChangeCipherSpec and Finished messages sent
2025-01-01 13:31:30,247 - INFO - [session.py:130] - Server Change Cipher Spec received successfully
2025-01-01 13:31:30,248 - INFO - [keys.py:212] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-01 13:31:30,249 - INFO - [session.py:135] - SSL Key Log handled successfully
2025-01-01 13:31:30,249 - INFO - [session.py:139] - TLS Handshake completed successfully
2025-01-01 13:31:30,250 - INFO - [session.py:168] - Found file to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 13:31:30,250 - INFO - [session.py:186] - Handshake completed: True
2025-01-01 13:31:30,250 - INFO - [session.py:187] - Use client cert: True
2025-01-01 13:31:30,251 - INFO - [session.py:188] - File to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 13:31:30,251 - INFO - [session.py:191] - Using encrypted exchange
2025-01-01 13:31:30,252 - INFO - [session.py:206] - Sending encrypted request data
2025-01-01 13:31:30,254 - INFO - [keys.py:185] - TLS Application Data sent from 192.168.1.1:12345 to 10.0.0.1:443
2025-01-01 13:31:30,255 - INFO - [session.py:217] - Sending encrypted response data
2025-01-01 13:31:30,256 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-01 13:31:30,256 - INFO - [session.py:229] - Attempting to send file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 13:31:30,257 - INFO - [session.py:240] - Opening file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 13:31:30,257 - INFO - [session.py:247] - Read 1103 bytes from file
2025-01-01 13:31:30,258 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-01 13:31:30,259 - INFO - [session.py:256] - File sent successfully
2025-01-01 13:31:30,259 - INFO - [session.py:231] - File sent successfully
2025-01-01 13:31:30,259 - INFO - [main.py:95] - Session completed successfully for 192.168.1.1
2025-01-01 13:31:30,259 - INFO - [main.py:87] - 
--- Client Session (no certificate) ---
2025-01-01 13:31:30,260 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-01 13:31:30,260 - INFO - [cert.py:108] - File exists: True
2025-01-01 13:31:30,260 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-01 13:31:30,261 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-01 13:31:30,261 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-01 13:31:30,261 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-01 13:31:30,262 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 13:31:30,262 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-01 13:31:30,263 - INFO - [cert.py:108] - File exists: True
2025-01-01 13:31:30,263 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-01 13:31:30,263 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-01 13:31:30,264 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-01 13:31:30,264 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-01 13:31:30,265 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 13:31:30,294 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-01 13:31:30,295 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-01 13:31:30,296 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-01 13:31:30,296 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-01 13:31:30,297 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-01 13:31:30,297 - INFO - [verify.py:58] - Public key comparison results:
2025-01-01 13:31:30,297 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 13:31:30,298 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 13:31:30,299 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-01 13:31:30,299 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-01 13:31:30,300 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-01 13:31:30,300 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-01 13:31:30,300 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-01 13:31:30,301 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-01 13:31:30,301 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-01 13:31:30,302 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-01 13:31:30,302 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-01 13:31:30,303 - INFO - [session.py:157] - Starting TLS session
2025-01-01 13:31:30,303 - INFO - [session.py:96] - Starting TLS Handshake...
2025-01-01 13:31:30,303 - INFO - [client.py:99] - Generated client_random: 6775279203bec3d344b278bfd4a32581d2a45087a200a443296f588104397a4a
2025-01-01 13:31:30,305 - INFO - [client.py:139] - Client Hello sent from 192.168.1.2
2025-01-01 13:31:30,307 - INFO - [session.py:101] - Client Hello sent successfully
2025-01-01 13:31:30,308 - INFO - [server.py:95] - Generated server_random: 67752792a4f03e64253841bd65aee3fe9ce10de410243e1cfe03a3ad1603a178
2025-01-01 13:31:30,311 - INFO - [session.py:106] - Server Hello received successfully
2025-01-01 13:31:30,311 - INFO - [client.py:176] - Prepared empty certificate
2025-01-01 13:31:30,311 - INFO - [client.py:188] - Encrypted pre_master_secret length: 256
2025-01-01 13:31:30,312 - INFO - [session.py:111] - Client handshake messages sent successfully
2025-01-01 13:31:30,314 - INFO - [session.py:116] - Server key pair verified successfully
2025-01-01 13:31:30,314 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-01 13:31:30,315 - INFO - [chain.py:185] - Decrypted pre_master_secret: 0303004846b0690c191977827f1cdb6da1919241080e71a8d6cf2939ee163c7e136e0c38489b4a78df00a3f3a64d1871
2025-01-01 13:31:30,316 - INFO - [chain.py:195] - Generated master secret: d8eedc484e613c1ecf33e5192de5696f97943da1b3d377a66c88a5956ce61d18505be7b05ea84c918d47182e4eb26c27
2025-01-01 13:31:30,316 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-01 13:31:30,316 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-01 13:31:30,317 - INFO - [session.py:120] - Master Secret handled successfully
2025-01-01 13:31:30,318 - INFO - [client.py:269] - Pre-master secret validated successfully
2025-01-01 13:31:30,319 - INFO - [client.py:287] - Generated digital signature: 08829e217feb4c778b8d3ec7ad804f52659366e836b718cdd072c5c740ad09a4ebfd1d8aa83563827cc4238ec2c8f700210915d76d61b0e8a94a1348bcf9b54eb45dd8605338272686ba47550dd982393a2a279e1fa59fce0af11276b10edab4c93a72b386d9d6ad5a9a05fdda792629ffd77eb7c74d1c74afad2197424bfd561db49e88f61cc83926c30e1aad349c1da6f0ad2245d28609a8926842554234210ebd56301f220a8fcb76f8023df2b41929eb89c7c6e17de248e68189973dfc8c7da25db91618bddff916a62f5155b87c0d71fc6d7ab47382a985b0055fb372afabdb07fca263057580379a2eeaed6453fd4bf08c3308c892e2629756a06bc5dd
2025-01-01 13:31:30,320 - INFO - [client.py:333] - Client ChangeCipherSpec and Finished messages sent
2025-01-01 13:31:30,321 - INFO - [session.py:125] - Client Change Cipher Spec sent successfully
2025-01-01 13:31:30,322 - INFO - [server.py:256] - Pre-master secret validated successfully
2025-01-01 13:31:30,322 - INFO - [server.py:274] - Generated digital signature: 9a4f63748ab5ca658a3806b1f825abac28a830df8466c0820c8829ed136c823d17261f83b8f72fa7f6bfb52788963a336bcc23d8e98cbaf2f39dfaef1f92134890366667a92b3c006f9ed4288145ea95d9718bc276c3a79c305ae7aa756262cc843768aad6b439421daaf6b5d0ec099e2f1dd06cc57b3c44aa2d64ec6ff9d9f1b55e0e695a682d099d4215ce16be2df7fd9539448cb35f1dc60eace923bc06536b3a9fb0da4ce052b8e4b0f952d5c3d45b7f8e57cc9a9183c6ca27c2ca0c965dd68a9f56a08e6cf2355fada60c3a2383ca57d159b3cd2826437864a547ccc954d29fb874b221c97c2f03eebedeec221547f07cf019d25df6998d9716d05192cb
2025-01-01 13:31:30,323 - INFO - [server.py:320] - Server ChangeCipherSpec and Finished messages sent
2025-01-01 13:31:30,324 - INFO - [session.py:130] - Server Change Cipher Spec received successfully
2025-01-01 13:31:30,325 - INFO - [keys.py:212] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-01 13:31:30,325 - INFO - [session.py:135] - SSL Key Log handled successfully
2025-01-01 13:31:30,326 - INFO - [session.py:139] - TLS Handshake completed successfully
2025-01-01 13:31:30,326 - INFO - [session.py:186] - Handshake completed: True
2025-01-01 13:31:30,326 - INFO - [session.py:187] - Use client cert: False
2025-01-01 13:31:30,326 - INFO - [session.py:188] - File to send: None
2025-01-01 13:31:30,327 - INFO - [session.py:194] - Using unencrypted exchange
2025-01-01 13:31:30,327 - INFO - [session.py:294] - Added request packet
2025-01-01 13:31:30,328 - INFO - [session.py:294] - Added response packet
2025-01-01 13:31:30,328 - WARNING - [session.py:271] - Using unencrypted communication
2025-01-01 13:31:30,328 - INFO - [main.py:95] - Session completed successfully for 192.168.1.2
2025-01-01 13:31:30,328 - INFO - [pcap_writer.py:232] - Packet 13: Valid HTTP message
2025-01-01 13:31:30,329 - INFO - [pcap_writer.py:232] - Packet 14: Valid HTTP message
2025-01-01 13:31:30,333 - INFO - [pcap_writer.py:387] - Saved 15 valid packets to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-01 13:31:30,334 - INFO - [pcap_writer.py:409] - Verifying 15 packets...
2025-01-01 13:31:30,335 - INFO - [pcap_writer.py:413] - Packet 1: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 13:31:30,335 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2025-01-01 13:31:30,336 - INFO - [pcap_writer.py:413] - Packet 2: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 13:31:30,336 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2775
2025-01-01 13:31:30,336 - INFO - [pcap_writer.py:413] - Packet 3: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 13:31:30,337 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 1646
2025-01-01 13:31:30,337 - INFO - [pcap_writer.py:413] - Packet 4: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 13:31:30,337 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-01 13:31:30,337 - INFO - [pcap_writer.py:413] - Packet 5: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 13:31:30,338 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-01 13:31:30,338 - INFO - [pcap_writer.py:413] - Packet 6: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 13:31:30,338 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 160
2025-01-01 13:31:30,338 - INFO - [pcap_writer.py:413] - Packet 7: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 13:31:30,338 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 128
2025-01-01 13:31:30,339 - INFO - [pcap_writer.py:413] - Packet 8: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 13:31:30,339 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 1152
2025-01-01 13:31:30,339 - INFO - [pcap_writer.py:413] - Packet 9: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-01 13:31:30,339 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2025-01-01 13:31:30,340 - INFO - [pcap_writer.py:413] - Packet 10: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-01 13:31:30,340 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2775
2025-01-01 13:31:30,340 - INFO - [pcap_writer.py:413] - Packet 11: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-01 13:31:30,340 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 269
2025-01-01 13:31:30,341 - INFO - [pcap_writer.py:413] - Packet 12: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-01 13:31:30,341 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-01 13:31:30,341 - INFO - [pcap_writer.py:413] - Packet 13: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-01 13:31:30,342 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-01 13:31:30,342 - INFO - [pcap_writer.py:413] - Packet 14: IP / TCP 192.168.1.2:12346 > 10.0.0.1:http PA / Raw
2025-01-01 13:31:30,342 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2025-01-01 13:31:30,342 - INFO - [pcap_writer.py:413] - Packet 15: IP / TCP 10.0.0.1:http > 192.168.1.2:12346 PA / Raw
2025-01-01 13:31:30,343 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2025-01-01 13:31:30,343 - INFO - [pcap_writer.py:427] - Verification complete: 15 valid packets, 15 TLS records
2025-01-01 13:31:30,343 - INFO - [main.py:106] - Results saved to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-01 13:31:30,344 - INFO - [main.py:160] - TLS session simulation completed successfully
2025-01-01 14:15:52,983 - INFO - [logging.py:83] - Logging configured successfully
2025-01-01 14:15:52,983 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-01 14:15:52,984 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-01 14:15:52,984 - INFO - [logging.py:92] - Log level: 20
2025-01-01 14:15:52,984 - INFO - [logging.py:93] - Timestamp: 2025-01-01T14:15:52.984546
2025-01-01 14:15:52,984 - INFO - [logging.py:94] - ==========================
2025-01-01 14:15:52,984 - INFO - [main.py:122] - Starting TLS session simulation
2025-01-01 14:15:52,985 - INFO - [main.py:87] - 
--- Client Session (certificate) ---
2025-01-01 14:15:52,986 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-01 14:15:52,986 - INFO - [cert.py:108] - File exists: True
2025-01-01 14:15:52,987 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-01 14:15:52,987 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-01 14:15:52,988 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-01 14:15:52,988 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-01 14:15:52,993 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 14:15:52,993 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-01 14:15:52,994 - INFO - [cert.py:108] - File exists: True
2025-01-01 14:15:52,994 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-01 14:15:52,995 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-01 14:15:52,995 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-01 14:15:52,996 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-01 14:15:52,997 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 14:15:53,037 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-01 14:15:53,038 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-01 14:15:53,039 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-01 14:15:53,039 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-01 14:15:53,042 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-01 14:15:53,042 - INFO - [verify.py:58] - Public key comparison results:
2025-01-01 14:15:53,043 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 14:15:53,044 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 14:15:53,045 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-01 14:15:53,045 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-01 14:15:53,052 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-01 14:15:53,053 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-01 14:15:53,053 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-01 14:15:53,054 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-01 14:15:53,054 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-01 14:15:53,055 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-01 14:15:53,056 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-01 14:15:53,056 - INFO - [session.py:157] - Starting TLS session
2025-01-01 14:15:53,057 - INFO - [session.py:96] - Starting TLS Handshake...
2025-01-01 14:15:53,057 - INFO - [client.py:99] - Generated client_random: 677531f9fcf815aa4bcb6aa27a61ea00688344378a9f3073bf487da10356fee0
2025-01-01 14:15:53,059 - INFO - [client.py:139] - Client Hello sent from 192.168.1.1
2025-01-01 14:15:53,061 - INFO - [session.py:101] - Client Hello sent successfully
2025-01-01 14:15:53,061 - INFO - [server.py:95] - Generated server_random: 677531f9873854c153d6862546b4ff0d0b7d2c3ef41c70fdcad73fcd14bf80fb
2025-01-01 14:15:53,064 - INFO - [session.py:106] - Server Hello received successfully
2025-01-01 14:15:53,065 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2025-01-01 14:15:53,065 - INFO - [cert.py:108] - File exists: True
2025-01-01 14:15:53,066 - INFO - [cert.py:109] - File size: 1915 bytes
2025-01-01 14:15:53,066 - INFO - [cert.py:113] - Read 1915 bytes
2025-01-01 14:15:53,067 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2025-01-01 14:15:53,067 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2025-01-01 14:15:53,068 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 14:15:53,068 - INFO - [client.py:173] - Prepared client certificate
2025-01-01 14:15:53,069 - INFO - [client.py:188] - Encrypted pre_master_secret length: 256
2025-01-01 14:15:53,071 - INFO - [session.py:111] - Client handshake messages sent successfully
2025-01-01 14:15:53,072 - INFO - [session.py:116] - Server key pair verified successfully
2025-01-01 14:15:53,073 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-01 14:15:53,074 - INFO - [chain.py:185] - Decrypted pre_master_secret: 03031f0c394638c06adce1aa302fb16670c5034e603a406968e7798d087fb60b143ed04a7049910698f3a822184fa816
2025-01-01 14:15:53,074 - INFO - [chain.py:195] - Generated master secret: 32f06c56d71cde7bda5380ad3861ff0d2b9d03f5c54cd960c63e8821a2cc58edeaba10b55ebca4c46ef3e9fcad99ee64
2025-01-01 14:15:53,075 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-01 14:15:53,075 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-01 14:15:53,075 - INFO - [session.py:120] - Master Secret handled successfully
2025-01-01 14:15:53,076 - INFO - [client.py:269] - Pre-master secret validated successfully
2025-01-01 14:15:53,077 - INFO - [client.py:287] - Generated digital signature: 29dece04c6e534e676996ce6f6691fbdcdad4be54cdfa9dd5ac92c15c449f23c4249349163933084146b4a16dc8d51f0367021af1bc0f36a1ae07d46763ac67e640df145a0cdfdef140fcd4208867fd25043427a343efa5a93097b0b5fed129c839e66efec8ee67b173a4970e29a4ce0d9617f8c8b3c77e275c98d86ece3eeedac77baad6051e5bd81e928536ad6bb8ed1781b160713c607200614e71e9fc011731b725c969003d05738073734915a0ae19cd686ae6dae14d950c919e8bad21b9a8f4d48f4c4f4b4b7ab810cbf5cde5f8c8531ba22866e55f0409527aee01201de475d15b59a1acd3d52a4caad730b417eaab843c63fc833fae4debaaeda5335
2025-01-01 14:15:53,088 - INFO - [client.py:333] - Client ChangeCipherSpec and Finished messages sent
2025-01-01 14:15:53,089 - INFO - [session.py:125] - Client Change Cipher Spec sent successfully
2025-01-01 14:15:53,090 - INFO - [server.py:257] - Pre-master secret validated successfully
2025-01-01 14:15:53,091 - INFO - [server.py:275] - Generated digital signature: 0c31636464a36fe220f34e5ac9d7bc63358736c5fee9adfebea5edd68bb44fa71149050923ac8b4ffb129796bcfe8348cc88411b85b2f0173b1ebd28090bdc3413ccbda4d52b53186e85515b40ca546b226737360ca835e825e64e80a7f6d68caaad782bf3495d19b11148ce4db4219ef79fb26e9fab96063884b1142af47d6b44cc138a64a2279ed302f6f0d2b19f8bd3e25d50039857fb34547cfbe84ec65a4396322a9cfe84fa49dac45af94a08eddd873eb4bd1090b6687ab61777d092f8d654f440178de86d802c090ae583a495376b194e2ca590b56eca272c83cd989f5346bd3c2e380f0f3f6117d46430415eae19113d653bba2c56fcb9661cf64e75
2025-01-01 14:15:53,092 - INFO - [server.py:321] - Server ChangeCipherSpec and Finished messages sent
2025-01-01 14:15:53,093 - INFO - [session.py:130] - Server Change Cipher Spec received successfully
2025-01-01 14:15:53,094 - INFO - [keys.py:212] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-01 14:15:53,094 - INFO - [session.py:135] - SSL Key Log handled successfully
2025-01-01 14:15:53,095 - INFO - [session.py:139] - TLS Handshake completed successfully
2025-01-01 14:15:53,095 - INFO - [session.py:168] - Found file to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 14:15:53,095 - INFO - [session.py:186] - Handshake completed: True
2025-01-01 14:15:53,096 - INFO - [session.py:187] - Use client cert: True
2025-01-01 14:15:53,096 - INFO - [session.py:188] - File to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 14:15:53,096 - INFO - [session.py:191] - Using encrypted exchange
2025-01-01 14:15:53,096 - INFO - [session.py:206] - Sending encrypted request data
2025-01-01 14:15:53,098 - INFO - [keys.py:185] - TLS Application Data sent from 192.168.1.1:12345 to 10.0.0.1:443
2025-01-01 14:15:53,099 - INFO - [session.py:217] - Sending encrypted response data
2025-01-01 14:15:53,100 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-01 14:15:53,100 - INFO - [session.py:229] - Attempting to send file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 14:15:53,101 - INFO - [session.py:240] - Opening file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 14:15:53,102 - INFO - [session.py:247] - Read 1103 bytes from file
2025-01-01 14:15:53,103 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-01 14:15:53,104 - INFO - [session.py:256] - File sent successfully
2025-01-01 14:15:53,105 - INFO - [session.py:231] - File sent successfully
2025-01-01 14:15:53,105 - INFO - [main.py:95] - Session completed successfully for 192.168.1.1
2025-01-01 14:15:53,106 - INFO - [main.py:87] - 
--- Client Session (no certificate) ---
2025-01-01 14:15:53,106 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-01 14:15:53,107 - INFO - [cert.py:108] - File exists: True
2025-01-01 14:15:53,107 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-01 14:15:53,108 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-01 14:15:53,108 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-01 14:15:53,108 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-01 14:15:53,108 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 14:15:53,109 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-01 14:15:53,109 - INFO - [cert.py:108] - File exists: True
2025-01-01 14:15:53,109 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-01 14:15:53,109 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-01 14:15:53,109 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-01 14:15:53,110 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-01 14:15:53,110 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 14:15:53,138 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-01 14:15:53,138 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-01 14:15:53,139 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-01 14:15:53,139 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-01 14:15:53,139 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-01 14:15:53,139 - INFO - [verify.py:58] - Public key comparison results:
2025-01-01 14:15:53,139 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 14:15:53,140 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 14:15:53,140 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-01 14:15:53,141 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-01 14:15:53,141 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-01 14:15:53,142 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-01 14:15:53,142 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-01 14:15:53,142 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-01 14:15:53,142 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-01 14:15:53,143 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-01 14:15:53,143 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-01 14:15:53,144 - INFO - [session.py:157] - Starting TLS session
2025-01-01 14:15:53,144 - INFO - [session.py:96] - Starting TLS Handshake...
2025-01-01 14:15:53,144 - INFO - [client.py:99] - Generated client_random: 677531f9f6b9bbda42e4caedf1389e669b2f8aebdbfb1ba20df342157e1b0b4b
2025-01-01 14:15:53,146 - INFO - [client.py:139] - Client Hello sent from 192.168.1.2
2025-01-01 14:15:53,148 - INFO - [session.py:101] - Client Hello sent successfully
2025-01-01 14:15:53,148 - INFO - [server.py:95] - Generated server_random: 677531f9153b4e99916070889fea966d83db4175514187dc23588de51597d8fd
2025-01-01 14:15:53,152 - INFO - [session.py:106] - Server Hello received successfully
2025-01-01 14:15:53,153 - INFO - [client.py:176] - Prepared empty certificate
2025-01-01 14:15:53,154 - INFO - [client.py:188] - Encrypted pre_master_secret length: 256
2025-01-01 14:15:53,156 - INFO - [session.py:111] - Client handshake messages sent successfully
2025-01-01 14:15:53,158 - INFO - [session.py:116] - Server key pair verified successfully
2025-01-01 14:15:53,158 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-01 14:15:53,159 - INFO - [chain.py:185] - Decrypted pre_master_secret: 03031f62b8e337739fb6be6978cc9daf459ab729f87e81762ae7c31d7085e2b97cd4fd7c78a3bcf073d9e68a835e3cb0
2025-01-01 14:15:53,160 - INFO - [chain.py:195] - Generated master secret: cea5f75b23cbf710874bc436002d98772ec4d00650ed4348f5e96200dc5b984a4d20b45dd4508218b4150d53bf48e244
2025-01-01 14:15:53,160 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-01 14:15:53,160 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-01 14:15:53,160 - INFO - [session.py:120] - Master Secret handled successfully
2025-01-01 14:15:53,161 - INFO - [client.py:269] - Pre-master secret validated successfully
2025-01-01 14:15:53,162 - INFO - [client.py:287] - Generated digital signature: 1b04be9840356e780d5b2794cf92f9566745341adcc120ee97b3383833c1e3cd1f91e78062a757c4c0390e574ca485a88d8b7a19e73a4f40fb3c926182cdff08078221d0cdc3ec21ecbc925f3775c26fe5c7941ac5f4dab50b47ca8f78028e3ad02f9131a1635b65d171b9ad5ebc6d7284a6ce2d81aeec3f9eda2eb9860512427406d84ac1570ceaad726a43a943f51a1210ede3163f7c2af9e2786709fc604a45108adf8de26d3768de6eaef29e88fa33ff71d1e3877f4b2b42a4d2f4e1bccc0533277a1fd5025e89f48b5b2d0138441d2f181975f84cb3a04afd85bcc7bd1b0b8d6ef48f853c479819321bffdeae4d6e9f2456960ebf7d23da57d1a9e7d56b
2025-01-01 14:15:53,163 - INFO - [client.py:333] - Client ChangeCipherSpec and Finished messages sent
2025-01-01 14:15:53,164 - INFO - [session.py:125] - Client Change Cipher Spec sent successfully
2025-01-01 14:15:53,165 - INFO - [server.py:257] - Pre-master secret validated successfully
2025-01-01 14:15:53,165 - INFO - [server.py:275] - Generated digital signature: 6a0efb6a5df104dbd5e93a4f42f265b79c553077e8433e111a7fa0249133f32a9e0fe011b76b2c32669bcc22c8a001bd8c23a72c8358ae530ccb69605602aba237628460321f2cae85ec3803e19a0a3fe92a175b284afc7307fb8f8b3ca5814dff5cdf9f58e4672e51cc4a78b2156867a5f7f510d56a7c2e9b908442449a7c2d5a7838db9e5d01084e5b8fc2d1cbd318fa766156ac75e84f6542073f974806d4477cbec89a4db3d2906560bd6f6ad0b29e8a820d513eff99b5400d974d8539e707b5fbec5ccd57e2eb99b8a6d48c36c1215636b3257bcea86101a6c551534997a99a08e759e426779505d8e099e80ba3aeda96e3d09f0596c25011b10808dc28
2025-01-01 14:15:53,166 - INFO - [server.py:321] - Server ChangeCipherSpec and Finished messages sent
2025-01-01 14:15:53,168 - INFO - [session.py:130] - Server Change Cipher Spec received successfully
2025-01-01 14:15:53,169 - INFO - [keys.py:212] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-01 14:15:53,169 - INFO - [session.py:135] - SSL Key Log handled successfully
2025-01-01 14:15:53,169 - INFO - [session.py:139] - TLS Handshake completed successfully
2025-01-01 14:15:53,170 - INFO - [session.py:186] - Handshake completed: True
2025-01-01 14:15:53,170 - INFO - [session.py:187] - Use client cert: False
2025-01-01 14:15:53,171 - INFO - [session.py:188] - File to send: None
2025-01-01 14:15:53,171 - INFO - [session.py:194] - Using unencrypted exchange
2025-01-01 14:15:53,171 - INFO - [session.py:294] - Added request packet
2025-01-01 14:15:53,172 - INFO - [session.py:294] - Added response packet
2025-01-01 14:15:53,172 - WARNING - [session.py:271] - Using unencrypted communication
2025-01-01 14:15:53,172 - INFO - [main.py:95] - Session completed successfully for 192.168.1.2
2025-01-01 14:15:53,173 - INFO - [pcap_writer.py:232] - Packet 13: Valid HTTP message
2025-01-01 14:15:53,173 - INFO - [pcap_writer.py:232] - Packet 14: Valid HTTP message
2025-01-01 14:15:53,177 - INFO - [pcap_writer.py:387] - Saved 15 valid packets to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-01 14:15:53,177 - INFO - [pcap_writer.py:409] - Verifying 15 packets...
2025-01-01 14:15:53,178 - INFO - [pcap_writer.py:413] - Packet 1: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 14:15:53,178 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2025-01-01 14:15:53,179 - INFO - [pcap_writer.py:413] - Packet 2: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 14:15:53,179 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2775
2025-01-01 14:15:53,179 - INFO - [pcap_writer.py:413] - Packet 3: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 14:15:53,179 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 1646
2025-01-01 14:15:53,179 - INFO - [pcap_writer.py:413] - Packet 4: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 14:15:53,180 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-01 14:15:53,180 - INFO - [pcap_writer.py:413] - Packet 5: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 14:15:53,180 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-01 14:15:53,180 - INFO - [pcap_writer.py:413] - Packet 6: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 14:15:53,181 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 160
2025-01-01 14:15:53,181 - INFO - [pcap_writer.py:413] - Packet 7: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 14:15:53,181 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 128
2025-01-01 14:15:53,181 - INFO - [pcap_writer.py:413] - Packet 8: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 14:15:53,181 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 1152
2025-01-01 14:15:53,181 - INFO - [pcap_writer.py:413] - Packet 9: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-01 14:15:53,182 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2025-01-01 14:15:53,182 - INFO - [pcap_writer.py:413] - Packet 10: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-01 14:15:53,182 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2775
2025-01-01 14:15:53,182 - INFO - [pcap_writer.py:413] - Packet 11: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-01 14:15:53,182 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 269
2025-01-01 14:15:53,183 - INFO - [pcap_writer.py:413] - Packet 12: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-01 14:15:53,183 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-01 14:15:53,183 - INFO - [pcap_writer.py:413] - Packet 13: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-01 14:15:53,183 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-01 14:15:53,184 - INFO - [pcap_writer.py:413] - Packet 14: IP / TCP 192.168.1.2:12346 > 10.0.0.1:http PA / Raw
2025-01-01 14:15:53,184 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2025-01-01 14:15:53,185 - INFO - [pcap_writer.py:413] - Packet 15: IP / TCP 10.0.0.1:http > 192.168.1.2:12346 PA / Raw
2025-01-01 14:15:53,185 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2025-01-01 14:15:53,185 - INFO - [pcap_writer.py:427] - Verification complete: 15 valid packets, 15 TLS records
2025-01-01 14:15:53,186 - INFO - [main.py:106] - Results saved to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-01 14:15:53,186 - INFO - [main.py:160] - TLS session simulation completed successfully
2025-01-01 14:23:42,247 - INFO - [logging.py:83] - Logging configured successfully
2025-01-01 14:23:42,248 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-01 14:23:42,248 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-01 14:23:42,248 - INFO - [logging.py:92] - Log level: 20
2025-01-01 14:23:42,249 - INFO - [logging.py:93] - Timestamp: 2025-01-01T14:23:42.249010
2025-01-01 14:23:42,249 - INFO - [logging.py:94] - ==========================
2025-01-01 14:23:42,249 - INFO - [main.py:122] - Starting TLS session simulation
2025-01-01 14:23:42,249 - INFO - [main.py:87] - 
--- Client Session (certificate) ---
2025-01-01 14:23:42,250 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-01 14:23:42,251 - INFO - [cert.py:108] - File exists: True
2025-01-01 14:23:42,251 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-01 14:23:42,251 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-01 14:23:42,252 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-01 14:23:42,252 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-01 14:23:42,252 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 14:23:42,253 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-01 14:23:42,253 - INFO - [cert.py:108] - File exists: True
2025-01-01 14:23:42,253 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-01 14:23:42,254 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-01 14:23:42,254 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-01 14:23:42,254 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-01 14:23:42,255 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 14:23:42,283 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-01 14:23:42,284 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-01 14:23:42,285 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-01 14:23:42,285 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-01 14:23:42,287 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-01 14:23:42,287 - INFO - [verify.py:58] - Public key comparison results:
2025-01-01 14:23:42,287 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 14:23:42,288 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 14:23:42,288 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-01 14:23:42,288 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-01 14:23:42,292 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-01 14:23:42,293 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-01 14:23:42,293 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-01 14:23:42,293 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-01 14:23:42,294 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-01 14:23:42,294 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-01 14:23:42,294 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-01 14:23:42,295 - INFO - [session.py:157] - Starting TLS session
2025-01-01 14:23:42,295 - INFO - [session.py:96] - Starting TLS Handshake...
2025-01-01 14:23:42,295 - INFO - [client.py:99] - Generated client_random: 677533cef8b19303b2701b356b723bcfa069fff482bd41cb442114d982cb0c26
2025-01-01 14:23:42,297 - INFO - [client.py:139] - Client Hello sent from 192.168.1.1
2025-01-01 14:23:42,299 - INFO - [session.py:101] - Client Hello sent successfully
2025-01-01 14:23:42,299 - INFO - [server.py:95] - Generated server_random: 677533ce09de028fb3eb8ca93555fe322f060fb9f9594dfce4645cabaae6bab1
2025-01-01 14:23:42,304 - INFO - [session.py:106] - Server Hello received successfully
2025-01-01 14:23:42,305 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2025-01-01 14:23:42,305 - INFO - [cert.py:108] - File exists: True
2025-01-01 14:23:42,306 - INFO - [cert.py:109] - File size: 1915 bytes
2025-01-01 14:23:42,306 - INFO - [cert.py:113] - Read 1915 bytes
2025-01-01 14:23:42,306 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2025-01-01 14:23:42,307 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2025-01-01 14:23:42,307 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 14:23:42,307 - INFO - [client.py:173] - Prepared client certificate
2025-01-01 14:23:42,308 - INFO - [client.py:188] - Encrypted pre_master_secret length: 256
2025-01-01 14:23:42,309 - INFO - [session.py:111] - Client handshake messages sent successfully
2025-01-01 14:23:42,310 - INFO - [session.py:116] - Server key pair verified successfully
2025-01-01 14:23:42,311 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-01 14:23:42,311 - INFO - [chain.py:185] - Decrypted pre_master_secret: 03037abbe048e0ec6503e626b1bc813cdbabd509d8f0749ff888546b83c511c47261c50cd1c2b3f3e931545e0a797a18
2025-01-01 14:23:42,311 - INFO - [chain.py:195] - Generated master secret: 45649cdad42ee772e30b182c8aaee566990f37530892abab1d41645c2ddee8eae246857bafe8bca335f0f3aafab7b27e
2025-01-01 14:23:42,312 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-01 14:23:42,312 - ERROR - [chain.py:266] - Unexpected error during Master Secret handling.
Traceback (most recent call last):
  File "C:\my-CTF\pcap_creator\tls\certificates\chain.py", line 253, in handle_master_secret
    raise MasterSecretError(f"Invalid master secret length: {len(session.master_secret)}")
tls.certificates.chain.MasterSecretError: Invalid master secret length: 96
2025-01-01 14:23:42,314 - ERROR - [session.py:143] - TLS Handshake failed: Failed to handle Master Secret
2025-01-01 14:23:42,315 - ERROR - [main.py:27] - Session error: Session failed for 192.168.1.1: Session failed: Handshake failed
2025-01-01 14:47:06,532 - INFO - [logging.py:83] - Logging configured successfully
2025-01-01 14:47:06,533 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-01 14:47:06,533 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-01 14:47:06,534 - INFO - [logging.py:92] - Log level: 20
2025-01-01 14:47:06,534 - INFO - [logging.py:93] - Timestamp: 2025-01-01T14:47:06.534284
2025-01-01 14:47:06,534 - INFO - [logging.py:94] - ==========================
2025-01-01 14:47:06,534 - INFO - [main.py:122] - Starting TLS session simulation
2025-01-01 14:47:06,535 - INFO - [main.py:87] - 
--- Client Session (certificate) ---
2025-01-01 14:47:06,536 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-01 14:47:06,536 - INFO - [cert.py:108] - File exists: True
2025-01-01 14:47:06,537 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-01 14:47:06,537 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-01 14:47:06,538 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-01 14:47:06,538 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-01 14:47:06,543 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 14:47:06,544 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-01 14:47:06,545 - INFO - [cert.py:108] - File exists: True
2025-01-01 14:47:06,545 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-01 14:47:06,546 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-01 14:47:06,547 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-01 14:47:06,547 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-01 14:47:06,548 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 14:47:06,587 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-01 14:47:06,587 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-01 14:47:06,588 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-01 14:47:06,588 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-01 14:47:06,591 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-01 14:47:06,591 - INFO - [verify.py:58] - Public key comparison results:
2025-01-01 14:47:06,591 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 14:47:06,592 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 14:47:06,593 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-01 14:47:06,593 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-01 14:47:06,604 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-01 14:47:06,605 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-01 14:47:06,605 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-01 14:47:06,605 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-01 14:47:06,606 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-01 14:47:06,607 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-01 14:47:06,608 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-01 14:47:06,608 - INFO - [session.py:157] - Starting TLS session
2025-01-01 14:47:06,609 - INFO - [session.py:96] - Starting TLS Handshake...
2025-01-01 14:47:06,609 - INFO - [client.py:99] - Generated client_random: 6775394ad92ea0b77090d1e09aece717689bb850daef7777a9ba9b0367c7151b
2025-01-01 14:47:06,611 - INFO - [client.py:139] - Client Hello sent from 192.168.1.1
2025-01-01 14:47:06,613 - INFO - [session.py:101] - Client Hello sent successfully
2025-01-01 14:47:06,614 - INFO - [server.py:95] - Generated server_random: 6775394a93e363952d7986903801b5eb4f46d6cd166892b5c2f59e49a03de3b9
2025-01-01 14:47:06,621 - INFO - [session.py:106] - Server Hello received successfully
2025-01-01 14:47:06,622 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2025-01-01 14:47:06,622 - INFO - [cert.py:108] - File exists: True
2025-01-01 14:47:06,623 - INFO - [cert.py:109] - File size: 1915 bytes
2025-01-01 14:47:06,623 - INFO - [cert.py:113] - Read 1915 bytes
2025-01-01 14:47:06,624 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2025-01-01 14:47:06,624 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2025-01-01 14:47:06,625 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 14:47:06,626 - INFO - [client.py:173] - Prepared client certificate
2025-01-01 14:47:06,626 - INFO - [client.py:188] - Encrypted pre_master_secret length: 256
2025-01-01 14:47:06,628 - INFO - [session.py:111] - Client handshake messages sent successfully
2025-01-01 14:47:06,630 - INFO - [session.py:116] - Server key pair verified successfully
2025-01-01 14:47:06,630 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-01 14:47:06,632 - INFO - [chain.py:185] - Decrypted pre_master_secret: 03034cdf3cc8477aaf85744b472d79e39ab3d0de8d2ecf57aee0076050049d12c4b3b886b0fdc821b4ce612f6ec85b4c
2025-01-01 14:47:06,633 - INFO - [chain.py:195] - Generated master secret: 0e212461ebb94f34c7b9aa1e46efc391008442933af86df989a4310cb4e9c3b85a61094417c3cd4e2c8079e686a2364b
2025-01-01 14:47:06,633 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-01 14:47:06,634 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-01 14:47:06,634 - INFO - [session.py:120] - Master Secret handled successfully
2025-01-01 14:47:06,636 - INFO - [client.py:269] - Pre-master secret validated successfully
2025-01-01 14:47:06,637 - INFO - [client.py:287] - Generated digital signature: 362ee346e8fa288ffc95a1f55fa316a8b7953d5d6dfc3b179ddf0b0a395afe9f938ebd2c7eaa20b8338c803bcc1e7a736678eaf202ad1cbf031d934c4877b91b409a5e2b0efbf1ad5dd4ea567d71468fa70cc03841d7e67a7ee40cc2e31704df2037c9c013ca31a32318794fe9ceadb013b2fe5ba6d6ba6c77dea0a8f7c5c016d0f3beaf4836ac5fa1dafeb5dcdc14238479f375b32a2b661c7a5351f823bca0922303c837d09cb7d51518a2c4c970b5ac316fcf6850e76e6517b3f241cbbc9643838def4801c7a02c7556fcc8e983bca88152b5229391ff63fc5913b5223cacada291819dbec7b32738ce59fa7587f422f6dfa7fc82ac95147d7c258647cf89
2025-01-01 14:47:06,639 - ERROR - [main.py:27] - Session error: Session failed for 192.168.1.1: Session failed: Failed to send ChangeCipherSpec: Failed to create finished messages: Failed to derive key block: PRF.derive_key_block() missing 1 required positional argument: 'req_len'
2025-01-01 14:49:58,906 - INFO - [logging.py:83] - Logging configured successfully
2025-01-01 14:49:58,907 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-01 14:49:58,907 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-01 14:49:58,907 - INFO - [logging.py:92] - Log level: 20
2025-01-01 14:49:58,907 - INFO - [logging.py:93] - Timestamp: 2025-01-01T14:49:58.907920
2025-01-01 14:49:58,908 - INFO - [logging.py:94] - ==========================
2025-01-01 14:49:58,908 - INFO - [main.py:122] - Starting TLS session simulation
2025-01-01 14:49:58,909 - INFO - [main.py:87] - 
--- Client Session (certificate) ---
2025-01-01 14:49:58,910 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-01 14:49:58,910 - INFO - [cert.py:108] - File exists: True
2025-01-01 14:49:58,910 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-01 14:49:58,911 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-01 14:49:58,911 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-01 14:49:58,912 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-01 14:49:58,912 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 14:49:58,913 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-01 14:49:58,913 - INFO - [cert.py:108] - File exists: True
2025-01-01 14:49:58,913 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-01 14:49:58,914 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-01 14:49:58,914 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-01 14:49:58,914 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-01 14:49:58,915 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 14:49:58,943 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-01 14:49:58,944 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-01 14:49:58,945 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-01 14:49:58,945 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-01 14:49:58,947 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-01 14:49:58,947 - INFO - [verify.py:58] - Public key comparison results:
2025-01-01 14:49:58,947 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 14:49:58,948 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 14:49:58,950 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-01 14:49:58,950 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-01 14:49:58,957 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-01 14:49:58,957 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-01 14:49:58,958 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-01 14:49:58,958 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-01 14:49:58,958 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-01 14:49:58,959 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-01 14:49:58,960 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-01 14:49:58,960 - INFO - [session.py:157] - Starting TLS session
2025-01-01 14:49:58,961 - INFO - [session.py:96] - Starting TLS Handshake...
2025-01-01 14:49:58,961 - INFO - [client.py:99] - Generated client_random: 677539f66ce324a4b55eb737770d23191c08c1322bcccf27ac8d6d2a117b85c6
2025-01-01 14:49:58,964 - INFO - [client.py:139] - Client Hello sent from 192.168.1.1
2025-01-01 14:49:58,968 - INFO - [session.py:101] - Client Hello sent successfully
2025-01-01 14:49:58,968 - INFO - [server.py:95] - Generated server_random: 677539f6a026e73c635645223ccd8e1debd3e4604de8784c39c97354db3961eb
2025-01-01 14:49:58,972 - INFO - [session.py:106] - Server Hello received successfully
2025-01-01 14:49:58,973 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2025-01-01 14:49:58,973 - INFO - [cert.py:108] - File exists: True
2025-01-01 14:49:58,974 - INFO - [cert.py:109] - File size: 1915 bytes
2025-01-01 14:49:58,974 - INFO - [cert.py:113] - Read 1915 bytes
2025-01-01 14:49:58,974 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2025-01-01 14:49:58,975 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2025-01-01 14:49:58,976 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 14:49:58,977 - INFO - [client.py:173] - Prepared client certificate
2025-01-01 14:49:58,977 - INFO - [client.py:188] - Encrypted pre_master_secret length: 256
2025-01-01 14:49:58,979 - INFO - [session.py:111] - Client handshake messages sent successfully
2025-01-01 14:49:58,982 - INFO - [session.py:116] - Server key pair verified successfully
2025-01-01 14:49:58,983 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-01 14:49:58,984 - INFO - [chain.py:185] - Decrypted pre_master_secret: 030330829be6d1b785f164128554223c639d943fd6fdef0f60bdcb74eca643c58c675392c53b07b80b6e0155ac238918
2025-01-01 14:49:58,985 - INFO - [chain.py:195] - Generated master secret: 899f4b94a5f977e1a32026c83de8292d35d0872ef6ad7973d88b274d294f9255594cb97e7c711334224eebf91fb97b85
2025-01-01 14:49:58,985 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-01 14:49:58,985 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-01 14:49:58,985 - INFO - [session.py:120] - Master Secret handled successfully
2025-01-01 14:49:58,986 - INFO - [client.py:269] - Pre-master secret validated successfully
2025-01-01 14:49:58,987 - INFO - [client.py:287] - Generated digital signature: ce17c6d1a4acaa2809a07d3eb296b23bcb2c7c2acff0c20b45ce7efa921b83d1e2f8d14fa90c1222667bfdc216e899ef560bef377cb9b8e364c7b95b82f1ac29e6e380eabd7178a3bbc0c734227a2b845a51c24a2dd2c960b0524d1ccc8a96fe18d05590c5a8f86b4da5ea4f5d7c4bdd9b3d0918e3a6895256c6e4eef42150f3be0cf3477ddf01b482715046d6ee38ccf037c8ed6f4ed7927adc963deb7c611cb1ba11dcdc8584ec9b0e230e587e1a2c84800ac3d53028b331893a2c64a8bf8db55e35f607cdce6f01029b1579ac51cb98009d3003044569b42d2d216f5b297003edddcdd7edb835018173bc263465d7e562951b911b3638ce5ad61bcf18be32
2025-01-01 14:49:58,991 - INFO - [client.py:333] - Client ChangeCipherSpec and Finished messages sent
2025-01-01 14:49:58,992 - INFO - [session.py:125] - Client Change Cipher Spec sent successfully
2025-01-01 14:49:58,993 - INFO - [server.py:257] - Pre-master secret validated successfully
2025-01-01 14:49:58,994 - INFO - [server.py:275] - Generated digital signature: 01b8617458abcbca1f5df34fb12ae78930c5f675f24cb8bc3916a2deaec93793dad3e60fe1372363e1da6df8cbfabbf84179c45e5e82d0b11af3200fff47da7ac5986cd668bdde8791166024738afed0b192f67594c5d7dd48ed68b7879f4b7d55a5bb712bd5a67bf932043f41d3dd002ce42cc00eecdbe3c14d3cfa5f85ceaaefc1e5f17e9785d3799596e8d920e446a10b11ad8830cef24f136fe4d24bfa7979dd4b789b3949c4f53380789f627736b92469a93713923165c94143f437733f56ba34503226c334bd6c259b5bbedc54161b685589d6c0c127c6891d97673006a1970e0f79e173b748a57c479925735de8ecaa8dde274bc6daaab7ccde198a57
2025-01-01 14:49:58,996 - INFO - [server.py:321] - Server ChangeCipherSpec and Finished messages sent
2025-01-01 14:49:58,998 - INFO - [session.py:130] - Server Change Cipher Spec received successfully
2025-01-01 14:49:59,000 - INFO - [keys.py:212] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-01 14:49:59,000 - INFO - [session.py:135] - SSL Key Log handled successfully
2025-01-01 14:49:59,001 - INFO - [session.py:139] - TLS Handshake completed successfully
2025-01-01 14:49:59,001 - INFO - [session.py:168] - Found file to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 14:49:59,001 - INFO - [session.py:186] - Handshake completed: True
2025-01-01 14:49:59,002 - INFO - [session.py:187] - Use client cert: True
2025-01-01 14:49:59,002 - INFO - [session.py:188] - File to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 14:49:59,002 - INFO - [session.py:191] - Using encrypted exchange
2025-01-01 14:49:59,003 - INFO - [session.py:206] - Sending encrypted request data
2025-01-01 14:49:59,004 - INFO - [keys.py:185] - TLS Application Data sent from 192.168.1.1:12345 to 10.0.0.1:443
2025-01-01 14:49:59,005 - INFO - [session.py:217] - Sending encrypted response data
2025-01-01 14:49:59,006 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-01 14:49:59,006 - INFO - [session.py:229] - Attempting to send file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 14:49:59,007 - INFO - [session.py:240] - Opening file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 14:49:59,007 - INFO - [session.py:247] - Read 1103 bytes from file
2025-01-01 14:49:59,008 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-01 14:49:59,009 - INFO - [session.py:256] - File sent successfully
2025-01-01 14:49:59,010 - INFO - [session.py:231] - File sent successfully
2025-01-01 14:49:59,010 - INFO - [main.py:95] - Session completed successfully for 192.168.1.1
2025-01-01 14:49:59,010 - INFO - [main.py:87] - 
--- Client Session (no certificate) ---
2025-01-01 14:49:59,011 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-01 14:49:59,012 - INFO - [cert.py:108] - File exists: True
2025-01-01 14:49:59,012 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-01 14:49:59,013 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-01 14:49:59,014 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-01 14:49:59,015 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-01 14:49:59,016 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 14:49:59,017 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-01 14:49:59,017 - INFO - [cert.py:108] - File exists: True
2025-01-01 14:49:59,017 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-01 14:49:59,018 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-01 14:49:59,018 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-01 14:49:59,018 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-01 14:49:59,019 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 14:49:59,047 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-01 14:49:59,050 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-01 14:49:59,050 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-01 14:49:59,051 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-01 14:49:59,051 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-01 14:49:59,052 - INFO - [verify.py:58] - Public key comparison results:
2025-01-01 14:49:59,052 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 14:49:59,052 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 14:49:59,053 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-01 14:49:59,053 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-01 14:49:59,053 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-01 14:49:59,054 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-01 14:49:59,054 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-01 14:49:59,054 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-01 14:49:59,054 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-01 14:49:59,055 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-01 14:49:59,055 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-01 14:49:59,056 - INFO - [session.py:157] - Starting TLS session
2025-01-01 14:49:59,056 - INFO - [session.py:96] - Starting TLS Handshake...
2025-01-01 14:49:59,056 - INFO - [client.py:99] - Generated client_random: 677539f77ea62ff300863b15ffb4c078c9e78388f29c4a623c9c52c0e342e8e9
2025-01-01 14:49:59,058 - INFO - [client.py:139] - Client Hello sent from 192.168.1.2
2025-01-01 14:49:59,061 - INFO - [session.py:101] - Client Hello sent successfully
2025-01-01 14:49:59,062 - INFO - [server.py:95] - Generated server_random: 677539f7d44dc6f512b975fc2b559d64bf4c37012ca3ecf95c7f9a093b193f35
2025-01-01 14:49:59,067 - INFO - [session.py:106] - Server Hello received successfully
2025-01-01 14:49:59,068 - INFO - [client.py:176] - Prepared empty certificate
2025-01-01 14:49:59,068 - INFO - [client.py:188] - Encrypted pre_master_secret length: 256
2025-01-01 14:49:59,070 - INFO - [session.py:111] - Client handshake messages sent successfully
2025-01-01 14:49:59,071 - INFO - [session.py:116] - Server key pair verified successfully
2025-01-01 14:49:59,071 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-01 14:49:59,072 - INFO - [chain.py:185] - Decrypted pre_master_secret: 0303a07ce740eeaffc22fab81b07268dffc3d0f893c3071543516bf2775e63935be0e6a3cf187b9e0e6a7fc33d7b34ac
2025-01-01 14:49:59,072 - INFO - [chain.py:195] - Generated master secret: e3667586a51d82a14922ef3782c05d24096d88091e3167f70156408f1eb618b3fc849f70ab2320ae3c672fabe17db3eb
2025-01-01 14:49:59,072 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-01 14:49:59,073 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-01 14:49:59,073 - INFO - [session.py:120] - Master Secret handled successfully
2025-01-01 14:49:59,073 - INFO - [client.py:269] - Pre-master secret validated successfully
2025-01-01 14:49:59,074 - INFO - [client.py:287] - Generated digital signature: 81e450cb9a50530d9dc0d94eb6cb2a92fedf20c9405bccb61c40b12251079e6e149bead19505293f4f6de5c393d525b6c89b5545c91f42671c10dd562e948884b19c28c8004a3ce1511f1d0375091a6e29fc6d782fb693fe8e4f46cdb30abed76ea9d0e9756b950507ecd63153e99019bdd4d66dab4d65cc927d5fc66efad0a9dc1e66e3d6cfa4ffdb810f16acde9ff8f3d331f23cee3074bd41d097191bca8f1823c681eb224885261373c8eb5f0469c7456fb6f88b5bf93f473d76d289fa78110e296992d5ec390046878a84f03eaa53eb88541911c8d5c703cdc5a36cf7be101f7146954d74c5457bcb000c4d7f1d533e935e676d2498789fd214216242b6
2025-01-01 14:49:59,076 - INFO - [client.py:333] - Client ChangeCipherSpec and Finished messages sent
2025-01-01 14:49:59,077 - INFO - [session.py:125] - Client Change Cipher Spec sent successfully
2025-01-01 14:49:59,079 - INFO - [server.py:257] - Pre-master secret validated successfully
2025-01-01 14:49:59,080 - INFO - [server.py:275] - Generated digital signature: 32defb0f2991e35c7fc61bcfd8b587ef4adcc8ba9c1c010454fa0751927b576cc734c50f3593f5aba7e55b69911bb9dc105c5bb090b1f0b1233bc5a7ee2fd0274273fe3dacb1cdddd2d674bd7e0c339784726150f0ccbd3d6945045d9a3945c080bfe48ee367ee67eae937b2ee6aed1b1347eee8001903d8e834531e5c6126d70aaa7cb4a0e9cc3ffca565878a3e788ba674261df4ca7cf7619f9c434a923dbdfe865acc8a40e28dbe578bec5c3694b0eb8774248c813c30e1db6e547d53b5509dfe80c8095cf831b5d8009c0b42e3aa9160cacb783b3cd443cdd7715841c80658b3cbfaea3919d59c99ca82075215a55cef612094fbc97652a7f11b83d0bc83
2025-01-01 14:49:59,083 - INFO - [server.py:321] - Server ChangeCipherSpec and Finished messages sent
2025-01-01 14:49:59,084 - INFO - [session.py:130] - Server Change Cipher Spec received successfully
2025-01-01 14:49:59,085 - INFO - [keys.py:212] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-01 14:49:59,085 - INFO - [session.py:135] - SSL Key Log handled successfully
2025-01-01 14:49:59,086 - INFO - [session.py:139] - TLS Handshake completed successfully
2025-01-01 14:49:59,086 - INFO - [session.py:186] - Handshake completed: True
2025-01-01 14:49:59,086 - INFO - [session.py:187] - Use client cert: False
2025-01-01 14:49:59,087 - INFO - [session.py:188] - File to send: None
2025-01-01 14:49:59,087 - INFO - [session.py:194] - Using unencrypted exchange
2025-01-01 14:49:59,087 - INFO - [session.py:294] - Added request packet
2025-01-01 14:49:59,088 - INFO - [session.py:294] - Added response packet
2025-01-01 14:49:59,088 - WARNING - [session.py:271] - Using unencrypted communication
2025-01-01 14:49:59,089 - INFO - [main.py:95] - Session completed successfully for 192.168.1.2
2025-01-01 14:49:59,089 - INFO - [pcap_writer.py:232] - Packet 13: Valid HTTP message
2025-01-01 14:49:59,089 - INFO - [pcap_writer.py:232] - Packet 14: Valid HTTP message
2025-01-01 14:49:59,094 - INFO - [pcap_writer.py:387] - Saved 15 valid packets to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-01 14:49:59,095 - INFO - [pcap_writer.py:409] - Verifying 15 packets...
2025-01-01 14:49:59,096 - INFO - [pcap_writer.py:413] - Packet 1: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 14:49:59,096 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2025-01-01 14:49:59,096 - INFO - [pcap_writer.py:413] - Packet 2: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 14:49:59,097 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2775
2025-01-01 14:49:59,098 - INFO - [pcap_writer.py:413] - Packet 3: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 14:49:59,098 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 1646
2025-01-01 14:49:59,099 - INFO - [pcap_writer.py:413] - Packet 4: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 14:49:59,099 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-01 14:49:59,100 - INFO - [pcap_writer.py:413] - Packet 5: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 14:49:59,100 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-01 14:49:59,101 - INFO - [pcap_writer.py:413] - Packet 6: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 14:49:59,101 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 160
2025-01-01 14:49:59,101 - INFO - [pcap_writer.py:413] - Packet 7: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 14:49:59,102 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 128
2025-01-01 14:49:59,102 - INFO - [pcap_writer.py:413] - Packet 8: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 14:49:59,102 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 1152
2025-01-01 14:49:59,103 - INFO - [pcap_writer.py:413] - Packet 9: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-01 14:49:59,103 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2025-01-01 14:49:59,103 - INFO - [pcap_writer.py:413] - Packet 10: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-01 14:49:59,103 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2775
2025-01-01 14:49:59,103 - INFO - [pcap_writer.py:413] - Packet 11: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-01 14:49:59,104 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 269
2025-01-01 14:49:59,104 - INFO - [pcap_writer.py:413] - Packet 12: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-01 14:49:59,104 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-01 14:49:59,104 - INFO - [pcap_writer.py:413] - Packet 13: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-01 14:49:59,104 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-01 14:49:59,105 - INFO - [pcap_writer.py:413] - Packet 14: IP / TCP 192.168.1.2:12346 > 10.0.0.1:http PA / Raw
2025-01-01 14:49:59,105 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2025-01-01 14:49:59,105 - INFO - [pcap_writer.py:413] - Packet 15: IP / TCP 10.0.0.1:http > 192.168.1.2:12346 PA / Raw
2025-01-01 14:49:59,105 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2025-01-01 14:49:59,105 - INFO - [pcap_writer.py:427] - Verification complete: 15 valid packets, 15 TLS records
2025-01-01 14:49:59,106 - INFO - [main.py:106] - Results saved to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-01 14:49:59,106 - INFO - [main.py:160] - TLS session simulation completed successfully
2025-01-01 15:30:04,697 - INFO - [logging.py:83] - Logging configured successfully
2025-01-01 15:30:04,701 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-01 15:30:04,701 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-01 15:30:04,702 - INFO - [logging.py:92] - Log level: 20
2025-01-01 15:30:04,702 - INFO - [logging.py:93] - Timestamp: 2025-01-01T15:30:04.702726
2025-01-01 15:30:04,702 - INFO - [logging.py:94] - ==========================
2025-01-01 15:30:04,703 - INFO - [main.py:129] - Starting TLS session simulation
2025-01-01 15:30:04,703 - INFO - [main.py:94] - 
--- Client Session (certificate) ---
2025-01-01 15:30:04,705 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-01 15:30:04,705 - INFO - [cert.py:108] - File exists: True
2025-01-01 15:30:04,705 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-01 15:30:04,706 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-01 15:30:04,706 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-01 15:30:04,707 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-01 15:30:04,712 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 15:30:04,712 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-01 15:30:04,713 - INFO - [cert.py:108] - File exists: True
2025-01-01 15:30:04,714 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-01 15:30:04,715 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-01 15:30:04,715 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-01 15:30:04,716 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-01 15:30:04,717 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 15:30:04,755 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-01 15:30:04,756 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-01 15:30:04,756 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-01 15:30:04,758 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-01 15:30:04,760 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-01 15:30:04,760 - INFO - [verify.py:58] - Public key comparison results:
2025-01-01 15:30:04,760 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 15:30:04,761 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 15:30:04,762 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-01 15:30:04,762 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-01 15:30:04,767 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-01 15:30:04,767 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-01 15:30:04,768 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-01 15:30:04,768 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-01 15:30:04,769 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-01 15:30:04,769 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-01 15:30:04,770 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-01 15:30:04,771 - INFO - [session.py:157] - Starting TLS session
2025-01-01 15:30:04,771 - INFO - [session.py:96] - Starting TLS Handshake...
2025-01-01 15:30:04,771 - INFO - [client.py:99] - Generated client_random: 6775435cf91d505f1877c423c273f7b5724b0bcfdc58850e0450ba8ee3e4cb2c
2025-01-01 15:30:04,777 - INFO - [client.py:139] - Client Hello sent from 192.168.1.1
2025-01-01 15:30:04,782 - INFO - [session.py:101] - Client Hello sent successfully
2025-01-01 15:30:04,783 - INFO - [server.py:95] - Generated server_random: 6775435c244b4a5c176902c26b9fc3f1668b3360f7368658a731b849bc655fec
2025-01-01 15:30:04,794 - INFO - [session.py:106] - Server Hello received successfully
2025-01-01 15:30:04,796 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2025-01-01 15:30:04,798 - INFO - [cert.py:108] - File exists: True
2025-01-01 15:30:04,800 - INFO - [cert.py:109] - File size: 1915 bytes
2025-01-01 15:30:04,801 - INFO - [cert.py:113] - Read 1915 bytes
2025-01-01 15:30:04,802 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2025-01-01 15:30:04,803 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2025-01-01 15:30:04,804 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 15:30:04,805 - INFO - [client.py:173] - Prepared client certificate
2025-01-01 15:30:04,807 - INFO - [client.py:188] - Encrypted pre_master_secret length: 256
2025-01-01 15:30:04,810 - INFO - [session.py:111] - Client handshake messages sent successfully
2025-01-01 15:30:04,813 - INFO - [session.py:116] - Server key pair verified successfully
2025-01-01 15:30:04,813 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-01 15:30:04,815 - INFO - [chain.py:185] - Decrypted pre_master_secret: 0303f53559d27d6e795944c64e7316ac5b238710dc146cc860b0cb37b5f1270a6837e11114f5ee8f833dd71d061a95d1
2025-01-01 15:30:04,816 - INFO - [chain.py:195] - Generated master secret: cd583bcd317605f36ba51d218075aa20a31900f576bae8f81d52b4590959e3f154dbe8d84699feabab60fc4b8d381529
2025-01-01 15:30:04,816 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-01 15:30:04,817 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-01 15:30:04,818 - INFO - [session.py:120] - Master Secret handled successfully
2025-01-01 15:30:04,821 - INFO - [client.py:269] - Pre-master secret validated successfully
2025-01-01 15:30:04,825 - INFO - [client.py:287] - Generated digital signature: 41595360053332c103503b5cbe305de459a7093f735917a765ca34443b666a42117e8b8eb1266276b1db306859437cbfd13e98d25030d8d47e7ebb06ba7f21f4a6fabe2949e9f6ce01688904bc213226f412a9d542e89b6cde8280c2c7641cf2f80c2d72e9e1757894243a1e1cbd0a49eaa9aa38a48ea160fc809ce9f06c4c393644902702054b91f50bacfacdcfa1e3a170fe207c8a401f82fd556714a9cda280afa66bfe39710b4fe757cd826e2c0a4697f15d077ce70232e36d26fadefc75748a63bbacc40fc4e1edb91d75f65b4b3e98fe746b1e739e25c2d960b22f3e99f4794992a1e1c8f2f4263bbe5c58b713cf5fa95c8c615a4fe3cf4ea749698ea6
2025-01-01 15:30:04,831 - INFO - [client.py:333] - Client ChangeCipherSpec and Finished messages sent
2025-01-01 15:30:04,834 - INFO - [session.py:125] - Client Change Cipher Spec sent successfully
2025-01-01 15:30:04,836 - INFO - [server.py:257] - Pre-master secret validated successfully
2025-01-01 15:30:04,839 - INFO - [server.py:275] - Generated digital signature: 78d9ded3148927101b50585b68202873957c08ac6e4ffd598a8a37f6093e5dffd0c03b057c621bf04bebc1ac87c93a4d86631480312b6644cb3541c5c153cea2c2709d90c95a7fe36a793cf71a91f455baf6a09d9056e05ecd1c225c020279c1c8f4eaa20b6436896c5447311ce401fbe90079433eb36d812e9b896f8f61b1b320f373763366468417da64220af3c1dd4fe23954f6fc580ca54160574e260dc67efdd1420f19cf897957d22bf43eb1001546c06d2dd2fec911c8fa6935eb15a1d1fc6aea78fa148f016f128a05b4e342482e09014898717db0fa70d9f90dfadebfb15bfcd8db9368fcdb99c990d863a2c00ff1d37801386d20433721b2546282
2025-01-01 15:30:04,843 - INFO - [server.py:321] - Server ChangeCipherSpec and Finished messages sent
2025-01-01 15:30:04,845 - INFO - [session.py:130] - Server Change Cipher Spec received successfully
2025-01-01 15:30:04,847 - INFO - [keys.py:212] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-01 15:30:04,848 - INFO - [session.py:135] - SSL Key Log handled successfully
2025-01-01 15:30:04,848 - INFO - [session.py:139] - TLS Handshake completed successfully
2025-01-01 15:30:04,849 - INFO - [session.py:168] - Found file to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 15:30:04,850 - INFO - [session.py:186] - Handshake completed: True
2025-01-01 15:30:04,850 - INFO - [session.py:187] - Use client cert: True
2025-01-01 15:30:04,850 - INFO - [session.py:188] - File to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 15:30:04,851 - INFO - [session.py:191] - Using encrypted exchange
2025-01-01 15:30:04,851 - INFO - [session.py:206] - Sending encrypted request data
2025-01-01 15:30:04,856 - INFO - [keys.py:185] - TLS Application Data sent from 192.168.1.1:12345 to 10.0.0.1:443
2025-01-01 15:30:04,857 - INFO - [session.py:217] - Sending encrypted response data
2025-01-01 15:30:04,860 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-01 15:30:04,863 - INFO - [session.py:229] - Attempting to send file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 15:30:04,864 - INFO - [session.py:240] - Opening file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 15:30:04,865 - INFO - [session.py:247] - Read 1103 bytes from file
2025-01-01 15:30:04,867 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-01 15:30:04,867 - INFO - [session.py:256] - File sent successfully
2025-01-01 15:30:04,868 - INFO - [session.py:231] - File sent successfully
2025-01-01 15:30:04,868 - INFO - [main.py:102] - Session completed successfully for 192.168.1.1
2025-01-01 15:30:04,868 - INFO - [main.py:94] - 
--- Client Session (no certificate) ---
2025-01-01 15:30:04,869 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-01 15:30:04,870 - INFO - [cert.py:108] - File exists: True
2025-01-01 15:30:04,870 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-01 15:30:04,871 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-01 15:30:04,871 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-01 15:30:04,872 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-01 15:30:04,873 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 15:30:04,874 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-01 15:30:04,874 - INFO - [cert.py:108] - File exists: True
2025-01-01 15:30:04,875 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-01 15:30:04,875 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-01 15:30:04,875 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-01 15:30:04,876 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-01 15:30:04,876 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 15:30:04,909 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-01 15:30:04,911 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-01 15:30:04,911 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-01 15:30:04,911 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-01 15:30:04,912 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-01 15:30:04,912 - INFO - [verify.py:58] - Public key comparison results:
2025-01-01 15:30:04,913 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 15:30:04,913 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 15:30:04,914 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-01 15:30:04,914 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-01 15:30:04,915 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-01 15:30:04,916 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-01 15:30:04,916 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-01 15:30:04,916 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-01 15:30:04,917 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-01 15:30:04,917 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-01 15:30:04,918 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-01 15:30:04,919 - INFO - [session.py:157] - Starting TLS session
2025-01-01 15:30:04,919 - INFO - [session.py:96] - Starting TLS Handshake...
2025-01-01 15:30:04,919 - INFO - [client.py:99] - Generated client_random: 6775435c8420c057a0bc93a8ab0d20a568581689c9b99e34a45b125a8288fa2e
2025-01-01 15:30:04,924 - INFO - [client.py:139] - Client Hello sent from 192.168.1.2
2025-01-01 15:30:04,928 - INFO - [session.py:101] - Client Hello sent successfully
2025-01-01 15:30:04,928 - INFO - [server.py:95] - Generated server_random: 6775435cde91e7d8cd442c7d21967887cfaaf5a625cef99f57054cfc8ac7960a
2025-01-01 15:30:04,931 - INFO - [session.py:106] - Server Hello received successfully
2025-01-01 15:30:04,932 - INFO - [client.py:176] - Prepared empty certificate
2025-01-01 15:30:04,932 - INFO - [client.py:188] - Encrypted pre_master_secret length: 256
2025-01-01 15:30:04,933 - INFO - [session.py:111] - Client handshake messages sent successfully
2025-01-01 15:30:04,934 - INFO - [session.py:116] - Server key pair verified successfully
2025-01-01 15:30:04,935 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-01 15:30:04,935 - INFO - [chain.py:185] - Decrypted pre_master_secret: 0303d1a0d89fe8c15e1d3e087473c4f9db7fb5d76eb383eae543747fb224e8bf1daef94cd4bf42b61743aada4d23c488
2025-01-01 15:30:04,936 - INFO - [chain.py:195] - Generated master secret: ba3af66328ceb4342024eb39192428f460c0f8902e82600b3c583d484527b3c0a636be1e5b1a813fc81f905394d0600e
2025-01-01 15:30:04,936 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-01 15:30:04,936 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-01 15:30:04,936 - INFO - [session.py:120] - Master Secret handled successfully
2025-01-01 15:30:04,937 - INFO - [client.py:269] - Pre-master secret validated successfully
2025-01-01 15:30:04,938 - INFO - [client.py:287] - Generated digital signature: cd1f9437dec98e810627bdedc2dc262b7cff6d473134526d3db6592cf8f6b5615d88751aac4c6d3bd51e3a0403f938e6c74651525ef7accc807da5f40519aa2b01023fcfd23735263c13a2fcb881bb5d54ae7c7508df91a70a48ee0448a5b2366fdfd0f18257f70f2a3a570037bbb714c4ed75fd04873e72bbd03b74f771cd7f656c1b9eb1feb191137e0d2d87be2b846dc927e5e659faa7ff9369e1b3c3f50d0dcbd0bff4eff44abe7e5d4f1860705ef2eb7c839be52a2c5ce1a340e87c9d493cacc7fb809ed859590c832f2f8b4264a46e64dd43ab49ddc879e551230749af83beea2bd85f801887f07149d33476754964e09116fa0924179b24cba0f98d45
2025-01-01 15:30:04,941 - INFO - [client.py:333] - Client ChangeCipherSpec and Finished messages sent
2025-01-01 15:30:04,942 - INFO - [session.py:125] - Client Change Cipher Spec sent successfully
2025-01-01 15:30:04,942 - INFO - [server.py:257] - Pre-master secret validated successfully
2025-01-01 15:30:04,943 - INFO - [server.py:275] - Generated digital signature: 9b33807fc60d09de3f7be37990f19ed242b0dbca5bd198d880a21e4377d653516f7723e55b20e46f65dda15b9dd790e24077ead0c62867a143be79e79a010e44387e96245a96d4a55a7bb01e71363be19848e61208b2dffd5425e8e6d1763da79b4466c7effea6e85419cc91ccba20e2220c3d96ff9b68c6bb3e4683ecf449d5d91bbedd05c2060c3087f1d535367bd06f0c3d11e1cbe0d1f5ca40e146e77a7b2b15d0ee1f0fd80648eed51375a745c20f4d203ad0e9f0b6dd89a68570c368c694b797e0178dc9b002ca0e8b565d5b28739876e34eb56bf6d580bb4a00d03f63bfa4d518bd880473f102f4b96459107d285ac65fb6e2c0490ac8b1c87e3a2c89
2025-01-01 15:30:04,944 - INFO - [server.py:321] - Server ChangeCipherSpec and Finished messages sent
2025-01-01 15:30:04,945 - INFO - [session.py:130] - Server Change Cipher Spec received successfully
2025-01-01 15:30:04,946 - INFO - [keys.py:212] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-01 15:30:04,946 - INFO - [session.py:135] - SSL Key Log handled successfully
2025-01-01 15:30:04,947 - INFO - [session.py:139] - TLS Handshake completed successfully
2025-01-01 15:30:04,947 - INFO - [session.py:186] - Handshake completed: True
2025-01-01 15:30:04,947 - INFO - [session.py:187] - Use client cert: False
2025-01-01 15:30:04,947 - INFO - [session.py:188] - File to send: None
2025-01-01 15:30:04,947 - INFO - [session.py:194] - Using unencrypted exchange
2025-01-01 15:30:04,948 - INFO - [session.py:294] - Added request packet
2025-01-01 15:30:04,948 - INFO - [session.py:294] - Added response packet
2025-01-01 15:30:04,948 - WARNING - [session.py:271] - Using unencrypted communication
2025-01-01 15:30:04,949 - INFO - [main.py:102] - Session completed successfully for 192.168.1.2
2025-01-01 15:30:04,949 - INFO - [pcap_writer.py:232] - Packet 13: Valid HTTP message
2025-01-01 15:30:04,949 - INFO - [pcap_writer.py:232] - Packet 14: Valid HTTP message
2025-01-01 15:30:04,955 - INFO - [pcap_writer.py:387] - Saved 15 valid packets to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-01 15:30:04,955 - INFO - [pcap_writer.py:409] - Verifying 15 packets...
2025-01-01 15:30:04,957 - INFO - [pcap_writer.py:413] - Packet 1: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 15:30:04,957 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2025-01-01 15:30:04,958 - INFO - [pcap_writer.py:413] - Packet 2: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 15:30:04,958 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2775
2025-01-01 15:30:04,958 - INFO - [pcap_writer.py:413] - Packet 3: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 15:30:04,958 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 1646
2025-01-01 15:30:04,959 - INFO - [pcap_writer.py:413] - Packet 4: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 15:30:04,959 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-01 15:30:04,959 - INFO - [pcap_writer.py:413] - Packet 5: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 15:30:04,959 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-01 15:30:04,960 - INFO - [pcap_writer.py:413] - Packet 6: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 15:30:04,960 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 160
2025-01-01 15:30:04,960 - INFO - [pcap_writer.py:413] - Packet 7: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 15:30:04,960 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 128
2025-01-01 15:30:04,960 - INFO - [pcap_writer.py:413] - Packet 8: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 15:30:04,960 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 1152
2025-01-01 15:30:04,961 - INFO - [pcap_writer.py:413] - Packet 9: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-01 15:30:04,961 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2025-01-01 15:30:04,961 - INFO - [pcap_writer.py:413] - Packet 10: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-01 15:30:04,961 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2775
2025-01-01 15:30:04,962 - INFO - [pcap_writer.py:413] - Packet 11: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-01 15:30:04,962 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 269
2025-01-01 15:30:04,962 - INFO - [pcap_writer.py:413] - Packet 12: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-01 15:30:04,962 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-01 15:30:04,963 - INFO - [pcap_writer.py:413] - Packet 13: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-01 15:30:04,963 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-01 15:30:04,963 - INFO - [pcap_writer.py:413] - Packet 14: IP / TCP 192.168.1.2:12346 > 10.0.0.1:http PA / Raw
2025-01-01 15:30:04,963 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2025-01-01 15:30:04,964 - INFO - [pcap_writer.py:413] - Packet 15: IP / TCP 10.0.0.1:http > 192.168.1.2:12346 PA / Raw
2025-01-01 15:30:04,964 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2025-01-01 15:30:04,964 - INFO - [pcap_writer.py:427] - Verification complete: 15 valid packets, 15 TLS records
2025-01-01 15:30:04,964 - INFO - [main.py:113] - Results saved to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-01 15:30:04,965 - INFO - [main.py:167] - TLS session simulation completed successfully
2025-01-01 15:47:03,286 - INFO - [logging.py:83] - Logging configured successfully
2025-01-01 15:47:03,287 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-01 15:47:03,287 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-01 15:47:03,287 - INFO - [logging.py:92] - Log level: 20
2025-01-01 15:47:03,287 - INFO - [logging.py:93] - Timestamp: 2025-01-01T15:47:03.287563
2025-01-01 15:47:03,287 - INFO - [logging.py:94] - ==========================
2025-01-01 15:47:03,287 - INFO - [main.py:129] - Starting TLS session simulation
2025-01-01 15:47:03,288 - INFO - [main.py:94] - 
--- Client Session (certificate) ---
2025-01-01 15:47:03,292 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-01 15:47:03,292 - INFO - [cert.py:108] - File exists: True
2025-01-01 15:47:03,292 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-01 15:47:03,293 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-01 15:47:03,293 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-01 15:47:03,294 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-01 15:47:03,299 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 15:47:03,300 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-01 15:47:03,301 - INFO - [cert.py:108] - File exists: True
2025-01-01 15:47:03,302 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-01 15:47:03,304 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-01 15:47:03,304 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-01 15:47:03,305 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-01 15:47:03,305 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 15:47:03,342 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-01 15:47:03,343 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-01 15:47:03,343 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-01 15:47:03,345 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-01 15:47:03,348 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-01 15:47:03,348 - INFO - [verify.py:58] - Public key comparison results:
2025-01-01 15:47:03,349 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 15:47:03,349 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 15:47:03,350 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-01 15:47:03,350 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-01 15:47:03,356 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-01 15:47:03,357 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-01 15:47:03,357 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-01 15:47:03,358 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-01 15:47:03,358 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-01 15:47:03,359 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-01 15:47:03,360 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-01 15:47:03,361 - INFO - [session.py:157] - Starting TLS session
2025-01-01 15:47:03,361 - INFO - [session.py:96] - Starting TLS Handshake...
2025-01-01 15:47:03,361 - INFO - [client.py:99] - Generated client_random: 67754757acd82f5b9b1a4eb4a17a2b61cd09ee1b19f262b64d9c82e31d32832b
2025-01-01 15:47:03,363 - INFO - [client.py:139] - Client Hello sent from 192.168.1.1
2025-01-01 15:47:03,365 - INFO - [session.py:101] - Client Hello sent successfully
2025-01-01 15:47:03,366 - INFO - [server.py:95] - Generated server_random: 6775475708e552a182a9257d9ccd3704a7ed57bbcc564683976ad6f88005eef8
2025-01-01 15:47:03,373 - INFO - [session.py:106] - Server Hello received successfully
2025-01-01 15:47:03,373 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2025-01-01 15:47:03,374 - INFO - [cert.py:108] - File exists: True
2025-01-01 15:47:03,375 - INFO - [cert.py:109] - File size: 1915 bytes
2025-01-01 15:47:03,376 - INFO - [cert.py:113] - Read 1915 bytes
2025-01-01 15:47:03,376 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2025-01-01 15:47:03,377 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2025-01-01 15:47:03,377 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 15:47:03,378 - INFO - [client.py:173] - Prepared client certificate
2025-01-01 15:47:03,379 - INFO - [client.py:188] - Encrypted pre_master_secret length: 256
2025-01-01 15:47:03,380 - INFO - [session.py:111] - Client handshake messages sent successfully
2025-01-01 15:47:03,382 - INFO - [session.py:116] - Server key pair verified successfully
2025-01-01 15:47:03,382 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-01 15:47:03,384 - INFO - [chain.py:185] - Decrypted pre_master_secret: 0303a59d4fbaa735567da0607028d283b7bfd956502e6a7b5804517dda131e08784b7f815739c3325695f08f9b75eb49
2025-01-01 15:47:03,386 - INFO - [chain.py:195] - Generated master secret: c986655737e72887b7e8d638d3111796ffebc565636527e34a8747c39e652ba972c98c240be106c8bf2e82b825dbbaa3
2025-01-01 15:47:03,387 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-01 15:47:03,387 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-01 15:47:03,388 - INFO - [session.py:120] - Master Secret handled successfully
2025-01-01 15:47:03,390 - INFO - [client.py:269] - Pre-master secret validated successfully
2025-01-01 15:47:03,392 - INFO - [client.py:287] - Generated digital signature: cfff0565478d6a0401294c18b9ab1bf892c8a63a5becf95f453fd86204568946758838330a01f637bf87d805b21dd01ed92fef1f7b14530d11c287c944fab01358a6d20b2e68f9516501db950a89d5bdab5812a5e07b7eddd050eafd2df6df8e79741cab2bb87e9a44bd9c5eea6480abb1efa17731df782ba1a6539ed03e63e69e5fc656b411ef5e8c583bb8339e5565c1b2a40810bbd988569937b8064f6c5a7bf0e61b1fa88ca8516d04ce700069cc35ac9e7a04db7411ed93bf6d5f3c4135defa46a083d3902a3d2aa2da072e8d835b31cd251c02aedc6e9246da25f8a40c650c6b8a3be51bba1b6e30efe183cf87747d90a322ab6b53f4c56816db603045
2025-01-01 15:47:03,394 - INFO - [client.py:333] - Client ChangeCipherSpec and Finished messages sent
2025-01-01 15:47:03,395 - INFO - [session.py:125] - Client Change Cipher Spec sent successfully
2025-01-01 15:47:03,396 - INFO - [server.py:257] - Pre-master secret validated successfully
2025-01-01 15:47:03,397 - INFO - [server.py:275] - Generated digital signature: 76f86612320e18dc8cc16c0e9c3ab48a9a9247a173030a168ca00522b51bd3ec6e807c409b6b3b27ce103aac77d69b978637a62aba0c62c5862cc0d6460e39e2f28d51f67bc8b07a534895bd9da063cd9e9d39a5ca3ceff7540a4403904e44522f76dc2ee87d151511dfb1087f3d5b5984ae74573826ca77a2eb0c3af77c2a3df02957a0a668f07bf557d3d776fbcda6e32476ac0a86e21f6ea35f6632cff141095435f6173b7bb1638cf184049206a0692bf238db45c9418a3b043721a9707424a671aa9398ba3e170860495906868cd9de9ce9adb83c24b47d0fbfc2524575376950071e5f5d6e8618de8f06869af0f0f28a02c9be2bb8b9af1bd16d93f0f8
2025-01-01 15:47:03,399 - INFO - [server.py:321] - Server ChangeCipherSpec and Finished messages sent
2025-01-01 15:47:03,400 - INFO - [session.py:130] - Server Change Cipher Spec received successfully
2025-01-01 15:47:03,403 - INFO - [keys.py:212] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-01 15:47:03,403 - INFO - [session.py:135] - SSL Key Log handled successfully
2025-01-01 15:47:03,404 - INFO - [session.py:139] - TLS Handshake completed successfully
2025-01-01 15:47:03,405 - INFO - [session.py:168] - Found file to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 15:47:03,405 - INFO - [session.py:186] - Handshake completed: True
2025-01-01 15:47:03,405 - INFO - [session.py:187] - Use client cert: True
2025-01-01 15:47:03,406 - INFO - [session.py:188] - File to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 15:47:03,406 - INFO - [session.py:191] - Using encrypted exchange
2025-01-01 15:47:03,406 - INFO - [session.py:206] - Sending encrypted request data
2025-01-01 15:47:03,408 - INFO - [keys.py:185] - TLS Application Data sent from 192.168.1.1:12345 to 10.0.0.1:443
2025-01-01 15:47:03,409 - INFO - [session.py:217] - Sending encrypted response data
2025-01-01 15:47:03,410 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-01 15:47:03,410 - INFO - [session.py:229] - Attempting to send file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 15:47:03,411 - INFO - [session.py:240] - Opening file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 15:47:03,411 - INFO - [session.py:247] - Read 1103 bytes from file
2025-01-01 15:47:03,413 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-01 15:47:03,413 - INFO - [session.py:256] - File sent successfully
2025-01-01 15:47:03,413 - INFO - [session.py:231] - File sent successfully
2025-01-01 15:47:03,414 - INFO - [main.py:102] - Session completed successfully for 192.168.1.1
2025-01-01 15:47:03,414 - INFO - [main.py:94] - 
--- Client Session (no certificate) ---
2025-01-01 15:47:03,415 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-01 15:47:03,415 - INFO - [cert.py:108] - File exists: True
2025-01-01 15:47:03,415 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-01 15:47:03,416 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-01 15:47:03,416 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-01 15:47:03,416 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-01 15:47:03,417 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 15:47:03,418 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-01 15:47:03,419 - INFO - [cert.py:108] - File exists: True
2025-01-01 15:47:03,420 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-01 15:47:03,420 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-01 15:47:03,420 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-01 15:47:03,421 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-01 15:47:03,421 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 15:47:03,454 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-01 15:47:03,455 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-01 15:47:03,455 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-01 15:47:03,455 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-01 15:47:03,456 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-01 15:47:03,456 - INFO - [verify.py:58] - Public key comparison results:
2025-01-01 15:47:03,456 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 15:47:03,457 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 15:47:03,457 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-01 15:47:03,458 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-01 15:47:03,458 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-01 15:47:03,459 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-01 15:47:03,459 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-01 15:47:03,459 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-01 15:47:03,460 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-01 15:47:03,460 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-01 15:47:03,461 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-01 15:47:03,461 - INFO - [session.py:157] - Starting TLS session
2025-01-01 15:47:03,462 - INFO - [session.py:96] - Starting TLS Handshake...
2025-01-01 15:47:03,462 - INFO - [client.py:99] - Generated client_random: 67754757c3a8907bd3d4d00103ce6dc1245dfb8001004f0e7a147f3c1a345e23
2025-01-01 15:47:03,464 - INFO - [client.py:139] - Client Hello sent from 192.168.1.2
2025-01-01 15:47:03,465 - INFO - [session.py:101] - Client Hello sent successfully
2025-01-01 15:47:03,466 - INFO - [server.py:95] - Generated server_random: 677547579d7534138cf97c45f61bd70fd514a783fd4288c09dd28e7b49c12d98
2025-01-01 15:47:03,471 - INFO - [session.py:106] - Server Hello received successfully
2025-01-01 15:47:03,472 - INFO - [client.py:176] - Prepared empty certificate
2025-01-01 15:47:03,473 - INFO - [client.py:188] - Encrypted pre_master_secret length: 256
2025-01-01 15:47:03,474 - INFO - [session.py:111] - Client handshake messages sent successfully
2025-01-01 15:47:03,475 - INFO - [session.py:116] - Server key pair verified successfully
2025-01-01 15:47:03,475 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-01 15:47:03,476 - INFO - [chain.py:185] - Decrypted pre_master_secret: 0303fb6f7f59475be96902ba559ce9d9feeece9d8820b17b79877f5b3ca134e9209b23378f1814e0422b156b92c82b89
2025-01-01 15:47:03,476 - INFO - [chain.py:195] - Generated master secret: a24ef50c9a4fbe6f15cdd6ea533717658706adb71c29eec886d1e03c8b33f2350e045fa73894df6045c73acbd98c38e3
2025-01-01 15:47:03,477 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-01 15:47:03,477 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-01 15:47:03,478 - INFO - [session.py:120] - Master Secret handled successfully
2025-01-01 15:47:03,478 - INFO - [client.py:269] - Pre-master secret validated successfully
2025-01-01 15:47:03,479 - INFO - [client.py:287] - Generated digital signature: 84d5fe9f086eff734901bf3769a0bf00ae4db9e7150dc4bdbcf987a2e0f3d6bfd26c4f61e61a0ad52e5722f1dde56403237a41882fc80c0e7da14a33f7b45c15ba70396682230215938ca415a859c45badc49a55721af84a0aa2b5bae7ca6709bca691885161b22946e6214aacb3444243d8cdd5fd6e756de25675ce7fd67b0ccba02152e7ada016f7130ad8fb40bf72457dbfd90872bba4b7c1d7cf17498dbccdb74bf1dcfca31f606b4f03b22621db9ed257ecda88598a12019eef08e6b1623fc80141e0c40bd057b5da631f586e8ff3ade9617dc8a87f8ad2021bd75a4809163dcaf23667e16ae4f8cfcb762bb70b4c0769b11dc99ef35a68b302258eced2
2025-01-01 15:47:03,480 - INFO - [client.py:333] - Client ChangeCipherSpec and Finished messages sent
2025-01-01 15:47:03,481 - INFO - [session.py:125] - Client Change Cipher Spec sent successfully
2025-01-01 15:47:03,482 - INFO - [server.py:257] - Pre-master secret validated successfully
2025-01-01 15:47:03,484 - INFO - [server.py:275] - Generated digital signature: cc2eb5cc9199f22e948983b0c5f625151cf8bc1e373ecf9d563fdb8de266ddccfbaefdcf898e04c72d061d2c1ecaab6d50ead31bf63d356fd0e577d44d41cc502fab9da58f7501b6a24f0520bab342881e8a9182917e0abb9c43b8ea8def30460d809b6d54f09be9f900388ae7be820a979164303530c4ab47b33d034788b6330c616ecb0ebcb00aa5dba0dcbec42ca14a036e7d159691b00ea0fa1875092bc98467588acd330fa99339d5bc0ce9a31d2b505989ba7e4bd4fa2874fd6980460fdc9c6b0270365cc7eb15a65c4a34278f45a767d3be705918c359ecac4de8ed406fd9a5f7d5eeea33815915c64cd75c85fec0372f8f0ce412d6789a901a2b7b1e
2025-01-01 15:47:03,487 - INFO - [server.py:321] - Server ChangeCipherSpec and Finished messages sent
2025-01-01 15:47:03,488 - INFO - [session.py:130] - Server Change Cipher Spec received successfully
2025-01-01 15:47:03,489 - INFO - [keys.py:212] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-01 15:47:03,489 - INFO - [session.py:135] - SSL Key Log handled successfully
2025-01-01 15:47:03,489 - INFO - [session.py:139] - TLS Handshake completed successfully
2025-01-01 15:47:03,490 - INFO - [session.py:186] - Handshake completed: True
2025-01-01 15:47:03,490 - INFO - [session.py:187] - Use client cert: False
2025-01-01 15:47:03,490 - INFO - [session.py:188] - File to send: None
2025-01-01 15:47:03,490 - INFO - [session.py:194] - Using unencrypted exchange
2025-01-01 15:47:03,491 - INFO - [session.py:294] - Added request packet
2025-01-01 15:47:03,491 - INFO - [session.py:294] - Added response packet
2025-01-01 15:47:03,491 - WARNING - [session.py:271] - Using unencrypted communication
2025-01-01 15:47:03,492 - INFO - [main.py:102] - Session completed successfully for 192.168.1.2
2025-01-01 15:47:03,492 - INFO - [pcap_writer.py:232] - Packet 13: Valid HTTP message
2025-01-01 15:47:03,493 - INFO - [pcap_writer.py:232] - Packet 14: Valid HTTP message
2025-01-01 15:47:03,498 - INFO - [pcap_writer.py:387] - Saved 15 valid packets to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-01 15:47:03,498 - INFO - [pcap_writer.py:409] - Verifying 15 packets...
2025-01-01 15:47:03,499 - INFO - [pcap_writer.py:413] - Packet 1: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 15:47:03,499 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2025-01-01 15:47:03,500 - INFO - [pcap_writer.py:413] - Packet 2: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 15:47:03,500 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2775
2025-01-01 15:47:03,501 - INFO - [pcap_writer.py:413] - Packet 3: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 15:47:03,502 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 1646
2025-01-01 15:47:03,503 - INFO - [pcap_writer.py:413] - Packet 4: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 15:47:03,503 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-01 15:47:03,504 - INFO - [pcap_writer.py:413] - Packet 5: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 15:47:03,504 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-01 15:47:03,505 - INFO - [pcap_writer.py:413] - Packet 6: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 15:47:03,505 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 160
2025-01-01 15:47:03,505 - INFO - [pcap_writer.py:413] - Packet 7: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 15:47:03,506 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 128
2025-01-01 15:47:03,506 - INFO - [pcap_writer.py:413] - Packet 8: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 15:47:03,506 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 1152
2025-01-01 15:47:03,506 - INFO - [pcap_writer.py:413] - Packet 9: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-01 15:47:03,507 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2025-01-01 15:47:03,507 - INFO - [pcap_writer.py:413] - Packet 10: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-01 15:47:03,507 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2775
2025-01-01 15:47:03,507 - INFO - [pcap_writer.py:413] - Packet 11: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-01 15:47:03,508 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 269
2025-01-01 15:47:03,508 - INFO - [pcap_writer.py:413] - Packet 12: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-01 15:47:03,508 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-01 15:47:03,509 - INFO - [pcap_writer.py:413] - Packet 13: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-01 15:47:03,509 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-01 15:47:03,509 - INFO - [pcap_writer.py:413] - Packet 14: IP / TCP 192.168.1.2:12346 > 10.0.0.1:http PA / Raw
2025-01-01 15:47:03,510 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2025-01-01 15:47:03,510 - INFO - [pcap_writer.py:413] - Packet 15: IP / TCP 10.0.0.1:http > 192.168.1.2:12346 PA / Raw
2025-01-01 15:47:03,510 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2025-01-01 15:47:03,511 - INFO - [pcap_writer.py:427] - Verification complete: 15 valid packets, 15 TLS records
2025-01-01 15:47:03,511 - INFO - [main.py:113] - Results saved to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-01 15:47:03,511 - INFO - [main.py:167] - TLS session simulation completed successfully
2025-01-01 15:50:52,430 - INFO - [logging.py:83] - Logging configured successfully
2025-01-01 15:50:52,431 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-01 15:50:52,431 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-01 15:50:52,431 - INFO - [logging.py:92] - Log level: 20
2025-01-01 15:50:52,431 - INFO - [logging.py:93] - Timestamp: 2025-01-01T15:50:52.431869
2025-01-01 15:50:52,432 - INFO - [logging.py:94] - ==========================
2025-01-01 15:50:52,432 - INFO - [main.py:129] - Starting TLS session simulation
2025-01-01 15:50:52,432 - INFO - [main.py:94] - 
--- Client Session (certificate) ---
2025-01-01 15:50:52,437 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-01 15:50:52,437 - INFO - [cert.py:108] - File exists: True
2025-01-01 15:50:52,438 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-01 15:50:52,438 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-01 15:50:52,438 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-01 15:50:52,439 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-01 15:50:52,444 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 15:50:52,445 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-01 15:50:52,446 - INFO - [cert.py:108] - File exists: True
2025-01-01 15:50:52,446 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-01 15:50:52,447 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-01 15:50:52,447 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-01 15:50:52,448 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-01 15:50:52,449 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 15:50:52,488 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-01 15:50:52,489 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-01 15:50:52,489 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-01 15:50:52,490 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-01 15:50:52,496 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-01 15:50:52,497 - INFO - [verify.py:58] - Public key comparison results:
2025-01-01 15:50:52,498 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 15:50:52,498 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 15:50:52,499 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-01 15:50:52,500 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-01 15:50:52,504 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-01 15:50:52,504 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-01 15:50:52,504 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-01 15:50:52,505 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-01 15:50:52,505 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-01 15:50:52,505 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-01 15:50:52,506 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-01 15:50:52,507 - INFO - [session.py:157] - Starting TLS session
2025-01-01 15:50:52,507 - INFO - [session.py:96] - Starting TLS Handshake...
2025-01-01 15:50:52,507 - INFO - [client.py:99] - Generated client_random: 6775483c25fe983e11f5ae22ff3990a3e34b660a37702e9e74e6ad1c364199be
2025-01-01 15:50:52,510 - INFO - [client.py:139] - Client Hello sent from 192.168.1.1
2025-01-01 15:50:52,513 - INFO - [session.py:101] - Client Hello sent successfully
2025-01-01 15:50:52,514 - INFO - [server.py:95] - Generated server_random: 6775483c2469d6b84f3fc69cb6700a062b8b4eac63f37c13b06aba1f538b0d41
2025-01-01 15:50:52,517 - INFO - [session.py:106] - Server Hello received successfully
2025-01-01 15:50:52,517 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2025-01-01 15:50:52,518 - INFO - [cert.py:108] - File exists: True
2025-01-01 15:50:52,518 - INFO - [cert.py:109] - File size: 1915 bytes
2025-01-01 15:50:52,519 - INFO - [cert.py:113] - Read 1915 bytes
2025-01-01 15:50:52,519 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2025-01-01 15:50:52,519 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2025-01-01 15:50:52,520 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 15:50:52,520 - INFO - [client.py:173] - Prepared client certificate
2025-01-01 15:50:52,521 - INFO - [client.py:188] - Encrypted pre_master_secret length: 256
2025-01-01 15:50:52,522 - INFO - [session.py:111] - Client handshake messages sent successfully
2025-01-01 15:50:52,523 - INFO - [session.py:116] - Server key pair verified successfully
2025-01-01 15:50:52,524 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-01 15:50:52,525 - INFO - [chain.py:185] - Decrypted pre_master_secret: 03031f9766c24ad494ff308dabcf0e4df091dd5b53c618b72c9502bcae23384eecbf2e07aee84d77ed450b16b7bcd6d5
2025-01-01 15:50:52,527 - INFO - [chain.py:195] - Generated master secret: 1035d92713854c4ff5740f57c48c99c818d2e84a24f0ffb09761811e654abb6cecccfdb25bab457be673d67b5e5e9a1f
2025-01-01 15:50:52,527 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-01 15:50:52,528 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-01 15:50:52,528 - INFO - [session.py:120] - Master Secret handled successfully
2025-01-01 15:50:52,529 - INFO - [client.py:269] - Pre-master secret validated successfully
2025-01-01 15:50:52,530 - INFO - [client.py:287] - Generated digital signature: d9bbd99e64ccd362662d7119d43d82240bc15987565942f533548af9e35c128a7dad171449c7cc87c9799f2a940b33cadd8ee0f01fd7c96b685db22c2464f92c42b05325c542463efb520561640883af884fb105347b5084cc4844a3fdf6da11b5b038a40812a3c758011555e19ef01305cba1f029801e8405a410a6b5a00059041259c9e16824e6b443395eed61f758d79823bdb60a9a501dd7951312e86e094348a9b74c15e7a03ccc2975de5651ed4b1f2e9af04e8958874d8098483e76c40205b8cf753533c79ec0d90d86dde0a1e18d07fc500d0ea0c1bd17ad9b880dfd73ba837354b1e731a89a3f5b9fbf32b805d25365e264fe66bf43a72ee78302ca
2025-01-01 15:50:52,532 - INFO - [client.py:333] - Client ChangeCipherSpec and Finished messages sent
2025-01-01 15:50:52,533 - INFO - [session.py:125] - Client Change Cipher Spec sent successfully
2025-01-01 15:50:52,534 - INFO - [server.py:257] - Pre-master secret validated successfully
2025-01-01 15:50:52,535 - INFO - [server.py:275] - Generated digital signature: 2999cb4b900e8434ac1e1de52a665265db3ba0a33bcabd24c753da96367297714705ca1ea1e1a154c7bdcad28283614689088d99969a18b568c63afb4ba545c4a6809268de8bba6d06ae5beaee84b3b9a2e4190cbb096cbc980cdec655222f937e51d13d98bf957c59eace7ede9fdfb4b58ce2cb8ea905a3c46ac91c0d2375179419bdc7e7d65399f3a0575ce6a15bd667a52b758757badf1f671bf01f0cf5889cd49f49aad3241b2a3271e221812afa49eff2b5783749ab642a1cb4803fe385929fbf425f0282c6f5641c5e137feba130666d84469f506461979ada5d2fefe65732a72e090da1ba43a2871b3cacf34e0d7ec8c91e5dd2647eb047b405e2384c
2025-01-01 15:50:52,536 - INFO - [server.py:321] - Server ChangeCipherSpec and Finished messages sent
2025-01-01 15:50:52,537 - INFO - [session.py:130] - Server Change Cipher Spec received successfully
2025-01-01 15:50:52,538 - INFO - [keys.py:212] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-01 15:50:52,538 - INFO - [session.py:135] - SSL Key Log handled successfully
2025-01-01 15:50:52,538 - INFO - [session.py:139] - TLS Handshake completed successfully
2025-01-01 15:50:52,538 - INFO - [session.py:168] - Found file to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 15:50:52,539 - INFO - [session.py:186] - Handshake completed: True
2025-01-01 15:50:52,539 - INFO - [session.py:187] - Use client cert: True
2025-01-01 15:50:52,540 - INFO - [session.py:188] - File to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 15:50:52,540 - INFO - [session.py:191] - Using encrypted exchange
2025-01-01 15:50:52,540 - INFO - [session.py:206] - Sending encrypted request data
2025-01-01 15:50:52,543 - INFO - [keys.py:185] - TLS Application Data sent from 192.168.1.1:12345 to 10.0.0.1:443
2025-01-01 15:50:52,544 - INFO - [session.py:217] - Sending encrypted response data
2025-01-01 15:50:52,545 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-01 15:50:52,546 - INFO - [session.py:229] - Attempting to send file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 15:50:52,547 - INFO - [session.py:240] - Opening file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 15:50:52,548 - INFO - [session.py:247] - Read 1103 bytes from file
2025-01-01 15:50:52,548 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-01 15:50:52,549 - INFO - [session.py:256] - File sent successfully
2025-01-01 15:50:52,549 - INFO - [session.py:231] - File sent successfully
2025-01-01 15:50:52,549 - INFO - [main.py:102] - Session completed successfully for 192.168.1.1
2025-01-01 15:50:52,549 - INFO - [main.py:94] - 
--- Client Session (no certificate) ---
2025-01-01 15:50:52,550 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-01 15:50:52,550 - INFO - [cert.py:108] - File exists: True
2025-01-01 15:50:52,550 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-01 15:50:52,551 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-01 15:50:52,551 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-01 15:50:52,551 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-01 15:50:52,552 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 15:50:52,552 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-01 15:50:52,553 - INFO - [cert.py:108] - File exists: True
2025-01-01 15:50:52,553 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-01 15:50:52,553 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-01 15:50:52,554 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-01 15:50:52,554 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-01 15:50:52,554 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 15:50:52,585 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-01 15:50:52,585 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-01 15:50:52,586 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-01 15:50:52,586 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-01 15:50:52,586 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-01 15:50:52,587 - INFO - [verify.py:58] - Public key comparison results:
2025-01-01 15:50:52,587 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 15:50:52,587 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 15:50:52,588 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-01 15:50:52,588 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-01 15:50:52,589 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-01 15:50:52,589 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-01 15:50:52,589 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-01 15:50:52,589 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-01 15:50:52,589 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-01 15:50:52,590 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-01 15:50:52,590 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-01 15:50:52,591 - INFO - [session.py:157] - Starting TLS session
2025-01-01 15:50:52,591 - INFO - [session.py:96] - Starting TLS Handshake...
2025-01-01 15:50:52,592 - INFO - [client.py:99] - Generated client_random: 6775483cf8d36958e5c2f93eb5ea4785b7ae7db99ea089348bebcf8adcd24991
2025-01-01 15:50:52,595 - INFO - [client.py:139] - Client Hello sent from 192.168.1.2
2025-01-01 15:50:52,597 - INFO - [session.py:101] - Client Hello sent successfully
2025-01-01 15:50:52,597 - INFO - [server.py:95] - Generated server_random: 6775483c4f1226d8b2253f1c37c396137c8f406828f00212ae24acaa21bb8c08
2025-01-01 15:50:52,601 - INFO - [session.py:106] - Server Hello received successfully
2025-01-01 15:50:52,601 - INFO - [client.py:176] - Prepared empty certificate
2025-01-01 15:50:52,602 - INFO - [client.py:188] - Encrypted pre_master_secret length: 256
2025-01-01 15:50:52,603 - INFO - [session.py:111] - Client handshake messages sent successfully
2025-01-01 15:50:52,604 - INFO - [session.py:116] - Server key pair verified successfully
2025-01-01 15:50:52,604 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-01 15:50:52,605 - INFO - [chain.py:185] - Decrypted pre_master_secret: 030385fc1ee9148c7628e31dd04f69ba7699325c9b1e9df724c080ca2ea287cc75a99782daa14e99c0f424af9c0ebf07
2025-01-01 15:50:52,606 - INFO - [chain.py:195] - Generated master secret: 9754faea57232b8962d110b67cd5bffa87d9615f87fdf78e12b1e6587cd5e867a2095e1f184db6a278066912deeac965
2025-01-01 15:50:52,606 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-01 15:50:52,606 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-01 15:50:52,606 - INFO - [session.py:120] - Master Secret handled successfully
2025-01-01 15:50:52,607 - INFO - [client.py:269] - Pre-master secret validated successfully
2025-01-01 15:50:52,609 - INFO - [client.py:287] - Generated digital signature: 4487ba7a3909d3ef693d07f824715463b1e20cc4d1f8d05ecf27fdcf6aade833d5d288c961d1ac04cfe4c8003e746790dae8686d82ff7f5359b4e97d9ba868fdc751058d97322844f5556f05198d9bbf693cff49f047ee8f271374bca5394870806071f8851ea33dcc47cf8f1e59a085243a720b88e9c4aa2e8709f4430b0345fdee0ac013abe09f47971dd75a2a2749efc14019abacdce9e31be4137b5267d7fd55a7a329bb25058d1462a19563235f25ece74b0fa3847422223d1a82d2da8777fcf7b84e5a9efcc3b626009f4bb23d6f9d6f2ccc173692a10440d79ad56ab4b3149d023488121d894921d2db1ab772d25b1e98e0f063ac283b30eb26075fbb
2025-01-01 15:50:52,611 - INFO - [client.py:333] - Client ChangeCipherSpec and Finished messages sent
2025-01-01 15:50:52,612 - INFO - [session.py:125] - Client Change Cipher Spec sent successfully
2025-01-01 15:50:52,613 - INFO - [server.py:257] - Pre-master secret validated successfully
2025-01-01 15:50:52,614 - INFO - [server.py:275] - Generated digital signature: 3d6f5fcf3f04e53a6e1813829e5c0444c51a7f3b045113f51d24fe639004d1c7278072d0df1cea5415e30d48158c64ad868bee8be1abafe90b2be8d68a1d693c93db97ab5cd044674abef770b451b10a32ce63d43708171a37b5ca3bfa1afc1c788328aa474201d0dc33e349d632a59d9f9cdd868d9ef927ef23ed7ef96fb348ad8508c2de4bb3ab7659c7b59759948b8222070085ccb76b0c219859f933be75c63610befda87d91f895668115731f75ae9d09ab5e32a58bc7b5a43e28721b445a28c30cece6a083447aa16b685b85a9f9b9408cccf3cf06e9897bba3453ba655d4928ca205dbfb52c448c5c91639e6c8532a30e1d43f379f06badc22054278e
2025-01-01 15:50:52,615 - INFO - [server.py:321] - Server ChangeCipherSpec and Finished messages sent
2025-01-01 15:50:52,616 - INFO - [session.py:130] - Server Change Cipher Spec received successfully
2025-01-01 15:50:52,617 - INFO - [keys.py:212] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-01 15:50:52,618 - INFO - [session.py:135] - SSL Key Log handled successfully
2025-01-01 15:50:52,618 - INFO - [session.py:139] - TLS Handshake completed successfully
2025-01-01 15:50:52,618 - INFO - [session.py:186] - Handshake completed: True
2025-01-01 15:50:52,619 - INFO - [session.py:187] - Use client cert: False
2025-01-01 15:50:52,619 - INFO - [session.py:188] - File to send: None
2025-01-01 15:50:52,619 - INFO - [session.py:194] - Using unencrypted exchange
2025-01-01 15:50:52,620 - INFO - [session.py:294] - Added request packet
2025-01-01 15:50:52,620 - INFO - [session.py:294] - Added response packet
2025-01-01 15:50:52,620 - WARNING - [session.py:271] - Using unencrypted communication
2025-01-01 15:50:52,621 - INFO - [main.py:102] - Session completed successfully for 192.168.1.2
2025-01-01 15:50:52,621 - INFO - [pcap_writer.py:232] - Packet 13: Valid HTTP message
2025-01-01 15:50:52,621 - INFO - [pcap_writer.py:232] - Packet 14: Valid HTTP message
2025-01-01 15:50:52,628 - INFO - [pcap_writer.py:387] - Saved 15 valid packets to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-01 15:50:52,629 - INFO - [pcap_writer.py:409] - Verifying 15 packets...
2025-01-01 15:50:52,629 - INFO - [pcap_writer.py:413] - Packet 1: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 15:50:52,630 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2025-01-01 15:50:52,630 - INFO - [pcap_writer.py:413] - Packet 2: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 15:50:52,630 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2775
2025-01-01 15:50:52,631 - INFO - [pcap_writer.py:413] - Packet 3: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 15:50:52,631 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 1646
2025-01-01 15:50:52,631 - INFO - [pcap_writer.py:413] - Packet 4: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 15:50:52,631 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-01 15:50:52,632 - INFO - [pcap_writer.py:413] - Packet 5: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 15:50:52,632 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-01 15:50:52,632 - INFO - [pcap_writer.py:413] - Packet 6: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 15:50:52,632 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 160
2025-01-01 15:50:52,633 - INFO - [pcap_writer.py:413] - Packet 7: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 15:50:52,633 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 128
2025-01-01 15:50:52,633 - INFO - [pcap_writer.py:413] - Packet 8: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 15:50:52,633 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 1152
2025-01-01 15:50:52,633 - INFO - [pcap_writer.py:413] - Packet 9: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-01 15:50:52,634 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2025-01-01 15:50:52,634 - INFO - [pcap_writer.py:413] - Packet 10: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-01 15:50:52,634 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2775
2025-01-01 15:50:52,635 - INFO - [pcap_writer.py:413] - Packet 11: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-01 15:50:52,635 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 269
2025-01-01 15:50:52,635 - INFO - [pcap_writer.py:413] - Packet 12: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-01 15:50:52,636 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-01 15:50:52,636 - INFO - [pcap_writer.py:413] - Packet 13: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-01 15:50:52,636 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-01 15:50:52,636 - INFO - [pcap_writer.py:413] - Packet 14: IP / TCP 192.168.1.2:12346 > 10.0.0.1:http PA / Raw
2025-01-01 15:50:52,636 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2025-01-01 15:50:52,637 - INFO - [pcap_writer.py:413] - Packet 15: IP / TCP 10.0.0.1:http > 192.168.1.2:12346 PA / Raw
2025-01-01 15:50:52,637 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2025-01-01 15:50:52,637 - INFO - [pcap_writer.py:427] - Verification complete: 15 valid packets, 15 TLS records
2025-01-01 15:50:52,637 - INFO - [main.py:113] - Results saved to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-01 15:50:52,637 - INFO - [main.py:167] - TLS session simulation completed successfully
2025-01-01 16:13:55,643 - INFO - [logging.py:83] - Logging configured successfully
2025-01-01 16:13:55,644 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-01 16:13:55,645 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-01 16:13:55,645 - INFO - [logging.py:92] - Log level: 20
2025-01-01 16:13:55,645 - INFO - [logging.py:93] - Timestamp: 2025-01-01T16:13:55.645906
2025-01-01 16:13:55,646 - INFO - [logging.py:94] - ==========================
2025-01-01 16:13:55,646 - INFO - [main.py:129] - Starting TLS session simulation
2025-01-01 16:13:55,647 - INFO - [main.py:94] - 
--- Client Session (certificate) ---
2025-01-01 16:13:55,648 - INFO - [session.py:92] - Initialized cipher suite: TLS_AES-128_CBC_SHA256
2025-01-01 16:13:55,649 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-01 16:13:55,649 - INFO - [cert.py:108] - File exists: True
2025-01-01 16:13:55,649 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-01 16:13:55,650 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-01 16:13:55,650 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-01 16:13:55,651 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-01 16:13:55,655 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 16:13:55,655 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-01 16:13:55,655 - INFO - [cert.py:108] - File exists: True
2025-01-01 16:13:55,656 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-01 16:13:55,656 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-01 16:13:55,657 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-01 16:13:55,657 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-01 16:13:55,658 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 16:13:55,700 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-01 16:13:55,701 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-01 16:13:55,702 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-01 16:13:55,703 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-01 16:13:55,705 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-01 16:13:55,705 - INFO - [verify.py:58] - Public key comparison results:
2025-01-01 16:13:55,705 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 16:13:55,706 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 16:13:55,708 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-01 16:13:55,708 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-01 16:13:55,718 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-01 16:13:55,719 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-01 16:13:55,719 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-01 16:13:55,720 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-01 16:13:55,720 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-01 16:13:55,720 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-01 16:13:55,721 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-01 16:13:55,722 - INFO - [session.py:169] - Starting TLS session
2025-01-01 16:13:55,722 - INFO - [session.py:108] - Starting TLS Handshake...
2025-01-01 16:13:55,722 - INFO - [client.py:99] - Generated client_random: 67754da3b57aad5c55855a75a9d2f60756c9311668192153c85fee10b6b77638
2025-01-01 16:13:55,726 - INFO - [client.py:139] - Client Hello sent from 192.168.1.1
2025-01-01 16:13:55,729 - INFO - [session.py:113] - Client Hello sent successfully
2025-01-01 16:13:55,729 - INFO - [server.py:95] - Generated server_random: 67754da36ebfc6b24e79e8527531402f6b9a1db3d0275524f7588496438065e3
2025-01-01 16:13:55,735 - INFO - [session.py:118] - Server Hello received successfully
2025-01-01 16:13:55,736 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2025-01-01 16:13:55,737 - INFO - [cert.py:108] - File exists: True
2025-01-01 16:13:55,737 - INFO - [cert.py:109] - File size: 1915 bytes
2025-01-01 16:13:55,738 - INFO - [cert.py:113] - Read 1915 bytes
2025-01-01 16:13:55,739 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2025-01-01 16:13:55,739 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2025-01-01 16:13:55,740 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 16:13:55,740 - INFO - [client.py:173] - Prepared client certificate
2025-01-01 16:13:55,741 - INFO - [client.py:188] - Encrypted pre_master_secret length: 256
2025-01-01 16:13:55,744 - INFO - [session.py:123] - Client handshake messages sent successfully
2025-01-01 16:13:55,745 - INFO - [session.py:128] - Server key pair verified successfully
2025-01-01 16:13:55,746 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-01 16:13:55,747 - INFO - [chain.py:185] - Decrypted pre_master_secret: 03031038d195623ba6968f2aa247cb54b4b6ad12016f75ee231025ac2ac281643f58d6e3f435155047fdc255275fca9c
2025-01-01 16:13:55,747 - INFO - [chain.py:195] - Generated master secret: 0d78c29688180cdcadfdc44136802281ae03470e6d1230be34e96e5717afc74a6f462e491b1c55864070bd16181671fe
2025-01-01 16:13:55,747 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-01 16:13:55,748 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-01 16:13:55,748 - INFO - [session.py:132] - Master Secret handled successfully
2025-01-01 16:13:55,749 - INFO - [client.py:269] - Pre-master secret validated successfully
2025-01-01 16:13:55,750 - INFO - [client.py:287] - Generated digital signature: 0ebee739e379ce83d78737972a7e76bb3989cec783aaf6d22fa90b6df07baf04b6ddb041548ee88753b1f08f3240a41002c86c52a99e76b20fcbe5d368651b7ae66b18ba1c962d2397657dfcbec5b0543d14c8003cbb5da9f9e4346b631995594399ac5833a9ebe3b571b124b6968d9c845920185b37a3b3f45f310461180ee719e5944b5b146264a630e9ddeb1350eedef7c3c80c570fed89d2e2210927f33da0172e0d973e62e9975f470b775e4fc1ce53684f00e7e2494351b095b61bebe03b1af9f8af29ffae67e309addf349592d2cb058cb66089b0ff0a74958ff52ae51835ee994ecee7c4d785da1a1a460b1c837f0720d2b27254792ef014cc682e2a
2025-01-01 16:13:55,752 - INFO - [client.py:333] - Client ChangeCipherSpec and Finished messages sent
2025-01-01 16:13:55,753 - INFO - [session.py:137] - Client Change Cipher Spec sent successfully
2025-01-01 16:13:55,754 - INFO - [server.py:257] - Pre-master secret validated successfully
2025-01-01 16:13:55,755 - INFO - [server.py:275] - Generated digital signature: bc81400574526537e0f1c1295cc54c3f2b9819df2398cbad07b245790efbc21ed1b0f66a9d87202483f64dd0c82bf24264c5f4ff58fc0ffe32a42c13723a6c048d32da55d01a9e0d6c980d82f897aeb484daf842d494e50607c1e759c7d5f33f0aa2f6bece13a38cc4bb4bf1759711fe922ac772e3910d8b788be806a6bc71380877b4c10b0730894c500d823e6a9e76fa0e9018e0743d28317b4c6419e470a707594d912232476ccc642e2b567c98d7c16960890bbf637966795cfaa2a2e8e94db3966e24707149c75fa9b17c6a14269e1820fefc8d94065b2b68f1088d64e68dde9b3e945a73ecc2e74993859ef38653b5014b8aa0bc374d9a88a2527ee405
2025-01-01 16:13:55,756 - INFO - [server.py:321] - Server ChangeCipherSpec and Finished messages sent
2025-01-01 16:13:55,758 - INFO - [session.py:142] - Server Change Cipher Spec received successfully
2025-01-01 16:13:55,759 - INFO - [keys.py:209] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-01 16:13:55,759 - INFO - [session.py:147] - SSL Key Log handled successfully
2025-01-01 16:13:55,759 - INFO - [session.py:151] - TLS Handshake completed successfully
2025-01-01 16:13:55,760 - INFO - [session.py:180] - Found file to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 16:13:55,760 - INFO - [session.py:198] - Handshake completed: True
2025-01-01 16:13:55,761 - INFO - [session.py:199] - Use client cert: True
2025-01-01 16:13:55,761 - INFO - [session.py:200] - File to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 16:13:55,761 - INFO - [session.py:203] - Using encrypted exchange
2025-01-01 16:13:55,761 - INFO - [session.py:218] - Sending encrypted request data
2025-01-01 16:13:55,764 - INFO - [keys.py:185] - TLS Application Data sent from 192.168.1.1:12345 to 10.0.0.1:443
2025-01-01 16:13:55,764 - INFO - [session.py:229] - Sending encrypted response data
2025-01-01 16:13:55,766 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-01 16:13:55,766 - INFO - [session.py:241] - Attempting to send file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 16:13:55,766 - INFO - [session.py:252] - Opening file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 16:13:55,767 - INFO - [session.py:259] - Read 1103 bytes from file
2025-01-01 16:13:55,768 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-01 16:13:55,769 - INFO - [session.py:268] - File sent successfully
2025-01-01 16:13:55,769 - INFO - [session.py:243] - File sent successfully
2025-01-01 16:13:55,769 - INFO - [main.py:102] - Session completed successfully for 192.168.1.1
2025-01-01 16:13:55,769 - INFO - [main.py:94] - 
--- Client Session (no certificate) ---
2025-01-01 16:13:55,770 - INFO - [session.py:92] - Initialized cipher suite: TLS_AES-128_CBC_SHA256
2025-01-01 16:13:55,770 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-01 16:13:55,771 - INFO - [cert.py:108] - File exists: True
2025-01-01 16:13:55,771 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-01 16:13:55,771 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-01 16:13:55,772 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-01 16:13:55,772 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-01 16:13:55,772 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 16:13:55,773 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-01 16:13:55,773 - INFO - [cert.py:108] - File exists: True
2025-01-01 16:13:55,773 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-01 16:13:55,773 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-01 16:13:55,774 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-01 16:13:55,774 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-01 16:13:55,775 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 16:13:55,804 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-01 16:13:55,805 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-01 16:13:55,805 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-01 16:13:55,806 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-01 16:13:55,806 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-01 16:13:55,807 - INFO - [verify.py:58] - Public key comparison results:
2025-01-01 16:13:55,807 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 16:13:55,809 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 16:13:55,810 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-01 16:13:55,810 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-01 16:13:55,812 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-01 16:13:55,813 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-01 16:13:55,813 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-01 16:13:55,813 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-01 16:13:55,814 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-01 16:13:55,814 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-01 16:13:55,815 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-01 16:13:55,815 - INFO - [session.py:169] - Starting TLS session
2025-01-01 16:13:55,815 - INFO - [session.py:108] - Starting TLS Handshake...
2025-01-01 16:13:55,815 - INFO - [client.py:99] - Generated client_random: 67754da3b21c2fd2a963cbaf2ce10a827b7f61395bc73cb12b518370cd95a987
2025-01-01 16:13:55,817 - INFO - [client.py:139] - Client Hello sent from 192.168.1.2
2025-01-01 16:13:55,819 - INFO - [session.py:113] - Client Hello sent successfully
2025-01-01 16:13:55,819 - INFO - [server.py:95] - Generated server_random: 67754da3d5b974e1f6702df0939e87dbee83891fcc020c7aa1be8d5e9a7071e2
2025-01-01 16:13:55,825 - INFO - [session.py:118] - Server Hello received successfully
2025-01-01 16:13:55,826 - INFO - [client.py:176] - Prepared empty certificate
2025-01-01 16:13:55,826 - INFO - [client.py:188] - Encrypted pre_master_secret length: 256
2025-01-01 16:13:55,828 - INFO - [session.py:123] - Client handshake messages sent successfully
2025-01-01 16:13:55,830 - INFO - [session.py:128] - Server key pair verified successfully
2025-01-01 16:13:55,830 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-01 16:13:55,831 - INFO - [chain.py:185] - Decrypted pre_master_secret: 03035a5b4d3b5726a3f163ec929d84d6558e426fd5317a9e43e29b0a772e1664dd5777bcaa78a54af3377e3b181495ce
2025-01-01 16:13:55,832 - INFO - [chain.py:195] - Generated master secret: d99afcb2857b9540b19e6fbaef38c8419438141011bdccb838c0dc8c0d479d586c0954df64037fb9a752b41e3ddcf1bd
2025-01-01 16:13:55,832 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-01 16:13:55,832 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-01 16:13:55,833 - INFO - [session.py:132] - Master Secret handled successfully
2025-01-01 16:13:55,834 - INFO - [client.py:269] - Pre-master secret validated successfully
2025-01-01 16:13:55,835 - INFO - [client.py:287] - Generated digital signature: 1e28d33fbc05b3c8dc28281a4f47b3245970984ec6a217d557779782ff35d1a1d55c0a9b36d44cdfedb61427bcce5b3efaf15ba4c5f25f65cd7e285c98e570ae104308bb4cc9b79572373c9671c0d383f79f8bea91a5a51a528d80b6fdf10f16080e30b12803b429aad8eac8654108caf58883833f197147a81c3c175a80ab77d4a911aa0f14f9f3a5a110654d9702909c613aa312f4378979ef95d2bbfe45fe2af1d8b0a5fde268b293d10a2bb1408a7eee6f6bb2eb7d4a902d5b5df12b573f88a26c613cb9cfd37846e47b377ac509819257e84063d4f433659701b8d8c1cdaee3ff140cc3171195ded871c8864b0298772e219103d5b107b2dad96dd383cc
2025-01-01 16:13:55,836 - INFO - [client.py:333] - Client ChangeCipherSpec and Finished messages sent
2025-01-01 16:13:55,837 - INFO - [session.py:137] - Client Change Cipher Spec sent successfully
2025-01-01 16:13:55,838 - INFO - [server.py:257] - Pre-master secret validated successfully
2025-01-01 16:13:55,838 - INFO - [server.py:275] - Generated digital signature: 7b369e16ca17f806e690f92324937d5b5480ef1b95597140958132e06b6be76452ae3324c08fd3ac5a7b997b2198acb562ea16ef6abde112bf71e2d345e82091938545f5c733e3da03f0e6074cc78211c2400539caa2f5f775406ac18bf86fc71ede12bedb7ccbad73d808932147d16df4468f8acd4e307c7b19f5fc3e09eb65c39623afc3068a76028f8ae299d59ad701baa3372a91a1690af94ab4c125c0943f3c89ec62ace48e57c5326dcd5ff7da0c3e0b4997e54147cdd5b1e801de6a40c3f383fc36e2f0f98e4bb5cd896c6decc834dee8b3106428d9309b0cd891e17f9b3dade0afe2039f84a52ed6b885c0a4296c87b929811cf08483f37f7b46df01
2025-01-01 16:13:55,840 - INFO - [server.py:321] - Server ChangeCipherSpec and Finished messages sent
2025-01-01 16:13:55,842 - INFO - [session.py:142] - Server Change Cipher Spec received successfully
2025-01-01 16:13:55,843 - INFO - [keys.py:209] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-01 16:13:55,843 - INFO - [session.py:147] - SSL Key Log handled successfully
2025-01-01 16:13:55,844 - INFO - [session.py:151] - TLS Handshake completed successfully
2025-01-01 16:13:55,844 - INFO - [session.py:198] - Handshake completed: True
2025-01-01 16:13:55,845 - INFO - [session.py:199] - Use client cert: False
2025-01-01 16:13:55,845 - INFO - [session.py:200] - File to send: None
2025-01-01 16:13:55,846 - INFO - [session.py:206] - Using unencrypted exchange
2025-01-01 16:13:55,846 - INFO - [session.py:306] - Added request packet
2025-01-01 16:13:55,847 - INFO - [session.py:306] - Added response packet
2025-01-01 16:13:55,847 - WARNING - [session.py:283] - Using unencrypted communication
2025-01-01 16:13:55,847 - INFO - [main.py:102] - Session completed successfully for 192.168.1.2
2025-01-01 16:13:55,848 - INFO - [pcap_writer.py:232] - Packet 13: Valid HTTP message
2025-01-01 16:13:55,848 - INFO - [pcap_writer.py:232] - Packet 14: Valid HTTP message
2025-01-01 16:13:55,853 - INFO - [pcap_writer.py:387] - Saved 15 valid packets to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-01 16:13:55,853 - INFO - [pcap_writer.py:409] - Verifying 15 packets...
2025-01-01 16:13:55,854 - INFO - [pcap_writer.py:413] - Packet 1: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 16:13:55,854 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2025-01-01 16:13:55,855 - INFO - [pcap_writer.py:413] - Packet 2: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 16:13:55,855 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2775
2025-01-01 16:13:55,855 - INFO - [pcap_writer.py:413] - Packet 3: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 16:13:55,855 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 1646
2025-01-01 16:13:55,856 - INFO - [pcap_writer.py:413] - Packet 4: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 16:13:55,856 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-01 16:13:55,856 - INFO - [pcap_writer.py:413] - Packet 5: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 16:13:55,856 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-01 16:13:55,857 - INFO - [pcap_writer.py:413] - Packet 6: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 16:13:55,857 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 160
2025-01-01 16:13:55,858 - INFO - [pcap_writer.py:413] - Packet 7: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 16:13:55,858 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 128
2025-01-01 16:13:55,858 - INFO - [pcap_writer.py:413] - Packet 8: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 16:13:55,859 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 1152
2025-01-01 16:13:55,859 - INFO - [pcap_writer.py:413] - Packet 9: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-01 16:13:55,859 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2025-01-01 16:13:55,860 - INFO - [pcap_writer.py:413] - Packet 10: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-01 16:13:55,860 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2775
2025-01-01 16:13:55,861 - INFO - [pcap_writer.py:413] - Packet 11: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-01 16:13:55,861 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 269
2025-01-01 16:13:55,861 - INFO - [pcap_writer.py:413] - Packet 12: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-01 16:13:55,862 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-01 16:13:55,863 - INFO - [pcap_writer.py:413] - Packet 13: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-01 16:13:55,863 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-01 16:13:55,864 - INFO - [pcap_writer.py:413] - Packet 14: IP / TCP 192.168.1.2:12346 > 10.0.0.1:http PA / Raw
2025-01-01 16:13:55,864 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2025-01-01 16:13:55,865 - INFO - [pcap_writer.py:413] - Packet 15: IP / TCP 10.0.0.1:http > 192.168.1.2:12346 PA / Raw
2025-01-01 16:13:55,865 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2025-01-01 16:13:55,865 - INFO - [pcap_writer.py:427] - Verification complete: 15 valid packets, 15 TLS records
2025-01-01 16:13:55,865 - INFO - [main.py:113] - Results saved to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-01 16:13:55,866 - INFO - [main.py:167] - TLS session simulation completed successfully
2025-01-01 23:12:38,290 - INFO - [logging.py:83] - Logging configured successfully
2025-01-01 23:12:38,291 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-01 23:12:38,292 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-01 23:12:38,292 - INFO - [logging.py:92] - Log level: 20
2025-01-01 23:12:38,293 - INFO - [logging.py:93] - Timestamp: 2025-01-01T23:12:38.293146
2025-01-01 23:12:38,293 - INFO - [logging.py:94] - ==========================
2025-01-01 23:12:38,293 - INFO - [main.py:122] - Starting TLS session simulation
2025-01-01 23:12:38,294 - INFO - [main.py:87] - 
--- Client Session (certificate) ---
2025-01-01 23:12:38,296 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-01 23:12:38,297 - INFO - [cert.py:108] - File exists: True
2025-01-01 23:12:38,298 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-01 23:12:38,312 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-01 23:12:38,314 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-01 23:12:38,315 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-01 23:12:38,323 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 23:12:38,325 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-01 23:12:38,326 - INFO - [cert.py:108] - File exists: True
2025-01-01 23:12:38,327 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-01 23:12:38,340 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-01 23:12:38,341 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-01 23:12:38,341 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-01 23:12:38,342 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 23:12:38,394 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-01 23:12:38,395 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-01 23:12:38,396 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-01 23:12:38,397 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-01 23:12:38,420 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-01 23:12:38,420 - INFO - [verify.py:58] - Public key comparison results:
2025-01-01 23:12:38,421 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 23:12:38,422 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 23:12:38,424 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-01 23:12:38,424 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-01 23:12:38,435 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-01 23:12:38,437 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-01 23:12:38,438 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-01 23:12:38,438 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-01 23:12:38,439 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-01 23:12:38,440 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-01 23:12:38,441 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-01 23:12:38,442 - INFO - [session.py:176] - Starting TLS session
2025-01-01 23:12:38,443 - INFO - [session.py:115] - Starting TLS Handshake...
2025-01-01 23:12:38,444 - INFO - [client.py:99] - Generated client_random: 6775afc638ef0f4bf1b0364e494e2a0b6578b255287a96b6450d4f20b593f19c
2025-01-01 23:12:38,446 - INFO - [client.py:139] - Client Hello sent from 192.168.1.1
2025-01-01 23:12:38,450 - INFO - [session.py:120] - Client Hello sent successfully
2025-01-01 23:12:38,451 - INFO - [server.py:95] - Generated server_random: 6775afc69e04a367743f9aa29262ea9a9f614f07312bf0b05dd7e541bdb581d0
2025-01-01 23:12:38,456 - INFO - [session.py:125] - Server Hello received successfully
2025-01-01 23:12:38,457 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2025-01-01 23:12:38,459 - INFO - [cert.py:108] - File exists: True
2025-01-01 23:12:38,459 - INFO - [cert.py:109] - File size: 1915 bytes
2025-01-01 23:12:38,469 - INFO - [cert.py:113] - Read 1915 bytes
2025-01-01 23:12:38,470 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2025-01-01 23:12:38,471 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2025-01-01 23:12:38,472 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 23:12:38,473 - INFO - [client.py:173] - Prepared client certificate
2025-01-01 23:12:38,474 - INFO - [client.py:188] - Encrypted pre_master_secret length: 256
2025-01-01 23:12:38,476 - INFO - [session.py:130] - Client handshake messages sent successfully
2025-01-01 23:12:38,478 - INFO - [session.py:135] - Server key pair verified successfully
2025-01-01 23:12:38,479 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-01 23:12:38,480 - INFO - [chain.py:185] - Decrypted pre_master_secret: 0303904c8fc2f06f6d69c6e1cd8b4950e03e3d79ee7ca064063e2866bdde5546566a71af951dd6374fde71af2568fdc2
2025-01-01 23:12:38,481 - INFO - [chain.py:195] - Generated master secret: 0a7eac51ad16ebd1af84a72a10760b5bc52be197c498a35834d3ec89e9d8699d297a81f86372b1fbe7ba6821194df4cb
2025-01-01 23:12:38,482 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-01 23:12:38,483 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-01 23:12:38,484 - INFO - [session.py:139] - Master Secret handled successfully
2025-01-01 23:12:38,485 - INFO - [client.py:269] - Pre-master secret validated successfully
2025-01-01 23:12:38,486 - INFO - [client.py:287] - Generated digital signature: be1631fd0471496c397ac42d0310354a56f8ead1274dc05256a7680ad74f89215517d9e71e54412592b49a87c0d3fe9b6c886799b1b54c7abf7c24f153c62685329d2dc1b1cc0e7484de54e1b0a58e8674bc8555ecebed88a046c6ff23d40628b6489731c917c4d90ead28be17618d6c38acaaeb38644f5e48d1c91396819cfd05878afab7eb7281e71bf84246b58293ce375a65ae04cdbb07c8a29a2a04a3eedb17e3f42d11ca7614d2750acefeab271edb538c1400ca4a938fe4379e81ab2d9055000b75875f8402df38038c7c01422873f49dccdc775c03458bab1f3db1816f396a66441fc53c4b5aeda6187c7738c0ce4a624fc7a7335bdb339ba40be93f
2025-01-01 23:12:38,489 - INFO - [client.py:333] - Client ChangeCipherSpec and Finished messages sent
2025-01-01 23:12:38,491 - INFO - [session.py:144] - Client Change Cipher Spec sent successfully
2025-01-01 23:12:38,493 - INFO - [server.py:257] - Pre-master secret validated successfully
2025-01-01 23:12:38,494 - INFO - [server.py:275] - Generated digital signature: d9ca229e9b66e3d674bf0ff59c2424ee44541b5d1c41845c7cffad45dacd2c8aeda65bca928d3713f977082b49aa149b1b86b4049fecb367156e592d776c149a4d872162f20cb6245e8598df5de323d97d26267730ac703ba5b51423329dce0e53e5a9ef161bbe3c9e1499b2be77d28759d09e7b5491198b6c5159ede83eb784fe64d5a2a20b86fbd4b0e7494c961edcf3379ab75191f34dc46b9f1c40a4a1a08db25faa3556d3992550c066ccaa47f2f032408351ae9ce37bf7bb7999cbc953381fee810e731d32394ee1b1d91b4c469a5c871efb789eea401d054fd9a6ef7e472e5f31451da4c465e33613f4f1d9af5ee0bd1b364123f66823ab719e6a84e0
2025-01-01 23:12:38,496 - INFO - [server.py:321] - Server ChangeCipherSpec and Finished messages sent
2025-01-01 23:12:38,498 - INFO - [session.py:149] - Server Change Cipher Spec received successfully
2025-01-01 23:12:38,500 - INFO - [keys.py:209] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-01 23:12:38,501 - INFO - [session.py:154] - SSL Key Log handled successfully
2025-01-01 23:12:38,501 - INFO - [session.py:158] - TLS Handshake completed successfully
2025-01-01 23:12:38,502 - INFO - [session.py:187] - Found file to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 23:12:38,503 - INFO - [session.py:205] - Handshake completed: True
2025-01-01 23:12:38,503 - INFO - [session.py:206] - Use client cert: True
2025-01-01 23:12:38,504 - INFO - [session.py:207] - File to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 23:12:38,505 - INFO - [session.py:210] - Using encrypted exchange
2025-01-01 23:12:38,505 - INFO - [session.py:225] - Sending encrypted request data
2025-01-01 23:12:38,507 - INFO - [keys.py:185] - TLS Application Data sent from 192.168.1.1:12345 to 10.0.0.1:443
2025-01-01 23:12:38,507 - INFO - [session.py:236] - Sending encrypted response data
2025-01-01 23:12:38,509 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-01 23:12:38,510 - INFO - [session.py:248] - Attempting to send file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 23:12:38,511 - INFO - [session.py:259] - Opening file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 23:12:38,512 - INFO - [session.py:266] - Read 1103 bytes from file
2025-01-01 23:12:38,514 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-01 23:12:38,515 - INFO - [session.py:275] - File sent successfully
2025-01-01 23:12:38,516 - INFO - [session.py:250] - File sent successfully
2025-01-01 23:12:38,516 - INFO - [main.py:95] - Session completed successfully for 192.168.1.1
2025-01-01 23:12:38,517 - INFO - [main.py:87] - 
--- Client Session (no certificate) ---
2025-01-01 23:12:38,518 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-01 23:12:38,519 - INFO - [cert.py:108] - File exists: True
2025-01-01 23:12:38,519 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-01 23:12:38,520 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-01 23:12:38,520 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-01 23:12:38,521 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-01 23:12:38,523 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 23:12:38,523 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-01 23:12:38,524 - INFO - [cert.py:108] - File exists: True
2025-01-01 23:12:38,525 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-01 23:12:38,525 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-01 23:12:38,526 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-01 23:12:38,526 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-01 23:12:38,527 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 23:12:38,555 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-01 23:12:38,556 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-01 23:12:38,556 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-01 23:12:38,557 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-01 23:12:38,558 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-01 23:12:38,559 - INFO - [verify.py:58] - Public key comparison results:
2025-01-01 23:12:38,559 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 23:12:38,561 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 23:12:38,562 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-01 23:12:38,562 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-01 23:12:38,563 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-01 23:12:38,564 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-01 23:12:38,564 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-01 23:12:38,565 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-01 23:12:38,565 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-01 23:12:38,566 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-01 23:12:38,567 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-01 23:12:38,568 - INFO - [session.py:176] - Starting TLS session
2025-01-01 23:12:38,568 - INFO - [session.py:115] - Starting TLS Handshake...
2025-01-01 23:12:38,569 - INFO - [client.py:99] - Generated client_random: 6775afc6abcf05c4658b761bce74f8a8c4e58dae0f725dd4c0702fa3425493cd
2025-01-01 23:12:38,571 - INFO - [client.py:139] - Client Hello sent from 192.168.1.2
2025-01-01 23:12:38,573 - INFO - [session.py:120] - Client Hello sent successfully
2025-01-01 23:12:38,574 - INFO - [server.py:95] - Generated server_random: 6775afc65ed65997b902d5a7eb4421585b0563f5b9ba6a4ce5501e13193a27e2
2025-01-01 23:12:38,578 - INFO - [session.py:125] - Server Hello received successfully
2025-01-01 23:12:38,579 - INFO - [client.py:176] - Prepared empty certificate
2025-01-01 23:12:38,580 - INFO - [client.py:188] - Encrypted pre_master_secret length: 256
2025-01-01 23:12:38,582 - INFO - [session.py:130] - Client handshake messages sent successfully
2025-01-01 23:12:38,584 - INFO - [session.py:135] - Server key pair verified successfully
2025-01-01 23:12:38,584 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-01 23:12:38,585 - INFO - [chain.py:185] - Decrypted pre_master_secret: 03030b174426db93067cc564a57a817bb675967f9cb741b06b3e3c94dc32800d9c438ba61f198c35a68af2092c9ee3ec
2025-01-01 23:12:38,586 - INFO - [chain.py:195] - Generated master secret: dac0724857ff5644dd7ff6eaac8213c726e98418c1c80586aceefe28ba5f556d78245c13e0d3f1453ed459baeb18fdc4
2025-01-01 23:12:38,586 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-01 23:12:38,587 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-01 23:12:38,587 - INFO - [session.py:139] - Master Secret handled successfully
2025-01-01 23:12:38,588 - INFO - [client.py:269] - Pre-master secret validated successfully
2025-01-01 23:12:38,589 - INFO - [client.py:287] - Generated digital signature: 6adcd235b13fc60a986ca4f6954cc76b1f7ded6b0a938773b6d00962ee38ba37d48d76d3b4d9f75e19c7e8bf7c3223b81bd439b59ce0b9a8ddcc1265c3aa0fac3aa59eada412d0880177005c6ff69ddb9fb8526218940ccb220bb04c271ff230753892b9a17712a81f410a4e4b433e7a26f1e02865c8ddb3e1f1e727348e1d22364eef4895a976a0b9ddc8124b807eeaa33495eabe82b9d475d7874b656ed4b6be2b40019aedc9af190fb2aba250151f7068203f0b6ab0e9e128f44866f3f4ad284484d230d8a73c1e3494cfc7de5a140739801e5782e4b7955321d1abf5098c84ddc1f6515a0b73fbaa2ae21b16d99b55fdad4309534942da00779b675ebfa7
2025-01-01 23:12:38,591 - INFO - [client.py:333] - Client ChangeCipherSpec and Finished messages sent
2025-01-01 23:12:38,593 - INFO - [session.py:144] - Client Change Cipher Spec sent successfully
2025-01-01 23:12:38,595 - INFO - [server.py:257] - Pre-master secret validated successfully
2025-01-01 23:12:38,596 - INFO - [server.py:275] - Generated digital signature: 840cac47ba5cb65cde2e58940a28bf047bafc464beb799cad69a5623401f8cb9bcc6b73c57b12dc57215968d6964f435822c10678d7388f0a5f7592a8749704f5174471237908ddef9f2b24f8b98104fa283023faa532d2eed0cc8ef875aafe5bedbf6879cea8784f938ee78859989b933a097f676c8fa39a1293b44ffb00b9dab073362952e2d1e60780683b9416a870277512297f8ba93dde9c5eb235ff4db7d4ae62d90e79649e434f7e209737bd68ecebd10b94fc888b2bed1d6646a86ccb8e667b384d1216093822d505a7ce4777c1600fdcfd2488f055131b8dddaa13e6e4d37fb08555aa1e3217c90176151a872bf2a715af98e854a57976253b07fe7
2025-01-01 23:12:38,598 - INFO - [server.py:321] - Server ChangeCipherSpec and Finished messages sent
2025-01-01 23:12:38,599 - INFO - [session.py:149] - Server Change Cipher Spec received successfully
2025-01-01 23:12:38,600 - INFO - [keys.py:209] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-01 23:12:38,600 - INFO - [session.py:154] - SSL Key Log handled successfully
2025-01-01 23:12:38,601 - INFO - [session.py:158] - TLS Handshake completed successfully
2025-01-01 23:12:38,601 - INFO - [session.py:205] - Handshake completed: True
2025-01-01 23:12:38,601 - INFO - [session.py:206] - Use client cert: False
2025-01-01 23:12:38,601 - INFO - [session.py:207] - File to send: None
2025-01-01 23:12:38,602 - INFO - [session.py:213] - Using unencrypted exchange
2025-01-01 23:12:38,602 - INFO - [session.py:313] - Added request packet
2025-01-01 23:12:38,603 - INFO - [session.py:313] - Added response packet
2025-01-01 23:12:38,603 - WARNING - [session.py:290] - Using unencrypted communication
2025-01-01 23:12:38,603 - INFO - [main.py:95] - Session completed successfully for 192.168.1.2
2025-01-01 23:12:38,604 - INFO - [pcap_writer.py:232] - Packet 13: Valid HTTP message
2025-01-01 23:12:38,604 - INFO - [pcap_writer.py:232] - Packet 14: Valid HTTP message
2025-01-01 23:12:38,609 - INFO - [pcap_writer.py:387] - Saved 15 valid packets to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-01 23:12:38,610 - INFO - [pcap_writer.py:409] - Verifying 15 packets...
2025-01-01 23:12:38,611 - INFO - [pcap_writer.py:413] - Packet 1: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 23:12:38,612 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2025-01-01 23:12:38,612 - INFO - [pcap_writer.py:413] - Packet 2: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 23:12:38,613 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2775
2025-01-01 23:12:38,613 - INFO - [pcap_writer.py:413] - Packet 3: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 23:12:38,613 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 1646
2025-01-01 23:12:38,613 - INFO - [pcap_writer.py:413] - Packet 4: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 23:12:38,614 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-01 23:12:38,614 - INFO - [pcap_writer.py:413] - Packet 5: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 23:12:38,614 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-01 23:12:38,615 - INFO - [pcap_writer.py:413] - Packet 6: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 23:12:38,615 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 160
2025-01-01 23:12:38,615 - INFO - [pcap_writer.py:413] - Packet 7: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 23:12:38,615 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 128
2025-01-01 23:12:38,616 - INFO - [pcap_writer.py:413] - Packet 8: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 23:12:38,616 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 1152
2025-01-01 23:12:38,617 - INFO - [pcap_writer.py:413] - Packet 9: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-01 23:12:38,617 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2025-01-01 23:12:38,617 - INFO - [pcap_writer.py:413] - Packet 10: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-01 23:12:38,617 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2775
2025-01-01 23:12:38,618 - INFO - [pcap_writer.py:413] - Packet 11: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-01 23:12:38,619 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 269
2025-01-01 23:12:38,619 - INFO - [pcap_writer.py:413] - Packet 12: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-01 23:12:38,620 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-01 23:12:38,620 - INFO - [pcap_writer.py:413] - Packet 13: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-01 23:12:38,621 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-01 23:12:38,621 - INFO - [pcap_writer.py:413] - Packet 14: IP / TCP 192.168.1.2:12346 > 10.0.0.1:http PA / Raw
2025-01-01 23:12:38,621 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2025-01-01 23:12:38,622 - INFO - [pcap_writer.py:413] - Packet 15: IP / TCP 10.0.0.1:http > 192.168.1.2:12346 PA / Raw
2025-01-01 23:12:38,622 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2025-01-01 23:12:38,622 - INFO - [pcap_writer.py:427] - Verification complete: 15 valid packets, 15 TLS records
2025-01-01 23:12:38,623 - INFO - [main.py:106] - Results saved to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-01 23:12:38,623 - INFO - [main.py:160] - TLS session simulation completed successfully
2025-01-01 23:17:55,814 - INFO - [logging.py:83] - Logging configured successfully
2025-01-01 23:17:55,815 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-01 23:17:55,816 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-01 23:17:55,816 - INFO - [logging.py:92] - Log level: 20
2025-01-01 23:17:55,817 - INFO - [logging.py:93] - Timestamp: 2025-01-01T23:17:55.817185
2025-01-01 23:17:55,818 - INFO - [logging.py:94] - ==========================
2025-01-01 23:17:55,818 - INFO - [main.py:122] - Starting TLS session simulation
2025-01-01 23:17:55,819 - INFO - [main.py:87] - 
--- Client Session (certificate) ---
2025-01-01 23:17:55,820 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-01 23:17:55,821 - INFO - [cert.py:108] - File exists: True
2025-01-01 23:17:55,821 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-01 23:17:55,822 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-01 23:17:55,823 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-01 23:17:55,823 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-01 23:17:55,829 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 23:17:55,830 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-01 23:17:55,833 - INFO - [cert.py:108] - File exists: True
2025-01-01 23:17:55,835 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-01 23:17:55,836 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-01 23:17:55,837 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-01 23:17:55,838 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-01 23:17:55,840 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 23:17:55,878 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-01 23:17:55,879 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-01 23:17:55,879 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-01 23:17:55,881 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-01 23:17:55,884 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-01 23:17:55,885 - INFO - [verify.py:58] - Public key comparison results:
2025-01-01 23:17:55,885 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 23:17:55,886 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 23:17:55,887 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-01 23:17:55,888 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-01 23:17:55,897 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-01 23:17:55,898 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-01 23:17:55,899 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-01 23:17:55,900 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-01 23:17:55,900 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-01 23:17:55,901 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-01 23:17:55,903 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-01 23:17:55,904 - INFO - [session.py:179] - Starting TLS session
2025-01-01 23:17:55,904 - INFO - [session.py:118] - Starting TLS Handshake...
2025-01-01 23:17:55,905 - INFO - [client.py:97] - Using cipher suite: 60
2025-01-01 23:17:55,905 - INFO - [client.py:102] - Generated client_random: 6775b103aaf84f1fd33446cedab100ad375ecb56191f0051e8810eed9140015b
2025-01-01 23:17:55,907 - ERROR - [main.py:27] - Session error: Session failed for 192.168.1.1: Session failed: Failed to send Client Hello: cipher_suites
2025-01-01 23:18:37,309 - INFO - [logging.py:83] - Logging configured successfully
2025-01-01 23:18:37,311 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-01 23:18:37,313 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-01 23:18:37,315 - INFO - [logging.py:92] - Log level: 20
2025-01-01 23:18:37,317 - INFO - [logging.py:93] - Timestamp: 2025-01-01T23:18:37.316929
2025-01-01 23:18:37,319 - INFO - [logging.py:94] - ==========================
2025-01-01 23:18:37,320 - INFO - [main.py:122] - Starting TLS session simulation
2025-01-01 23:18:37,323 - INFO - [main.py:87] - 
--- Client Session (certificate) ---
2025-01-01 23:18:37,327 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-01 23:18:37,331 - INFO - [cert.py:108] - File exists: True
2025-01-01 23:18:37,334 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-01 23:18:37,339 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-01 23:18:37,341 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-01 23:18:37,347 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-01 23:18:37,353 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 23:18:37,356 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-01 23:18:37,360 - INFO - [cert.py:108] - File exists: True
2025-01-01 23:18:37,362 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-01 23:18:37,365 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-01 23:18:37,368 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-01 23:18:37,376 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-01 23:18:37,379 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 23:18:37,443 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-01 23:18:37,444 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-01 23:18:37,445 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-01 23:18:37,445 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-01 23:18:37,449 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-01 23:18:37,451 - INFO - [verify.py:58] - Public key comparison results:
2025-01-01 23:18:37,452 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 23:18:37,453 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 23:18:37,454 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-01 23:18:37,455 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-01 23:18:37,465 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-01 23:18:37,467 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-01 23:18:37,467 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-01 23:18:37,468 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-01 23:18:37,469 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-01 23:18:37,469 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-01 23:18:37,471 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-01 23:18:37,472 - INFO - [session.py:179] - Starting TLS session
2025-01-01 23:18:37,473 - INFO - [session.py:118] - Starting TLS Handshake...
2025-01-01 23:18:37,474 - INFO - [client.py:97] - Using cipher suite: 60
2025-01-01 23:18:37,475 - INFO - [client.py:102] - Generated client_random: 6775b12da5af2899b261a14f0833493f46693b968c0d80e7e4009f37f3ebf01a
2025-01-01 23:18:37,478 - ERROR - [main.py:27] - Session error: Session failed for 192.168.1.1: Session failed: Failed to send Client Hello: cipher
2025-01-01 23:19:07,573 - INFO - [logging.py:83] - Logging configured successfully
2025-01-01 23:19:07,573 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-01 23:19:07,574 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-01 23:19:07,574 - INFO - [logging.py:92] - Log level: 20
2025-01-01 23:19:07,574 - INFO - [logging.py:93] - Timestamp: 2025-01-01T23:19:07.574731
2025-01-01 23:19:07,574 - INFO - [logging.py:94] - ==========================
2025-01-01 23:19:07,575 - INFO - [main.py:122] - Starting TLS session simulation
2025-01-01 23:19:07,575 - INFO - [main.py:87] - 
--- Client Session (certificate) ---
2025-01-01 23:19:07,576 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-01 23:19:07,576 - INFO - [cert.py:108] - File exists: True
2025-01-01 23:19:07,576 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-01 23:19:07,577 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-01 23:19:07,577 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-01 23:19:07,577 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-01 23:19:07,578 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 23:19:07,578 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-01 23:19:07,579 - INFO - [cert.py:108] - File exists: True
2025-01-01 23:19:07,580 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-01 23:19:07,580 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-01 23:19:07,581 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-01 23:19:07,581 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-01 23:19:07,582 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 23:19:07,613 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-01 23:19:07,613 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-01 23:19:07,614 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-01 23:19:07,614 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-01 23:19:07,618 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-01 23:19:07,618 - INFO - [verify.py:58] - Public key comparison results:
2025-01-01 23:19:07,619 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 23:19:07,620 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 23:19:07,620 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-01 23:19:07,621 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-01 23:19:07,624 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-01 23:19:07,624 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-01 23:19:07,625 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-01 23:19:07,625 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-01 23:19:07,626 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-01 23:19:07,626 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-01 23:19:07,627 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-01 23:19:07,628 - INFO - [session.py:179] - Starting TLS session
2025-01-01 23:19:07,629 - INFO - [session.py:118] - Starting TLS Handshake...
2025-01-01 23:19:07,629 - INFO - [client.py:97] - Using cipher suite: 60
2025-01-01 23:19:07,630 - INFO - [client.py:102] - Generated client_random: 6775b14b2870a4ba453a015b5f5a5e084b1d2aef6652c9d185fbb99712ba425a
2025-01-01 23:19:07,632 - ERROR - [main.py:27] - Session error: Session failed for 192.168.1.1: Session failed: Failed to send Client Hello: cipher
2025-01-01 23:20:18,961 - INFO - [logging.py:83] - Logging configured successfully
2025-01-01 23:20:18,962 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-01 23:20:18,962 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-01 23:20:18,963 - INFO - [logging.py:92] - Log level: 20
2025-01-01 23:20:18,964 - INFO - [logging.py:93] - Timestamp: 2025-01-01T23:20:18.964319
2025-01-01 23:20:18,964 - INFO - [logging.py:94] - ==========================
2025-01-01 23:20:18,965 - INFO - [main.py:122] - Starting TLS session simulation
2025-01-01 23:20:18,966 - INFO - [main.py:87] - 
--- Client Session (certificate) ---
2025-01-01 23:20:18,968 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-01 23:20:18,969 - INFO - [cert.py:108] - File exists: True
2025-01-01 23:20:18,969 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-01 23:20:18,970 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-01 23:20:18,971 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-01 23:20:18,971 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-01 23:20:18,973 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 23:20:18,974 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-01 23:20:18,975 - INFO - [cert.py:108] - File exists: True
2025-01-01 23:20:18,976 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-01 23:20:18,977 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-01 23:20:18,978 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-01 23:20:18,980 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-01 23:20:18,981 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 23:20:19,017 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-01 23:20:19,018 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-01 23:20:19,018 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-01 23:20:19,019 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-01 23:20:19,021 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-01 23:20:19,021 - INFO - [verify.py:58] - Public key comparison results:
2025-01-01 23:20:19,021 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 23:20:19,023 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 23:20:19,024 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-01 23:20:19,024 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-01 23:20:19,030 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-01 23:20:19,031 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-01 23:20:19,031 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-01 23:20:19,032 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-01 23:20:19,032 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-01 23:20:19,033 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-01 23:20:19,034 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-01 23:20:19,035 - INFO - [session.py:179] - Starting TLS session
2025-01-01 23:20:19,035 - INFO - [session.py:118] - Starting TLS Handshake...
2025-01-01 23:20:19,036 - INFO - [client.py:98] - Using cipher suite: 60
2025-01-01 23:20:19,036 - INFO - [client.py:103] - Generated client_random: 6775b1934a69a301eb58a5f90f1fdbb32d095e5a8b11b40d8a532e990a9f218c
2025-01-01 23:20:19,037 - ERROR - [main.py:27] - Session error: Session failed for 192.168.1.1: Session failed: Failed to send Client Hello: compression_methods
2025-01-01 23:21:28,239 - INFO - [logging.py:83] - Logging configured successfully
2025-01-01 23:21:28,240 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-01 23:21:28,240 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-01 23:21:28,240 - INFO - [logging.py:92] - Log level: 20
2025-01-01 23:21:28,241 - INFO - [logging.py:93] - Timestamp: 2025-01-01T23:21:28.241044
2025-01-01 23:21:28,241 - INFO - [logging.py:94] - ==========================
2025-01-01 23:21:28,241 - INFO - [main.py:122] - Starting TLS session simulation
2025-01-01 23:21:28,241 - INFO - [main.py:87] - 
--- Client Session (certificate) ---
2025-01-01 23:21:28,242 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-01 23:21:28,242 - INFO - [cert.py:108] - File exists: True
2025-01-01 23:21:28,243 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-01 23:21:28,243 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-01 23:21:28,243 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-01 23:21:28,244 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-01 23:21:28,244 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 23:21:28,245 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-01 23:21:28,245 - INFO - [cert.py:108] - File exists: True
2025-01-01 23:21:28,246 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-01 23:21:28,246 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-01 23:21:28,246 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-01 23:21:28,247 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-01 23:21:28,247 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 23:21:28,276 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-01 23:21:28,277 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-01 23:21:28,278 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-01 23:21:28,279 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-01 23:21:28,282 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-01 23:21:28,282 - INFO - [verify.py:58] - Public key comparison results:
2025-01-01 23:21:28,283 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 23:21:28,284 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 23:21:28,285 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-01 23:21:28,285 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-01 23:21:28,292 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-01 23:21:28,294 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-01 23:21:28,295 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-01 23:21:28,295 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-01 23:21:28,297 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-01 23:21:28,297 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-01 23:21:28,299 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-01 23:21:28,300 - INFO - [session.py:179] - Starting TLS session
2025-01-01 23:21:28,301 - INFO - [session.py:118] - Starting TLS Handshake...
2025-01-01 23:21:28,301 - INFO - [client.py:98] - Using cipher suite: 60
2025-01-01 23:21:28,301 - INFO - [client.py:103] - Generated client_random: 6775b1d8db7d20b8c1077eb3f386116335bbc00954f27eeb262ea1b60cdf2f82
2025-01-01 23:21:28,303 - ERROR - [main.py:27] - Session error: Session failed for 192.168.1.1: Session failed: Failed to send Client Hello: compression_methods
2025-01-01 23:28:49,227 - INFO - [logging.py:83] - Logging configured successfully
2025-01-01 23:28:49,228 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-01 23:28:49,228 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-01 23:28:49,229 - INFO - [logging.py:92] - Log level: 20
2025-01-01 23:28:49,230 - INFO - [logging.py:93] - Timestamp: 2025-01-01T23:28:49.230111
2025-01-01 23:28:49,230 - INFO - [logging.py:94] - ==========================
2025-01-01 23:28:49,231 - INFO - [main.py:122] - Starting TLS session simulation
2025-01-01 23:28:49,232 - INFO - [main.py:87] - 
--- Client Session (certificate) ---
2025-01-01 23:28:49,235 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-01 23:28:49,237 - INFO - [cert.py:108] - File exists: True
2025-01-01 23:28:49,238 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-01 23:28:49,239 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-01 23:28:49,241 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-01 23:28:49,243 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-01 23:28:49,245 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 23:28:49,246 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-01 23:28:49,248 - INFO - [cert.py:108] - File exists: True
2025-01-01 23:28:49,250 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-01 23:28:49,252 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-01 23:28:49,253 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-01 23:28:49,255 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-01 23:28:49,260 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 23:28:49,309 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-01 23:28:49,310 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-01 23:28:49,311 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-01 23:28:49,311 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-01 23:28:49,313 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-01 23:28:49,314 - INFO - [verify.py:58] - Public key comparison results:
2025-01-01 23:28:49,314 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 23:28:49,315 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 23:28:49,315 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-01 23:28:49,316 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-01 23:28:49,321 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-01 23:28:49,322 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-01 23:28:49,323 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-01 23:28:49,323 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-01 23:28:49,324 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-01 23:28:49,334 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-01 23:28:49,335 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-01 23:28:49,336 - INFO - [session.py:179] - Starting TLS session
2025-01-01 23:28:49,336 - INFO - [session.py:118] - Starting TLS Handshake...
2025-01-01 23:28:49,336 - INFO - [client.py:97] - Using cipher suite: 60
2025-01-01 23:28:49,336 - INFO - [client.py:102] - Generated client_random: 6775b391055dcf717c8c5c9d985c868809e0877bd4e1da1bb543605e64c21aa0
2025-01-01 23:28:49,339 - INFO - [client.py:142] - Client Hello sent from 192.168.1.1
2025-01-01 23:28:49,345 - INFO - [session.py:123] - Client Hello sent successfully
2025-01-01 23:28:49,347 - INFO - [server.py:95] - Generated server_random: 6775b391217760ebcf9f64d915c7a9c24451218b0a387db323f69be0fdd62bf8
2025-01-01 23:28:49,354 - INFO - [session.py:128] - Server Hello received successfully
2025-01-01 23:28:49,356 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2025-01-01 23:28:49,358 - INFO - [cert.py:108] - File exists: True
2025-01-01 23:28:49,360 - INFO - [cert.py:109] - File size: 1915 bytes
2025-01-01 23:28:49,362 - INFO - [cert.py:113] - Read 1915 bytes
2025-01-01 23:28:49,363 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2025-01-01 23:28:49,365 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2025-01-01 23:28:49,367 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 23:28:49,370 - INFO - [client.py:176] - Prepared client certificate
2025-01-01 23:28:49,374 - INFO - [client.py:191] - Encrypted pre_master_secret length: 256
2025-01-01 23:28:49,379 - INFO - [session.py:133] - Client handshake messages sent successfully
2025-01-01 23:28:49,382 - INFO - [session.py:138] - Server key pair verified successfully
2025-01-01 23:28:49,383 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-01 23:28:49,384 - INFO - [chain.py:185] - Decrypted pre_master_secret: 0303a65ddb2b95a7c17777bc9d5833df5503bb9350dc46357f08b76ff8da39eb7e1096f268a46ded936cde47d65f6db9
2025-01-01 23:28:49,385 - INFO - [chain.py:195] - Generated master secret: 14448e0b52e35b3f6a307dcc2101e26225a9f309ae556e28bf6ec965d82bf65f336c2a3c20279566b0bcfd1a79779f20
2025-01-01 23:28:49,386 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-01 23:28:49,386 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-01 23:28:49,387 - INFO - [session.py:142] - Master Secret handled successfully
2025-01-01 23:28:49,389 - INFO - [client.py:272] - Pre-master secret validated successfully
2025-01-01 23:28:49,393 - INFO - [client.py:290] - Generated digital signature: b15de94956f850de14e1f988de24d2cf614a5974dc402a391c34de0a0150207fc66525381851e802528c767e7eb4b15622a12401b41c7bb4d07726f4f09153f778a437803c9dfb2e53b0eae7de392546e330ed0132afea91382692cf6a53e76a1d921a6bf67468b28ddf9a8926086192a26ed39590f007b042b9f62a3fbeca7b588b632e60c7c39753f7b0c83ddb1edccf8d9ad54093751b25d3b3f88d3eb2c5827af0227950c4b2144034b80aead245525ff9490b8af0ba99c408a5826e3702b82911b68d1ee8d6d51cda9790620001ba286c87e9b8adb84b0fe695f966c21de31c2dface957bb735ef68f497696c6fe1717be6cb02d7b1501744b5715ff913
2025-01-01 23:28:49,401 - INFO - [client.py:336] - Client ChangeCipherSpec and Finished messages sent
2025-01-01 23:28:49,403 - INFO - [session.py:147] - Client Change Cipher Spec sent successfully
2025-01-01 23:28:49,405 - INFO - [server.py:257] - Pre-master secret validated successfully
2025-01-01 23:28:49,408 - INFO - [server.py:275] - Generated digital signature: 21eee2d21005c065917cc6815b01faf0d83d7fd6658613ac65f0853437754ba48b36df46f54ce8f4e5c070ea900d4a5f62463f3938ca3f2b3c2523e3cf5ea08184ecd7410fe18e12f62627bfaad311754124d7308133cece7401f54bc71500e121162e9e7c3e6c3950a0f9557d7a74c41b6478330dfb4e13b568721bd66f349ac28407b50981ace946276a483f41f92474d33f57f427d17e92f8293658dc995e8a01e2c730daa8290a31a6d994bff874a6868d023b3e7cc26499aa3b9b89ae01739b94117e488ac097f7ba5e9e980d78b30e9239e5d3a8a0e4a5a30137c420dd88be8fe69bc7a69119f102578a5040c2ca776fed4e370c191ff43658c5f96046
2025-01-01 23:28:49,415 - INFO - [server.py:321] - Server ChangeCipherSpec and Finished messages sent
2025-01-01 23:28:49,417 - INFO - [session.py:152] - Server Change Cipher Spec received successfully
2025-01-01 23:28:49,418 - INFO - [keys.py:209] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-01 23:28:49,419 - INFO - [session.py:157] - SSL Key Log handled successfully
2025-01-01 23:28:49,420 - INFO - [session.py:161] - TLS Handshake completed successfully
2025-01-01 23:28:49,421 - INFO - [session.py:190] - Found file to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 23:28:49,421 - INFO - [session.py:208] - Handshake completed: True
2025-01-01 23:28:49,422 - INFO - [session.py:209] - Use client cert: True
2025-01-01 23:28:49,423 - INFO - [session.py:210] - File to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 23:28:49,425 - INFO - [session.py:213] - Using encrypted exchange
2025-01-01 23:28:49,427 - INFO - [session.py:228] - Sending encrypted request data
2025-01-01 23:28:49,432 - INFO - [keys.py:185] - TLS Application Data sent from 192.168.1.1:12345 to 10.0.0.1:443
2025-01-01 23:28:49,434 - INFO - [session.py:239] - Sending encrypted response data
2025-01-01 23:28:49,437 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-01 23:28:49,438 - INFO - [session.py:251] - Attempting to send file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 23:28:49,440 - INFO - [session.py:262] - Opening file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 23:28:49,443 - INFO - [session.py:269] - Read 1103 bytes from file
2025-01-01 23:28:49,447 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-01 23:28:49,449 - INFO - [session.py:278] - File sent successfully
2025-01-01 23:28:49,450 - INFO - [session.py:253] - File sent successfully
2025-01-01 23:28:49,451 - INFO - [main.py:95] - Session completed successfully for 192.168.1.1
2025-01-01 23:28:49,453 - INFO - [main.py:87] - 
--- Client Session (no certificate) ---
2025-01-01 23:28:49,455 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-01 23:28:49,458 - INFO - [cert.py:108] - File exists: True
2025-01-01 23:28:49,460 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-01 23:28:49,462 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-01 23:28:49,464 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-01 23:28:49,467 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-01 23:28:49,472 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 23:28:49,475 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-01 23:28:49,478 - INFO - [cert.py:108] - File exists: True
2025-01-01 23:28:49,481 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-01 23:28:49,484 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-01 23:28:49,485 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-01 23:28:49,486 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-01 23:28:49,488 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 23:28:49,539 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-01 23:28:49,540 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-01 23:28:49,541 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-01 23:28:49,541 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-01 23:28:49,542 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-01 23:28:49,544 - INFO - [verify.py:58] - Public key comparison results:
2025-01-01 23:28:49,544 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 23:28:49,545 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 23:28:49,546 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-01 23:28:49,547 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-01 23:28:49,548 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-01 23:28:49,548 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-01 23:28:49,549 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-01 23:28:49,549 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-01 23:28:49,549 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-01 23:28:49,550 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-01 23:28:49,552 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-01 23:28:49,553 - INFO - [session.py:179] - Starting TLS session
2025-01-01 23:28:49,554 - INFO - [session.py:118] - Starting TLS Handshake...
2025-01-01 23:28:49,555 - INFO - [client.py:97] - Using cipher suite: 60
2025-01-01 23:28:49,556 - INFO - [client.py:102] - Generated client_random: 6775b39183d7bf0312675ee21364036578fdc9d4a487b260ca7ce71337f29110
2025-01-01 23:28:49,561 - INFO - [client.py:142] - Client Hello sent from 192.168.1.2
2025-01-01 23:28:49,566 - INFO - [session.py:123] - Client Hello sent successfully
2025-01-01 23:28:49,567 - INFO - [server.py:95] - Generated server_random: 6775b391f46448b53a63ada5c355dc2328964b6ee7f71402b1e076b1e96b533a
2025-01-01 23:28:49,571 - INFO - [session.py:128] - Server Hello received successfully
2025-01-01 23:28:49,573 - INFO - [client.py:179] - Prepared empty certificate
2025-01-01 23:28:49,574 - INFO - [client.py:191] - Encrypted pre_master_secret length: 256
2025-01-01 23:28:49,577 - INFO - [session.py:133] - Client handshake messages sent successfully
2025-01-01 23:28:49,579 - INFO - [session.py:138] - Server key pair verified successfully
2025-01-01 23:28:49,580 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-01 23:28:49,581 - INFO - [chain.py:185] - Decrypted pre_master_secret: 0303a5e25ae20e0ff6ca66fbbd2859c83871d19b68e28768d3204578fef82d959b5329d40152603bba8adcc90f245cec
2025-01-01 23:28:49,581 - INFO - [chain.py:195] - Generated master secret: f4d650e704e7c4bb53f79a7c3dbe0c997e0640762161f8c731d93eecf4b5fc800a7233f36b1f8446d8c5f4061cbb36f4
2025-01-01 23:28:49,582 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-01 23:28:49,583 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-01 23:28:49,583 - INFO - [session.py:142] - Master Secret handled successfully
2025-01-01 23:28:49,584 - INFO - [client.py:272] - Pre-master secret validated successfully
2025-01-01 23:28:49,585 - INFO - [client.py:290] - Generated digital signature: 6c702f315bea758bd12d95c07064a33f4dbd871191a05b05393b19057f52243343a74f286c6da03245b33721a970aeeb34de0f50ed6f81b9746cc5660c924e07f9e63bbbecd1f6df75899fc084849d8f66005407f95bdc9d6b48dfe87e893a9e2cbf7e9460e4d282d05b1940b20e589bcbe7fb3f5bcd6350ffe8797a816a4cbd4067a951ec9f41e27e35b7022f55534f1ea2a75c9f4fe353bdea826eedfcfb260dec63cdeb6228bbc484782eacff38f7d7b8fa9c1a75681f715ab7ecffc59e0aa53e41cfeee8825abd34755773c536c5719b314cc7a19ca596722a8ed1e99002d9430ac87ff214406957b04f9fb0093fe867484b3b49f7e974641fe23861a84e
2025-01-01 23:28:49,588 - INFO - [client.py:336] - Client ChangeCipherSpec and Finished messages sent
2025-01-01 23:28:49,591 - INFO - [session.py:147] - Client Change Cipher Spec sent successfully
2025-01-01 23:28:49,595 - INFO - [server.py:257] - Pre-master secret validated successfully
2025-01-01 23:28:49,597 - INFO - [server.py:275] - Generated digital signature: d682b5684f255fe95e950e49d2e12face11e11a65705356f371e293caa6681d6863abb7fdbf0f07269f7e6093dd05736526f4f1e0796d34530c51431929074aaac3f13f3005a9154ff71da7d927b42f7c6136d4aef4e47d7f511fcf2e5b274f2681f1e76f350e37ec5766bc6a101d26b0db8c7ad8b9b33803fcb9667fba02a75bb1151aa327da3cab1a35947f4ee3879d86715dcf4babcb8b57fa76599d28a1dbede007ae6fc1dab0a4f98265755dd1d67ad4a622afe22c19307ceae5c4b59508cb319060a772f6420e15b475aee401f0b70cc5a5f4caf9549ced0208645704844c1acb537a4b615be4f3e5f7f141eb1e63a6d94d98cab72c06b187ef15c1dea
2025-01-01 23:28:49,599 - INFO - [server.py:321] - Server ChangeCipherSpec and Finished messages sent
2025-01-01 23:28:49,600 - INFO - [session.py:152] - Server Change Cipher Spec received successfully
2025-01-01 23:28:49,602 - INFO - [keys.py:209] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-01 23:28:49,603 - INFO - [session.py:157] - SSL Key Log handled successfully
2025-01-01 23:28:49,604 - INFO - [session.py:161] - TLS Handshake completed successfully
2025-01-01 23:28:49,606 - INFO - [session.py:208] - Handshake completed: True
2025-01-01 23:28:49,607 - INFO - [session.py:209] - Use client cert: False
2025-01-01 23:28:49,609 - INFO - [session.py:210] - File to send: None
2025-01-01 23:28:49,610 - INFO - [session.py:216] - Using unencrypted exchange
2025-01-01 23:28:49,614 - INFO - [session.py:316] - Added request packet
2025-01-01 23:28:49,618 - INFO - [session.py:316] - Added response packet
2025-01-01 23:28:49,619 - WARNING - [session.py:293] - Using unencrypted communication
2025-01-01 23:28:49,619 - INFO - [main.py:95] - Session completed successfully for 192.168.1.2
2025-01-01 23:28:49,620 - INFO - [pcap_writer.py:232] - Packet 13: Valid HTTP message
2025-01-01 23:28:49,621 - INFO - [pcap_writer.py:232] - Packet 14: Valid HTTP message
2025-01-01 23:28:49,636 - INFO - [pcap_writer.py:387] - Saved 15 valid packets to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-01 23:28:49,637 - INFO - [pcap_writer.py:409] - Verifying 15 packets...
2025-01-01 23:28:49,638 - INFO - [pcap_writer.py:413] - Packet 1: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 23:28:49,639 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2025-01-01 23:28:49,641 - INFO - [pcap_writer.py:413] - Packet 2: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 23:28:49,643 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2775
2025-01-01 23:28:49,646 - INFO - [pcap_writer.py:413] - Packet 3: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 23:28:49,648 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 1646
2025-01-01 23:28:49,650 - INFO - [pcap_writer.py:413] - Packet 4: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 23:28:49,650 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-01 23:28:49,651 - INFO - [pcap_writer.py:413] - Packet 5: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 23:28:49,652 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-01 23:28:49,652 - INFO - [pcap_writer.py:413] - Packet 6: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 23:28:49,653 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 160
2025-01-01 23:28:49,653 - INFO - [pcap_writer.py:413] - Packet 7: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 23:28:49,653 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 128
2025-01-01 23:28:49,654 - INFO - [pcap_writer.py:413] - Packet 8: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 23:28:49,654 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 1152
2025-01-01 23:28:49,655 - INFO - [pcap_writer.py:413] - Packet 9: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-01 23:28:49,656 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2025-01-01 23:28:49,657 - INFO - [pcap_writer.py:413] - Packet 10: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-01 23:28:49,659 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2775
2025-01-01 23:28:49,661 - INFO - [pcap_writer.py:413] - Packet 11: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-01 23:28:49,662 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 269
2025-01-01 23:28:49,664 - INFO - [pcap_writer.py:413] - Packet 12: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-01 23:28:49,666 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-01 23:28:49,668 - INFO - [pcap_writer.py:413] - Packet 13: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-01 23:28:49,669 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-01 23:28:49,669 - INFO - [pcap_writer.py:413] - Packet 14: IP / TCP 192.168.1.2:12346 > 10.0.0.1:http PA / Raw
2025-01-01 23:28:49,670 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2025-01-01 23:28:49,671 - INFO - [pcap_writer.py:413] - Packet 15: IP / TCP 10.0.0.1:http > 192.168.1.2:12346 PA / Raw
2025-01-01 23:28:49,672 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2025-01-01 23:28:49,674 - INFO - [pcap_writer.py:427] - Verification complete: 15 valid packets, 15 TLS records
2025-01-01 23:28:49,675 - INFO - [main.py:106] - Results saved to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-01 23:28:49,677 - INFO - [main.py:160] - TLS session simulation completed successfully
2025-01-01 23:53:55,141 - INFO - [logging.py:83] - Logging configured successfully
2025-01-01 23:53:55,142 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-01 23:53:55,143 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-01 23:53:55,143 - INFO - [logging.py:92] - Log level: 20
2025-01-01 23:53:55,144 - INFO - [logging.py:93] - Timestamp: 2025-01-01T23:53:55.144253
2025-01-01 23:53:55,144 - INFO - [logging.py:94] - ==========================
2025-01-01 23:53:55,145 - INFO - [main.py:122] - Starting TLS session simulation
2025-01-01 23:53:55,145 - INFO - [main.py:87] - 
--- Client Session (certificate) ---
2025-01-01 23:53:55,147 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-01 23:53:55,148 - INFO - [cert.py:108] - File exists: True
2025-01-01 23:53:55,148 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-01 23:53:55,149 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-01 23:53:55,150 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-01 23:53:55,151 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-01 23:53:55,159 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 23:53:55,161 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-01 23:53:55,161 - INFO - [cert.py:108] - File exists: True
2025-01-01 23:53:55,162 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-01 23:53:55,162 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-01 23:53:55,163 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-01 23:53:55,163 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-01 23:53:55,164 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 23:53:55,205 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-01 23:53:55,206 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-01 23:53:55,207 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-01 23:53:55,208 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-01 23:53:55,212 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-01 23:53:55,212 - INFO - [verify.py:58] - Public key comparison results:
2025-01-01 23:53:55,213 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 23:53:55,214 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 23:53:55,215 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-01 23:53:55,216 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-01 23:53:55,224 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-01 23:53:55,225 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-01 23:53:55,226 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-01 23:53:55,226 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-01 23:53:55,227 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-01 23:53:55,228 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-01 23:53:55,229 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-01 23:53:55,230 - INFO - [session.py:179] - Starting TLS session
2025-01-01 23:53:55,230 - INFO - [session.py:118] - Starting TLS Handshake...
2025-01-01 23:53:55,231 - INFO - [client.py:100] - Generated client_random: 6f40c787e5442c16ca3e9ae3a80a2bff1cce87adb254badfc25c74cd116369a8
2025-01-01 23:53:55,232 - INFO - [client.py:143] - Client Hello sent from 192.168.1.1
2025-01-01 23:53:55,236 - INFO - [session.py:123] - Client Hello sent successfully
2025-01-01 23:53:55,237 - INFO - [server.py:94] - Generated server_random: 095118ace2a8d43f93b63cc2ff44384b7362c86192ccce30d2d92c4bc78f82c4
2025-01-01 23:53:55,241 - INFO - [session.py:128] - Server Hello received successfully
2025-01-01 23:53:55,242 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2025-01-01 23:53:55,243 - INFO - [cert.py:108] - File exists: True
2025-01-01 23:53:55,243 - INFO - [cert.py:109] - File size: 1915 bytes
2025-01-01 23:53:55,245 - INFO - [cert.py:113] - Read 1915 bytes
2025-01-01 23:53:55,245 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2025-01-01 23:53:55,245 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2025-01-01 23:53:55,246 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 23:53:55,246 - INFO - [client.py:177] - Prepared client certificate
2025-01-01 23:53:55,247 - INFO - [client.py:192] - Encrypted pre_master_secret length: 256
2025-01-01 23:53:55,248 - INFO - [session.py:133] - Client handshake messages sent successfully
2025-01-01 23:53:55,250 - INFO - [session.py:138] - Server key pair verified successfully
2025-01-01 23:53:55,250 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-01 23:53:55,251 - INFO - [chain.py:185] - Decrypted pre_master_secret: 030333d670a6da6f59b452590119b7dbbaf82cb4944f9c670b193f19eb710b9321be69c1b03d3418393218e88e5af0b4
2025-01-01 23:53:55,253 - INFO - [chain.py:195] - Generated master secret: 8d6229123e387e4dca4c7e932de2ea68ef4f5ff26ad9d40ae758f5e8de7400b02731070666816d9c162af2570ed390dc
2025-01-01 23:53:55,253 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-01 23:53:55,254 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-01 23:53:55,254 - INFO - [session.py:142] - Master Secret handled successfully
2025-01-01 23:53:55,255 - INFO - [client.py:273] - Pre-master secret validated successfully
2025-01-01 23:53:55,256 - INFO - [client.py:291] - Generated digital signature: c6ded772b1521155d5e1e81a9bfd306eea41ed233cffe2352b922f01ef15d81263037e6f103f2ae5354c37b546a0972967367c73c897eb69367a0aa88075ac334d8e9506dfb442eb9f5e292a5fb2983d3895d6e9d24b267b810e17339b092b79497cc82efe5611692cefb2163e8e7fce108a2b375b2a9e2c786aca83b0085c2cab7b22e8a642d4ebcc455cd45eb6e756177310a3ebd1a541893b870a928e3baf9eefc024e66515f5b60a0b7e18c1cce10510f5c0ec005c1e8b0732529da3470e24c8f3b05a5c8ebfedee2827badf839ab9247cbdd287568061325c4faacd57e8aaf96e2114c78309a782e6abbd174cb33591fb4f79037b9ed07da5f8d31aaccf
2025-01-01 23:53:55,258 - INFO - [client.py:337] - Client ChangeCipherSpec and Finished messages sent
2025-01-01 23:53:55,259 - INFO - [session.py:147] - Client Change Cipher Spec sent successfully
2025-01-01 23:53:55,260 - INFO - [server.py:260] - Pre-master secret validated successfully
2025-01-01 23:53:55,261 - INFO - [server.py:278] - Generated digital signature: c57dbb72db0296e76dd4681b299285d67639495a91028fd6c10481b65bd16dcc790da5b832a2e9e0f21377ddbe35ce07cce38fb5c2d3fafb28e42a2d7ba48699a6f552d926e0ebf990ce62788ed20362d69c2019cbe5c62f1bca3f72dd464b99026669a22df5af4618c2ec5dd5454a774beab2358ccb70703af89a7c0816c0d1e0a0e9188152e380810b3b16caaee6dd8a815f0a709cf19dafab0a111eb1706864ad30ea6cf8dd5eb2f3d27ab2d9fa7dcb3e5f80df8b3b42512564f000c3ebf18217abba1e8a7c2b99358c8867f55711f82aa60c1f77a76a6ed28fc047a2c5c6b64027cb7dd92a8a7620ae8f0f2887eecffd3b69f76c77b6f3742967f8837173
2025-01-01 23:53:55,262 - INFO - [server.py:324] - Server ChangeCipherSpec and Finished messages sent
2025-01-01 23:53:55,263 - INFO - [session.py:152] - Server Change Cipher Spec received successfully
2025-01-01 23:53:55,264 - INFO - [keys.py:209] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-01 23:53:55,264 - INFO - [session.py:157] - SSL Key Log handled successfully
2025-01-01 23:53:55,265 - INFO - [session.py:161] - TLS Handshake completed successfully
2025-01-01 23:53:55,265 - INFO - [session.py:190] - Found file to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 23:53:55,266 - INFO - [session.py:208] - Handshake completed: True
2025-01-01 23:53:55,266 - INFO - [session.py:209] - Use client cert: True
2025-01-01 23:53:55,267 - INFO - [session.py:210] - File to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 23:53:55,268 - INFO - [session.py:213] - Using encrypted exchange
2025-01-01 23:53:55,269 - INFO - [session.py:228] - Sending encrypted request data
2025-01-01 23:53:55,274 - INFO - [keys.py:185] - TLS Application Data sent from 192.168.1.1:12345 to 10.0.0.1:443
2025-01-01 23:53:55,275 - INFO - [session.py:239] - Sending encrypted response data
2025-01-01 23:53:55,276 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-01 23:53:55,277 - INFO - [session.py:251] - Attempting to send file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 23:53:55,278 - INFO - [session.py:262] - Opening file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 23:53:55,279 - INFO - [session.py:269] - Read 1103 bytes from file
2025-01-01 23:53:55,280 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-01 23:53:55,281 - INFO - [session.py:278] - File sent successfully
2025-01-01 23:53:55,281 - INFO - [session.py:253] - File sent successfully
2025-01-01 23:53:55,282 - INFO - [main.py:95] - Session completed successfully for 192.168.1.1
2025-01-01 23:53:55,282 - INFO - [main.py:87] - 
--- Client Session (no certificate) ---
2025-01-01 23:53:55,283 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-01 23:53:55,285 - INFO - [cert.py:108] - File exists: True
2025-01-01 23:53:55,287 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-01 23:53:55,289 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-01 23:53:55,289 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-01 23:53:55,290 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-01 23:53:55,291 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 23:53:55,292 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-01 23:53:55,293 - INFO - [cert.py:108] - File exists: True
2025-01-01 23:53:55,293 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-01 23:53:55,294 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-01 23:53:55,294 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-01 23:53:55,295 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-01 23:53:55,296 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 23:53:55,325 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-01 23:53:55,326 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-01 23:53:55,327 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-01 23:53:55,328 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-01 23:53:55,328 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-01 23:53:55,329 - INFO - [verify.py:58] - Public key comparison results:
2025-01-01 23:53:55,329 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 23:53:55,330 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 23:53:55,331 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-01 23:53:55,332 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-01 23:53:55,332 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-01 23:53:55,333 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-01 23:53:55,333 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-01 23:53:55,334 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-01 23:53:55,334 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-01 23:53:55,335 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-01 23:53:55,337 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-01 23:53:55,338 - INFO - [session.py:179] - Starting TLS session
2025-01-01 23:53:55,338 - INFO - [session.py:118] - Starting TLS Handshake...
2025-01-01 23:53:55,338 - INFO - [client.py:100] - Generated client_random: 07ffd91f49ad003f5cbff77f7e24d1a1d789775eccc52909e4d1b9ebab675c22
2025-01-01 23:53:55,340 - INFO - [client.py:143] - Client Hello sent from 192.168.1.2
2025-01-01 23:53:55,343 - INFO - [session.py:123] - Client Hello sent successfully
2025-01-01 23:53:55,343 - INFO - [server.py:94] - Generated server_random: ccd73de44ebd92f95be0cdb48073133a729a1e5b8dfb78c3fc666631fcac399a
2025-01-01 23:53:55,346 - INFO - [session.py:128] - Server Hello received successfully
2025-01-01 23:53:55,347 - INFO - [client.py:180] - Prepared empty certificate
2025-01-01 23:53:55,347 - INFO - [client.py:192] - Encrypted pre_master_secret length: 256
2025-01-01 23:53:55,349 - INFO - [session.py:133] - Client handshake messages sent successfully
2025-01-01 23:53:55,351 - INFO - [session.py:138] - Server key pair verified successfully
2025-01-01 23:53:55,352 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-01 23:53:55,354 - INFO - [chain.py:185] - Decrypted pre_master_secret: 030313622377b43825e47505ec85deb099647eff7a1517606474a5bfb15fda3b744c7754ee9dadc64168fe3f3ded4747
2025-01-01 23:53:55,355 - INFO - [chain.py:195] - Generated master secret: 355ee9a2456f23d135853a1c195596999ed6695f0cde20b2ae58d0f36de182cb9fca75dd83d877960fbc5bc02a54a83e
2025-01-01 23:53:55,355 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-01 23:53:55,355 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-01 23:53:55,356 - INFO - [session.py:142] - Master Secret handled successfully
2025-01-01 23:53:55,357 - INFO - [client.py:273] - Pre-master secret validated successfully
2025-01-01 23:53:55,358 - INFO - [client.py:291] - Generated digital signature: 6b03063a801f1dcd4fab863c7e95f1e7267c91f0886417e9ce6099d04148c738dc41b1de2ff1fc1b954e57fcad3aa2fdd8e255ff3e6068a96301c0bc3da45a4ad0a88043a5159a2c774fe21a9e4bb3a1f6d1c239952639923d5cf529999057302b3f5f9c791144db98a218fbf5189d2f02f0231630aba0997b80d45c9074d28ad758088e9d79268660d19a352380c62ccc85bee205b9cab1aed113c8928c910bcde9f281927aff0a9c2e9dfdae1bc2e6ac7e5854f788b2c90ff2d710525b033619ee1819ed2748d6a5651f1ff328457f0e4fcfb2080d6b953323f4dbd44f642757d139c0e6d99e0755a961283e9b7d1ff8ee38cf9d47829f98added51bad0ae0
2025-01-01 23:53:55,360 - INFO - [client.py:337] - Client ChangeCipherSpec and Finished messages sent
2025-01-01 23:53:55,361 - INFO - [session.py:147] - Client Change Cipher Spec sent successfully
2025-01-01 23:53:55,362 - INFO - [server.py:260] - Pre-master secret validated successfully
2025-01-01 23:53:55,363 - INFO - [server.py:278] - Generated digital signature: 774c0da65a70b2807a6e1b5eee0d5d8c066257b4af05f374daff9cf701ef8dc4249ae0a68a1699798494a74b0f442941afbc2a57357300fd970d478671f13e236d68ab942db60f7f8d435c151c8dfeca475414e1b239056769f6a28c4978f5f5d3d48d0a81818b5b01c1deade1286d54e3b1cd40b27ca36a4e426a2fc92d0b269b69c0ba408c08d42d83f8026cb33245102c5605d6cbbb0db624d394de7ae290e96377c74edc8e2de77f187f64f456e74389be08f35637f9c9c49b284fc77c66269e99a7f4b0f76223434a1ba11d2a91fa4c94d1c07582af2cee1d26840d63b506017fa4f24eccce261f03d92f5d445aa9f664e1ed666a645b9f487e4fd91bb6
2025-01-01 23:53:55,365 - INFO - [server.py:324] - Server ChangeCipherSpec and Finished messages sent
2025-01-01 23:53:55,366 - INFO - [session.py:152] - Server Change Cipher Spec received successfully
2025-01-01 23:53:55,367 - INFO - [keys.py:209] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-01 23:53:55,368 - INFO - [session.py:157] - SSL Key Log handled successfully
2025-01-01 23:53:55,369 - INFO - [session.py:161] - TLS Handshake completed successfully
2025-01-01 23:53:55,370 - INFO - [session.py:208] - Handshake completed: True
2025-01-01 23:53:55,371 - INFO - [session.py:209] - Use client cert: False
2025-01-01 23:53:55,371 - INFO - [session.py:210] - File to send: None
2025-01-01 23:53:55,372 - INFO - [session.py:216] - Using unencrypted exchange
2025-01-01 23:53:55,373 - INFO - [session.py:316] - Added request packet
2025-01-01 23:53:55,374 - INFO - [session.py:316] - Added response packet
2025-01-01 23:53:55,374 - WARNING - [session.py:293] - Using unencrypted communication
2025-01-01 23:53:55,376 - INFO - [main.py:95] - Session completed successfully for 192.168.1.2
2025-01-01 23:53:55,376 - INFO - [pcap_writer.py:232] - Packet 13: Valid HTTP message
2025-01-01 23:53:55,377 - INFO - [pcap_writer.py:232] - Packet 14: Valid HTTP message
2025-01-01 23:53:55,382 - INFO - [pcap_writer.py:387] - Saved 15 valid packets to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-01 23:53:55,383 - INFO - [pcap_writer.py:409] - Verifying 15 packets...
2025-01-01 23:53:55,383 - INFO - [pcap_writer.py:413] - Packet 1: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 23:53:55,384 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2025-01-01 23:53:55,385 - INFO - [pcap_writer.py:413] - Packet 2: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 23:53:55,386 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2743
2025-01-01 23:53:55,386 - INFO - [pcap_writer.py:413] - Packet 3: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 23:53:55,387 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 1646
2025-01-01 23:53:55,388 - INFO - [pcap_writer.py:413] - Packet 4: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 23:53:55,388 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-01 23:53:55,388 - INFO - [pcap_writer.py:413] - Packet 5: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 23:53:55,389 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-01 23:53:55,389 - INFO - [pcap_writer.py:413] - Packet 6: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 23:53:55,390 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 160
2025-01-01 23:53:55,390 - INFO - [pcap_writer.py:413] - Packet 7: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 23:53:55,390 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 128
2025-01-01 23:53:55,390 - INFO - [pcap_writer.py:413] - Packet 8: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 23:53:55,391 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 1152
2025-01-01 23:53:55,391 - INFO - [pcap_writer.py:413] - Packet 9: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-01 23:53:55,391 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2025-01-01 23:53:55,391 - INFO - [pcap_writer.py:413] - Packet 10: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-01 23:53:55,392 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2743
2025-01-01 23:53:55,392 - INFO - [pcap_writer.py:413] - Packet 11: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-01 23:53:55,392 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 269
2025-01-01 23:53:55,393 - INFO - [pcap_writer.py:413] - Packet 12: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-01 23:53:55,393 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-01 23:53:55,393 - INFO - [pcap_writer.py:413] - Packet 13: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-01 23:53:55,394 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-01 23:53:55,394 - INFO - [pcap_writer.py:413] - Packet 14: IP / TCP 192.168.1.2:12346 > 10.0.0.1:http PA / Raw
2025-01-01 23:53:55,395 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2025-01-01 23:53:55,395 - INFO - [pcap_writer.py:413] - Packet 15: IP / TCP 10.0.0.1:http > 192.168.1.2:12346 PA / Raw
2025-01-01 23:53:55,395 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2025-01-01 23:53:55,396 - INFO - [pcap_writer.py:427] - Verification complete: 15 valid packets, 15 TLS records
2025-01-01 23:53:55,396 - INFO - [main.py:106] - Results saved to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-01 23:53:55,397 - INFO - [main.py:160] - TLS session simulation completed successfully
2025-01-02 00:00:53,522 - INFO - [logging.py:83] - Logging configured successfully
2025-01-02 00:00:53,523 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-02 00:00:53,524 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-02 00:00:53,525 - INFO - [logging.py:92] - Log level: 20
2025-01-02 00:00:53,526 - INFO - [logging.py:93] - Timestamp: 2025-01-02T00:00:53.526154
2025-01-02 00:00:53,527 - INFO - [logging.py:94] - ==========================
2025-01-02 00:00:53,528 - INFO - [main.py:122] - Starting TLS session simulation
2025-01-02 00:00:53,530 - INFO - [main.py:87] - 
--- Client Session (certificate) ---
2025-01-02 00:00:53,532 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-02 00:00:53,534 - INFO - [cert.py:108] - File exists: True
2025-01-02 00:00:53,535 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-02 00:00:53,537 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-02 00:00:53,539 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-02 00:00:53,540 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-02 00:00:53,545 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 00:00:53,548 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-02 00:00:53,549 - INFO - [cert.py:108] - File exists: True
2025-01-02 00:00:53,551 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-02 00:00:53,554 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-02 00:00:53,556 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-02 00:00:53,559 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-02 00:00:53,562 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 00:00:53,710 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-02 00:00:53,711 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-02 00:00:53,712 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-02 00:00:53,712 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-02 00:00:53,748 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-02 00:00:53,749 - INFO - [verify.py:58] - Public key comparison results:
2025-01-02 00:00:53,749 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 00:00:53,750 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 00:00:53,751 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-02 00:00:53,751 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-02 00:00:53,760 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-02 00:00:53,762 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-02 00:00:53,763 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-02 00:00:53,763 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-02 00:00:53,764 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-02 00:00:53,765 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-02 00:00:53,766 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-02 00:00:53,766 - INFO - [session.py:179] - Starting TLS session
2025-01-02 00:00:53,767 - INFO - [session.py:118] - Starting TLS Handshake...
2025-01-02 00:00:53,767 - INFO - [client.py:100] - Generated client_random: 27a08bf3cb7e9a9adb1a8b37023cf4be9d8d6e0f9bcadbbb1db3708650970d1d
2025-01-02 00:00:53,771 - INFO - [client.py:143] - Client Hello sent from 192.168.1.1
2025-01-02 00:00:53,776 - INFO - [session.py:123] - Client Hello sent successfully
2025-01-02 00:00:53,777 - INFO - [server.py:94] - Generated server_random: 2db101d4d87f044be724628cc33532781cecb7f6ac2b5b921c7ffb0ff8624d64
2025-01-02 00:00:53,781 - INFO - [session.py:128] - Server Hello received successfully
2025-01-02 00:00:53,782 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2025-01-02 00:00:53,783 - INFO - [cert.py:108] - File exists: True
2025-01-02 00:00:53,784 - INFO - [cert.py:109] - File size: 1915 bytes
2025-01-02 00:00:53,785 - INFO - [cert.py:113] - Read 1915 bytes
2025-01-02 00:00:53,787 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2025-01-02 00:00:53,788 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2025-01-02 00:00:53,790 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 00:00:53,792 - INFO - [client.py:177] - Prepared client certificate
2025-01-02 00:00:53,793 - INFO - [client.py:192] - Encrypted pre_master_secret length: 256
2025-01-02 00:00:53,796 - INFO - [session.py:133] - Client handshake messages sent successfully
2025-01-02 00:00:53,797 - INFO - [session.py:138] - Server key pair verified successfully
2025-01-02 00:00:53,798 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-02 00:00:53,799 - INFO - [chain.py:185] - Decrypted pre_master_secret: 03031480e0d660cc6390777ffd314f45646e89048ac231798db8f9ca100daf5a73fe05138b9ef0cd6a163aa7d790ad39
2025-01-02 00:00:53,800 - INFO - [chain.py:195] - Generated master secret: 91804ee8ebb9ad8545031d96b312ebf87d765ca2fb510a3638a4161b05fb0662497ba4948eec24844a5ddba07206228d
2025-01-02 00:00:53,801 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-02 00:00:53,801 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-02 00:00:53,801 - INFO - [session.py:142] - Master Secret handled successfully
2025-01-02 00:00:53,804 - INFO - [client.py:273] - Pre-master secret validated successfully
2025-01-02 00:00:53,807 - INFO - [client.py:291] - Generated digital signature: 2490f7c4a69b25ba6d4e73a6d7d3112c6f30b176a280603a3a0702c7ce483f88e663bf5e190ba2007e7da9933151f44ca9557290c199283f8c465f2bd1924e31b6bed1e5772bc99bc9a6505a66e876380632c162b4dea063ea728d6b098065e7fb98539fad1b0834a86fa27aef72688e07df1392c13b6ced48fbcdc9e4fb8f788dd642de94124eca0f59f4eccf98ce9c6e8cb289ac3983713c31e2818e62f66c3246c1eb3e740d83dbe50d177538dfe7d1bd98820c1c8694eea74fd9aaccd0ebf83471bca785236111c8a886d308989ad7219de85bf4890546c2c2d4b318f527ace868049a78c01f8771be5e0b453df7f42a88a9c3879c27f84c4115d8709689
2025-01-02 00:00:53,810 - INFO - [client.py:337] - Client ChangeCipherSpec and Finished messages sent
2025-01-02 00:00:53,812 - INFO - [session.py:147] - Client Change Cipher Spec sent successfully
2025-01-02 00:00:53,813 - INFO - [server.py:260] - Pre-master secret validated successfully
2025-01-02 00:00:53,815 - INFO - [server.py:278] - Generated digital signature: 067031aca8cca424c199aaa1c6fc069b4f54adea6c9b467c21d97e74392fc631d0370370b31916633f846234b20c551eccc61aec85bc5dfd9371bb28569706f1fc4f84094067969bacf7866c683e20ad76fe006e0c21cc09786815b9f155b5a0f50ddc1cd6aa1b4f6fd6e1db6f411486cd7c8195b15aa7861d661de827d5617c1beb98c5283881b4f18643f4ac7aee3bd7e3cc1e8a8d5bbd3d34efdf900ab613c66c2c8c64c9438758eb0c70ddb6bc7935d759460578a9d09d67e05f1c10c9bffe287621dbe1fefb190ea14f6cfc192a99cde5adfd6c15116c030624d256df6330d14c74fd2fa2d17bd1e935ee0dfaf74292bca69b92e9a69b4b5d0bea54ba81
2025-01-02 00:00:53,817 - INFO - [server.py:324] - Server ChangeCipherSpec and Finished messages sent
2025-01-02 00:00:53,820 - INFO - [session.py:152] - Server Change Cipher Spec received successfully
2025-01-02 00:00:53,821 - INFO - [keys.py:218] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-02 00:00:53,823 - INFO - [session.py:157] - SSL Key Log handled successfully
2025-01-02 00:00:53,824 - INFO - [session.py:161] - TLS Handshake completed successfully
2025-01-02 00:00:53,825 - INFO - [session.py:190] - Found file to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 00:00:53,826 - INFO - [session.py:208] - Handshake completed: True
2025-01-02 00:00:53,826 - INFO - [session.py:209] - Use client cert: True
2025-01-02 00:00:53,827 - INFO - [session.py:210] - File to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 00:00:53,827 - INFO - [session.py:213] - Using encrypted exchange
2025-01-02 00:00:53,827 - INFO - [session.py:228] - Sending encrypted request data
2025-01-02 00:00:53,829 - INFO - [keys.py:185] - TLS Application Data sent from 192.168.1.1:12345 to 10.0.0.1:443
2025-01-02 00:00:53,830 - INFO - [session.py:239] - Sending encrypted response data
2025-01-02 00:00:53,832 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-02 00:00:53,833 - INFO - [session.py:251] - Attempting to send file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 00:00:53,833 - INFO - [session.py:262] - Opening file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 00:00:53,835 - INFO - [session.py:269] - Read 1103 bytes from file
2025-01-02 00:00:53,838 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-02 00:00:53,839 - INFO - [session.py:278] - File sent successfully
2025-01-02 00:00:53,841 - INFO - [session.py:253] - File sent successfully
2025-01-02 00:00:53,843 - INFO - [main.py:95] - Session completed successfully for 192.168.1.1
2025-01-02 00:00:53,843 - INFO - [main.py:87] - 
--- Client Session (no certificate) ---
2025-01-02 00:00:53,844 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-02 00:00:53,845 - INFO - [cert.py:108] - File exists: True
2025-01-02 00:00:53,845 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-02 00:00:53,846 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-02 00:00:53,847 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-02 00:00:53,847 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-02 00:00:53,848 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 00:00:53,849 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-02 00:00:53,850 - INFO - [cert.py:108] - File exists: True
2025-01-02 00:00:53,850 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-02 00:00:53,851 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-02 00:00:53,852 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-02 00:00:53,854 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-02 00:00:53,857 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 00:00:53,893 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-02 00:00:53,894 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-02 00:00:53,894 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-02 00:00:53,895 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-02 00:00:53,895 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-02 00:00:53,895 - INFO - [verify.py:58] - Public key comparison results:
2025-01-02 00:00:53,896 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 00:00:53,897 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 00:00:53,898 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-02 00:00:53,899 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-02 00:00:53,900 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-02 00:00:53,901 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-02 00:00:53,902 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-02 00:00:53,903 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-02 00:00:53,904 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-02 00:00:53,905 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-02 00:00:53,909 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-02 00:00:53,910 - INFO - [session.py:179] - Starting TLS session
2025-01-02 00:00:53,911 - INFO - [session.py:118] - Starting TLS Handshake...
2025-01-02 00:00:53,911 - INFO - [client.py:100] - Generated client_random: b7bded4ccbece7215a9ccfbcec9e6cb51f5525a084fdbef7bfdb4eb554bb65b1
2025-01-02 00:00:53,914 - INFO - [client.py:143] - Client Hello sent from 192.168.1.2
2025-01-02 00:00:53,918 - INFO - [session.py:123] - Client Hello sent successfully
2025-01-02 00:00:53,919 - INFO - [server.py:94] - Generated server_random: b7201618ce0276f9b19a19e5072c2c1e03b0f60a59328fa0e85ba87163968695
2025-01-02 00:00:53,925 - INFO - [session.py:128] - Server Hello received successfully
2025-01-02 00:00:53,926 - INFO - [client.py:180] - Prepared empty certificate
2025-01-02 00:00:53,927 - INFO - [client.py:192] - Encrypted pre_master_secret length: 256
2025-01-02 00:00:53,929 - INFO - [session.py:133] - Client handshake messages sent successfully
2025-01-02 00:00:53,931 - INFO - [session.py:138] - Server key pair verified successfully
2025-01-02 00:00:53,932 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-02 00:00:53,933 - INFO - [chain.py:185] - Decrypted pre_master_secret: 03035e278023ce130c8eae77e8583898411ad2de1c49f8f325a06eb230eab8b33c0fc5854d3ed600e9b8b08b91160dbe
2025-01-02 00:00:53,934 - INFO - [chain.py:195] - Generated master secret: 79314208bf1b17adc93e8c0aeab4283ce3a9163549c49847196d2b186dc104ae9a959996c9107f5841e3fdf81add7601
2025-01-02 00:00:53,936 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-02 00:00:53,937 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-02 00:00:53,937 - INFO - [session.py:142] - Master Secret handled successfully
2025-01-02 00:00:53,939 - INFO - [client.py:273] - Pre-master secret validated successfully
2025-01-02 00:00:53,943 - INFO - [client.py:291] - Generated digital signature: 24d086d1d33b90a492334fe5240da02c03dd851f556610b8cd2ad2209c8ef8c71a6428f4f4e57803a0606198fdc9e5f4a33c400db7c8522d726ccf09fe0c72eae0449c81b8c4bd9819f41eb7307b234ecad188c26912329a969b5bf73776887cbd95d2c2d50dc80a5229cb6c79c49767e792b00da5b949e937731c1c0caadc0de5e9ffc93ba6d61a6bb1c28cae00789908afa461ed7c3447ae263d787d64246dfce510e21d070df34bb8f2944c90542f741a39c195a7230798f194cedf0b8240c782960c3515369c7793ff0d78f8c15eb1ebadde715e35fde71f3ccb0574e840a0302f4c52b0d238a14079175ebda95564674b017ecfca577653a784d0ac59b7
2025-01-02 00:00:53,947 - INFO - [client.py:337] - Client ChangeCipherSpec and Finished messages sent
2025-01-02 00:00:53,949 - INFO - [session.py:147] - Client Change Cipher Spec sent successfully
2025-01-02 00:00:53,951 - INFO - [server.py:260] - Pre-master secret validated successfully
2025-01-02 00:00:53,954 - INFO - [server.py:278] - Generated digital signature: 2e3de173e4f60ba33f3a1f661161376ca3c0746423eed8b0ba6ebcb2b413682960ae4355b36d67c7d0bdb78efbd35f7dffe5df5a6d14b8e7948e8e8adb1abf241f372d2ffbaf6db7dd8a3d34926f79f170977ad4c593a03e7aac0768e75575b0297a8b71fbe5d6650ab8d5f8852639b0f656449d3f2e20b385846826a23ab7371496eae8acecffe8f9a2afa5a029a5a7943a13491b16eca7275916296d344355f646a49cd82047867c46f3278eb25da3af58803557a6763f171dd04f484f81c0a65f0a5c56f6317f5883039f82212b5e3fab25231897ee1418a180583af34ba76cf69355fcaad85a87a833b61de9df6f5511976cc06b9e7e25e893e72024cebc
2025-01-02 00:00:53,957 - INFO - [server.py:324] - Server ChangeCipherSpec and Finished messages sent
2025-01-02 00:00:53,959 - INFO - [session.py:152] - Server Change Cipher Spec received successfully
2025-01-02 00:00:53,961 - INFO - [keys.py:218] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-02 00:00:53,962 - INFO - [session.py:157] - SSL Key Log handled successfully
2025-01-02 00:00:53,964 - INFO - [session.py:161] - TLS Handshake completed successfully
2025-01-02 00:00:53,966 - INFO - [session.py:208] - Handshake completed: True
2025-01-02 00:00:53,967 - INFO - [session.py:209] - Use client cert: False
2025-01-02 00:00:53,967 - INFO - [session.py:210] - File to send: None
2025-01-02 00:00:53,968 - INFO - [session.py:216] - Using unencrypted exchange
2025-01-02 00:00:53,972 - INFO - [session.py:316] - Added request packet
2025-01-02 00:00:53,974 - INFO - [session.py:316] - Added response packet
2025-01-02 00:00:53,974 - WARNING - [session.py:293] - Using unencrypted communication
2025-01-02 00:00:53,976 - INFO - [main.py:95] - Session completed successfully for 192.168.1.2
2025-01-02 00:00:53,977 - INFO - [pcap_writer.py:232] - Packet 13: Valid HTTP message
2025-01-02 00:00:53,977 - INFO - [pcap_writer.py:232] - Packet 14: Valid HTTP message
2025-01-02 00:00:53,997 - INFO - [pcap_writer.py:387] - Saved 15 valid packets to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-02 00:00:53,998 - INFO - [pcap_writer.py:409] - Verifying 15 packets...
2025-01-02 00:00:53,999 - INFO - [pcap_writer.py:413] - Packet 1: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 00:00:53,999 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2025-01-02 00:00:54,000 - INFO - [pcap_writer.py:413] - Packet 2: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 00:00:54,001 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2743
2025-01-02 00:00:54,002 - INFO - [pcap_writer.py:413] - Packet 3: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 00:00:54,004 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 1646
2025-01-02 00:00:54,006 - INFO - [pcap_writer.py:413] - Packet 4: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 00:00:54,008 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-02 00:00:54,009 - INFO - [pcap_writer.py:413] - Packet 5: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 00:00:54,012 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-02 00:00:54,014 - INFO - [pcap_writer.py:413] - Packet 6: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 00:00:54,015 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 160
2025-01-02 00:00:54,016 - INFO - [pcap_writer.py:413] - Packet 7: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 00:00:54,017 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 128
2025-01-02 00:00:54,018 - INFO - [pcap_writer.py:413] - Packet 8: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 00:00:54,020 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 1152
2025-01-02 00:00:54,022 - INFO - [pcap_writer.py:413] - Packet 9: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-02 00:00:54,023 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2025-01-02 00:00:54,024 - INFO - [pcap_writer.py:413] - Packet 10: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-02 00:00:54,026 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2743
2025-01-02 00:00:54,028 - INFO - [pcap_writer.py:413] - Packet 11: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-02 00:00:54,029 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 269
2025-01-02 00:00:54,030 - INFO - [pcap_writer.py:413] - Packet 12: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-02 00:00:54,030 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-02 00:00:54,031 - INFO - [pcap_writer.py:413] - Packet 13: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-02 00:00:54,032 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-02 00:00:54,033 - INFO - [pcap_writer.py:413] - Packet 14: IP / TCP 192.168.1.2:12346 > 10.0.0.1:http PA / Raw
2025-01-02 00:00:54,033 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2025-01-02 00:00:54,034 - INFO - [pcap_writer.py:413] - Packet 15: IP / TCP 10.0.0.1:http > 192.168.1.2:12346 PA / Raw
2025-01-02 00:00:54,035 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2025-01-02 00:00:54,037 - INFO - [pcap_writer.py:427] - Verification complete: 15 valid packets, 15 TLS records
2025-01-02 00:00:54,038 - INFO - [main.py:106] - Results saved to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-02 00:00:54,039 - INFO - [main.py:160] - TLS session simulation completed successfully
2025-01-02 00:02:45,906 - INFO - [logging.py:83] - Logging configured successfully
2025-01-02 00:02:45,907 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-02 00:02:45,908 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-02 00:02:45,908 - INFO - [logging.py:92] - Log level: 20
2025-01-02 00:02:45,909 - INFO - [logging.py:93] - Timestamp: 2025-01-02T00:02:45.909452
2025-01-02 00:02:45,910 - INFO - [logging.py:94] - ==========================
2025-01-02 00:02:45,911 - INFO - [main.py:122] - Starting TLS session simulation
2025-01-02 00:02:45,911 - INFO - [main.py:87] - 
--- Client Session (certificate) ---
2025-01-02 00:02:45,914 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-02 00:02:45,915 - INFO - [cert.py:108] - File exists: True
2025-01-02 00:02:45,915 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-02 00:02:45,916 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-02 00:02:45,917 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-02 00:02:45,918 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-02 00:02:45,920 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 00:02:45,921 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-02 00:02:45,922 - INFO - [cert.py:108] - File exists: True
2025-01-02 00:02:45,922 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-02 00:02:45,923 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-02 00:02:45,924 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-02 00:02:45,925 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-02 00:02:45,926 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 00:02:45,959 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-02 00:02:45,959 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-02 00:02:45,960 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-02 00:02:45,960 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-02 00:02:45,962 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-02 00:02:45,962 - INFO - [verify.py:58] - Public key comparison results:
2025-01-02 00:02:45,963 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 00:02:45,964 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 00:02:45,965 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-02 00:02:45,966 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-02 00:02:45,971 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-02 00:02:45,971 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-02 00:02:45,972 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-02 00:02:45,972 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-02 00:02:45,973 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-02 00:02:45,973 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-02 00:02:45,974 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-02 00:02:45,979 - INFO - [session.py:179] - Starting TLS session
2025-01-02 00:02:45,980 - INFO - [session.py:118] - Starting TLS Handshake...
2025-01-02 00:02:45,980 - INFO - [client.py:100] - Generated client_random: 46abb79b4cab1668aa1152a28df0c7edc59cf214cc70e692690bce11454b183d
2025-01-02 00:02:45,985 - INFO - [client.py:143] - Client Hello sent from 192.168.1.1
2025-01-02 00:02:45,989 - INFO - [session.py:123] - Client Hello sent successfully
2025-01-02 00:02:45,989 - INFO - [server.py:94] - Generated server_random: 7388b3ae3e616adeedf547cdcc0f34edb26f11775dbde9a73abdeb08da55d564
2025-01-02 00:02:45,992 - INFO - [session.py:128] - Server Hello received successfully
2025-01-02 00:02:45,993 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2025-01-02 00:02:45,993 - INFO - [cert.py:108] - File exists: True
2025-01-02 00:02:45,994 - INFO - [cert.py:109] - File size: 1915 bytes
2025-01-02 00:02:45,994 - INFO - [cert.py:113] - Read 1915 bytes
2025-01-02 00:02:45,994 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2025-01-02 00:02:45,995 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2025-01-02 00:02:45,996 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 00:02:45,997 - INFO - [client.py:177] - Prepared client certificate
2025-01-02 00:02:45,998 - INFO - [client.py:192] - Encrypted pre_master_secret length: 256
2025-01-02 00:02:46,000 - INFO - [session.py:133] - Client handshake messages sent successfully
2025-01-02 00:02:46,002 - INFO - [session.py:138] - Server key pair verified successfully
2025-01-02 00:02:46,002 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-02 00:02:46,003 - INFO - [chain.py:185] - Decrypted pre_master_secret: 0303e7ed2e288aeb98a87b69389ecc72c93241d7fbc40a8e9d4abce11eec167072502e809de1c8ea4a655fcc6d993c5f
2025-01-02 00:02:46,004 - INFO - [chain.py:195] - Generated master secret: 2aa0880cbee19680585733532580d30ff8154cb6ca8974d611e7442e6b7caa309f3a3eec487b91c6d241022a1c46a571
2025-01-02 00:02:46,004 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-02 00:02:46,004 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-02 00:02:46,005 - INFO - [session.py:142] - Master Secret handled successfully
2025-01-02 00:02:46,006 - INFO - [client.py:273] - Pre-master secret validated successfully
2025-01-02 00:02:46,007 - INFO - [client.py:291] - Generated digital signature: d0d11875400fc17b0be173cefd37113a33f15dd59d91bb96bd8802c61c47924259fd86191bda8a6cb68d22b3a61a9eba2556430d9634024a3ed8b559ce3aeb9c91ab8fde45e7d9eab37fd4b641016389ef1e00fc82e5f3ca20c6d1b3125a2db90d07b089a566f9dc3769724f6a51c62ea6b07071591e0f31645776534a5cd9f3f866ae0006df1ec83f69f15a45a3aa427e727b254f3bb2f71c9933f2894072ab4457ceaf408835cb19f4fdf302d0492504f8c003f5bd302b5d5d16f7dbf2ad832aebbea3e40169df6e8aa526b66a905a3ee3fe2d50f6cf03957f21550f8e436af5dea0edc71929a2ce625e202326e6fcdc780d01e2778d2dc260d86b3c0dc459
2025-01-02 00:02:46,009 - INFO - [client.py:337] - Client ChangeCipherSpec and Finished messages sent
2025-01-02 00:02:46,010 - INFO - [session.py:147] - Client Change Cipher Spec sent successfully
2025-01-02 00:02:46,011 - INFO - [server.py:260] - Pre-master secret validated successfully
2025-01-02 00:02:46,012 - INFO - [server.py:278] - Generated digital signature: 1e1ed74a33f03d9491bf47ae177147a1f62d19891f409c5942e2abe206970ca010d379915303e811ec672b1c2207fa5982056e5a7c1d5596db471438a65ae4e10cd170b280fab2753bb9e01b4dd578199595574a5488873ec8d25277b6263f56b59dd4a2c37b90f20d4df9ce1727c320eababfa80e37cceccd28a59734bd856621f8e5bfcb5751193214dec26fa01dbd198e68b926f9ae7d861e11060b75290e3a1447f81752bd33385fe2efd9f72546319fef3016e762d33185edc634a5519cef5f330d237cbb96a818b4ced278fcdccefc3f902bc46fdebfe1df2e1e492da7074b32b6ca4798bab594e45d6369d70da95f61ecdadbeb40fd1cdf9294e6db97
2025-01-02 00:02:46,015 - INFO - [server.py:324] - Server ChangeCipherSpec and Finished messages sent
2025-01-02 00:02:46,017 - INFO - [session.py:152] - Server Change Cipher Spec received successfully
2025-01-02 00:02:46,018 - INFO - [keys.py:218] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-02 00:02:46,018 - INFO - [session.py:157] - SSL Key Log handled successfully
2025-01-02 00:02:46,019 - INFO - [session.py:161] - TLS Handshake completed successfully
2025-01-02 00:02:46,020 - INFO - [session.py:190] - Found file to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 00:02:46,021 - INFO - [session.py:208] - Handshake completed: True
2025-01-02 00:02:46,021 - INFO - [session.py:209] - Use client cert: True
2025-01-02 00:02:46,022 - INFO - [session.py:210] - File to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 00:02:46,022 - INFO - [session.py:213] - Using encrypted exchange
2025-01-02 00:02:46,023 - INFO - [session.py:228] - Sending encrypted request data
2025-01-02 00:02:46,025 - INFO - [keys.py:185] - TLS Application Data sent from 192.168.1.1:12345 to 10.0.0.1:443
2025-01-02 00:02:46,026 - INFO - [session.py:239] - Sending encrypted response data
2025-01-02 00:02:46,027 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-02 00:02:46,028 - INFO - [session.py:251] - Attempting to send file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 00:02:46,028 - INFO - [session.py:262] - Opening file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 00:02:46,029 - INFO - [session.py:269] - Read 1103 bytes from file
2025-01-02 00:02:46,030 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-02 00:02:46,031 - INFO - [session.py:278] - File sent successfully
2025-01-02 00:02:46,032 - INFO - [session.py:253] - File sent successfully
2025-01-02 00:02:46,032 - INFO - [main.py:95] - Session completed successfully for 192.168.1.1
2025-01-02 00:02:46,032 - INFO - [main.py:87] - 
--- Client Session (no certificate) ---
2025-01-02 00:02:46,033 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-02 00:02:46,034 - INFO - [cert.py:108] - File exists: True
2025-01-02 00:02:46,035 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-02 00:02:46,035 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-02 00:02:46,036 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-02 00:02:46,036 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-02 00:02:46,037 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 00:02:46,039 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-02 00:02:46,039 - INFO - [cert.py:108] - File exists: True
2025-01-02 00:02:46,040 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-02 00:02:46,040 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-02 00:02:46,041 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-02 00:02:46,041 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-02 00:02:46,043 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 00:02:46,072 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-02 00:02:46,073 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-02 00:02:46,073 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-02 00:02:46,074 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-02 00:02:46,074 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-02 00:02:46,074 - INFO - [verify.py:58] - Public key comparison results:
2025-01-02 00:02:46,074 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 00:02:46,075 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 00:02:46,075 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-02 00:02:46,076 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-02 00:02:46,076 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-02 00:02:46,076 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-02 00:02:46,077 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-02 00:02:46,077 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-02 00:02:46,077 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-02 00:02:46,077 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-02 00:02:46,078 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-02 00:02:46,078 - INFO - [session.py:179] - Starting TLS session
2025-01-02 00:02:46,079 - INFO - [session.py:118] - Starting TLS Handshake...
2025-01-02 00:02:46,079 - INFO - [client.py:100] - Generated client_random: 40f3d489c79a2745da57946cdd9b47874f04ce92f7682ac53ab008d35d5819c7
2025-01-02 00:02:46,082 - INFO - [client.py:143] - Client Hello sent from 192.168.1.2
2025-01-02 00:02:46,085 - INFO - [session.py:123] - Client Hello sent successfully
2025-01-02 00:02:46,086 - INFO - [server.py:94] - Generated server_random: 31059e5a24076ab8bcf18ab1cfb03a773647193bd473ac963d5d58c2f66bcce3
2025-01-02 00:02:46,090 - INFO - [session.py:128] - Server Hello received successfully
2025-01-02 00:02:46,090 - INFO - [client.py:180] - Prepared empty certificate
2025-01-02 00:02:46,091 - INFO - [client.py:192] - Encrypted pre_master_secret length: 256
2025-01-02 00:02:46,092 - INFO - [session.py:133] - Client handshake messages sent successfully
2025-01-02 00:02:46,094 - INFO - [session.py:138] - Server key pair verified successfully
2025-01-02 00:02:46,094 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-02 00:02:46,095 - INFO - [chain.py:185] - Decrypted pre_master_secret: 030357c3a1de806b8d9321b61bd63cfd199ba5e1badf2941e9d1e9be1b440ecab312e6d536975551621ed57bfb9098fd
2025-01-02 00:02:46,095 - INFO - [chain.py:195] - Generated master secret: 0b5a994ac40fae10bd76d9f5f34e8b01a9edf3be667da008e6ec7a05bfc510e6a26a4d55bc15416ff0a6a8e76ddc51f1
2025-01-02 00:02:46,095 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-02 00:02:46,096 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-02 00:02:46,096 - INFO - [session.py:142] - Master Secret handled successfully
2025-01-02 00:02:46,097 - INFO - [client.py:273] - Pre-master secret validated successfully
2025-01-02 00:02:46,098 - INFO - [client.py:291] - Generated digital signature: aa7fbea496ad6e9d5df559347fbead31a39ad6e01ccc2f2fd3982051edb7662a303878945031fedd21465cd9ccaea124f7b0c135f0b456f47a693a41089ba31bb6c9707fdf8fbdef56d0fc5731ebd18ba09c40f2efdb6fa671b739b1c5e6e7a32c4833ff805afdca898c6bd45c1280f9d5c8e001c9ff79257bb15e8da04acfe663974372253ef24205881d2a3ec66ef42f0e8e40c17f05c4b73361a509b557294621a5e4d9bddf71f472e8a48c8246dd192669502105f396c71e5c113b9448fd4678b98551c34a998c2ccaec708785b3253227490c2dcfe4c62fbac2704224b1054d591e3270cdf3961cf9d42b84c628243ef963911396abe964b06b72e5e77f
2025-01-02 00:02:46,101 - INFO - [client.py:337] - Client ChangeCipherSpec and Finished messages sent
2025-01-02 00:02:46,103 - INFO - [session.py:147] - Client Change Cipher Spec sent successfully
2025-01-02 00:02:46,103 - INFO - [server.py:260] - Pre-master secret validated successfully
2025-01-02 00:02:46,104 - INFO - [server.py:278] - Generated digital signature: 91bbd4ff715bdb44a2d2f5257d70ae9f14f08c9f3af58f4139eefc0705f9842431a4aed82728d4105f20a759ab19c88871ebc21c55bab9a0ed7e3087d48a7353e7d2c4bc6e9fb69bbcee4c4b5477db6e3faa709c243ad6413acda0895903104fe7313c393ec38345b07c9e6cf8110a6b2f377bcc6ff16f5662319e1ec16bad687b4b62f6baa41d5f77391628c2d55b3ea7e11f655d9109a8a61d2f7a330bf4261aa59f5fee18c15f0c10ef8f42a7d99935c7ebe78fd89eada82c3ba90044676cd9cbb92f76b7b80c41061705334bc46e03ee5f5b2f87c6d5cbe4c8985a0ca3ba732a44ab863534b6a77c4ba3c7906cb84cc95272402fdba9297b56fee5ba99d3
2025-01-02 00:02:46,106 - INFO - [server.py:324] - Server ChangeCipherSpec and Finished messages sent
2025-01-02 00:02:46,107 - INFO - [session.py:152] - Server Change Cipher Spec received successfully
2025-01-02 00:02:46,107 - INFO - [keys.py:218] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-02 00:02:46,108 - INFO - [session.py:157] - SSL Key Log handled successfully
2025-01-02 00:02:46,108 - INFO - [session.py:161] - TLS Handshake completed successfully
2025-01-02 00:02:46,108 - INFO - [session.py:208] - Handshake completed: True
2025-01-02 00:02:46,109 - INFO - [session.py:209] - Use client cert: False
2025-01-02 00:02:46,109 - INFO - [session.py:210] - File to send: None
2025-01-02 00:02:46,109 - INFO - [session.py:216] - Using unencrypted exchange
2025-01-02 00:02:46,110 - INFO - [session.py:316] - Added request packet
2025-01-02 00:02:46,111 - INFO - [session.py:316] - Added response packet
2025-01-02 00:02:46,111 - WARNING - [session.py:293] - Using unencrypted communication
2025-01-02 00:02:46,111 - INFO - [main.py:95] - Session completed successfully for 192.168.1.2
2025-01-02 00:02:46,112 - INFO - [pcap_writer.py:232] - Packet 13: Valid HTTP message
2025-01-02 00:02:46,112 - INFO - [pcap_writer.py:232] - Packet 14: Valid HTTP message
2025-01-02 00:02:46,116 - INFO - [pcap_writer.py:387] - Saved 15 valid packets to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-02 00:02:46,117 - INFO - [pcap_writer.py:409] - Verifying 15 packets...
2025-01-02 00:02:46,118 - INFO - [pcap_writer.py:413] - Packet 1: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 00:02:46,119 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2025-01-02 00:02:46,119 - INFO - [pcap_writer.py:413] - Packet 2: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 00:02:46,119 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2743
2025-01-02 00:02:46,120 - INFO - [pcap_writer.py:413] - Packet 3: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 00:02:46,120 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 1646
2025-01-02 00:02:46,120 - INFO - [pcap_writer.py:413] - Packet 4: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 00:02:46,121 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-02 00:02:46,121 - INFO - [pcap_writer.py:413] - Packet 5: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 00:02:46,121 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-02 00:02:46,121 - INFO - [pcap_writer.py:413] - Packet 6: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 00:02:46,122 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 160
2025-01-02 00:02:46,122 - INFO - [pcap_writer.py:413] - Packet 7: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 00:02:46,122 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 128
2025-01-02 00:02:46,122 - INFO - [pcap_writer.py:413] - Packet 8: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 00:02:46,123 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 1152
2025-01-02 00:02:46,123 - INFO - [pcap_writer.py:413] - Packet 9: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-02 00:02:46,123 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2025-01-02 00:02:46,124 - INFO - [pcap_writer.py:413] - Packet 10: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-02 00:02:46,124 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2743
2025-01-02 00:02:46,124 - INFO - [pcap_writer.py:413] - Packet 11: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-02 00:02:46,125 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 269
2025-01-02 00:02:46,125 - INFO - [pcap_writer.py:413] - Packet 12: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-02 00:02:46,125 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-02 00:02:46,126 - INFO - [pcap_writer.py:413] - Packet 13: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-02 00:02:46,126 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-02 00:02:46,126 - INFO - [pcap_writer.py:413] - Packet 14: IP / TCP 192.168.1.2:12346 > 10.0.0.1:http PA / Raw
2025-01-02 00:02:46,127 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2025-01-02 00:02:46,127 - INFO - [pcap_writer.py:413] - Packet 15: IP / TCP 10.0.0.1:http > 192.168.1.2:12346 PA / Raw
2025-01-02 00:02:46,127 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2025-01-02 00:02:46,127 - INFO - [pcap_writer.py:427] - Verification complete: 15 valid packets, 15 TLS records
2025-01-02 00:02:46,127 - INFO - [main.py:106] - Results saved to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-02 00:02:46,128 - INFO - [main.py:160] - TLS session simulation completed successfully
2025-01-02 00:03:04,483 - INFO - [logging.py:83] - Logging configured successfully
2025-01-02 00:03:04,483 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-02 00:03:04,484 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-02 00:03:04,484 - INFO - [logging.py:92] - Log level: 20
2025-01-02 00:03:04,484 - INFO - [logging.py:93] - Timestamp: 2025-01-02T00:03:04.484947
2025-01-02 00:03:04,485 - INFO - [logging.py:94] - ==========================
2025-01-02 00:03:04,485 - INFO - [main.py:122] - Starting TLS session simulation
2025-01-02 00:03:04,486 - INFO - [main.py:87] - 
--- Client Session (certificate) ---
2025-01-02 00:03:04,487 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-02 00:03:04,488 - INFO - [cert.py:108] - File exists: True
2025-01-02 00:03:04,488 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-02 00:03:04,489 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-02 00:03:04,489 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-02 00:03:04,490 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-02 00:03:04,490 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 00:03:04,491 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-02 00:03:04,491 - INFO - [cert.py:108] - File exists: True
2025-01-02 00:03:04,492 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-02 00:03:04,492 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-02 00:03:04,493 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-02 00:03:04,493 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-02 00:03:04,494 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 00:03:04,535 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-02 00:03:04,535 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-02 00:03:04,536 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-02 00:03:04,536 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-02 00:03:04,537 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-02 00:03:04,538 - INFO - [verify.py:58] - Public key comparison results:
2025-01-02 00:03:04,538 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 00:03:04,539 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 00:03:04,539 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-02 00:03:04,539 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-02 00:03:04,543 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-02 00:03:04,543 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-02 00:03:04,544 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-02 00:03:04,544 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-02 00:03:04,545 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-02 00:03:04,545 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-02 00:03:04,546 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-02 00:03:04,547 - INFO - [session.py:179] - Starting TLS session
2025-01-02 00:03:04,548 - INFO - [session.py:118] - Starting TLS Handshake...
2025-01-02 00:03:04,548 - INFO - [client.py:100] - Generated client_random: 6f380f4635970c732bd791a4684ec38d01608ec0f5048080f055f1bcf90a7ba4
2025-01-02 00:03:04,554 - INFO - [client.py:143] - Client Hello sent from 192.168.1.1
2025-01-02 00:03:04,558 - INFO - [session.py:123] - Client Hello sent successfully
2025-01-02 00:03:04,559 - INFO - [server.py:94] - Generated server_random: 976462222d9c39033266155129d93012f74b2377c1a8d716e72b9edf9c13a17d
2025-01-02 00:03:04,564 - INFO - [session.py:128] - Server Hello received successfully
2025-01-02 00:03:04,565 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2025-01-02 00:03:04,566 - INFO - [cert.py:108] - File exists: True
2025-01-02 00:03:04,567 - INFO - [cert.py:109] - File size: 1915 bytes
2025-01-02 00:03:04,569 - INFO - [cert.py:113] - Read 1915 bytes
2025-01-02 00:03:04,570 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2025-01-02 00:03:04,571 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2025-01-02 00:03:04,572 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 00:03:04,573 - INFO - [client.py:177] - Prepared client certificate
2025-01-02 00:03:04,573 - INFO - [client.py:192] - Encrypted pre_master_secret length: 256
2025-01-02 00:03:04,574 - INFO - [session.py:133] - Client handshake messages sent successfully
2025-01-02 00:03:04,576 - INFO - [session.py:138] - Server key pair verified successfully
2025-01-02 00:03:04,576 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-02 00:03:04,577 - INFO - [chain.py:185] - Decrypted pre_master_secret: 030300a558e4495aa391f2a9994e69aaeeb464ae7810292bba7b24a559abab3f7d1b44396ad62a7eba2dcce1f0905512
2025-01-02 00:03:04,577 - INFO - [chain.py:195] - Generated master secret: 27c571df9c8bde0bb85200208a5380b3b2a1603d81e4c1322e42f9f7612edf1dd61195569fee602dd3e39a51d7d809fd
2025-01-02 00:03:04,578 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-02 00:03:04,578 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-02 00:03:04,578 - INFO - [session.py:142] - Master Secret handled successfully
2025-01-02 00:03:04,579 - INFO - [client.py:273] - Pre-master secret validated successfully
2025-01-02 00:03:04,581 - INFO - [client.py:291] - Generated digital signature: 318f3208ebc6545b3e6466b3f7c73c62675726fddb46e86629f6f1f8a7e00f369d73e2c6603ca9646ec330045a413ee0aa31393115d213614480ffd524661c127de243966016858023e59e835e503b1690060caed9e64b0ca2e80cc4475ebada248ed0a44f0cccaf64bdcf75813e92b5a9de53ffb0e26850e4c57d22ae640515ea2448acad513a531fc4701ff82359151b684a9b6b0a98b40a4a64a3477acff90a9154bb419d16e8b406407fdc0521ff948079c7ad7d8bf6b67b7d4cd942cd96d05a72f49da7290910512700d96ab252225f636393920752d6d0bbcaa14a3d9776bbd3ae995eff9c6ca205cb7c72b775b7d11a364affe6da50ed538cec2928dc
2025-01-02 00:03:04,584 - INFO - [client.py:337] - Client ChangeCipherSpec and Finished messages sent
2025-01-02 00:03:04,587 - INFO - [session.py:147] - Client Change Cipher Spec sent successfully
2025-01-02 00:03:04,588 - INFO - [server.py:260] - Pre-master secret validated successfully
2025-01-02 00:03:04,589 - INFO - [server.py:278] - Generated digital signature: 4d31b693e10dec13d3b7f2e6324f95811c54780c39414289ddf6375edfc00beed515a84e7e470b7199c104d85f1618293c73eb0536489eb60722a9612de4679b2867cd5462948b4edb49c7e4cd7fc7b896fdf64fab54eece75f8c24aa0f5a0fc6f3a4d5cfea308bb1c84ec18414e0101ccb059dd15a17cd16f82e9bd15f5925373b5232bb1fffb134b1668379b007ea439fa54170dd927f8c3dccb366366f37a4bacf70f3d128cc9939408e5747c00e4859977d88b09656d43993d38d46247989bc3a56424dcc5d16fdf8b81b1b486704b4c8f142e88bdd5e1db144f90665d32b609be9c47446867f83947eb1bc0d5c75c2ceb7af7b70881fdbc89c034c063a6
2025-01-02 00:03:04,591 - INFO - [server.py:324] - Server ChangeCipherSpec and Finished messages sent
2025-01-02 00:03:04,592 - INFO - [session.py:152] - Server Change Cipher Spec received successfully
2025-01-02 00:03:04,593 - INFO - [keys.py:218] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-02 00:03:04,593 - INFO - [session.py:157] - SSL Key Log handled successfully
2025-01-02 00:03:04,594 - INFO - [session.py:161] - TLS Handshake completed successfully
2025-01-02 00:03:04,594 - INFO - [session.py:190] - Found file to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 00:03:04,595 - INFO - [session.py:208] - Handshake completed: True
2025-01-02 00:03:04,595 - INFO - [session.py:209] - Use client cert: True
2025-01-02 00:03:04,596 - INFO - [session.py:210] - File to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 00:03:04,596 - INFO - [session.py:213] - Using encrypted exchange
2025-01-02 00:03:04,597 - INFO - [session.py:228] - Sending encrypted request data
2025-01-02 00:03:04,599 - INFO - [keys.py:185] - TLS Application Data sent from 192.168.1.1:12345 to 10.0.0.1:443
2025-01-02 00:03:04,600 - INFO - [session.py:239] - Sending encrypted response data
2025-01-02 00:03:04,603 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-02 00:03:04,604 - INFO - [session.py:251] - Attempting to send file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 00:03:04,604 - INFO - [session.py:262] - Opening file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 00:03:04,605 - INFO - [session.py:269] - Read 1103 bytes from file
2025-01-02 00:03:04,606 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-02 00:03:04,607 - INFO - [session.py:278] - File sent successfully
2025-01-02 00:03:04,607 - INFO - [session.py:253] - File sent successfully
2025-01-02 00:03:04,607 - INFO - [main.py:95] - Session completed successfully for 192.168.1.1
2025-01-02 00:03:04,607 - INFO - [main.py:87] - 
--- Client Session (no certificate) ---
2025-01-02 00:03:04,608 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-02 00:03:04,608 - INFO - [cert.py:108] - File exists: True
2025-01-02 00:03:04,608 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-02 00:03:04,609 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-02 00:03:04,609 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-02 00:03:04,609 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-02 00:03:04,610 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 00:03:04,610 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-02 00:03:04,611 - INFO - [cert.py:108] - File exists: True
2025-01-02 00:03:04,611 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-02 00:03:04,611 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-02 00:03:04,612 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-02 00:03:04,612 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-02 00:03:04,614 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 00:03:04,656 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-02 00:03:04,657 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-02 00:03:04,657 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-02 00:03:04,657 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-02 00:03:04,657 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-02 00:03:04,658 - INFO - [verify.py:58] - Public key comparison results:
2025-01-02 00:03:04,658 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 00:03:04,658 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 00:03:04,659 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-02 00:03:04,659 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-02 00:03:04,660 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-02 00:03:04,660 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-02 00:03:04,660 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-02 00:03:04,661 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-02 00:03:04,661 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-02 00:03:04,662 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-02 00:03:04,663 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-02 00:03:04,664 - INFO - [session.py:179] - Starting TLS session
2025-01-02 00:03:04,665 - INFO - [session.py:118] - Starting TLS Handshake...
2025-01-02 00:03:04,665 - INFO - [client.py:100] - Generated client_random: 674fc0b7ab0437d99a0700ce1cec74ba3fa7e03d17fc8f6c0f84eac73d4017e5
2025-01-02 00:03:04,670 - INFO - [client.py:143] - Client Hello sent from 192.168.1.2
2025-01-02 00:03:04,672 - INFO - [session.py:123] - Client Hello sent successfully
2025-01-02 00:03:04,672 - INFO - [server.py:94] - Generated server_random: 9245021ba7f2598456918ab80a5bea3eec46d780a9e0306d6af0f4ebafaeaec0
2025-01-02 00:03:04,675 - INFO - [session.py:128] - Server Hello received successfully
2025-01-02 00:03:04,676 - INFO - [client.py:180] - Prepared empty certificate
2025-01-02 00:03:04,676 - INFO - [client.py:192] - Encrypted pre_master_secret length: 256
2025-01-02 00:03:04,678 - INFO - [session.py:133] - Client handshake messages sent successfully
2025-01-02 00:03:04,679 - INFO - [session.py:138] - Server key pair verified successfully
2025-01-02 00:03:04,680 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-02 00:03:04,683 - INFO - [chain.py:185] - Decrypted pre_master_secret: 03038ba21f3123e42a5e8abf17525d49c1c512d6b4d0012b50f42eea3c143d6803c914286259d052c9f169ebfd7073a0
2025-01-02 00:03:04,684 - INFO - [chain.py:195] - Generated master secret: 908e20b5b289ddd3df7b0604ce092b92aa6066c71e323ac1cd1bd26365e37478c961741aabea4e2aa49a39953fccefd3
2025-01-02 00:03:04,686 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-02 00:03:04,688 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-02 00:03:04,688 - INFO - [session.py:142] - Master Secret handled successfully
2025-01-02 00:03:04,689 - INFO - [client.py:273] - Pre-master secret validated successfully
2025-01-02 00:03:04,690 - INFO - [client.py:291] - Generated digital signature: 15311c59872be5fdb50bbfad9de414f7a04019bbc609da79b4ade745893d64613aff72176a72f9498343cc4d67841c166ae283cb83bf6e5581a857009cc55437f0365daac786c2ee581c044b3b6b29bf5e58529740e5c0aa451846594df3259366b0be406a944a6dd729b42941abe004dad61c0108d676e8e0afdbad8ded3c824adca6aa92db70f02515bf8c0868df2de6b4ce204b3785a1fcd755be76d4e3d76a0a2e2a91286e4883513cefacec6b1fa521222d744b9b73b17cafb886221a08786657d8996720a1dafbaa2354d17039e262d365c01afd61d489f37fe1448cad1c9ace7f032c0029287237b58c03ef9818e02144164efe9a7c1b5739b62ae1f4
2025-01-02 00:03:04,691 - INFO - [client.py:337] - Client ChangeCipherSpec and Finished messages sent
2025-01-02 00:03:04,692 - INFO - [session.py:147] - Client Change Cipher Spec sent successfully
2025-01-02 00:03:04,693 - INFO - [server.py:260] - Pre-master secret validated successfully
2025-01-02 00:03:04,694 - INFO - [server.py:278] - Generated digital signature: 8e7e6d72344c54a489376b2252301f94cb414e656b78dc8e659711fbfcc8c29a146300c4670bd6fc8a945b11874f2771b9643675b3848879b9c06a551cc2fa59d6e2ba01339f753f299f8c8c357de8f051331ed72c12a8fac85342d0d82735be0f5a178dc37acda48d1fad5bd8267c5e71c155f2ed5d703ea3aeda4b42fecdadedfb5e6a0962e1d9487bae297e491b6d438ec18b628e19dae28efd4beaf65d449bc18a172b23380d2101da435dbec6d233ae65bc33fcfc7f0c8ecbfb03cda4b09ab910a88d50dc2c8e0da0f8779092e578ae6c12b652f72e0f5a7c24300a8132c8cb5c8a0d0108d19ad070500768683873204f2b8b3ea61d164b28cbcb191d19
2025-01-02 00:03:04,696 - INFO - [server.py:324] - Server ChangeCipherSpec and Finished messages sent
2025-01-02 00:03:04,699 - INFO - [session.py:152] - Server Change Cipher Spec received successfully
2025-01-02 00:03:04,700 - INFO - [keys.py:218] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-02 00:03:04,700 - INFO - [session.py:157] - SSL Key Log handled successfully
2025-01-02 00:03:04,701 - INFO - [session.py:161] - TLS Handshake completed successfully
2025-01-02 00:03:04,701 - INFO - [session.py:208] - Handshake completed: True
2025-01-02 00:03:04,701 - INFO - [session.py:209] - Use client cert: False
2025-01-02 00:03:04,702 - INFO - [session.py:210] - File to send: None
2025-01-02 00:03:04,702 - INFO - [session.py:216] - Using unencrypted exchange
2025-01-02 00:03:04,703 - INFO - [session.py:316] - Added request packet
2025-01-02 00:03:04,704 - INFO - [session.py:316] - Added response packet
2025-01-02 00:03:04,705 - WARNING - [session.py:293] - Using unencrypted communication
2025-01-02 00:03:04,705 - INFO - [main.py:95] - Session completed successfully for 192.168.1.2
2025-01-02 00:03:04,707 - INFO - [pcap_writer.py:232] - Packet 13: Valid HTTP message
2025-01-02 00:03:04,708 - INFO - [pcap_writer.py:232] - Packet 14: Valid HTTP message
2025-01-02 00:03:04,715 - INFO - [pcap_writer.py:387] - Saved 15 valid packets to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-02 00:03:04,716 - INFO - [pcap_writer.py:409] - Verifying 15 packets...
2025-01-02 00:03:04,716 - INFO - [pcap_writer.py:413] - Packet 1: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 00:03:04,717 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2025-01-02 00:03:04,717 - INFO - [pcap_writer.py:413] - Packet 2: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 00:03:04,718 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2743
2025-01-02 00:03:04,718 - INFO - [pcap_writer.py:413] - Packet 3: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 00:03:04,718 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 1646
2025-01-02 00:03:04,718 - INFO - [pcap_writer.py:413] - Packet 4: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 00:03:04,719 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-02 00:03:04,719 - INFO - [pcap_writer.py:413] - Packet 5: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 00:03:04,719 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-02 00:03:04,720 - INFO - [pcap_writer.py:413] - Packet 6: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 00:03:04,720 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 160
2025-01-02 00:03:04,720 - INFO - [pcap_writer.py:413] - Packet 7: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 00:03:04,721 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 128
2025-01-02 00:03:04,721 - INFO - [pcap_writer.py:413] - Packet 8: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 00:03:04,723 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 1152
2025-01-02 00:03:04,725 - INFO - [pcap_writer.py:413] - Packet 9: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-02 00:03:04,726 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2025-01-02 00:03:04,726 - INFO - [pcap_writer.py:413] - Packet 10: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-02 00:03:04,726 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2743
2025-01-02 00:03:04,727 - INFO - [pcap_writer.py:413] - Packet 11: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-02 00:03:04,727 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 269
2025-01-02 00:03:04,727 - INFO - [pcap_writer.py:413] - Packet 12: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-02 00:03:04,727 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-02 00:03:04,728 - INFO - [pcap_writer.py:413] - Packet 13: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-02 00:03:04,728 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-02 00:03:04,728 - INFO - [pcap_writer.py:413] - Packet 14: IP / TCP 192.168.1.2:12346 > 10.0.0.1:http PA / Raw
2025-01-02 00:03:04,728 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2025-01-02 00:03:04,728 - INFO - [pcap_writer.py:413] - Packet 15: IP / TCP 10.0.0.1:http > 192.168.1.2:12346 PA / Raw
2025-01-02 00:03:04,729 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2025-01-02 00:03:04,729 - INFO - [pcap_writer.py:427] - Verification complete: 15 valid packets, 15 TLS records
2025-01-02 00:03:04,730 - INFO - [main.py:106] - Results saved to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-02 00:03:04,730 - INFO - [main.py:160] - TLS session simulation completed successfully
2025-01-02 11:08:58,118 - INFO - [logging.py:83] - Logging configured successfully
2025-01-02 11:08:58,119 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-02 11:08:58,120 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-02 11:08:58,120 - INFO - [logging.py:92] - Log level: 20
2025-01-02 11:08:58,121 - INFO - [logging.py:93] - Timestamp: 2025-01-02T11:08:58.121203
2025-01-02 11:08:58,122 - INFO - [logging.py:94] - ==========================
2025-01-02 11:08:58,122 - INFO - [main.py:122] - Starting TLS session simulation
2025-01-02 11:08:58,122 - INFO - [main.py:87] - 
--- Client Session (certificate) ---
2025-01-02 11:08:58,124 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-02 11:08:58,124 - INFO - [cert.py:108] - File exists: True
2025-01-02 11:08:58,125 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-02 11:08:58,126 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-02 11:08:58,126 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-02 11:08:58,127 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-02 11:08:58,133 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 11:08:58,134 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-02 11:08:58,134 - INFO - [cert.py:108] - File exists: True
2025-01-02 11:08:58,135 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-02 11:08:58,136 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-02 11:08:58,137 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-02 11:08:58,137 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-02 11:08:58,138 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 11:08:58,179 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-02 11:08:58,181 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-02 11:08:58,181 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-02 11:08:58,182 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-02 11:08:58,185 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-02 11:08:58,186 - INFO - [verify.py:58] - Public key comparison results:
2025-01-02 11:08:58,186 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 11:08:58,187 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 11:08:58,188 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-02 11:08:58,188 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-02 11:08:58,192 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-02 11:08:58,193 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-02 11:08:58,194 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-02 11:08:58,194 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-02 11:08:58,195 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-02 11:08:58,197 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-02 11:08:58,201 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-02 11:08:58,202 - INFO - [session.py:179] - Starting TLS session
2025-01-02 11:08:58,202 - INFO - [session.py:118] - Starting TLS Handshake...
2025-01-02 11:08:58,202 - INFO - [client.py:100] - Generated client_random: 88f18355c8e9283fc413446fee61ce60fbd99037dda37f044988dacb59bca8d3
2025-01-02 11:08:58,209 - INFO - [client.py:143] - Client Hello sent from 192.168.1.1
2025-01-02 11:08:58,211 - INFO - [session.py:123] - Client Hello sent successfully
2025-01-02 11:08:58,212 - INFO - [server.py:94] - Generated server_random: dd10267815039fee8c2af3942be50ab2232e655628f19c21070550360dd2fd1e
2025-01-02 11:08:58,219 - INFO - [session.py:128] - Server Hello received successfully
2025-01-02 11:08:58,219 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2025-01-02 11:08:58,220 - INFO - [cert.py:108] - File exists: True
2025-01-02 11:08:58,221 - INFO - [cert.py:109] - File size: 1915 bytes
2025-01-02 11:08:58,222 - INFO - [cert.py:113] - Read 1915 bytes
2025-01-02 11:08:58,222 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2025-01-02 11:08:58,223 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2025-01-02 11:08:58,223 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 11:08:58,224 - INFO - [client.py:177] - Prepared client certificate
2025-01-02 11:08:58,224 - INFO - [client.py:192] - Encrypted pre_master_secret length: 256
2025-01-02 11:08:58,226 - INFO - [session.py:133] - Client handshake messages sent successfully
2025-01-02 11:08:58,228 - INFO - [session.py:138] - Server key pair verified successfully
2025-01-02 11:08:58,228 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-02 11:08:58,230 - INFO - [chain.py:185] - Decrypted pre_master_secret: 03033d512b96d9397781e5fe3f22c69f5a554c7a04e5419e12126c04f1248447c70f15b1a65aef69b797f7a63e391edb
2025-01-02 11:08:58,232 - INFO - [chain.py:195] - Generated master secret: b160905daa5393f615157c601dd865e11fb0e8d3ac37cb66bbf9cf6242fe2e1b1fa8647b2a544b72eb5a5d86bc784149
2025-01-02 11:08:58,233 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-02 11:08:58,233 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-02 11:08:58,233 - INFO - [session.py:142] - Master Secret handled successfully
2025-01-02 11:08:58,235 - INFO - [client.py:273] - Pre-master secret validated successfully
2025-01-02 11:08:58,236 - INFO - [client.py:291] - Generated digital signature: 460ceda32259c62bfc44f52474501cfe7c77d01c5a6c24f22e74c188d7764bfee61b2b19a7e48eea9538643046a698edd4c0c6dbb519a1f0aa18746c57bf2cee4f467e8d5286ef005dffe427b95c5d923745a4e2e00b5591056a34cff709c7d8a46a01c8854280d0f2636e4e384d582d12549b634696ada5450f1265ed57413b5d90730dcef7880b53385a1f0782f1fd0ebc7494fa8482b1fae2e85ed83e525aaedeafd84103c0aade93608d13c766de697df633b4b2e78b9ee94f51742be9f16b7dc8387b5751751751a6770269f2b3e3753d75036bc0d56bac9a1e8a3529dc12ae0f22b5092b328d2d5e1882683454cb70a5f09dfa52a9580b40383ffdd4ed
2025-01-02 11:08:58,238 - INFO - [client.py:337] - Client ChangeCipherSpec and Finished messages sent
2025-01-02 11:08:58,239 - INFO - [session.py:147] - Client Change Cipher Spec sent successfully
2025-01-02 11:08:58,241 - INFO - [server.py:260] - Pre-master secret validated successfully
2025-01-02 11:08:58,242 - INFO - [server.py:278] - Generated digital signature: c94c96bf016e555af823648113d3a49bf617b1ed08643c4429b46c29b2a6eb34c66c1b562e249510f8f712dacc2c4a15dfc69a754446fe9525ac8e52b4a5b19ec33a0e6c6abb27533c218a23fe771f0a37f329c18f899d3e9ed180fb03e68bc0dfb5dbb6ce5152d064131b015ae9fce610258f0690309652e706daececc571d0b535fbf382f5cf8578cbd2de32893d109f2f548274c8d4f8becc35d39e5df0d226930328ec271fa877576d849dd739250385ca8d03890793194a1df8f0422c74d242fe6a19932246936c3c3876bbfd5517afc90e86665e2aa9676d01b4eafce27366b65960b702d913b54967c005f2a4c379f957a6c55d850e1220e5a518404c
2025-01-02 11:08:58,245 - INFO - [server.py:324] - Server ChangeCipherSpec and Finished messages sent
2025-01-02 11:08:58,249 - INFO - [session.py:152] - Server Change Cipher Spec received successfully
2025-01-02 11:08:58,252 - INFO - [keys.py:218] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-02 11:08:58,252 - INFO - [session.py:157] - SSL Key Log handled successfully
2025-01-02 11:08:58,253 - INFO - [session.py:161] - TLS Handshake completed successfully
2025-01-02 11:08:58,254 - INFO - [session.py:190] - Found file to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 11:08:58,254 - INFO - [session.py:208] - Handshake completed: True
2025-01-02 11:08:58,255 - INFO - [session.py:209] - Use client cert: True
2025-01-02 11:08:58,256 - INFO - [session.py:210] - File to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 11:08:58,256 - INFO - [session.py:213] - Using encrypted exchange
2025-01-02 11:08:58,257 - INFO - [session.py:228] - Sending encrypted request data
2025-01-02 11:08:58,261 - INFO - [keys.py:185] - TLS Application Data sent from 192.168.1.1:12345 to 10.0.0.1:443
2025-01-02 11:08:58,263 - INFO - [session.py:239] - Sending encrypted response data
2025-01-02 11:08:58,266 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-02 11:08:58,267 - INFO - [session.py:251] - Attempting to send file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 11:08:58,268 - INFO - [session.py:262] - Opening file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 11:08:58,269 - INFO - [session.py:269] - Read 1103 bytes from file
2025-01-02 11:08:58,271 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-02 11:08:58,272 - INFO - [session.py:278] - File sent successfully
2025-01-02 11:08:58,272 - INFO - [session.py:253] - File sent successfully
2025-01-02 11:08:58,272 - INFO - [main.py:95] - Session completed successfully for 192.168.1.1
2025-01-02 11:08:58,273 - INFO - [main.py:87] - 
--- Client Session (no certificate) ---
2025-01-02 11:08:58,274 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-02 11:08:58,275 - INFO - [cert.py:108] - File exists: True
2025-01-02 11:08:58,275 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-02 11:08:58,276 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-02 11:08:58,276 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-02 11:08:58,276 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-02 11:08:58,279 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 11:08:58,279 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-02 11:08:58,281 - INFO - [cert.py:108] - File exists: True
2025-01-02 11:08:58,282 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-02 11:08:58,283 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-02 11:08:58,283 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-02 11:08:58,284 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-02 11:08:58,284 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 11:08:58,314 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-02 11:08:58,315 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-02 11:08:58,315 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-02 11:08:58,316 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-02 11:08:58,316 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-02 11:08:58,316 - INFO - [verify.py:58] - Public key comparison results:
2025-01-02 11:08:58,317 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 11:08:58,318 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 11:08:58,318 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-02 11:08:58,319 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-02 11:08:58,319 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-02 11:08:58,319 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-02 11:08:58,320 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-02 11:08:58,320 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-02 11:08:58,320 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-02 11:08:58,321 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-02 11:08:58,321 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-02 11:08:58,322 - INFO - [session.py:179] - Starting TLS session
2025-01-02 11:08:58,322 - INFO - [session.py:118] - Starting TLS Handshake...
2025-01-02 11:08:58,322 - INFO - [client.py:100] - Generated client_random: 768dfeab7a4764f748090f58b842085873638e4ebe28785fc56f01eeb8f8e5a3
2025-01-02 11:08:58,324 - INFO - [client.py:143] - Client Hello sent from 192.168.1.2
2025-01-02 11:08:58,326 - INFO - [session.py:123] - Client Hello sent successfully
2025-01-02 11:08:58,326 - INFO - [server.py:94] - Generated server_random: 8c4a25fa328bb5e9ad95ca58949475b6c5ac36109c65debf3823a0eb06b929b2
2025-01-02 11:08:58,331 - INFO - [session.py:128] - Server Hello received successfully
2025-01-02 11:08:58,332 - INFO - [client.py:180] - Prepared empty certificate
2025-01-02 11:08:58,332 - INFO - [client.py:192] - Encrypted pre_master_secret length: 256
2025-01-02 11:08:58,334 - INFO - [session.py:133] - Client handshake messages sent successfully
2025-01-02 11:08:58,335 - INFO - [session.py:138] - Server key pair verified successfully
2025-01-02 11:08:58,335 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-02 11:08:58,336 - INFO - [chain.py:185] - Decrypted pre_master_secret: 0303d1866bc713a49a5717da4b6f146cc332d7fac8a63c0fdaeeb9130492460fcae916c1fa9d466e1bb2e8cdd63be55b
2025-01-02 11:08:58,336 - INFO - [chain.py:195] - Generated master secret: 67be88398cb6fcf6faee4c58d3d925945d66d486f91ef929076ad2a40e2d84b5c3e1d5b343a44ef45e70bd4704bc2eba
2025-01-02 11:08:58,336 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-02 11:08:58,337 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-02 11:08:58,337 - INFO - [session.py:142] - Master Secret handled successfully
2025-01-02 11:08:58,338 - INFO - [client.py:273] - Pre-master secret validated successfully
2025-01-02 11:08:58,339 - INFO - [client.py:291] - Generated digital signature: 3f13e19db9d168d6c4be5b5c0b8a17ccca56fc6727bafa8381b7a475a48764c2c06c457c1121458c2caf3e6f08a8e8f21744de1c683fae974d7209c5bd236f76083cd96d6220667c6b9ce12cc51135d6dccd0313f2880cdebafadba5c16f5f18bcb3903ba498b43ad08edeab2e88c13d9d0d691bddf75450740706b641185ee494d62f2d65c396d6aff5f8d87da27d524f567fcd6eaa6c03e5c86eee9cb416dfa3c41fbeab22f12a4a10db0d8cbe4c01ba70d917f7589c86f4c59b2500defe74977596555ce40ffd17639789e9d908951e59f2fa203449569032f6f8b03f0a6d5f9f18ebbf6b533d600858aa44e437f7631df29b3c2fbe7daa76a20991c70bd0
2025-01-02 11:08:58,340 - INFO - [client.py:337] - Client ChangeCipherSpec and Finished messages sent
2025-01-02 11:08:58,341 - INFO - [session.py:147] - Client Change Cipher Spec sent successfully
2025-01-02 11:08:58,342 - INFO - [server.py:260] - Pre-master secret validated successfully
2025-01-02 11:08:58,343 - INFO - [server.py:278] - Generated digital signature: 3be7bda66dbdab25f7cdf40c9aaab09659b17764e13d406578b7552c0ce00c7729f38ce681303e12f4a3d73411a8a103119d00215635962ef26c22054e8a0f66aa8d06f08bc25dc8bebe8c9199d8a3191ff37d71028a7e7b10bc18b67faf49152aabe2f107852241c12dc5ce7432d4bc3fbc2e42aefb00f5a56cde04b04960214b2f547f83882fdbeab86d857e356b35fd801c9e671d46b8ad175623ae6fbcc2b85eb68a7257c8dd472a51fd679127683605f502b99ac10fde3d14d3aa0429fa70f52df088f0f059389aff6317983fc18991dcfb17d8215497578a3a605ccf254ddad024b7e31b9867aaa07133932d5b43ddeb4da50443672c2d7c4b02857461
2025-01-02 11:08:58,345 - INFO - [server.py:324] - Server ChangeCipherSpec and Finished messages sent
2025-01-02 11:08:58,346 - INFO - [session.py:152] - Server Change Cipher Spec received successfully
2025-01-02 11:08:58,348 - INFO - [keys.py:218] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-02 11:08:58,348 - INFO - [session.py:157] - SSL Key Log handled successfully
2025-01-02 11:08:58,349 - INFO - [session.py:161] - TLS Handshake completed successfully
2025-01-02 11:08:58,349 - INFO - [session.py:208] - Handshake completed: True
2025-01-02 11:08:58,349 - INFO - [session.py:209] - Use client cert: False
2025-01-02 11:08:58,350 - INFO - [session.py:210] - File to send: None
2025-01-02 11:08:58,350 - INFO - [session.py:216] - Using unencrypted exchange
2025-01-02 11:08:58,351 - INFO - [session.py:316] - Added request packet
2025-01-02 11:08:58,351 - INFO - [session.py:316] - Added response packet
2025-01-02 11:08:58,352 - WARNING - [session.py:293] - Using unencrypted communication
2025-01-02 11:08:58,352 - INFO - [main.py:95] - Session completed successfully for 192.168.1.2
2025-01-02 11:08:58,352 - INFO - [pcap_writer.py:232] - Packet 13: Valid HTTP message
2025-01-02 11:08:58,353 - INFO - [pcap_writer.py:232] - Packet 14: Valid HTTP message
2025-01-02 11:08:58,357 - INFO - [pcap_writer.py:387] - Saved 15 valid packets to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-02 11:08:58,357 - INFO - [pcap_writer.py:409] - Verifying 15 packets...
2025-01-02 11:08:58,358 - INFO - [pcap_writer.py:413] - Packet 1: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 11:08:58,358 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2025-01-02 11:08:58,359 - INFO - [pcap_writer.py:413] - Packet 2: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 11:08:58,359 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2743
2025-01-02 11:08:58,359 - INFO - [pcap_writer.py:413] - Packet 3: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 11:08:58,360 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 1646
2025-01-02 11:08:58,360 - INFO - [pcap_writer.py:413] - Packet 4: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 11:08:58,360 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-02 11:08:58,360 - INFO - [pcap_writer.py:413] - Packet 5: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 11:08:58,361 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-02 11:08:58,361 - INFO - [pcap_writer.py:413] - Packet 6: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 11:08:58,362 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 160
2025-01-02 11:08:58,363 - INFO - [pcap_writer.py:413] - Packet 7: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 11:08:58,363 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 128
2025-01-02 11:08:58,365 - INFO - [pcap_writer.py:413] - Packet 8: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 11:08:58,365 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 1152
2025-01-02 11:08:58,366 - INFO - [pcap_writer.py:413] - Packet 9: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-02 11:08:58,366 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2025-01-02 11:08:58,367 - INFO - [pcap_writer.py:413] - Packet 10: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-02 11:08:58,367 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2743
2025-01-02 11:08:58,368 - INFO - [pcap_writer.py:413] - Packet 11: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-02 11:08:58,368 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 269
2025-01-02 11:08:58,368 - INFO - [pcap_writer.py:413] - Packet 12: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-02 11:08:58,369 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-02 11:08:58,369 - INFO - [pcap_writer.py:413] - Packet 13: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-02 11:08:58,369 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-02 11:08:58,370 - INFO - [pcap_writer.py:413] - Packet 14: IP / TCP 192.168.1.2:12346 > 10.0.0.1:http PA / Raw
2025-01-02 11:08:58,370 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2025-01-02 11:08:58,370 - INFO - [pcap_writer.py:413] - Packet 15: IP / TCP 10.0.0.1:http > 192.168.1.2:12346 PA / Raw
2025-01-02 11:08:58,371 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2025-01-02 11:08:58,371 - INFO - [pcap_writer.py:427] - Verification complete: 15 valid packets, 15 TLS records
2025-01-02 11:08:58,371 - INFO - [main.py:106] - Results saved to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-02 11:08:58,371 - INFO - [main.py:160] - TLS session simulation completed successfully
2025-01-02 11:11:43,773 - INFO - [logging.py:83] - Logging configured successfully
2025-01-02 11:11:43,774 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-02 11:11:43,774 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-02 11:11:43,775 - INFO - [logging.py:92] - Log level: 20
2025-01-02 11:11:43,775 - INFO - [logging.py:93] - Timestamp: 2025-01-02T11:11:43.775468
2025-01-02 11:11:43,775 - INFO - [logging.py:94] - ==========================
2025-01-02 11:11:43,776 - INFO - [main.py:122] - Starting TLS session simulation
2025-01-02 11:11:43,776 - INFO - [main.py:87] - 
--- Client Session (certificate) ---
2025-01-02 11:11:43,778 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-02 11:11:43,778 - INFO - [cert.py:108] - File exists: True
2025-01-02 11:11:43,778 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-02 11:11:43,779 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-02 11:11:43,779 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-02 11:11:43,779 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-02 11:11:43,784 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 11:11:43,784 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-02 11:11:43,785 - INFO - [cert.py:108] - File exists: True
2025-01-02 11:11:43,785 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-02 11:11:43,785 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-02 11:11:43,786 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-02 11:11:43,786 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-02 11:11:43,787 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 11:11:43,829 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-02 11:11:43,830 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-02 11:11:43,830 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-02 11:11:43,832 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-02 11:11:43,835 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-02 11:11:43,836 - INFO - [verify.py:58] - Public key comparison results:
2025-01-02 11:11:43,836 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 11:11:43,837 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 11:11:43,838 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-02 11:11:43,839 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-02 11:11:43,844 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-02 11:11:43,845 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-02 11:11:43,846 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-02 11:11:43,846 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-02 11:11:43,847 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-02 11:11:43,847 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-02 11:11:43,848 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-02 11:11:43,849 - INFO - [session.py:179] - Starting TLS session
2025-01-02 11:11:43,849 - INFO - [session.py:118] - Starting TLS Handshake...
2025-01-02 11:11:43,849 - INFO - [client.py:100] - Generated client_random: 17c443ce22344a956f10bd0b19eb072edd689efad6872d710c1b3faac6510417
2025-01-02 11:11:43,854 - INFO - [client.py:143] - Client Hello sent from 192.168.1.1
2025-01-02 11:11:43,858 - INFO - [session.py:123] - Client Hello sent successfully
2025-01-02 11:11:43,859 - INFO - [server.py:94] - Generated server_random: d9f395dbc892eeacde1c9161203daff14048a4c5f2115e3f74b37f87b675aa6d
2025-01-02 11:11:43,863 - INFO - [session.py:128] - Server Hello received successfully
2025-01-02 11:11:43,863 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2025-01-02 11:11:43,864 - INFO - [cert.py:108] - File exists: True
2025-01-02 11:11:43,864 - INFO - [cert.py:109] - File size: 1915 bytes
2025-01-02 11:11:43,865 - INFO - [cert.py:113] - Read 1915 bytes
2025-01-02 11:11:43,865 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2025-01-02 11:11:43,866 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2025-01-02 11:11:43,867 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 11:11:43,867 - INFO - [client.py:177] - Prepared client certificate
2025-01-02 11:11:43,868 - INFO - [client.py:192] - Encrypted pre_master_secret length: 256
2025-01-02 11:11:43,869 - INFO - [session.py:133] - Client handshake messages sent successfully
2025-01-02 11:11:43,870 - INFO - [session.py:138] - Server key pair verified successfully
2025-01-02 11:11:43,871 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-02 11:11:43,872 - INFO - [chain.py:185] - Decrypted pre_master_secret: 0303141870d34a2271deaf063937129aa59066c8612aab4b2332f2eabce7d62fcdc367724802937a2f2b45e42fe0f111
2025-01-02 11:11:43,872 - INFO - [chain.py:195] - Generated master secret: 5b47e6ff0bdb3af8ed057361f23616832fc1b3983c88082683764ecdcdf74a4650dfe624fdb8eabc670e503ae1dbee9c
2025-01-02 11:11:43,873 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-02 11:11:43,873 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-02 11:11:43,874 - INFO - [session.py:142] - Master Secret handled successfully
2025-01-02 11:11:43,875 - INFO - [client.py:273] - Pre-master secret validated successfully
2025-01-02 11:11:43,876 - INFO - [client.py:291] - Generated digital signature: 005ba7c156fd6925f834c3a4c37d93b7b0a19cd08d093f2c9b9a7fa9ebbf0fda0b3a9ec7ca9f4134cf8f0146343d9dac14aa8329646e623833b2528d4fb9128c9a0abcfea85e3e423913b5ed53fa490a196a26533fb00997b6ed43e40698ca3f4ac111da7943dea3db8a99bc80fd93dadd90ed012ca4b4b35ad16f2b1ccb252f404f822be777ab8286242ce28a0c434e0050f858ddfbdf7f5c574ac8c1f70bc51b508e56647079481bccb3aeec2de6f9ae64a9cbd1000ca16adc1c06cdd554ee28afc53fce7ebe5d264bd28738b3ff46cf46eb383e92cb18bdfc4d67282964651a7bb7d5c576f62c2cb2e739e86538d061fd1134860485512c8b7afc40d6359f
2025-01-02 11:11:43,878 - INFO - [client.py:337] - Client ChangeCipherSpec and Finished messages sent
2025-01-02 11:11:43,880 - INFO - [session.py:147] - Client Change Cipher Spec sent successfully
2025-01-02 11:11:43,880 - INFO - [server.py:260] - Pre-master secret validated successfully
2025-01-02 11:11:43,882 - INFO - [server.py:278] - Generated digital signature: 2e36f8a0a62ea5b56971e6ceca22b646031483333187301e641de9aba8d269f9af50788b566ab4703f25bebdec1558402ca4edb98e8c7fd333ebf0395ae78121ad4877f2140c8594a9178dd6b371274edd06289cc0469c1d5ac72769ebfcc337c50387b6c63b8f0b90543b28b2a5d682a741aa73b7ea1e908e398ac7ba1711d710c87221da3ebc345c21988f77516243a1b9eeb11f587d6bb11cb7f67d708c246223621b1b2b7b4990052d854abd636ea4282f74239583677f17cbf23226281395db215203069ca458b735615d8cc66092365d2f4589197d3dec772be8e79f3e44c232e3afe674a27ae6aa9e0436a974c5858b3a252e79cfd9887fc67387689b
2025-01-02 11:11:43,883 - INFO - [server.py:324] - Server ChangeCipherSpec and Finished messages sent
2025-01-02 11:11:43,884 - INFO - [session.py:152] - Server Change Cipher Spec received successfully
2025-01-02 11:11:43,885 - INFO - [keys.py:218] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-02 11:11:43,885 - INFO - [session.py:157] - SSL Key Log handled successfully
2025-01-02 11:11:43,886 - INFO - [session.py:161] - TLS Handshake completed successfully
2025-01-02 11:11:43,887 - INFO - [session.py:190] - Found file to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 11:11:43,887 - INFO - [session.py:208] - Handshake completed: True
2025-01-02 11:11:43,887 - INFO - [session.py:209] - Use client cert: True
2025-01-02 11:11:43,888 - INFO - [session.py:210] - File to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 11:11:43,889 - INFO - [session.py:213] - Using encrypted exchange
2025-01-02 11:11:43,890 - INFO - [session.py:228] - Sending encrypted request data
2025-01-02 11:11:43,892 - INFO - [keys.py:185] - TLS Application Data sent from 192.168.1.1:12345 to 10.0.0.1:443
2025-01-02 11:11:43,893 - INFO - [session.py:239] - Sending encrypted response data
2025-01-02 11:11:43,894 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-02 11:11:43,895 - INFO - [session.py:251] - Attempting to send file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 11:11:43,895 - INFO - [session.py:262] - Opening file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 11:11:43,896 - INFO - [session.py:269] - Read 1103 bytes from file
2025-01-02 11:11:43,897 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-02 11:11:43,897 - INFO - [session.py:278] - File sent successfully
2025-01-02 11:11:43,897 - INFO - [session.py:253] - File sent successfully
2025-01-02 11:11:43,898 - INFO - [main.py:95] - Session completed successfully for 192.168.1.1
2025-01-02 11:11:43,898 - INFO - [main.py:87] - 
--- Client Session (no certificate) ---
2025-01-02 11:11:43,899 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-02 11:11:43,899 - INFO - [cert.py:108] - File exists: True
2025-01-02 11:11:43,900 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-02 11:11:43,900 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-02 11:11:43,901 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-02 11:11:43,905 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-02 11:11:43,909 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 11:11:43,910 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-02 11:11:43,910 - INFO - [cert.py:108] - File exists: True
2025-01-02 11:11:43,911 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-02 11:11:43,911 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-02 11:11:43,912 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-02 11:11:43,912 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-02 11:11:43,913 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 11:11:43,943 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-02 11:11:43,944 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-02 11:11:43,944 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-02 11:11:43,945 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-02 11:11:43,945 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-02 11:11:43,945 - INFO - [verify.py:58] - Public key comparison results:
2025-01-02 11:11:43,945 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 11:11:43,946 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 11:11:43,946 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-02 11:11:43,947 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-02 11:11:43,947 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-02 11:11:43,948 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-02 11:11:43,948 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-02 11:11:43,948 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-02 11:11:43,948 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-02 11:11:43,949 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-02 11:11:43,950 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-02 11:11:43,951 - INFO - [session.py:179] - Starting TLS session
2025-01-02 11:11:43,951 - INFO - [session.py:118] - Starting TLS Handshake...
2025-01-02 11:11:43,951 - INFO - [client.py:100] - Generated client_random: 01bfec52100ba1cbb902b9776361642b58ae60f11255721389a2f41b53b45e29
2025-01-02 11:11:43,953 - INFO - [client.py:143] - Client Hello sent from 192.168.1.2
2025-01-02 11:11:43,955 - INFO - [session.py:123] - Client Hello sent successfully
2025-01-02 11:11:43,955 - INFO - [server.py:94] - Generated server_random: 64e2688a8570c7230265b3a6b08da5b10c714d477f3d4b8a6efb84f998c57adc
2025-01-02 11:11:43,961 - INFO - [session.py:128] - Server Hello received successfully
2025-01-02 11:11:43,961 - INFO - [client.py:180] - Prepared empty certificate
2025-01-02 11:11:43,962 - INFO - [client.py:192] - Encrypted pre_master_secret length: 256
2025-01-02 11:11:43,964 - INFO - [session.py:133] - Client handshake messages sent successfully
2025-01-02 11:11:43,965 - INFO - [session.py:138] - Server key pair verified successfully
2025-01-02 11:11:43,965 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-02 11:11:43,966 - INFO - [chain.py:185] - Decrypted pre_master_secret: 03039b7f15521bc2f05bfad7c157928c5eb08cef88f540847883803ece85317c1554faa540fcfb9dd5724521dcc5b1cc
2025-01-02 11:11:43,966 - INFO - [chain.py:195] - Generated master secret: 67e9088faf2fd64fb2c00320a2620eb9384515a14962e9861cfbd39c5db4027788e29f07fd6d156daee062c461c21236
2025-01-02 11:11:43,967 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-02 11:11:43,967 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-02 11:11:43,967 - INFO - [session.py:142] - Master Secret handled successfully
2025-01-02 11:11:43,968 - INFO - [client.py:273] - Pre-master secret validated successfully
2025-01-02 11:11:43,969 - INFO - [client.py:291] - Generated digital signature: cc333c1af3f5186ceb89aaa5bc665e2e0bf2e66595ce89dbb413f3a933f0abc91a4ec48bfd43f26be12fa61cdc9f770b54456757bd94e5744577d2020fa66c33352c365520ac07bae1d5d833e6aa625887ef1b64fce07b835b80c19dfe4c198c719e2586fe9e54a3ba05f1f7fcb107f75d26ee81f802c3054cb2e424438dbebcea2f5107607266858e225cd9228185fa1dc62fea7ee2919f26ddffb95498aecb672480624b39d45809edb41faa3cada4d110715c6c445098b4aa5db4e1bbdaf1c6e85f57f0bb43176dbbc1e66c180ccdb183f346fbf7931a1327592e431969b9ac8a80dd2aeea9411c74dcdf4c3e22ea65bfddfaf362d73132a753ff0f969ace
2025-01-02 11:11:43,971 - INFO - [client.py:337] - Client ChangeCipherSpec and Finished messages sent
2025-01-02 11:11:43,973 - INFO - [session.py:147] - Client Change Cipher Spec sent successfully
2025-01-02 11:11:43,974 - INFO - [server.py:260] - Pre-master secret validated successfully
2025-01-02 11:11:43,975 - INFO - [server.py:278] - Generated digital signature: d8d90e738f5f35c2a3bbb6c2e6c211d62dc9661a75a15d7a6d623a1f8876f52c5c77bcee260026846325f4fc4be0483716cfcd1ac039c797ab93392b7de80e377d4631f7762fa56ffc77f2f85910f62bc0932c3d6549eaa281ecdb5c8314ef13d4ae8ee8dcf10d494f9da56ec3febc713cddeee272bead6192d1ff1676ec2659db3ea8b071c582015cb9247de690d8cfe485bca68a112195361c43a26f15063003f82322c36473623eb1d155124fef669f64aba5dca7b94c52fa54b8eaef8f5449ece238b5894437ee96fe161e290ca48d1ff3206f872e0d49862be658f35f1540a4c776129bec181452aef865e9faa57cde66bd7fb5038ad2d5ba8792159e84
2025-01-02 11:11:43,978 - INFO - [server.py:324] - Server ChangeCipherSpec and Finished messages sent
2025-01-02 11:11:43,979 - INFO - [session.py:152] - Server Change Cipher Spec received successfully
2025-01-02 11:11:43,980 - INFO - [keys.py:218] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-02 11:11:43,981 - INFO - [session.py:157] - SSL Key Log handled successfully
2025-01-02 11:11:43,981 - INFO - [session.py:161] - TLS Handshake completed successfully
2025-01-02 11:11:43,981 - INFO - [session.py:208] - Handshake completed: True
2025-01-02 11:11:43,981 - INFO - [session.py:209] - Use client cert: False
2025-01-02 11:11:43,982 - INFO - [session.py:210] - File to send: None
2025-01-02 11:11:43,982 - INFO - [session.py:216] - Using unencrypted exchange
2025-01-02 11:11:43,982 - INFO - [session.py:316] - Added request packet
2025-01-02 11:11:43,983 - INFO - [session.py:316] - Added response packet
2025-01-02 11:11:43,983 - WARNING - [session.py:293] - Using unencrypted communication
2025-01-02 11:11:43,983 - INFO - [main.py:95] - Session completed successfully for 192.168.1.2
2025-01-02 11:11:43,984 - INFO - [pcap_writer.py:232] - Packet 13: Valid HTTP message
2025-01-02 11:11:43,984 - INFO - [pcap_writer.py:232] - Packet 14: Valid HTTP message
2025-01-02 11:11:43,990 - INFO - [pcap_writer.py:387] - Saved 15 valid packets to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-02 11:11:43,991 - INFO - [pcap_writer.py:409] - Verifying 15 packets...
2025-01-02 11:11:43,992 - INFO - [pcap_writer.py:413] - Packet 1: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 11:11:43,992 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2025-01-02 11:11:43,993 - INFO - [pcap_writer.py:413] - Packet 2: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 11:11:43,993 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2743
2025-01-02 11:11:43,993 - INFO - [pcap_writer.py:413] - Packet 3: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 11:11:43,994 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 1646
2025-01-02 11:11:43,994 - INFO - [pcap_writer.py:413] - Packet 4: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 11:11:43,994 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-02 11:11:43,994 - INFO - [pcap_writer.py:413] - Packet 5: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 11:11:43,995 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-02 11:11:43,995 - INFO - [pcap_writer.py:413] - Packet 6: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 11:11:43,995 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 160
2025-01-02 11:11:43,995 - INFO - [pcap_writer.py:413] - Packet 7: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 11:11:43,996 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 128
2025-01-02 11:11:43,996 - INFO - [pcap_writer.py:413] - Packet 8: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 11:11:43,996 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 1152
2025-01-02 11:11:43,997 - INFO - [pcap_writer.py:413] - Packet 9: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-02 11:11:43,997 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2025-01-02 11:11:43,998 - INFO - [pcap_writer.py:413] - Packet 10: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-02 11:11:43,998 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2743
2025-01-02 11:11:43,999 - INFO - [pcap_writer.py:413] - Packet 11: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-02 11:11:43,999 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 269
2025-01-02 11:11:43,999 - INFO - [pcap_writer.py:413] - Packet 12: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-02 11:11:43,999 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-02 11:11:44,000 - INFO - [pcap_writer.py:413] - Packet 13: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-02 11:11:44,000 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-02 11:11:44,000 - INFO - [pcap_writer.py:413] - Packet 14: IP / TCP 192.168.1.2:12346 > 10.0.0.1:http PA / Raw
2025-01-02 11:11:44,000 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2025-01-02 11:11:44,000 - INFO - [pcap_writer.py:413] - Packet 15: IP / TCP 10.0.0.1:http > 192.168.1.2:12346 PA / Raw
2025-01-02 11:11:44,001 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2025-01-02 11:11:44,001 - INFO - [pcap_writer.py:427] - Verification complete: 15 valid packets, 15 TLS records
2025-01-02 11:11:44,001 - INFO - [main.py:106] - Results saved to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-02 11:11:44,002 - INFO - [main.py:160] - TLS session simulation completed successfully
2025-01-02 11:14:17,281 - INFO - [logging.py:83] - Logging configured successfully
2025-01-02 11:14:17,282 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-02 11:14:17,282 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-02 11:14:17,283 - INFO - [logging.py:92] - Log level: 20
2025-01-02 11:14:17,283 - INFO - [logging.py:93] - Timestamp: 2025-01-02T11:14:17.283696
2025-01-02 11:14:17,284 - INFO - [logging.py:94] - ==========================
2025-01-02 11:14:17,284 - INFO - [main.py:122] - Starting TLS session simulation
2025-01-02 11:14:17,285 - INFO - [main.py:87] - 
--- Client Session (certificate) ---
2025-01-02 11:14:17,286 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-02 11:14:17,287 - INFO - [cert.py:108] - File exists: True
2025-01-02 11:14:17,288 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-02 11:14:17,289 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-02 11:14:17,290 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-02 11:14:17,292 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-02 11:14:17,296 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 11:14:17,299 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-02 11:14:17,302 - INFO - [cert.py:108] - File exists: True
2025-01-02 11:14:17,305 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-02 11:14:17,307 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-02 11:14:17,309 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-02 11:14:17,312 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-02 11:14:17,316 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 11:14:17,370 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-02 11:14:17,371 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-02 11:14:17,372 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-02 11:14:17,372 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-02 11:14:17,374 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-02 11:14:17,375 - INFO - [verify.py:58] - Public key comparison results:
2025-01-02 11:14:17,375 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 11:14:17,376 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 11:14:17,379 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-02 11:14:17,380 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-02 11:14:17,384 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-02 11:14:17,386 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-02 11:14:17,388 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-02 11:14:17,390 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-02 11:14:17,393 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-02 11:14:17,395 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-02 11:14:17,400 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-02 11:14:17,403 - INFO - [session.py:179] - Starting TLS session
2025-01-02 11:14:17,405 - INFO - [session.py:118] - Starting TLS Handshake...
2025-01-02 11:14:17,408 - INFO - [client.py:100] - Generated client_random: b9ba5413edc30238654c630b07c938b9a985410c34e03113cbe4f0ff6388f66b
2025-01-02 11:14:17,427 - INFO - [client.py:143] - Client Hello sent from 192.168.1.1
2025-01-02 11:14:17,433 - INFO - [session.py:123] - Client Hello sent successfully
2025-01-02 11:14:17,434 - INFO - [server.py:94] - Generated server_random: fb9ec9427127914bea36742e659f0b4b5dc174c3c8b083aca88585caae4c1862
2025-01-02 11:14:17,446 - INFO - [session.py:128] - Server Hello received successfully
2025-01-02 11:14:17,447 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2025-01-02 11:14:17,448 - INFO - [cert.py:108] - File exists: True
2025-01-02 11:14:17,450 - INFO - [cert.py:109] - File size: 1915 bytes
2025-01-02 11:14:17,452 - INFO - [cert.py:113] - Read 1915 bytes
2025-01-02 11:14:17,453 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2025-01-02 11:14:17,455 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2025-01-02 11:14:17,458 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 11:14:17,460 - INFO - [client.py:177] - Prepared client certificate
2025-01-02 11:14:17,460 - INFO - [client.py:192] - Encrypted pre_master_secret length: 256
2025-01-02 11:14:17,464 - INFO - [session.py:133] - Client handshake messages sent successfully
2025-01-02 11:14:17,468 - INFO - [session.py:138] - Server key pair verified successfully
2025-01-02 11:14:17,469 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-02 11:14:17,475 - INFO - [chain.py:185] - Decrypted pre_master_secret: 0303aaa348b2b742c9ee4448b655cd581c16127209f5c01e85e86f0ab42d9fed09d59dbdabf1619fb4f70a911f8e472e
2025-01-02 11:14:17,476 - INFO - [chain.py:195] - Generated master secret: 79712de8702bf93d827be20b17785dea11fb32d4e8b9c8cf222f960e6972b8b3dcc29ef37255876e5a51a9f5f555b2ff
2025-01-02 11:14:17,477 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-02 11:14:17,478 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-02 11:14:17,479 - INFO - [session.py:142] - Master Secret handled successfully
2025-01-02 11:14:17,481 - INFO - [client.py:273] - Pre-master secret validated successfully
2025-01-02 11:14:17,489 - INFO - [client.py:291] - Generated digital signature: 98149f946d1d616e4c1b2ba7241cb405c8b898b85b5cf48f17968a5627f04897e80f7ca16dac82bc902d86db7ff65c4753598f6ce311b74b9bbf86161c2093862516bc25a5f154a0fb39778c4dddc8c9ed83051e17ff44825a8fefa6a3152d2c6c91211e15f92b99abfc9895a11e6864cdcc30128b5a1b7fab8cf3f1daaa0d28d2e525a58fdca5467719a0023d8a24f9d615b2fb14d4984f812603f333c13e548872159fe1e953b0f41c0f306363463d182f2f09bc7e2c1662e15bb144e0fb36973f614943b41591c27c7915fd1c30a3dbcc1ed7b4e9082b80a4ba38fe12c366e4ccecb06bb9fe675af8084ab705c9cce5bdd29a4e7345db655ab4b481569bf9
2025-01-02 11:14:17,497 - INFO - [client.py:337] - Client ChangeCipherSpec and Finished messages sent
2025-01-02 11:14:17,502 - INFO - [session.py:147] - Client Change Cipher Spec sent successfully
2025-01-02 11:14:17,507 - INFO - [server.py:260] - Pre-master secret validated successfully
2025-01-02 11:14:17,510 - INFO - [server.py:278] - Generated digital signature: 013f5f2de39211ab7c9bb3bb7e655782b39f625b091f4a3e29fdcfef4920b72d7ec1c63906af6367ed6a4de700de344543e4158c409ab7cd3e33f0689f9d752dda5cac24c64b24e4d04b66fd0e955c5864015452ab38797f868756eca526c99c63f88e6bce2128ce591cece09576430ef10cf2b53d9995d28537e49b2f0c4225fc89b9a2659857548f875f3e96ecdf9fad1f57ff0eff07276a22403044944dc265cff73e7ba4dd41a77b86e0e5d5d0c371cc16674f7716ae8848d2f5604f2dd77e5335f48482b4c87846d0669214f1e51fcb4c4d4f6d561a5a28c346209c9e95951d5f7935a1807103e1edb9dc6d712be4dd308503ab2576c28c89d0f0617998
2025-01-02 11:14:17,515 - INFO - [server.py:324] - Server ChangeCipherSpec and Finished messages sent
2025-01-02 11:14:17,519 - INFO - [session.py:152] - Server Change Cipher Spec received successfully
2025-01-02 11:14:17,523 - INFO - [keys.py:218] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-02 11:14:17,525 - INFO - [session.py:157] - SSL Key Log handled successfully
2025-01-02 11:14:17,527 - INFO - [session.py:161] - TLS Handshake completed successfully
2025-01-02 11:14:17,529 - INFO - [session.py:190] - Found file to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 11:14:17,531 - INFO - [session.py:208] - Handshake completed: True
2025-01-02 11:14:17,533 - INFO - [session.py:209] - Use client cert: True
2025-01-02 11:14:17,535 - INFO - [session.py:210] - File to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 11:14:17,537 - INFO - [session.py:213] - Using encrypted exchange
2025-01-02 11:14:17,538 - INFO - [session.py:228] - Sending encrypted request data
2025-01-02 11:14:17,547 - INFO - [keys.py:185] - TLS Application Data sent from 192.168.1.1:12345 to 10.0.0.1:443
2025-01-02 11:14:17,550 - INFO - [session.py:239] - Sending encrypted response data
2025-01-02 11:14:17,560 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-02 11:14:17,562 - INFO - [session.py:251] - Attempting to send file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 11:14:17,563 - INFO - [session.py:262] - Opening file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 11:14:17,564 - INFO - [session.py:269] - Read 1103 bytes from file
2025-01-02 11:14:17,570 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-02 11:14:17,574 - INFO - [session.py:278] - File sent successfully
2025-01-02 11:14:17,576 - INFO - [session.py:253] - File sent successfully
2025-01-02 11:14:17,577 - INFO - [main.py:95] - Session completed successfully for 192.168.1.1
2025-01-02 11:14:17,578 - INFO - [main.py:87] - 
--- Client Session (no certificate) ---
2025-01-02 11:14:17,580 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-02 11:14:17,582 - INFO - [cert.py:108] - File exists: True
2025-01-02 11:14:17,584 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-02 11:14:17,587 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-02 11:14:17,589 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-02 11:14:17,592 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-02 11:14:17,595 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 11:14:17,596 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-02 11:14:17,597 - INFO - [cert.py:108] - File exists: True
2025-01-02 11:14:17,599 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-02 11:14:17,601 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-02 11:14:17,603 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-02 11:14:17,605 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-02 11:14:17,610 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 11:14:17,657 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-02 11:14:17,658 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-02 11:14:17,659 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-02 11:14:17,659 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-02 11:14:17,660 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-02 11:14:17,661 - INFO - [verify.py:58] - Public key comparison results:
2025-01-02 11:14:17,661 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 11:14:17,662 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 11:14:17,663 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-02 11:14:17,663 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-02 11:14:17,664 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-02 11:14:17,665 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-02 11:14:17,665 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-02 11:14:17,666 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-02 11:14:17,666 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-02 11:14:17,668 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-02 11:14:17,672 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-02 11:14:17,675 - INFO - [session.py:179] - Starting TLS session
2025-01-02 11:14:17,675 - INFO - [session.py:118] - Starting TLS Handshake...
2025-01-02 11:14:17,676 - INFO - [client.py:100] - Generated client_random: ef07f5b56eee2afdc0f2ca00c5b5bb0cb28630a7bb684918d8b286d32ecab5f4
2025-01-02 11:14:17,679 - INFO - [client.py:143] - Client Hello sent from 192.168.1.2
2025-01-02 11:14:17,683 - INFO - [session.py:123] - Client Hello sent successfully
2025-01-02 11:14:17,684 - INFO - [server.py:94] - Generated server_random: d19d1992a87a3d8e826c64beeee7dac462c1b53a9a83c9dbbcbf79018a69a6cf
2025-01-02 11:14:17,695 - INFO - [session.py:128] - Server Hello received successfully
2025-01-02 11:14:17,697 - INFO - [client.py:180] - Prepared empty certificate
2025-01-02 11:14:17,699 - INFO - [client.py:192] - Encrypted pre_master_secret length: 256
2025-01-02 11:14:17,707 - INFO - [session.py:133] - Client handshake messages sent successfully
2025-01-02 11:14:17,711 - INFO - [session.py:138] - Server key pair verified successfully
2025-01-02 11:14:17,712 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-02 11:14:17,714 - INFO - [chain.py:185] - Decrypted pre_master_secret: 0303b1f936d391a1f1edd2b9cc07378e56e1b3bc08c2d5d6f67180a2e064eda0ed540bea4cee71527f93f9f135eb67c7
2025-01-02 11:14:17,715 - INFO - [chain.py:195] - Generated master secret: 22e8d3f14d893ce008ccc8d6ca5c1da2f3f1de84f860699215c1e03c48736ae53562a645adc4931d4f0c8f9f4eff1ca7
2025-01-02 11:14:17,716 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-02 11:14:17,717 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-02 11:14:17,719 - INFO - [session.py:142] - Master Secret handled successfully
2025-01-02 11:14:17,724 - INFO - [client.py:273] - Pre-master secret validated successfully
2025-01-02 11:14:17,728 - INFO - [client.py:291] - Generated digital signature: 14b276a1135a9867bcc7de9f6231a945a96f567cab264f5eb8fec021bb95a4f01218d91b240a739e34de802b82c8ff18520467f4b5d15b960df320a7addedb741f8c08fd7a89d147e494abf21bb2b13b52e0a1231e5eb6cc56d2794b9770f679a572c7555bd03326a97cfa1b6831436c6e91692ee77f042b2ee8f27d80111793bbf4f0861d54ff285326fe94fa85b4343e8400b461e13e38ed5fdeb7681e2dabb1cbbc3cbddd474b16fc99313fdc5cf44a3f389552e34888e0bf51faaeac91e3d8b30987877c0d82d9fc80885e74d294b5332b247e293b757a30150ff9725bd154b81c5c5a9a815b2cdf310cdf7b5783a47478cdfbe2b037e2b143ca1dff6494
2025-01-02 11:14:17,738 - INFO - [client.py:337] - Client ChangeCipherSpec and Finished messages sent
2025-01-02 11:14:17,742 - INFO - [session.py:147] - Client Change Cipher Spec sent successfully
2025-01-02 11:14:17,748 - INFO - [server.py:260] - Pre-master secret validated successfully
2025-01-02 11:14:17,756 - INFO - [server.py:278] - Generated digital signature: bcfd3297164f1d54d5ed3a2300c752d74666e2e9fb49ae5b0e1d0534bec53035d844fc30dc728e3c5711453bcda917789a81d06afca0c597441e3517d0e3283a4cb1e70debe4ccbab44fdd61459db26840fe5192a71dcd5aa46aeefaa37e744267880845cd350fd65a8e9fa5cb0a7464e48db1d9cb6f35a9e0f9aa4a45b10b6366592660ad0f532d44b430ff2a371b6f996bda036f2e5531575d56d8d1dedf033b6013a3464c3fababd11d4797e1eccf88a40499baf6a75ab836084d1e2fbae68c34f3caef31eafb5e36f9beaed4c443975827266834280a82544619b99df695f33284113a05499cbd7f6c850a8ebdb6f64ab67de9002bcd5a34937718970eac
2025-01-02 11:14:17,763 - INFO - [server.py:324] - Server ChangeCipherSpec and Finished messages sent
2025-01-02 11:14:17,771 - INFO - [session.py:152] - Server Change Cipher Spec received successfully
2025-01-02 11:14:17,776 - INFO - [keys.py:218] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-02 11:14:17,778 - INFO - [session.py:157] - SSL Key Log handled successfully
2025-01-02 11:14:17,780 - INFO - [session.py:161] - TLS Handshake completed successfully
2025-01-02 11:14:17,781 - INFO - [session.py:208] - Handshake completed: True
2025-01-02 11:14:17,784 - INFO - [session.py:209] - Use client cert: False
2025-01-02 11:14:17,786 - INFO - [session.py:210] - File to send: None
2025-01-02 11:14:17,788 - INFO - [session.py:216] - Using unencrypted exchange
2025-01-02 11:14:17,792 - INFO - [session.py:316] - Added request packet
2025-01-02 11:14:17,795 - INFO - [session.py:316] - Added response packet
2025-01-02 11:14:17,796 - WARNING - [session.py:293] - Using unencrypted communication
2025-01-02 11:14:17,797 - INFO - [main.py:95] - Session completed successfully for 192.168.1.2
2025-01-02 11:14:17,800 - INFO - [pcap_writer.py:232] - Packet 13: Valid HTTP message
2025-01-02 11:14:17,802 - INFO - [pcap_writer.py:232] - Packet 14: Valid HTTP message
2025-01-02 11:14:17,822 - INFO - [pcap_writer.py:387] - Saved 15 valid packets to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-02 11:14:17,825 - INFO - [pcap_writer.py:409] - Verifying 15 packets...
2025-01-02 11:14:17,827 - INFO - [pcap_writer.py:413] - Packet 1: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 11:14:17,828 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2025-01-02 11:14:17,829 - INFO - [pcap_writer.py:413] - Packet 2: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 11:14:17,830 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2743
2025-01-02 11:14:17,830 - INFO - [pcap_writer.py:413] - Packet 3: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 11:14:17,831 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 1646
2025-01-02 11:14:17,833 - INFO - [pcap_writer.py:413] - Packet 4: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 11:14:17,835 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-02 11:14:17,838 - INFO - [pcap_writer.py:413] - Packet 5: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 11:14:17,840 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-02 11:14:17,843 - INFO - [pcap_writer.py:413] - Packet 6: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 11:14:17,844 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 160
2025-01-02 11:14:17,846 - INFO - [pcap_writer.py:413] - Packet 7: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 11:14:17,847 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 128
2025-01-02 11:14:17,848 - INFO - [pcap_writer.py:413] - Packet 8: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 11:14:17,849 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 1152
2025-01-02 11:14:17,851 - INFO - [pcap_writer.py:413] - Packet 9: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-02 11:14:17,853 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2025-01-02 11:14:17,855 - INFO - [pcap_writer.py:413] - Packet 10: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-02 11:14:17,858 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2743
2025-01-02 11:14:17,860 - INFO - [pcap_writer.py:413] - Packet 11: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-02 11:14:17,861 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 269
2025-01-02 11:14:17,861 - INFO - [pcap_writer.py:413] - Packet 12: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-02 11:14:17,862 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-02 11:14:17,864 - INFO - [pcap_writer.py:413] - Packet 13: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-02 11:14:17,865 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-02 11:14:17,867 - INFO - [pcap_writer.py:413] - Packet 14: IP / TCP 192.168.1.2:12346 > 10.0.0.1:http PA / Raw
2025-01-02 11:14:17,869 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2025-01-02 11:14:17,872 - INFO - [pcap_writer.py:413] - Packet 15: IP / TCP 10.0.0.1:http > 192.168.1.2:12346 PA / Raw
2025-01-02 11:14:17,875 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2025-01-02 11:14:17,877 - INFO - [pcap_writer.py:427] - Verification complete: 15 valid packets, 15 TLS records
2025-01-02 11:14:17,879 - INFO - [main.py:106] - Results saved to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-02 11:14:17,880 - INFO - [main.py:160] - TLS session simulation completed successfully
2025-01-02 11:17:21,608 - INFO - [logging.py:83] - Logging configured successfully
2025-01-02 11:17:21,609 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-02 11:17:21,609 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-02 11:17:21,610 - INFO - [logging.py:92] - Log level: 20
2025-01-02 11:17:21,610 - INFO - [logging.py:93] - Timestamp: 2025-01-02T11:17:21.610900
2025-01-02 11:17:21,611 - INFO - [logging.py:94] - ==========================
2025-01-02 11:17:21,611 - INFO - [main.py:122] - Starting TLS session simulation
2025-01-02 11:17:21,612 - INFO - [main.py:87] - 
--- Client Session (certificate) ---
2025-01-02 11:17:21,613 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-02 11:17:21,614 - INFO - [cert.py:108] - File exists: True
2025-01-02 11:17:21,614 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-02 11:17:21,615 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-02 11:17:21,615 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-02 11:17:21,616 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-02 11:17:21,618 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 11:17:21,618 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-02 11:17:21,619 - INFO - [cert.py:108] - File exists: True
2025-01-02 11:17:21,620 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-02 11:17:21,621 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-02 11:17:21,622 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-02 11:17:21,623 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-02 11:17:21,624 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 11:17:21,655 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-02 11:17:21,656 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-02 11:17:21,656 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-02 11:17:21,657 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-02 11:17:21,659 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-02 11:17:21,660 - INFO - [verify.py:58] - Public key comparison results:
2025-01-02 11:17:21,660 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 11:17:21,661 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 11:17:21,662 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-02 11:17:21,663 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-02 11:17:21,664 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-02 11:17:21,665 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-02 11:17:21,666 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-02 11:17:21,666 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-02 11:17:21,667 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-02 11:17:21,667 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-02 11:17:21,669 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-02 11:17:21,669 - INFO - [session.py:179] - Starting TLS session
2025-01-02 11:17:21,669 - INFO - [session.py:118] - Starting TLS Handshake...
2025-01-02 11:17:21,670 - INFO - [client.py:100] - Generated client_random: 46c77b943e36df09abd961e15020bfbb76128986fe948f500af56e46c7effb65
2025-01-02 11:17:21,674 - INFO - [client.py:143] - Client Hello sent from 192.168.1.1
2025-01-02 11:17:21,676 - INFO - [session.py:123] - Client Hello sent successfully
2025-01-02 11:17:21,677 - INFO - [server.py:94] - Generated server_random: e999c280af6b8a44b32e81659001aab8ee1133ef8066f9258ec9c0a62f53c3f4
2025-01-02 11:17:21,682 - INFO - [session.py:128] - Server Hello received successfully
2025-01-02 11:17:21,683 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2025-01-02 11:17:21,683 - INFO - [cert.py:108] - File exists: True
2025-01-02 11:17:21,684 - INFO - [cert.py:109] - File size: 1915 bytes
2025-01-02 11:17:21,685 - INFO - [cert.py:113] - Read 1915 bytes
2025-01-02 11:17:21,685 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2025-01-02 11:17:21,686 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2025-01-02 11:17:21,687 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 11:17:21,687 - INFO - [client.py:177] - Prepared client certificate
2025-01-02 11:17:21,688 - INFO - [client.py:192] - Encrypted pre_master_secret length: 256
2025-01-02 11:17:21,689 - INFO - [session.py:133] - Client handshake messages sent successfully
2025-01-02 11:17:21,691 - INFO - [session.py:138] - Server key pair verified successfully
2025-01-02 11:17:21,691 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-02 11:17:21,693 - INFO - [chain.py:185] - Decrypted pre_master_secret: 030327d9502cce74de971b66cb884135ecec6d2dbd694d4610b9d4b0a5b581c613a48552c650f422591a86f1d9733c5b
2025-01-02 11:17:21,693 - INFO - [chain.py:195] - Generated master secret: a26f6b75c4da5a7fa281294456c399f7e6e8d28f2d9f350b59d9444897a53567e9f9e51d4939658272a8838e050cbe2e
2025-01-02 11:17:21,693 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-02 11:17:21,694 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-02 11:17:21,694 - INFO - [session.py:142] - Master Secret handled successfully
2025-01-02 11:17:21,696 - INFO - [client.py:273] - Pre-master secret validated successfully
2025-01-02 11:17:21,696 - INFO - [client.py:291] - Generated digital signature: 51d2b451937ab94d30468aca52b01079c338e846db0476a860c4b03f36bad358acb3ad2321f76365053412bf6756182832d5f0fb1059f4c21f87ef269369f45191c0cb0bee9ba9ab761e67b17be4883a94429d9cabbb999c13c35db966e545b04abace45a49ccda482e7e4e9ade23c3f0347013e64a7df00f434450fc4fbe1334080fca477046f6baad273209d37fb1c9eee9c283e16837d35304efd5b94fe44516f940b9a2b5ff1666df342d0d318acfe6a7c8d927c4619bbcb5c546f1df4a246350027eefae311141bd6345cd91f4c67e8cc86bd48d89c4112abcdb0963ede4d04fba62e98b7b651c6e0310c1981419d098ac2c9fb3bf24596479d8598c931
2025-01-02 11:17:21,699 - INFO - [client.py:337] - Client ChangeCipherSpec and Finished messages sent
2025-01-02 11:17:21,700 - INFO - [session.py:147] - Client Change Cipher Spec sent successfully
2025-01-02 11:17:21,701 - INFO - [server.py:260] - Pre-master secret validated successfully
2025-01-02 11:17:21,702 - INFO - [server.py:278] - Generated digital signature: 4c667cdc1f6e2ed92a83c6347b53ddbca873182026d9d2d888b8431699dcf0ed142fce65273f659ff2e33259cffb12028f67b566da6267a2eae2c7b32676946a2d254820d3162e3f6039b4a2df3b2fad3fea173c54efa32f39fd601fe75dcc94d3465ee4f08fae8105345fccb2c05b08e52cf2920dd4faae57a1271dce3310a0574d9968bbf10c2a4eba14f0054e4ba5e91600c85bf3e8d5c7e95ad9d09edbcd82187a3c516deb641db96028e1419661b9cdf8524d9e1e9d231a2934e43f0a6998d6600d7e7751c446419c997fe1fcc71c11f9024c895930a4ead4aa08e9b36e204ca91e1dcd4e1139d676c585783bdd0e5149d2750ee162e0d9635351ebd201
2025-01-02 11:17:21,703 - INFO - [server.py:324] - Server ChangeCipherSpec and Finished messages sent
2025-01-02 11:17:21,704 - INFO - [session.py:152] - Server Change Cipher Spec received successfully
2025-01-02 11:17:21,705 - INFO - [keys.py:218] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-02 11:17:21,705 - INFO - [session.py:157] - SSL Key Log handled successfully
2025-01-02 11:17:21,706 - INFO - [session.py:161] - TLS Handshake completed successfully
2025-01-02 11:17:21,706 - INFO - [session.py:190] - Found file to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 11:17:21,707 - INFO - [session.py:208] - Handshake completed: True
2025-01-02 11:17:21,707 - INFO - [session.py:209] - Use client cert: True
2025-01-02 11:17:21,708 - INFO - [session.py:210] - File to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 11:17:21,708 - INFO - [session.py:213] - Using encrypted exchange
2025-01-02 11:17:21,709 - INFO - [session.py:228] - Sending encrypted request data
2025-01-02 11:17:21,710 - INFO - [keys.py:185] - TLS Application Data sent from 192.168.1.1:12345 to 10.0.0.1:443
2025-01-02 11:17:21,710 - INFO - [session.py:239] - Sending encrypted response data
2025-01-02 11:17:21,712 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-02 11:17:21,713 - INFO - [session.py:251] - Attempting to send file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 11:17:21,714 - INFO - [session.py:262] - Opening file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 11:17:21,714 - INFO - [session.py:269] - Read 1103 bytes from file
2025-01-02 11:17:21,716 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-02 11:17:21,716 - INFO - [session.py:278] - File sent successfully
2025-01-02 11:17:21,717 - INFO - [session.py:253] - File sent successfully
2025-01-02 11:17:21,717 - INFO - [main.py:95] - Session completed successfully for 192.168.1.1
2025-01-02 11:17:21,717 - INFO - [main.py:87] - 
--- Client Session (no certificate) ---
2025-01-02 11:17:21,718 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-02 11:17:21,718 - INFO - [cert.py:108] - File exists: True
2025-01-02 11:17:21,719 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-02 11:17:21,719 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-02 11:17:21,719 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-02 11:17:21,720 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-02 11:17:21,720 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 11:17:21,721 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-02 11:17:21,721 - INFO - [cert.py:108] - File exists: True
2025-01-02 11:17:21,721 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-02 11:17:21,722 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-02 11:17:21,722 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-02 11:17:21,722 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-02 11:17:21,723 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 11:17:21,751 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-02 11:17:21,752 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-02 11:17:21,752 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-02 11:17:21,753 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-02 11:17:21,753 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-02 11:17:21,753 - INFO - [verify.py:58] - Public key comparison results:
2025-01-02 11:17:21,754 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 11:17:21,755 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 11:17:21,756 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-02 11:17:21,756 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-02 11:17:21,757 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-02 11:17:21,757 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-02 11:17:21,757 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-02 11:17:21,757 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-02 11:17:21,758 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-02 11:17:21,758 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-02 11:17:21,758 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-02 11:17:21,759 - INFO - [session.py:179] - Starting TLS session
2025-01-02 11:17:21,759 - INFO - [session.py:118] - Starting TLS Handshake...
2025-01-02 11:17:21,759 - INFO - [client.py:100] - Generated client_random: 30d950cc8de70c524bcc170afe1f89ff780677e0e496a0c4369d727889fe133b
2025-01-02 11:17:21,761 - INFO - [client.py:143] - Client Hello sent from 192.168.1.2
2025-01-02 11:17:21,763 - INFO - [session.py:123] - Client Hello sent successfully
2025-01-02 11:17:21,764 - INFO - [server.py:94] - Generated server_random: 05b8a47fb356987175512127af8aa98c25ca4030d2209428bdb642b4c76dd23c
2025-01-02 11:17:21,768 - INFO - [session.py:128] - Server Hello received successfully
2025-01-02 11:17:21,769 - INFO - [client.py:180] - Prepared empty certificate
2025-01-02 11:17:21,769 - INFO - [client.py:192] - Encrypted pre_master_secret length: 256
2025-01-02 11:17:21,771 - INFO - [session.py:133] - Client handshake messages sent successfully
2025-01-02 11:17:21,772 - INFO - [session.py:138] - Server key pair verified successfully
2025-01-02 11:17:21,772 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-02 11:17:21,773 - INFO - [chain.py:185] - Decrypted pre_master_secret: 030324e2475177a9c3d062e38cdd4f3047e8a28aba7fd6c953558e77a464d8c163af1791553064c2d2ce698651fd8252
2025-01-02 11:17:21,773 - INFO - [chain.py:195] - Generated master secret: f1ef6cad2f005b4860a4e038a7e00be3abc261ee8f77755d0c84b3547c9179ef725b1f0051da769ac3d3d66de409c3fd
2025-01-02 11:17:21,774 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-02 11:17:21,774 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-02 11:17:21,774 - INFO - [session.py:142] - Master Secret handled successfully
2025-01-02 11:17:21,775 - INFO - [client.py:273] - Pre-master secret validated successfully
2025-01-02 11:17:21,776 - INFO - [client.py:291] - Generated digital signature: bc6861fcab399cf5824c927070d1371e66b79c83142be4c64af25007e86fa77831602f976ce54fc0a6de1ca00953795ea085bc50589ffd06f8a8b79c163fb2dd4efae85d958e078c51b23d6c4e844ab735459b51deed03be81e20f07e05085b5a0b400a98e2c5d860f268a90b406464ff53f965568ce32a20e724e637acac882a18b2717975fef06221d452bdda6b9a25273a07e8e0214388fcf86eced3341072795ffa077d1d98901b489ba06b0947b294029abb9c89dfd3a69748c828944763e50a65c6cac53b3201b16e1efd965b2db760cff5e04a4fd79c998a5df9daf1e7c0eb4992f5f4d6dfa096c367ef2bf537f347ca6578a46a2883fb47f012f693d
2025-01-02 11:17:21,777 - INFO - [client.py:337] - Client ChangeCipherSpec and Finished messages sent
2025-01-02 11:17:21,779 - INFO - [session.py:147] - Client Change Cipher Spec sent successfully
2025-01-02 11:17:21,780 - INFO - [server.py:260] - Pre-master secret validated successfully
2025-01-02 11:17:21,781 - INFO - [server.py:278] - Generated digital signature: 5af7f42b478d154ed92892e6126c85795a3546702ce3d93ae90428a55e56ced638e93083ac18ad50de15f2664e8ebe3d3aeeb46897d4d8c5406913d616c3fe2d3be66826ba526f272c7fd55c53988ae2bb158fa34e718a419a29b85f4016068eff9b6401f01287812edd7c9482ea7e7f2263e9213d8b4262d35886cba0facd5245970306a6261e14b78c35cfdc824bf278787d3613dc6e959639d759c3142915ea9137bfe98fee7552812b1333375f9f1936d1cc4257a7f97cd65919b0f7206745d716f4f07bc600501ae7f6075dfe3ae9aa6be3f27c37e4cacef16528f22ed17f3b6e1faec5e7f6ddb5c14c64de3a281dbd14c86307751fd0c9dda9edab0c41
2025-01-02 11:17:21,783 - INFO - [server.py:324] - Server ChangeCipherSpec and Finished messages sent
2025-01-02 11:17:21,784 - INFO - [session.py:152] - Server Change Cipher Spec received successfully
2025-01-02 11:17:21,784 - INFO - [keys.py:218] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-02 11:17:21,785 - INFO - [session.py:157] - SSL Key Log handled successfully
2025-01-02 11:17:21,785 - INFO - [session.py:161] - TLS Handshake completed successfully
2025-01-02 11:17:21,785 - INFO - [session.py:208] - Handshake completed: True
2025-01-02 11:17:21,786 - INFO - [session.py:209] - Use client cert: False
2025-01-02 11:17:21,786 - INFO - [session.py:210] - File to send: None
2025-01-02 11:17:21,786 - INFO - [session.py:216] - Using unencrypted exchange
2025-01-02 11:17:21,787 - INFO - [session.py:316] - Added request packet
2025-01-02 11:17:21,788 - INFO - [session.py:316] - Added response packet
2025-01-02 11:17:21,788 - WARNING - [session.py:293] - Using unencrypted communication
2025-01-02 11:17:21,789 - INFO - [main.py:95] - Session completed successfully for 192.168.1.2
2025-01-02 11:17:21,789 - INFO - [pcap_writer.py:232] - Packet 13: Valid HTTP message
2025-01-02 11:17:21,789 - INFO - [pcap_writer.py:232] - Packet 14: Valid HTTP message
2025-01-02 11:17:21,794 - INFO - [pcap_writer.py:387] - Saved 15 valid packets to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-02 11:17:21,794 - INFO - [pcap_writer.py:409] - Verifying 15 packets...
2025-01-02 11:17:21,795 - INFO - [pcap_writer.py:413] - Packet 1: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 11:17:21,796 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2025-01-02 11:17:21,796 - INFO - [pcap_writer.py:413] - Packet 2: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 11:17:21,797 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2743
2025-01-02 11:17:21,798 - INFO - [pcap_writer.py:413] - Packet 3: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 11:17:21,798 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 1646
2025-01-02 11:17:21,798 - INFO - [pcap_writer.py:413] - Packet 4: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 11:17:21,799 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-02 11:17:21,799 - INFO - [pcap_writer.py:413] - Packet 5: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 11:17:21,800 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-02 11:17:21,800 - INFO - [pcap_writer.py:413] - Packet 6: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 11:17:21,800 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 160
2025-01-02 11:17:21,801 - INFO - [pcap_writer.py:413] - Packet 7: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 11:17:21,801 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 128
2025-01-02 11:17:21,801 - INFO - [pcap_writer.py:413] - Packet 8: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 11:17:21,802 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 1152
2025-01-02 11:17:21,802 - INFO - [pcap_writer.py:413] - Packet 9: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-02 11:17:21,802 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2025-01-02 11:17:21,802 - INFO - [pcap_writer.py:413] - Packet 10: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-02 11:17:21,803 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2743
2025-01-02 11:17:21,803 - INFO - [pcap_writer.py:413] - Packet 11: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-02 11:17:21,803 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 269
2025-01-02 11:17:21,803 - INFO - [pcap_writer.py:413] - Packet 12: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-02 11:17:21,804 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-02 11:17:21,804 - INFO - [pcap_writer.py:413] - Packet 13: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-02 11:17:21,805 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-02 11:17:21,805 - INFO - [pcap_writer.py:413] - Packet 14: IP / TCP 192.168.1.2:12346 > 10.0.0.1:http PA / Raw
2025-01-02 11:17:21,805 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2025-01-02 11:17:21,806 - INFO - [pcap_writer.py:413] - Packet 15: IP / TCP 10.0.0.1:http > 192.168.1.2:12346 PA / Raw
2025-01-02 11:17:21,806 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2025-01-02 11:17:21,806 - INFO - [pcap_writer.py:427] - Verification complete: 15 valid packets, 15 TLS records
2025-01-02 11:17:21,806 - INFO - [main.py:106] - Results saved to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-02 11:17:21,807 - INFO - [main.py:160] - TLS session simulation completed successfully
2025-01-02 11:24:24,970 - INFO - [logging.py:83] - Logging configured successfully
2025-01-02 11:24:24,971 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-02 11:24:24,971 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-02 11:24:24,972 - INFO - [logging.py:92] - Log level: 20
2025-01-02 11:24:24,972 - INFO - [logging.py:93] - Timestamp: 2025-01-02T11:24:24.972471
2025-01-02 11:24:24,972 - INFO - [logging.py:94] - ==========================
2025-01-02 11:24:24,973 - INFO - [main.py:122] - Starting TLS session simulation
2025-01-02 11:24:24,973 - INFO - [main.py:87] - 
--- Client Session (certificate) ---
2025-01-02 11:24:24,974 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-02 11:24:24,975 - INFO - [cert.py:108] - File exists: True
2025-01-02 11:24:24,975 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-02 11:24:24,976 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-02 11:24:24,976 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-02 11:24:24,977 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-02 11:24:24,978 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 11:24:24,978 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-02 11:24:24,979 - INFO - [cert.py:108] - File exists: True
2025-01-02 11:24:24,979 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-02 11:24:24,980 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-02 11:24:24,980 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-02 11:24:24,981 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-02 11:24:24,981 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 11:24:25,027 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-02 11:24:25,028 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-02 11:24:25,029 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-02 11:24:25,029 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-02 11:24:25,033 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-02 11:24:25,034 - INFO - [verify.py:58] - Public key comparison results:
2025-01-02 11:24:25,035 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 11:24:25,037 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 11:24:25,038 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-02 11:24:25,039 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-02 11:24:25,050 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-02 11:24:25,051 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-02 11:24:25,052 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-02 11:24:25,053 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-02 11:24:25,055 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-02 11:24:25,057 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-02 11:24:25,062 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-02 11:24:25,065 - INFO - [session.py:179] - Starting TLS session
2025-01-02 11:24:25,066 - INFO - [session.py:118] - Starting TLS Handshake...
2025-01-02 11:24:25,067 - INFO - [client.py:100] - Generated client_random: 93e78b01b09c3949781c27ce725e2b247cd12cbcd9eaaf12d30a8fc00e4184cd
2025-01-02 11:24:25,076 - INFO - [client.py:143] - Client Hello sent from 192.168.1.1
2025-01-02 11:24:25,083 - ERROR - [main.py:27] - Session error: Session failed for 192.168.1.1: Session failed: Failed to send Client Hello: Failed to send TLS packet: CustomPcapWriter.create_tls_packet() got an unexpected keyword argument 'seq_num'
2025-01-02 11:25:39,457 - INFO - [logging.py:83] - Logging configured successfully
2025-01-02 11:25:39,458 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-02 11:25:39,459 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-02 11:25:39,460 - INFO - [logging.py:92] - Log level: 20
2025-01-02 11:25:39,460 - INFO - [logging.py:93] - Timestamp: 2025-01-02T11:25:39.460451
2025-01-02 11:25:39,460 - INFO - [logging.py:94] - ==========================
2025-01-02 11:25:39,461 - INFO - [main.py:122] - Starting TLS session simulation
2025-01-02 11:25:39,462 - INFO - [main.py:87] - 
--- Client Session (certificate) ---
2025-01-02 11:25:39,465 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-02 11:25:39,467 - INFO - [cert.py:108] - File exists: True
2025-01-02 11:25:39,468 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-02 11:25:39,469 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-02 11:25:39,469 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-02 11:25:39,470 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-02 11:25:39,471 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 11:25:39,473 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-02 11:25:39,475 - INFO - [cert.py:108] - File exists: True
2025-01-02 11:25:39,477 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-02 11:25:39,479 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-02 11:25:39,480 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-02 11:25:39,481 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-02 11:25:39,482 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 11:25:39,543 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-02 11:25:39,544 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-02 11:25:39,544 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-02 11:25:39,545 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-02 11:25:39,548 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-02 11:25:39,550 - INFO - [verify.py:58] - Public key comparison results:
2025-01-02 11:25:39,552 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 11:25:39,554 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 11:25:39,555 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-02 11:25:39,556 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-02 11:25:39,557 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-02 11:25:39,558 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-02 11:25:39,558 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-02 11:25:39,559 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-02 11:25:39,560 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-02 11:25:39,561 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-02 11:25:39,562 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-02 11:25:39,563 - INFO - [session.py:179] - Starting TLS session
2025-01-02 11:25:39,564 - INFO - [session.py:118] - Starting TLS Handshake...
2025-01-02 11:25:39,565 - INFO - [client.py:100] - Generated client_random: 0523ae9b51ddcdb082bc3f1db699c314d1fab10cc913de829e1d49df1a427367
2025-01-02 11:25:39,573 - INFO - [client.py:143] - Client Hello sent from 192.168.1.1
2025-01-02 11:25:39,576 - INFO - [session.py:123] - Client Hello sent successfully
2025-01-02 11:25:39,577 - INFO - [server.py:94] - Generated server_random: 7b10fd0fe89915c9ec5e10878dcb435b38da50008bd3da67027be7d83f3dba48
2025-01-02 11:25:39,585 - INFO - [session.py:128] - Server Hello received successfully
2025-01-02 11:25:39,587 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2025-01-02 11:25:39,588 - INFO - [cert.py:108] - File exists: True
2025-01-02 11:25:39,589 - INFO - [cert.py:109] - File size: 1915 bytes
2025-01-02 11:25:39,591 - INFO - [cert.py:113] - Read 1915 bytes
2025-01-02 11:25:39,591 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2025-01-02 11:25:39,592 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2025-01-02 11:25:39,593 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 11:25:39,594 - INFO - [client.py:177] - Prepared client certificate
2025-01-02 11:25:39,595 - INFO - [client.py:192] - Encrypted pre_master_secret length: 256
2025-01-02 11:25:39,597 - INFO - [session.py:133] - Client handshake messages sent successfully
2025-01-02 11:25:39,603 - INFO - [session.py:138] - Server key pair verified successfully
2025-01-02 11:25:39,604 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-02 11:25:39,606 - INFO - [chain.py:185] - Decrypted pre_master_secret: 0303027f57388f6df28f998ac9f8db197b056e2dc8a126d98229cca0e2e06d8765e6042f594b222a81c43cdb41270787
2025-01-02 11:25:39,607 - INFO - [chain.py:195] - Generated master secret: acf413f339bcea6737b65d294c8a2b21aa2abab308677ef9fa08d3db3e079e970fdcb18c2015255e9386e4f24ec1857d
2025-01-02 11:25:39,608 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-02 11:25:39,608 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-02 11:25:39,609 - INFO - [session.py:142] - Master Secret handled successfully
2025-01-02 11:25:39,611 - INFO - [client.py:273] - Pre-master secret validated successfully
2025-01-02 11:25:39,613 - INFO - [client.py:291] - Generated digital signature: bd78ae8a52ab20736cf9459234781f4e9b57d0c612b11b9745328c1d7ef2f02b907790fdc7cfa4fce72680af33470470e41089062dec243944f60fef5235a20129b3d1c9c7f43f72c05b5390e16b007d7c78eaaed5ec63e43b1c56f11aebad11918cabcb3b7260333ef7629c1e16fd699992fadc152495b9f661459607d22c82c5f38a9ea73801961c794d884a593ad13080f9fe4839aec1e47fbdc44ea7eb3dea0cc727e09ac5321486a7c0701c142038928484228567d7a5620eb4b6dd1e0db0333d2100513d161eb3928bfa9c28c1b0e3da0bcabfab5b389be5115dec260def4c87afca558440d06e501f626b3755ed3760c049dce612bd3d6014d59ca892
2025-01-02 11:25:39,619 - INFO - [client.py:337] - Client ChangeCipherSpec and Finished messages sent
2025-01-02 11:25:39,624 - INFO - [session.py:147] - Client Change Cipher Spec sent successfully
2025-01-02 11:25:39,626 - INFO - [server.py:260] - Pre-master secret validated successfully
2025-01-02 11:25:39,628 - INFO - [server.py:278] - Generated digital signature: 88bbf3e256d050bf7475c096650ed021fdeba5e8cb69c9e989ffe08885970346cca105e188f42d462ece605746ef4976a1af1fc0015f5fafc7e259edc5f724f382e7da87b270e6eaa77df8f3d90ae4b8e1ef4e15a631b2ccb484483d2ebdde6005ad7b46b9fa93ceb0928ff40e558835f8827065595a5cdd2d76ddd26a1e807702caf09877e5582f44b10122571493b75a5370850b7380e9e960c1d6ce1dc4a7ef94b958458f0944236f9ea9dc081b4bd4e9edfbf501e696470326c1c82df6d195db40b9f0d38634e13d9dbd19c30b2c5c3256d81c9d824e41376072b68a4a27ace8959ea0f0b9210828a2e9d38ae0a8b9d325a5dd074f8ddd4889928b642069
2025-01-02 11:25:39,632 - INFO - [server.py:324] - Server ChangeCipherSpec and Finished messages sent
2025-01-02 11:25:39,636 - INFO - [session.py:152] - Server Change Cipher Spec received successfully
2025-01-02 11:25:39,638 - INFO - [keys.py:218] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-02 11:25:39,640 - INFO - [session.py:157] - SSL Key Log handled successfully
2025-01-02 11:25:39,641 - INFO - [session.py:161] - TLS Handshake completed successfully
2025-01-02 11:25:39,643 - INFO - [session.py:190] - Found file to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 11:25:39,644 - INFO - [session.py:208] - Handshake completed: True
2025-01-02 11:25:39,645 - INFO - [session.py:209] - Use client cert: True
2025-01-02 11:25:39,646 - INFO - [session.py:210] - File to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 11:25:39,647 - INFO - [session.py:213] - Using encrypted exchange
2025-01-02 11:25:39,648 - INFO - [session.py:228] - Sending encrypted request data
2025-01-02 11:25:39,656 - INFO - [keys.py:185] - TLS Application Data sent from 192.168.1.1:12345 to 10.0.0.1:443
2025-01-02 11:25:39,657 - INFO - [session.py:239] - Sending encrypted response data
2025-01-02 11:25:39,660 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-02 11:25:39,661 - INFO - [session.py:251] - Attempting to send file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 11:25:39,662 - INFO - [session.py:262] - Opening file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 11:25:39,664 - INFO - [session.py:269] - Read 1103 bytes from file
2025-01-02 11:25:39,671 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-02 11:25:39,673 - INFO - [session.py:278] - File sent successfully
2025-01-02 11:25:39,675 - INFO - [session.py:253] - File sent successfully
2025-01-02 11:25:39,676 - INFO - [main.py:95] - Session completed successfully for 192.168.1.1
2025-01-02 11:25:39,677 - INFO - [main.py:87] - 
--- Client Session (no certificate) ---
2025-01-02 11:25:39,679 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-02 11:25:39,681 - INFO - [cert.py:108] - File exists: True
2025-01-02 11:25:39,682 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-02 11:25:39,684 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-02 11:25:39,685 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-02 11:25:39,688 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-02 11:25:39,693 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 11:25:39,695 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-02 11:25:39,696 - INFO - [cert.py:108] - File exists: True
2025-01-02 11:25:39,698 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-02 11:25:39,700 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-02 11:25:39,702 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-02 11:25:39,704 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-02 11:25:39,708 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 11:25:39,757 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-02 11:25:39,758 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-02 11:25:39,759 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-02 11:25:39,759 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-02 11:25:39,760 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-02 11:25:39,761 - INFO - [verify.py:58] - Public key comparison results:
2025-01-02 11:25:39,761 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 11:25:39,763 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 11:25:39,764 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-02 11:25:39,765 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-02 11:25:39,767 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-02 11:25:39,768 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-02 11:25:39,769 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-02 11:25:39,770 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-02 11:25:39,772 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-02 11:25:39,773 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-02 11:25:39,775 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-02 11:25:39,776 - INFO - [session.py:179] - Starting TLS session
2025-01-02 11:25:39,776 - INFO - [session.py:118] - Starting TLS Handshake...
2025-01-02 11:25:39,777 - INFO - [client.py:100] - Generated client_random: 980327bb5368ed2a73d066a8cc22e1994e0734749450b5f5406c60f373a06a9a
2025-01-02 11:25:39,780 - INFO - [client.py:143] - Client Hello sent from 192.168.1.2
2025-01-02 11:25:39,786 - INFO - [session.py:123] - Client Hello sent successfully
2025-01-02 11:25:39,787 - INFO - [server.py:94] - Generated server_random: 916f0ece4438d4dbd1ef51a55d5acb8aa6a58c04204554d6207ac531a0d14b44
2025-01-02 11:25:39,792 - INFO - [session.py:128] - Server Hello received successfully
2025-01-02 11:25:39,793 - INFO - [client.py:180] - Prepared empty certificate
2025-01-02 11:25:39,794 - INFO - [client.py:192] - Encrypted pre_master_secret length: 256
2025-01-02 11:25:39,796 - INFO - [session.py:133] - Client handshake messages sent successfully
2025-01-02 11:25:39,800 - INFO - [session.py:138] - Server key pair verified successfully
2025-01-02 11:25:39,802 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-02 11:25:39,804 - INFO - [chain.py:185] - Decrypted pre_master_secret: 030343c4c96e70031f4474dcc97ef4bf13642b6590e9b4d134b33747341cb279cc0a1d8b584a82661f066a4807f3343e
2025-01-02 11:25:39,805 - INFO - [chain.py:195] - Generated master secret: f0cea71c115bb0387cab66126bca98ebfaec88e78106249e16fe1fb4ee91f3a10b222f628c7a7d80dbe43ecca57e5327
2025-01-02 11:25:39,806 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-02 11:25:39,806 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-02 11:25:39,807 - INFO - [session.py:142] - Master Secret handled successfully
2025-01-02 11:25:39,810 - INFO - [client.py:273] - Pre-master secret validated successfully
2025-01-02 11:25:39,812 - INFO - [client.py:291] - Generated digital signature: 0baba316847c7e8dce5f6afa1da98009ae5c3a5d67ed047747e196d685ba82731488378cbf860233222ed98a38fac5c61c83b7dacbd9036aad37cc3c8721ee9e7ec5dea47936404c060b8634777342a12073f943a6120110de1c6a0c3e8fb1c344bfb5771db78ff6e825bde6992b6b702487c2f808d8844638068e030bb94dd050332e6f4211ffbec264db09b1679b2a54b4cf8cb53bc6d253f2edd4386959a6e6701f74fe5791d0955df604b79a56083537f93f356f50118737e9f329b2b2b37073a55b4a4e36cdb8de46ce4410f179261e72bf990996a2dab3ff125710aaba9eab717c4428883f60db74457169cd0078828f24096ae228f3dd6e40fe3d991b
2025-01-02 11:25:39,813 - INFO - [client.py:337] - Client ChangeCipherSpec and Finished messages sent
2025-01-02 11:25:39,817 - INFO - [session.py:147] - Client Change Cipher Spec sent successfully
2025-01-02 11:25:39,820 - INFO - [server.py:260] - Pre-master secret validated successfully
2025-01-02 11:25:39,821 - INFO - [server.py:278] - Generated digital signature: d046633740de59fac4d6e1fd95dca3095391f8e0f69d772cc38657a22ef30fdce4b6b868d03ffb398ac6d6c8ded09daec12069e4bb606cde66e89f8d6765dec33af875a613c635aa59f98bf9ef8f97b5edc65474861e32f543f4ffb38c887a8b5e94c54cdb1489807d132e368be4687482102362c8c85ec2e4357ee84ae1dc3b3ae648d4e097430fd9ea0a8be9d986bbc89ce08c644fb62b9c936baf813531875560fb6053107dcc899a08c787f540fa57a0f6554adcef381e41e35d86bd7d338156e2ae82ff4bd3507c2248b7238dc5449bbea35272e510d0d64efdb3423bc14a33645e575197202f952f09ba3d8f779d825368b7289b095f5e7234dd99f290
2025-01-02 11:25:39,823 - INFO - [server.py:324] - Server ChangeCipherSpec and Finished messages sent
2025-01-02 11:25:39,825 - INFO - [session.py:152] - Server Change Cipher Spec received successfully
2025-01-02 11:25:39,828 - INFO - [keys.py:218] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-02 11:25:39,829 - INFO - [session.py:157] - SSL Key Log handled successfully
2025-01-02 11:25:39,830 - INFO - [session.py:161] - TLS Handshake completed successfully
2025-01-02 11:25:39,830 - INFO - [session.py:208] - Handshake completed: True
2025-01-02 11:25:39,831 - INFO - [session.py:209] - Use client cert: False
2025-01-02 11:25:39,832 - INFO - [session.py:210] - File to send: None
2025-01-02 11:25:39,833 - INFO - [session.py:216] - Using unencrypted exchange
2025-01-02 11:25:39,837 - INFO - [session.py:316] - Added request packet
2025-01-02 11:25:39,840 - INFO - [session.py:316] - Added response packet
2025-01-02 11:25:39,840 - WARNING - [session.py:293] - Using unencrypted communication
2025-01-02 11:25:39,841 - INFO - [main.py:95] - Session completed successfully for 192.168.1.2
2025-01-02 11:25:39,842 - INFO - [pcap_writer.py:232] - Packet 13: Valid HTTP message
2025-01-02 11:25:39,842 - INFO - [pcap_writer.py:232] - Packet 14: Valid HTTP message
2025-01-02 11:25:39,853 - INFO - [pcap_writer.py:395] - Saved 15 valid packets to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-02 11:25:39,854 - INFO - [pcap_writer.py:417] - Verifying 15 packets...
2025-01-02 11:25:39,855 - INFO - [pcap_writer.py:421] - Packet 1: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 11:25:39,855 - INFO - [pcap_writer.py:428] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2025-01-02 11:25:39,856 - INFO - [pcap_writer.py:421] - Packet 2: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 11:25:39,856 - INFO - [pcap_writer.py:428] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2743
2025-01-02 11:25:39,857 - INFO - [pcap_writer.py:421] - Packet 3: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 11:25:39,857 - INFO - [pcap_writer.py:428] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 1646
2025-01-02 11:25:39,858 - INFO - [pcap_writer.py:421] - Packet 4: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 11:25:39,858 - INFO - [pcap_writer.py:428] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-02 11:25:39,858 - INFO - [pcap_writer.py:421] - Packet 5: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 11:25:39,859 - INFO - [pcap_writer.py:428] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-02 11:25:39,859 - INFO - [pcap_writer.py:421] - Packet 6: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 11:25:39,860 - INFO - [pcap_writer.py:428] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 160
2025-01-02 11:25:39,861 - INFO - [pcap_writer.py:421] - Packet 7: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 11:25:39,861 - INFO - [pcap_writer.py:428] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 128
2025-01-02 11:25:39,862 - INFO - [pcap_writer.py:421] - Packet 8: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 11:25:39,862 - INFO - [pcap_writer.py:428] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 1152
2025-01-02 11:25:39,862 - INFO - [pcap_writer.py:421] - Packet 9: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-02 11:25:39,863 - INFO - [pcap_writer.py:428] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2025-01-02 11:25:39,863 - INFO - [pcap_writer.py:421] - Packet 10: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-02 11:25:39,864 - INFO - [pcap_writer.py:428] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2743
2025-01-02 11:25:39,865 - INFO - [pcap_writer.py:421] - Packet 11: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-02 11:25:39,867 - INFO - [pcap_writer.py:428] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 269
2025-01-02 11:25:39,869 - INFO - [pcap_writer.py:421] - Packet 12: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-02 11:25:39,871 - INFO - [pcap_writer.py:428] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-02 11:25:39,873 - INFO - [pcap_writer.py:421] - Packet 13: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-02 11:25:39,875 - INFO - [pcap_writer.py:428] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-02 11:25:39,876 - INFO - [pcap_writer.py:421] - Packet 14: IP / TCP 192.168.1.2:12346 > 10.0.0.1:http PA / Raw
2025-01-02 11:25:39,877 - INFO - [pcap_writer.py:428] - TLS Record: HTTP message
2025-01-02 11:25:39,877 - INFO - [pcap_writer.py:421] - Packet 15: IP / TCP 10.0.0.1:http > 192.168.1.2:12346 PA / Raw
2025-01-02 11:25:39,878 - INFO - [pcap_writer.py:428] - TLS Record: HTTP message
2025-01-02 11:25:39,879 - INFO - [pcap_writer.py:435] - Verification complete: 15 valid packets, 15 TLS records
2025-01-02 11:25:39,879 - INFO - [main.py:106] - Results saved to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-02 11:25:39,880 - INFO - [main.py:160] - TLS session simulation completed successfully
2025-01-02 11:45:47,977 - INFO - [logging.py:83] - Logging configured successfully
2025-01-02 11:45:47,979 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-02 11:45:47,979 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-02 11:45:47,979 - INFO - [logging.py:92] - Log level: 20
2025-01-02 11:45:47,979 - INFO - [logging.py:93] - Timestamp: 2025-01-02T11:45:47.979941
2025-01-02 11:45:47,980 - INFO - [logging.py:94] - ==========================
2025-01-02 11:45:47,980 - INFO - [main.py:122] - Starting TLS session simulation
2025-01-02 11:45:47,981 - INFO - [main.py:87] - 
--- Client Session (certificate) ---
2025-01-02 11:45:47,982 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-02 11:45:47,983 - INFO - [cert.py:108] - File exists: True
2025-01-02 11:45:47,983 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-02 11:45:47,984 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-02 11:45:47,985 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-02 11:45:47,986 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-02 11:45:47,992 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 11:45:47,993 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-02 11:45:47,995 - INFO - [cert.py:108] - File exists: True
2025-01-02 11:45:47,996 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-02 11:45:47,997 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-02 11:45:47,998 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-02 11:45:47,998 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-02 11:45:47,999 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 11:45:48,045 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-02 11:45:48,047 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-02 11:45:48,048 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-02 11:45:48,050 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-02 11:45:48,054 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-02 11:45:48,054 - INFO - [verify.py:58] - Public key comparison results:
2025-01-02 11:45:48,055 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 11:45:48,056 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 11:45:48,057 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-02 11:45:48,057 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-02 11:45:48,063 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-02 11:45:48,064 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-02 11:45:48,065 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-02 11:45:48,065 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-02 11:45:48,067 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-02 11:45:48,067 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-02 11:45:48,069 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-02 11:45:48,069 - INFO - [session.py:180] - Starting TLS session
2025-01-02 11:45:48,069 - INFO - [session.py:119] - Starting TLS Handshake...
2025-01-02 11:45:48,070 - INFO - [client.py:100] - Generated client_random: 25bacb8758b2bdc1bc94c683adc394556e1e644fbb9873bd26ebf84edf925589
2025-01-02 11:45:48,072 - INFO - [client.py:143] - Client Hello sent from 192.168.1.1
2025-01-02 11:45:48,075 - ERROR - [main.py:27] - Session error: Session failed for 192.168.1.1: Session failed: Failed to send Client Hello: Failed to send TLS packet: 'SessionState' object has no attribute 'client_seq_num'
2025-01-02 11:47:12,934 - INFO - [logging.py:83] - Logging configured successfully
2025-01-02 11:47:12,935 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-02 11:47:12,935 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-02 11:47:12,936 - INFO - [logging.py:92] - Log level: 20
2025-01-02 11:47:12,936 - INFO - [logging.py:93] - Timestamp: 2025-01-02T11:47:12.936596
2025-01-02 11:47:12,936 - INFO - [logging.py:94] - ==========================
2025-01-02 11:47:12,937 - INFO - [main.py:122] - Starting TLS session simulation
2025-01-02 11:47:12,937 - INFO - [main.py:87] - 
--- Client Session (certificate) ---
2025-01-02 11:47:12,938 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-02 11:47:12,939 - INFO - [cert.py:108] - File exists: True
2025-01-02 11:47:12,939 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-02 11:47:12,940 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-02 11:47:12,940 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-02 11:47:12,941 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-02 11:47:12,942 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 11:47:12,942 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-02 11:47:12,943 - INFO - [cert.py:108] - File exists: True
2025-01-02 11:47:12,943 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-02 11:47:12,944 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-02 11:47:12,944 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-02 11:47:12,944 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-02 11:47:12,945 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 11:47:12,976 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-02 11:47:12,977 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-02 11:47:12,977 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-02 11:47:12,977 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-02 11:47:12,979 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-02 11:47:12,979 - INFO - [verify.py:58] - Public key comparison results:
2025-01-02 11:47:13,001 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 11:47:13,004 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 11:47:13,006 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-02 11:47:13,007 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-02 11:47:13,009 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-02 11:47:13,010 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-02 11:47:13,011 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-02 11:47:13,012 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-02 11:47:13,018 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-02 11:47:13,018 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-02 11:47:13,021 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-02 11:47:13,022 - INFO - [session.py:180] - Starting TLS session
2025-01-02 11:47:13,022 - INFO - [session.py:119] - Starting TLS Handshake...
2025-01-02 11:47:13,022 - INFO - [client.py:100] - Generated client_random: 7e046fcd868377d865a9d030463588221fe71e0494cafc2c36a1275c1d5ef87b
2025-01-02 11:47:13,025 - INFO - [client.py:143] - Client Hello sent from 192.168.1.1
2025-01-02 11:47:13,029 - ERROR - [main.py:27] - Session error: Session failed for 192.168.1.1: Session failed: Failed to send Client Hello: Failed to send TLS packet: 'SessionState' object has no attribute 'client_seq_num'
2025-01-02 11:59:51,256 - INFO - [logging.py:83] - Logging configured successfully
2025-01-02 11:59:51,258 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-02 11:59:51,258 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-02 11:59:51,259 - INFO - [logging.py:92] - Log level: 20
2025-01-02 11:59:51,259 - INFO - [logging.py:93] - Timestamp: 2025-01-02T11:59:51.259416
2025-01-02 11:59:51,259 - INFO - [logging.py:94] - ==========================
2025-01-02 11:59:51,260 - INFO - [main.py:123] - Starting TLS session simulation
2025-01-02 11:59:51,260 - INFO - [main.py:88] - 
--- Client Session (certificate) ---
2025-01-02 11:59:51,262 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-02 11:59:51,262 - INFO - [cert.py:108] - File exists: True
2025-01-02 11:59:51,263 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-02 11:59:51,264 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-02 11:59:51,264 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-02 11:59:51,265 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-02 11:59:51,272 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 11:59:51,273 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-02 11:59:51,274 - INFO - [cert.py:108] - File exists: True
2025-01-02 11:59:51,275 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-02 11:59:51,275 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-02 11:59:51,276 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-02 11:59:51,276 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-02 11:59:51,277 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 11:59:51,330 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-02 11:59:51,331 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-02 11:59:51,331 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-02 11:59:51,332 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-02 11:59:51,336 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-02 11:59:51,337 - INFO - [verify.py:58] - Public key comparison results:
2025-01-02 11:59:51,339 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 11:59:51,339 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 11:59:51,341 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-02 11:59:51,341 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-02 11:59:51,345 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-02 11:59:51,346 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-02 11:59:51,347 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-02 11:59:51,348 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-02 11:59:51,349 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-02 11:59:51,350 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-02 11:59:51,352 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-02 11:59:51,354 - INFO - [session.py:175] - Starting TLS session
2025-01-02 11:59:51,355 - INFO - [session.py:114] - Starting TLS Handshake...
2025-01-02 11:59:51,356 - INFO - [client.py:100] - Generated client_random: 906f5c88f19f2a0c682ec694334c6e063f28544e90165e5eba5f942e4d5ada51
2025-01-02 11:59:51,360 - INFO - [client.py:143] - Client Hello sent from 192.168.1.1
2025-01-02 11:59:51,364 - ERROR - [main.py:28] - Session error: Session failed for 192.168.1.1: Session failed: Failed to send Client Hello: Failed to send TLS packet: 'SessionState' object has no attribute 'client_seq_num'
2025-01-02 12:02:50,104 - INFO - [logging.py:83] - Logging configured successfully
2025-01-02 12:02:50,105 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-02 12:02:50,106 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-02 12:02:50,106 - INFO - [logging.py:92] - Log level: 20
2025-01-02 12:02:50,106 - INFO - [logging.py:93] - Timestamp: 2025-01-02T12:02:50.106878
2025-01-02 12:02:50,107 - INFO - [logging.py:94] - ==========================
2025-01-02 12:02:50,108 - INFO - [main.py:123] - Starting TLS session simulation
2025-01-02 12:02:50,108 - INFO - [main.py:88] - 
--- Client Session (certificate) ---
2025-01-02 12:02:50,110 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-02 12:02:50,110 - INFO - [cert.py:108] - File exists: True
2025-01-02 12:02:50,111 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-02 12:02:50,112 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-02 12:02:50,112 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-02 12:02:50,113 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-02 12:02:50,119 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 12:02:50,119 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-02 12:02:50,120 - INFO - [cert.py:108] - File exists: True
2025-01-02 12:02:50,121 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-02 12:02:50,121 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-02 12:02:50,122 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-02 12:02:50,122 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-02 12:02:50,123 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 12:02:50,160 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-02 12:02:50,161 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-02 12:02:50,162 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-02 12:02:50,164 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-02 12:02:50,168 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-02 12:02:50,169 - INFO - [verify.py:58] - Public key comparison results:
2025-01-02 12:02:50,169 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 12:02:50,170 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 12:02:50,171 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-02 12:02:50,171 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-02 12:02:50,174 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-02 12:02:50,175 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-02 12:02:50,175 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-02 12:02:50,175 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-02 12:02:50,176 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-02 12:02:50,176 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-02 12:02:50,177 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-02 12:02:50,178 - INFO - [session.py:175] - Starting TLS session
2025-01-02 12:02:50,178 - INFO - [session.py:114] - Starting TLS Handshake...
2025-01-02 12:02:50,178 - INFO - [client.py:100] - Generated client_random: 6eea1c684499d537ab5cccd073bc174dd2bf435ba675b4aa809f242cc72e087c
2025-01-02 12:02:50,181 - INFO - [client.py:143] - Client Hello sent from 192.168.1.1
2025-01-02 12:02:50,184 - ERROR - [main.py:28] - Session error: Session failed for 192.168.1.1: Session failed: Failed to send Client Hello: Failed to send TLS packet: 'CustomPcapWriter' object has no attribute 'create_tls_packet'
2025-01-02 12:06:15,175 - INFO - [logging.py:83] - Logging configured successfully
2025-01-02 12:06:15,176 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-02 12:06:15,177 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-02 12:06:15,177 - INFO - [logging.py:92] - Log level: 20
2025-01-02 12:06:15,178 - INFO - [logging.py:93] - Timestamp: 2025-01-02T12:06:15.178077
2025-01-02 12:06:15,178 - INFO - [logging.py:94] - ==========================
2025-01-02 12:06:15,178 - INFO - [main.py:123] - Starting TLS session simulation
2025-01-02 12:06:15,179 - INFO - [main.py:88] - 
--- Client Session (certificate) ---
2025-01-02 12:06:15,181 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-02 12:06:15,181 - INFO - [cert.py:108] - File exists: True
2025-01-02 12:06:15,182 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-02 12:06:15,182 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-02 12:06:15,183 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-02 12:06:15,183 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-02 12:06:15,188 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 12:06:15,189 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-02 12:06:15,189 - INFO - [cert.py:108] - File exists: True
2025-01-02 12:06:15,190 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-02 12:06:15,192 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-02 12:06:15,192 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-02 12:06:15,194 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-02 12:06:15,196 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 12:06:15,257 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-02 12:06:15,258 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-02 12:06:15,258 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-02 12:06:15,259 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-02 12:06:15,262 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-02 12:06:15,263 - INFO - [verify.py:58] - Public key comparison results:
2025-01-02 12:06:15,263 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 12:06:15,264 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 12:06:15,266 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-02 12:06:15,266 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-02 12:06:15,270 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-02 12:06:15,271 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-02 12:06:15,271 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-02 12:06:15,272 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-02 12:06:15,273 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-02 12:06:15,274 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-02 12:06:15,276 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-02 12:06:15,278 - INFO - [session.py:175] - Starting TLS session
2025-01-02 12:06:15,279 - INFO - [session.py:114] - Starting TLS Handshake...
2025-01-02 12:06:15,280 - INFO - [client.py:100] - Generated client_random: 73d0615645c1d0fb5a893cd48d2e68af03259840947b0eb045292ec653395be7
2025-01-02 12:06:15,283 - INFO - [client.py:143] - Client Hello sent from 192.168.1.1
2025-01-02 12:06:15,286 - ERROR - [main.py:28] - Session error: Session failed for 192.168.1.1: Session failed: Failed to send Client Hello: Failed to send TLS packet: SessionState.create_tls_packet() got an unexpected keyword argument 'seq_num'
2025-01-02 12:17:10,128 - INFO - [logging.py:83] - Logging configured successfully
2025-01-02 12:17:10,129 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-02 12:17:10,129 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-02 12:17:10,130 - INFO - [logging.py:92] - Log level: 20
2025-01-02 12:17:10,130 - INFO - [logging.py:93] - Timestamp: 2025-01-02T12:17:10.130792
2025-01-02 12:17:10,131 - INFO - [logging.py:94] - ==========================
2025-01-02 12:17:10,131 - INFO - [main.py:123] - Starting TLS session simulation
2025-01-02 12:17:10,132 - ERROR - [main.py:28] - Configuration error: Environment setup failed: CustomPcapWriter._setup_logging() missing 1 required positional argument: 'self'
2025-01-02 12:18:53,359 - INFO - [logging.py:83] - Logging configured successfully
2025-01-02 12:18:53,359 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-02 12:18:53,360 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-02 12:18:53,360 - INFO - [logging.py:92] - Log level: 20
2025-01-02 12:18:53,361 - INFO - [logging.py:93] - Timestamp: 2025-01-02T12:18:53.361399
2025-01-02 12:18:53,361 - INFO - [logging.py:94] - ==========================
2025-01-02 12:18:53,362 - INFO - [main.py:123] - Starting TLS session simulation
2025-01-02 12:18:53,362 - INFO - [main.py:88] - 
--- Client Session (certificate) ---
2025-01-02 12:18:53,363 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-02 12:18:53,364 - INFO - [cert.py:108] - File exists: True
2025-01-02 12:18:53,364 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-02 12:18:53,365 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-02 12:18:53,365 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-02 12:18:53,366 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-02 12:18:53,367 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 12:18:53,368 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-02 12:18:53,369 - INFO - [cert.py:108] - File exists: True
2025-01-02 12:18:53,369 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-02 12:18:53,370 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-02 12:18:53,371 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-02 12:18:53,371 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-02 12:18:53,373 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 12:18:53,403 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-02 12:18:53,404 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-02 12:18:53,405 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-02 12:18:53,405 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-02 12:18:53,407 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-02 12:18:53,407 - INFO - [verify.py:58] - Public key comparison results:
2025-01-02 12:18:53,407 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 12:18:53,408 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 12:18:53,409 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-02 12:18:53,409 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-02 12:18:53,411 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-02 12:18:53,411 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-02 12:18:53,411 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-02 12:18:53,411 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-02 12:18:53,412 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-02 12:18:53,412 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-02 12:18:53,413 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-02 12:18:53,414 - INFO - [session.py:175] - Starting TLS session
2025-01-02 12:18:53,414 - INFO - [session.py:114] - Starting TLS Handshake...
2025-01-02 12:18:53,415 - INFO - [client.py:100] - Generated client_random: a2d2f496e8a0a820ad1c8a74eaa6e564e305d8d3a4c3b82652c11665ab0916ce
2025-01-02 12:18:53,417 - INFO - [client.py:143] - Client Hello sent from 192.168.1.1
2025-01-02 12:18:53,419 - ERROR - [main.py:28] - Session error: Session failed for 192.168.1.1: Session failed: Failed to send Client Hello: Failed to send TLS packet: SessionState.create_tls_packet() missing 1 required positional argument: 'self'
2025-01-02 12:26:14,319 - INFO - [logging.py:83] - Logging configured successfully
2025-01-02 12:26:14,320 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-02 12:26:14,321 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-02 12:26:14,321 - INFO - [logging.py:92] - Log level: 20
2025-01-02 12:26:14,383 - INFO - [logging.py:93] - Timestamp: 2025-01-02T12:26:14.383515
2025-01-02 12:26:14,384 - INFO - [logging.py:94] - ==========================
2025-01-02 12:26:14,385 - INFO - [main.py:123] - Starting TLS session simulation
2025-01-02 12:26:14,386 - INFO - [main.py:88] - 
--- Client Session (certificate) ---
2025-01-02 12:26:14,389 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-02 12:26:14,391 - INFO - [cert.py:108] - File exists: True
2025-01-02 12:26:14,392 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-02 12:26:14,393 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-02 12:26:14,394 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-02 12:26:14,395 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-02 12:26:14,398 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 12:26:14,399 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-02 12:26:14,401 - INFO - [cert.py:108] - File exists: True
2025-01-02 12:26:14,402 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-02 12:26:14,403 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-02 12:26:14,404 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-02 12:26:14,405 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-02 12:26:14,407 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 12:26:14,623 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-02 12:26:14,625 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-02 12:26:14,626 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-02 12:26:14,627 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-02 12:26:14,630 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-02 12:26:14,679 - INFO - [verify.py:58] - Public key comparison results:
2025-01-02 12:26:14,680 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 12:26:14,682 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 12:26:14,684 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-02 12:26:14,685 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-02 12:26:14,687 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-02 12:26:14,688 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-02 12:26:14,689 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-02 12:26:14,691 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-02 12:26:14,692 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-02 12:26:14,693 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-02 12:26:14,697 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-02 12:26:14,699 - INFO - [session.py:175] - Starting TLS session
2025-01-02 12:26:14,700 - INFO - [session.py:114] - Starting TLS Handshake...
2025-01-02 12:26:14,700 - INFO - [client.py:100] - Generated client_random: 55950ecab26e41265a6a3dd66f42b931b15621d3d3229c4db660ebad6f67f582
2025-01-02 12:26:14,706 - INFO - [client.py:143] - Client Hello sent from 192.168.1.1
2025-01-02 12:26:14,709 - ERROR - [main.py:28] - Session error: Session failed for 192.168.1.1: Session failed: Failed to send Client Hello: Failed to send TLS packet: 'SessionState' object has no attribute 'update_tcp_seq_ack'
2025-01-02 12:49:19,540 - INFO - [logging.py:83] - Logging configured successfully
2025-01-02 12:49:19,541 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-02 12:49:19,542 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-02 12:49:19,542 - INFO - [logging.py:92] - Log level: 20
2025-01-02 12:49:19,543 - INFO - [logging.py:93] - Timestamp: 2025-01-02T12:49:19.543333
2025-01-02 12:49:19,544 - INFO - [logging.py:94] - ==========================
2025-01-02 12:49:19,545 - INFO - [main.py:123] - Starting TLS session simulation
2025-01-02 12:49:19,546 - INFO - [main.py:88] - 
--- Client Session (certificate) ---
2025-01-02 12:49:19,549 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-02 12:49:19,550 - INFO - [cert.py:108] - File exists: True
2025-01-02 12:49:19,551 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-02 12:49:19,553 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-02 12:49:19,554 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-02 12:49:19,555 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-02 12:49:19,563 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 12:49:19,564 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-02 12:49:19,565 - INFO - [cert.py:108] - File exists: True
2025-01-02 12:49:19,565 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-02 12:49:19,567 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-02 12:49:19,568 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-02 12:49:19,570 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-02 12:49:19,572 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 12:49:19,660 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-02 12:49:19,661 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-02 12:49:19,662 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-02 12:49:19,663 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-02 12:49:19,668 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-02 12:49:19,669 - INFO - [verify.py:58] - Public key comparison results:
2025-01-02 12:49:19,669 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 12:49:19,671 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 12:49:19,673 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-02 12:49:19,674 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-02 12:49:19,681 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-02 12:49:19,682 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-02 12:49:19,682 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-02 12:49:19,683 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-02 12:49:19,684 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-02 12:49:19,685 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-02 12:49:19,687 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-02 12:49:19,688 - INFO - [session.py:175] - Starting TLS session
2025-01-02 12:49:19,689 - INFO - [session.py:114] - Starting TLS Handshake...
2025-01-02 12:49:19,690 - INFO - [client.py:100] - Generated client_random: e3c3bd71406eca6d9cc97dd7db316a27aa453addd99e6940e1c49cc9d3514ed9
2025-01-02 12:49:19,698 - INFO - [client.py:143] - Client Hello sent from 192.168.1.1
2025-01-02 12:49:19,706 - INFO - [session.py:119] - Client Hello sent successfully
2025-01-02 12:49:19,706 - INFO - [server.py:94] - Generated server_random: be4d3027a0c0c7d5bcc30c5adcc81d9b9496fd91d9a4fbadfa16e2d7e8905a4f
2025-01-02 12:49:19,719 - INFO - [session.py:124] - Server Hello received successfully
2025-01-02 12:49:19,720 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2025-01-02 12:49:19,722 - INFO - [cert.py:108] - File exists: True
2025-01-02 12:49:19,724 - INFO - [cert.py:109] - File size: 1915 bytes
2025-01-02 12:49:19,726 - INFO - [cert.py:113] - Read 1915 bytes
2025-01-02 12:49:19,727 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2025-01-02 12:49:19,728 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2025-01-02 12:49:19,729 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 12:49:19,730 - INFO - [client.py:177] - Prepared client certificate
2025-01-02 12:49:19,732 - INFO - [client.py:192] - Encrypted pre_master_secret length: 256
2025-01-02 12:49:19,735 - INFO - [session.py:129] - Client handshake messages sent successfully
2025-01-02 12:49:19,749 - INFO - [session.py:134] - Server key pair verified successfully
2025-01-02 12:49:19,750 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-02 12:49:19,752 - INFO - [chain.py:185] - Decrypted pre_master_secret: 0303111a56fde118c5226d65461c48c27c0087eb2cc2938f744a0eda7bc19ca674b6b0ff45eaf8474d0ea1dbf1d68812
2025-01-02 12:49:19,752 - INFO - [chain.py:195] - Generated master secret: ca5a4a333fe06f6216aa91746b0443bac3151fca99f180dbbbcb86904a361adfd432c94ee0e939359b7f768170fd3753
2025-01-02 12:49:19,754 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-02 12:49:19,755 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-02 12:49:19,756 - INFO - [session.py:138] - Master Secret handled successfully
2025-01-02 12:49:19,758 - INFO - [client.py:273] - Pre-master secret validated successfully
2025-01-02 12:49:19,762 - INFO - [client.py:291] - Generated digital signature: 31ec006eba5456bd47f3be0fe0b34579dcf7bc712c1e59468676269cf8a40aff9d1ad1fef4a319cc47a6b1e45f9a762d9f9b2b4838e3f5ab1441a45250c8829ca72d396848a494be45075aa7d488c7201d8b50128c1656601e0aecc988c98d390292baab58134bacb7e3caffc84e1e16d92552d9f5249c7165b51ff4f9810a8f9ddc3d5e7baf60d6a835b85e7dcaefcf92ad15dd7f3c495404d2e1b05a2275383e8a294fe74f7cb681459a5f9a6beac089f7fa3efc3b3217600a9a81c7b225b0dec616bf7f061db7b58f6d8bb970d87020c9e2a2aa160df1fdf16880db6d5b149979f477dce9c8db32e3e1089445f8d3dca2bb3e085f0fa86f4b76215610b0bd
2025-01-02 12:49:19,769 - INFO - [client.py:337] - Client ChangeCipherSpec and Finished messages sent
2025-01-02 12:49:19,772 - INFO - [session.py:143] - Client Change Cipher Spec sent successfully
2025-01-02 12:49:19,774 - INFO - [server.py:260] - Pre-master secret validated successfully
2025-01-02 12:49:19,776 - INFO - [server.py:278] - Generated digital signature: 5c37c50f9de8028fd97db5056770188ec4a8b7a9489e661667025edea870d0eb1b4a5a024073e99266496dfac5459c63f50012255a84dac41d04c526d4a1d0129a2e8f14ef6c699723cbe5211a071f11c8a4727f1d1a1e8c2cd561cf6223a5836e2e6454f6fb2c4343158c91464cfe8312f3383d3503a1bac38836348586c1361c35785aab70b905b41844e4d72b6fd14dd340f93688aac4293ed9c200dc39c8c678952e21e522009dbdf4750ea124350279b9f3ebb0854e8eb59d205c9615361d73e6528f29d51e93ebf045e05f41784d4e5b2c078958736c0e28ddb6fccaf8f09299ec6457c3f8ce0adf8813b0d26ef71ae67c8499ae31cf2ceff68c9f4fcf
2025-01-02 12:49:19,779 - INFO - [server.py:324] - Server ChangeCipherSpec and Finished messages sent
2025-01-02 12:49:19,781 - INFO - [session.py:148] - Server Change Cipher Spec received successfully
2025-01-02 12:49:19,782 - INFO - [keys.py:218] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-02 12:49:19,783 - INFO - [session.py:153] - SSL Key Log handled successfully
2025-01-02 12:49:19,783 - INFO - [session.py:157] - TLS Handshake completed successfully
2025-01-02 12:49:19,785 - INFO - [session.py:186] - Found file to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 12:49:19,786 - INFO - [session.py:204] - Handshake completed: True
2025-01-02 12:49:19,788 - INFO - [session.py:205] - Use client cert: True
2025-01-02 12:49:19,789 - INFO - [session.py:206] - File to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 12:49:19,790 - INFO - [session.py:209] - Using encrypted exchange
2025-01-02 12:49:19,792 - INFO - [session.py:224] - Sending encrypted request data
2025-01-02 12:49:19,794 - INFO - [keys.py:185] - TLS Application Data sent from 192.168.1.1:12345 to 10.0.0.1:443
2025-01-02 12:49:19,795 - INFO - [session.py:235] - Sending encrypted response data
2025-01-02 12:49:19,797 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-02 12:49:19,798 - INFO - [session.py:247] - Attempting to send file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 12:49:19,799 - INFO - [session.py:258] - Opening file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 12:49:19,801 - INFO - [session.py:265] - Read 1103 bytes from file
2025-01-02 12:49:19,803 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-02 12:49:19,804 - INFO - [session.py:274] - File sent successfully
2025-01-02 12:49:19,806 - INFO - [session.py:249] - File sent successfully
2025-01-02 12:49:19,806 - INFO - [main.py:96] - Session completed successfully for 192.168.1.1
2025-01-02 12:49:19,806 - INFO - [main.py:88] - 
--- Client Session (no certificate) ---
2025-01-02 12:49:19,807 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-02 12:49:19,808 - INFO - [cert.py:108] - File exists: True
2025-01-02 12:49:19,808 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-02 12:49:19,808 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-02 12:49:19,809 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-02 12:49:19,809 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-02 12:49:19,811 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 12:49:19,812 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-02 12:49:19,812 - INFO - [cert.py:108] - File exists: True
2025-01-02 12:49:19,813 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-02 12:49:19,813 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-02 12:49:19,813 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-02 12:49:19,814 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-02 12:49:19,815 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 12:49:19,852 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-02 12:49:19,853 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-02 12:49:19,853 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-02 12:49:19,854 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-02 12:49:19,855 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-02 12:49:19,855 - INFO - [verify.py:58] - Public key comparison results:
2025-01-02 12:49:19,856 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 12:49:19,856 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 12:49:19,857 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-02 12:49:19,858 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-02 12:49:19,858 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-02 12:49:19,859 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-02 12:49:19,859 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-02 12:49:19,860 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-02 12:49:19,860 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-02 12:49:19,861 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-02 12:49:19,863 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-02 12:49:19,863 - INFO - [session.py:175] - Starting TLS session
2025-01-02 12:49:19,864 - INFO - [session.py:114] - Starting TLS Handshake...
2025-01-02 12:49:19,864 - INFO - [client.py:100] - Generated client_random: 6ffcf002e140d71e2b8c15c0abd663c0d791634bb2f994bed6c4bcda5945fa54
2025-01-02 12:49:19,867 - INFO - [client.py:143] - Client Hello sent from 192.168.1.2
2025-01-02 12:49:19,871 - INFO - [session.py:119] - Client Hello sent successfully
2025-01-02 12:49:19,871 - INFO - [server.py:94] - Generated server_random: 3cb6ca3c6ac8459c9ad39c6b4fd53bd8777d33450efc32440c0fb5c74f8e890d
2025-01-02 12:49:19,879 - INFO - [session.py:124] - Server Hello received successfully
2025-01-02 12:49:19,879 - INFO - [client.py:180] - Prepared empty certificate
2025-01-02 12:49:19,880 - INFO - [client.py:192] - Encrypted pre_master_secret length: 256
2025-01-02 12:49:19,882 - INFO - [session.py:129] - Client handshake messages sent successfully
2025-01-02 12:49:19,885 - INFO - [session.py:134] - Server key pair verified successfully
2025-01-02 12:49:19,885 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-02 12:49:19,886 - INFO - [chain.py:185] - Decrypted pre_master_secret: 03036a2e42a45193e54193af1aa022ea9731f34e46cceba6046e8db6bf2c69c869db2a8d53a32fde2f2e01fd3c862571
2025-01-02 12:49:19,887 - INFO - [chain.py:195] - Generated master secret: 6ee9581ea4a4f18fb59d22976b7bc4d3e966be2f875621490b5b27503874c254461cbb004d3c9cd3763c6db38778af24
2025-01-02 12:49:19,888 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-02 12:49:19,888 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-02 12:49:19,889 - INFO - [session.py:138] - Master Secret handled successfully
2025-01-02 12:49:19,890 - INFO - [client.py:273] - Pre-master secret validated successfully
2025-01-02 12:49:19,892 - INFO - [client.py:291] - Generated digital signature: 653b3459903dece25a1b376032d87afb6de51e33b75c3e42eee457065460447dec81bc250b173881e6ac3cb7c959046743ff5d17f893ac3caf6f973c20de1c957634fa4ea9abac7063fb81d73783b64efd3badc3f14d88c53e0fa843292290d7603ccc67d3877b1d6f3951021ccd65eba96e18b6fe17bb7ed89594d21f2e2de37c81d5ffcc9a0f284503ae30af75bf49e48425273fc1be008409cc2f72e67fcb40c549c054eb599ba87b6c479b9061dcb4735f655e1bbb8170af918195e6c29228c89fb1e9721a8ee6dade2a033c007f45cd9c7606d4f5f2ba852e2d1e5dad7ef209b0a71bfa34d37ef0902eba9fbbe737dcf5761dd95281541080ea59a35c11
2025-01-02 12:49:19,895 - INFO - [client.py:337] - Client ChangeCipherSpec and Finished messages sent
2025-01-02 12:49:19,897 - INFO - [session.py:143] - Client Change Cipher Spec sent successfully
2025-01-02 12:49:19,898 - INFO - [server.py:260] - Pre-master secret validated successfully
2025-01-02 12:49:19,900 - INFO - [server.py:278] - Generated digital signature: 9835374a5c9d91643cb362ee98cabe5f9ecebe2e20ae77b2cedfb124b57e78455d73ad10aa34226d42b7639160d8d11cb482676817d0b12565501062e171970578c8e4a99b0d032930907321d916b540bae9b43fc54fa10c1549802085e2b2f6e65be37b28e4641e0181a2c6d403932836dbfb331f5431a16970e5454aaa4c7878853b95e5fdec638acfbe8a265834eee04245054e213159cc844cf7687dcc40032bd8f7f1d59172dd12ccf7cc52257909e9424794de82fb43ce8e9dc0fbe9f6622fd4e2161849eaa26f525c55a2499029ca0651e39f796865ead8425797cf90c99d5db3a683ee50bc2357ab010be5391cefde2860bd1a27d3c4e43acb4820a0
2025-01-02 12:49:19,902 - INFO - [server.py:324] - Server ChangeCipherSpec and Finished messages sent
2025-01-02 12:49:19,904 - INFO - [session.py:148] - Server Change Cipher Spec received successfully
2025-01-02 12:49:19,905 - INFO - [keys.py:218] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-02 12:49:19,905 - INFO - [session.py:153] - SSL Key Log handled successfully
2025-01-02 12:49:19,906 - INFO - [session.py:157] - TLS Handshake completed successfully
2025-01-02 12:49:19,907 - INFO - [session.py:204] - Handshake completed: True
2025-01-02 12:49:19,907 - INFO - [session.py:205] - Use client cert: False
2025-01-02 12:49:19,908 - INFO - [session.py:206] - File to send: None
2025-01-02 12:49:19,909 - INFO - [session.py:212] - Using unencrypted exchange
2025-01-02 12:49:19,909 - ERROR - [session.py:315] - Failed to send unencrypted data: 'PcapWriter' object has no attribute 'create_tcp_packet'
2025-01-02 12:49:19,910 - ERROR - [session.py:315] - Failed to send unencrypted data: 'PcapWriter' object has no attribute 'create_tcp_packet'
2025-01-02 12:49:19,910 - WARNING - [session.py:289] - Using unencrypted communication
2025-01-02 12:49:19,911 - INFO - [main.py:96] - Session completed successfully for 192.168.1.2
2025-01-02 12:49:19,918 - INFO - [packet_storage.py:79] - Saved 13 valid packets to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-02 12:49:19,919 - INFO - [packet_storage.py:100] - Verifying 13 packets...
2025-01-02 12:49:19,920 - INFO - [packet_storage.py:104] - Packet 1: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 12:49:19,921 - ERROR - [packet_storage.py:108] - Error verifying packet 1: type object 'PacketValidator' has no attribute 'count_tls_records'
2025-01-02 12:49:19,922 - INFO - [packet_storage.py:104] - Packet 2: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 12:49:19,923 - ERROR - [packet_storage.py:108] - Error verifying packet 2: type object 'PacketValidator' has no attribute 'count_tls_records'
2025-01-02 12:49:19,924 - INFO - [packet_storage.py:104] - Packet 3: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 12:49:19,925 - ERROR - [packet_storage.py:108] - Error verifying packet 3: type object 'PacketValidator' has no attribute 'count_tls_records'
2025-01-02 12:49:19,926 - INFO - [packet_storage.py:104] - Packet 4: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 12:49:19,926 - ERROR - [packet_storage.py:108] - Error verifying packet 4: type object 'PacketValidator' has no attribute 'count_tls_records'
2025-01-02 12:49:19,927 - INFO - [packet_storage.py:104] - Packet 5: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 12:49:19,927 - ERROR - [packet_storage.py:108] - Error verifying packet 5: type object 'PacketValidator' has no attribute 'count_tls_records'
2025-01-02 12:49:19,928 - INFO - [packet_storage.py:104] - Packet 6: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 12:49:19,929 - ERROR - [packet_storage.py:108] - Error verifying packet 6: type object 'PacketValidator' has no attribute 'count_tls_records'
2025-01-02 12:49:19,929 - INFO - [packet_storage.py:104] - Packet 7: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 12:49:19,930 - ERROR - [packet_storage.py:108] - Error verifying packet 7: type object 'PacketValidator' has no attribute 'count_tls_records'
2025-01-02 12:49:19,931 - INFO - [packet_storage.py:104] - Packet 8: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 12:49:19,931 - ERROR - [packet_storage.py:108] - Error verifying packet 8: type object 'PacketValidator' has no attribute 'count_tls_records'
2025-01-02 12:49:19,931 - INFO - [packet_storage.py:104] - Packet 9: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-02 12:49:19,932 - ERROR - [packet_storage.py:108] - Error verifying packet 9: type object 'PacketValidator' has no attribute 'count_tls_records'
2025-01-02 12:49:19,932 - INFO - [packet_storage.py:104] - Packet 10: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-02 12:49:19,933 - ERROR - [packet_storage.py:108] - Error verifying packet 10: type object 'PacketValidator' has no attribute 'count_tls_records'
2025-01-02 12:49:19,934 - INFO - [packet_storage.py:104] - Packet 11: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-02 12:49:19,934 - ERROR - [packet_storage.py:108] - Error verifying packet 11: type object 'PacketValidator' has no attribute 'count_tls_records'
2025-01-02 12:49:19,936 - INFO - [packet_storage.py:104] - Packet 12: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-02 12:49:19,937 - ERROR - [packet_storage.py:108] - Error verifying packet 12: type object 'PacketValidator' has no attribute 'count_tls_records'
2025-01-02 12:49:19,938 - INFO - [packet_storage.py:104] - Packet 13: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-02 12:49:19,939 - ERROR - [packet_storage.py:108] - Error verifying packet 13: type object 'PacketValidator' has no attribute 'count_tls_records'
2025-01-02 12:49:19,939 - INFO - [packet_storage.py:111] - Verification complete: 13 valid packets, 0 TLS records
2025-01-02 12:49:19,940 - INFO - [main.py:107] - Results saved to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-02 12:49:19,941 - INFO - [main.py:161] - TLS session simulation completed successfully
2025-01-02 12:49:40,535 - INFO - [logging.py:83] - Logging configured successfully
2025-01-02 12:49:40,535 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-02 12:49:40,536 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-02 12:49:40,536 - INFO - [logging.py:92] - Log level: 20
2025-01-02 12:49:40,537 - INFO - [logging.py:93] - Timestamp: 2025-01-02T12:49:40.536992
2025-01-02 12:49:40,537 - INFO - [logging.py:94] - ==========================
2025-01-02 12:49:40,537 - INFO - [main.py:123] - Starting TLS session simulation
2025-01-02 12:49:40,538 - INFO - [main.py:88] - 
--- Client Session (certificate) ---
2025-01-02 12:49:40,538 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-02 12:49:40,539 - INFO - [cert.py:108] - File exists: True
2025-01-02 12:49:40,539 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-02 12:49:40,539 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-02 12:49:40,540 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-02 12:49:40,540 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-02 12:49:40,541 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 12:49:40,542 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-02 12:49:40,542 - INFO - [cert.py:108] - File exists: True
2025-01-02 12:49:40,543 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-02 12:49:40,543 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-02 12:49:40,544 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-02 12:49:40,544 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-02 12:49:40,545 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 12:49:40,574 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-02 12:49:40,575 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-02 12:49:40,576 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-02 12:49:40,576 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-02 12:49:40,579 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-02 12:49:40,580 - INFO - [verify.py:58] - Public key comparison results:
2025-01-02 12:49:40,580 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 12:49:40,581 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 12:49:40,582 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-02 12:49:40,583 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-02 12:49:40,584 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-02 12:49:40,584 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-02 12:49:40,585 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-02 12:49:40,585 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-02 12:49:40,585 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-02 12:49:40,586 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-02 12:49:40,600 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-02 12:49:40,601 - INFO - [session.py:175] - Starting TLS session
2025-01-02 12:49:40,602 - INFO - [session.py:114] - Starting TLS Handshake...
2025-01-02 12:49:40,603 - INFO - [client.py:100] - Generated client_random: b64bb47924bf4aff69dbb27abf7d3630a9b7e655e44842d0ab41474238c2c48b
2025-01-02 12:49:40,607 - INFO - [client.py:143] - Client Hello sent from 192.168.1.1
2025-01-02 12:49:40,611 - INFO - [session.py:119] - Client Hello sent successfully
2025-01-02 12:49:40,612 - INFO - [server.py:94] - Generated server_random: 7e482b7d772f42ba725a0a1c011f6a78970fa690f753c0debfa14530b55eb464
2025-01-02 12:49:40,618 - INFO - [session.py:124] - Server Hello received successfully
2025-01-02 12:49:40,619 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2025-01-02 12:49:40,620 - INFO - [cert.py:108] - File exists: True
2025-01-02 12:49:40,621 - INFO - [cert.py:109] - File size: 1915 bytes
2025-01-02 12:49:40,622 - INFO - [cert.py:113] - Read 1915 bytes
2025-01-02 12:49:40,623 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2025-01-02 12:49:40,623 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2025-01-02 12:49:40,625 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 12:49:40,625 - INFO - [client.py:177] - Prepared client certificate
2025-01-02 12:49:40,626 - INFO - [client.py:192] - Encrypted pre_master_secret length: 256
2025-01-02 12:49:40,628 - INFO - [session.py:129] - Client handshake messages sent successfully
2025-01-02 12:49:40,630 - INFO - [session.py:134] - Server key pair verified successfully
2025-01-02 12:49:40,630 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-02 12:49:40,632 - INFO - [chain.py:185] - Decrypted pre_master_secret: 0303feec930948228afb4aa1d7db631c0919d43d4fbb5bf3cee69d8e263ef2b818023f1abd34daf4e55a2d2c104f17c5
2025-01-02 12:49:40,633 - INFO - [chain.py:195] - Generated master secret: d5ffca567dcf53c240e83e15aa55329a3c0efb9d6afff0141c5188b43127bfaac6f593938c9c6a055264e6e2b3f1f3f2
2025-01-02 12:49:40,634 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-02 12:49:40,636 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-02 12:49:40,637 - INFO - [session.py:138] - Master Secret handled successfully
2025-01-02 12:49:40,639 - INFO - [client.py:273] - Pre-master secret validated successfully
2025-01-02 12:49:40,640 - INFO - [client.py:291] - Generated digital signature: 917a1afaeb77b9fc1db33d649e6fced40b82af6b1d86e2376b5103dcf6c4085e2d659b543706390968351728dfc01373332f85056d42b6e0dbc150a530db5c9e9395010614098abe0a8da4f75376f5e52919c8e8266205b4134c6dbde1727034bac859bceabc383d48ff4983252f9c7a66a8e214dc0bd72b2c8c8c7f093eb175fd3eb721ca915710bdb3bded20179d318a8508aa771d39ea0c719ca658d1839d2d4c0e3cfeee2e2ae4ac35969e16146675f81f4f2c47789ff0d341ba9f54951f75bff74eca6d7912c338f3ac2c13afef4f2709eebe053454e7baa5ab7cf64fcb0072b9129deee2ed10f78d8a236c532fc03c7176062735cac32d74c231172a7b
2025-01-02 12:49:40,643 - INFO - [client.py:337] - Client ChangeCipherSpec and Finished messages sent
2025-01-02 12:49:40,644 - INFO - [session.py:143] - Client Change Cipher Spec sent successfully
2025-01-02 12:49:40,645 - INFO - [server.py:260] - Pre-master secret validated successfully
2025-01-02 12:49:40,647 - INFO - [server.py:278] - Generated digital signature: 2d19b09bea5aa4dfe072044b1e81b9c6915c88ef94c51510a01c471ea8a1607c7d12fca2785ed46ccbfd2f8d01b3258102ca3432fcd8407c9801c8232076a1c91d7603240ef1bd2f32fa3d2628608f531c19b664c46162d8219dca439c08a858288c96eb1921fa41184f80cde0588aa0ad88bf9c0396847bf2794929d1e70b21aced297f6528ee07e4f11f5e7878ff3342516c11f21235fa013ea3b096d530f089b93107c78527319b9a31d4abc96debfdbe82d369656f5142d23ef3eb27cab184b037b9a851a9c7db9aef4ca85ae3bd46c1a75504440ecb426feddd755f516f9154dcb94e16ccac525fd393a6332ad93f9aefbb0a4828d87fc42a02a84f793d
2025-01-02 12:49:40,650 - INFO - [server.py:324] - Server ChangeCipherSpec and Finished messages sent
2025-01-02 12:49:40,652 - INFO - [session.py:148] - Server Change Cipher Spec received successfully
2025-01-02 12:49:40,654 - INFO - [keys.py:218] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-02 12:49:40,654 - INFO - [session.py:153] - SSL Key Log handled successfully
2025-01-02 12:49:40,655 - INFO - [session.py:157] - TLS Handshake completed successfully
2025-01-02 12:49:40,656 - INFO - [session.py:186] - Found file to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 12:49:40,657 - INFO - [session.py:204] - Handshake completed: True
2025-01-02 12:49:40,657 - INFO - [session.py:205] - Use client cert: True
2025-01-02 12:49:40,658 - INFO - [session.py:206] - File to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 12:49:40,658 - INFO - [session.py:209] - Using encrypted exchange
2025-01-02 12:49:40,659 - INFO - [session.py:224] - Sending encrypted request data
2025-01-02 12:49:40,661 - INFO - [keys.py:185] - TLS Application Data sent from 192.168.1.1:12345 to 10.0.0.1:443
2025-01-02 12:49:40,662 - INFO - [session.py:235] - Sending encrypted response data
2025-01-02 12:49:40,664 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-02 12:49:40,664 - INFO - [session.py:247] - Attempting to send file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 12:49:40,665 - INFO - [session.py:258] - Opening file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 12:49:40,666 - INFO - [session.py:265] - Read 1103 bytes from file
2025-01-02 12:49:40,669 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-02 12:49:40,671 - INFO - [session.py:274] - File sent successfully
2025-01-02 12:49:40,672 - INFO - [session.py:249] - File sent successfully
2025-01-02 12:49:40,672 - INFO - [main.py:96] - Session completed successfully for 192.168.1.1
2025-01-02 12:49:40,673 - INFO - [main.py:88] - 
--- Client Session (no certificate) ---
2025-01-02 12:49:40,673 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-02 12:49:40,674 - INFO - [cert.py:108] - File exists: True
2025-01-02 12:49:40,675 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-02 12:49:40,676 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-02 12:49:40,676 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-02 12:49:40,677 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-02 12:49:40,680 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 12:49:40,681 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-02 12:49:40,682 - INFO - [cert.py:108] - File exists: True
2025-01-02 12:49:40,683 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-02 12:49:40,685 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-02 12:49:40,687 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-02 12:49:40,689 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-02 12:49:40,692 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 12:49:40,741 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-02 12:49:40,741 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-02 12:49:40,742 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-02 12:49:40,742 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-02 12:49:40,742 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-02 12:49:40,743 - INFO - [verify.py:58] - Public key comparison results:
2025-01-02 12:49:40,743 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 12:49:40,744 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 12:49:40,746 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-02 12:49:40,746 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-02 12:49:40,747 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-02 12:49:40,747 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-02 12:49:40,748 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-02 12:49:40,748 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-02 12:49:40,749 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-02 12:49:40,752 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-02 12:49:40,756 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-02 12:49:40,757 - INFO - [session.py:175] - Starting TLS session
2025-01-02 12:49:40,758 - INFO - [session.py:114] - Starting TLS Handshake...
2025-01-02 12:49:40,758 - INFO - [client.py:100] - Generated client_random: 0dff9d077f574e682dd752f252c520f587c243a2f01dca62887ff06bd83926a8
2025-01-02 12:49:40,762 - INFO - [client.py:143] - Client Hello sent from 192.168.1.2
2025-01-02 12:49:40,768 - INFO - [session.py:119] - Client Hello sent successfully
2025-01-02 12:49:40,770 - INFO - [server.py:94] - Generated server_random: e999745358752b121e277404e3fc6d496828d05f03b8e6754b14fbf0ca4ee118
2025-01-02 12:49:40,778 - INFO - [session.py:124] - Server Hello received successfully
2025-01-02 12:49:40,779 - INFO - [client.py:180] - Prepared empty certificate
2025-01-02 12:49:40,780 - INFO - [client.py:192] - Encrypted pre_master_secret length: 256
2025-01-02 12:49:40,781 - INFO - [session.py:129] - Client handshake messages sent successfully
2025-01-02 12:49:40,785 - INFO - [session.py:134] - Server key pair verified successfully
2025-01-02 12:49:40,786 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-02 12:49:40,788 - INFO - [chain.py:185] - Decrypted pre_master_secret: 0303cc5efb3d5f67a1997750fe555972a2ee7c2306a74c1bcd34823720713c814c2f7722af8ae8b88040eed4e2157397
2025-01-02 12:49:40,789 - INFO - [chain.py:195] - Generated master secret: 56e2f4d94a1f78bdef4c26dbb7e43a9d0f38fa4e85e7fc722d25b81b92cb727a7a0bde8470c4ed023f545375e404ee4a
2025-01-02 12:49:40,789 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-02 12:49:40,790 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-02 12:49:40,790 - INFO - [session.py:138] - Master Secret handled successfully
2025-01-02 12:49:40,792 - INFO - [client.py:273] - Pre-master secret validated successfully
2025-01-02 12:49:40,794 - INFO - [client.py:291] - Generated digital signature: b814a392d5e18470fc88ba3f5bf27c79008b37394ad809e6c1579617f78661e39820e747ba9cfcdd2234d2967f094912ca3ec47560bb04ee5824576d42f6d5e1a224317154d5eab1991bab841a35def60c635d1a2e3cc74655d6d500d8109c02d4712b7ddbe3f7c5df4dff0c005cd0a98908acfac03933820f03018de72b3b1ffbdf556af6a5f107d3bdbc4e57a3a08effc9568582d8cfb2204b5b126f3f857846b7c1da1156f72296e90da4f5db1eda25d9fec880649895342b441627fe53444fd5b53d47964bd1d1675404085170113126c5c50a5c10b3a14ed09bb5283f4f52bda812f11bb45d937f9abdbd77611e254772ef646b7c63bdf1547dfad79e89
2025-01-02 12:49:40,795 - INFO - [client.py:337] - Client ChangeCipherSpec and Finished messages sent
2025-01-02 12:49:40,796 - INFO - [session.py:143] - Client Change Cipher Spec sent successfully
2025-01-02 12:49:40,797 - INFO - [server.py:260] - Pre-master secret validated successfully
2025-01-02 12:49:40,798 - INFO - [server.py:278] - Generated digital signature: 4f036e63e14019f3912e972f9afff047e2bfe844a73be6d1d4bfd963bac43936aafb5c7881dd011451099303877efef57a002a91bdcbcbe67fbfbf57a7ac28a713937fbb60f5bdc359876662d2126ee050755cf6f8cabb17cca084afae1b233a2b1377e25c649054768b58fc96f8e884c7f54fb7e2049b18ae735bd1f309c76485c599f9e4f16fab49bd8233ba86054679a6d4f9355b8984012abbc0b1f57c7fbfeb57c174190d7e16804ca57fb9f21e59ae43a341e2009ed64353283edea809d08403ed4faf63f7bc844b205d65d6a37f820fb79916b22d4f71a9c936536e8247ff24d32641214c7e62b9634e109110865551bcf70a8e9be156735ad2ec3e29
2025-01-02 12:49:40,802 - INFO - [server.py:324] - Server ChangeCipherSpec and Finished messages sent
2025-01-02 12:49:40,805 - INFO - [session.py:148] - Server Change Cipher Spec received successfully
2025-01-02 12:49:40,806 - INFO - [keys.py:218] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-02 12:49:40,806 - INFO - [session.py:153] - SSL Key Log handled successfully
2025-01-02 12:49:40,807 - INFO - [session.py:157] - TLS Handshake completed successfully
2025-01-02 12:49:40,807 - INFO - [session.py:204] - Handshake completed: True
2025-01-02 12:49:40,807 - INFO - [session.py:205] - Use client cert: False
2025-01-02 12:49:40,808 - INFO - [session.py:206] - File to send: None
2025-01-02 12:49:40,808 - INFO - [session.py:212] - Using unencrypted exchange
2025-01-02 12:49:40,809 - ERROR - [session.py:315] - Failed to send unencrypted data: 'PcapWriter' object has no attribute 'create_tcp_packet'
2025-01-02 12:49:40,809 - ERROR - [session.py:315] - Failed to send unencrypted data: 'PcapWriter' object has no attribute 'create_tcp_packet'
2025-01-02 12:49:40,809 - WARNING - [session.py:289] - Using unencrypted communication
2025-01-02 12:49:40,809 - INFO - [main.py:96] - Session completed successfully for 192.168.1.2
2025-01-02 12:49:40,814 - INFO - [packet_storage.py:79] - Saved 13 valid packets to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-02 12:49:40,815 - INFO - [packet_storage.py:100] - Verifying 13 packets...
2025-01-02 12:49:40,816 - INFO - [packet_storage.py:104] - Packet 1: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 12:49:40,817 - ERROR - [packet_storage.py:108] - Error verifying packet 1: type object 'PacketValidator' has no attribute 'count_tls_records'
2025-01-02 12:49:40,819 - INFO - [packet_storage.py:104] - Packet 2: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 12:49:40,820 - ERROR - [packet_storage.py:108] - Error verifying packet 2: type object 'PacketValidator' has no attribute 'count_tls_records'
2025-01-02 12:49:40,822 - INFO - [packet_storage.py:104] - Packet 3: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 12:49:40,823 - ERROR - [packet_storage.py:108] - Error verifying packet 3: type object 'PacketValidator' has no attribute 'count_tls_records'
2025-01-02 12:49:40,825 - INFO - [packet_storage.py:104] - Packet 4: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 12:49:40,826 - ERROR - [packet_storage.py:108] - Error verifying packet 4: type object 'PacketValidator' has no attribute 'count_tls_records'
2025-01-02 12:49:40,827 - INFO - [packet_storage.py:104] - Packet 5: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 12:49:40,827 - ERROR - [packet_storage.py:108] - Error verifying packet 5: type object 'PacketValidator' has no attribute 'count_tls_records'
2025-01-02 12:49:40,828 - INFO - [packet_storage.py:104] - Packet 6: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 12:49:40,829 - ERROR - [packet_storage.py:108] - Error verifying packet 6: type object 'PacketValidator' has no attribute 'count_tls_records'
2025-01-02 12:49:40,830 - INFO - [packet_storage.py:104] - Packet 7: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 12:49:40,830 - ERROR - [packet_storage.py:108] - Error verifying packet 7: type object 'PacketValidator' has no attribute 'count_tls_records'
2025-01-02 12:49:40,831 - INFO - [packet_storage.py:104] - Packet 8: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 12:49:40,832 - ERROR - [packet_storage.py:108] - Error verifying packet 8: type object 'PacketValidator' has no attribute 'count_tls_records'
2025-01-02 12:49:40,833 - INFO - [packet_storage.py:104] - Packet 9: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-02 12:49:40,834 - ERROR - [packet_storage.py:108] - Error verifying packet 9: type object 'PacketValidator' has no attribute 'count_tls_records'
2025-01-02 12:49:40,836 - INFO - [packet_storage.py:104] - Packet 10: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-02 12:49:40,837 - ERROR - [packet_storage.py:108] - Error verifying packet 10: type object 'PacketValidator' has no attribute 'count_tls_records'
2025-01-02 12:49:40,839 - INFO - [packet_storage.py:104] - Packet 11: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-02 12:49:40,840 - ERROR - [packet_storage.py:108] - Error verifying packet 11: type object 'PacketValidator' has no attribute 'count_tls_records'
2025-01-02 12:49:40,841 - INFO - [packet_storage.py:104] - Packet 12: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-02 12:49:40,842 - ERROR - [packet_storage.py:108] - Error verifying packet 12: type object 'PacketValidator' has no attribute 'count_tls_records'
2025-01-02 12:49:40,843 - INFO - [packet_storage.py:104] - Packet 13: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-02 12:49:40,843 - ERROR - [packet_storage.py:108] - Error verifying packet 13: type object 'PacketValidator' has no attribute 'count_tls_records'
2025-01-02 12:49:40,844 - INFO - [packet_storage.py:111] - Verification complete: 13 valid packets, 0 TLS records
2025-01-02 12:49:40,844 - INFO - [main.py:107] - Results saved to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-02 12:49:40,845 - INFO - [main.py:161] - TLS session simulation completed successfully
2025-01-02 12:53:09,656 - INFO - [logging.py:83] - Logging configured successfully
2025-01-02 12:53:09,658 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-02 12:53:09,659 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-02 12:53:09,659 - INFO - [logging.py:92] - Log level: 20
2025-01-02 12:53:09,660 - INFO - [logging.py:93] - Timestamp: 2025-01-02T12:53:09.660458
2025-01-02 12:53:09,661 - INFO - [logging.py:94] - ==========================
2025-01-02 12:53:09,661 - INFO - [main.py:123] - Starting TLS session simulation
2025-01-02 12:53:09,662 - INFO - [main.py:88] - 
--- Client Session (certificate) ---
2025-01-02 12:53:09,664 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-02 12:53:09,665 - INFO - [cert.py:108] - File exists: True
2025-01-02 12:53:09,666 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-02 12:53:09,667 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-02 12:53:09,668 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-02 12:53:09,670 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-02 12:53:09,677 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 12:53:09,678 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-02 12:53:09,679 - INFO - [cert.py:108] - File exists: True
2025-01-02 12:53:09,680 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-02 12:53:09,682 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-02 12:53:09,683 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-02 12:53:09,684 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-02 12:53:09,688 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 12:53:09,752 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-02 12:53:09,753 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-02 12:53:09,753 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-02 12:53:09,754 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-02 12:53:09,757 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-02 12:53:09,757 - INFO - [verify.py:58] - Public key comparison results:
2025-01-02 12:53:09,758 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 12:53:09,759 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 12:53:09,761 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-02 12:53:09,761 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-02 12:53:09,767 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-02 12:53:09,768 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-02 12:53:09,768 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-02 12:53:09,769 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-02 12:53:09,769 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-02 12:53:09,771 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-02 12:53:09,772 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-02 12:53:09,773 - INFO - [session.py:175] - Starting TLS session
2025-01-02 12:53:09,774 - INFO - [session.py:114] - Starting TLS Handshake...
2025-01-02 12:53:09,774 - INFO - [client.py:100] - Generated client_random: d70532ebc79508fdbaab836018cd36e1f9376b3114dbf1090d65e72886f0f575
2025-01-02 12:53:09,778 - INFO - [client.py:143] - Client Hello sent from 192.168.1.1
2025-01-02 12:53:09,784 - INFO - [session.py:119] - Client Hello sent successfully
2025-01-02 12:53:09,785 - INFO - [server.py:94] - Generated server_random: 9f8d5a9d80782c60323d9e6facb39a23b252213b5e89c49699780caa7fae8542
2025-01-02 12:53:09,790 - INFO - [session.py:124] - Server Hello received successfully
2025-01-02 12:53:09,791 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2025-01-02 12:53:09,792 - INFO - [cert.py:108] - File exists: True
2025-01-02 12:53:09,793 - INFO - [cert.py:109] - File size: 1915 bytes
2025-01-02 12:53:09,795 - INFO - [cert.py:113] - Read 1915 bytes
2025-01-02 12:53:09,796 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2025-01-02 12:53:09,798 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2025-01-02 12:53:09,801 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 12:53:09,802 - INFO - [client.py:177] - Prepared client certificate
2025-01-02 12:53:09,805 - INFO - [client.py:192] - Encrypted pre_master_secret length: 256
2025-01-02 12:53:09,808 - INFO - [session.py:129] - Client handshake messages sent successfully
2025-01-02 12:53:09,810 - INFO - [session.py:134] - Server key pair verified successfully
2025-01-02 12:53:09,811 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-02 12:53:09,814 - INFO - [chain.py:185] - Decrypted pre_master_secret: 0303e6a1fe9ef73be232177a59ed3596a84675848049161cfa147d789458bf98814fc1b0b9791b723824825fa4dc4b1e
2025-01-02 12:53:09,816 - INFO - [chain.py:195] - Generated master secret: 3a1e481703e282fcf4b384b60435bf115bc9608ca03cebcd00e9ca7763c4a615e56cd61de937ecf2be4edc91fb8583f0
2025-01-02 12:53:09,817 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-02 12:53:09,817 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-02 12:53:09,818 - INFO - [session.py:138] - Master Secret handled successfully
2025-01-02 12:53:09,819 - INFO - [client.py:273] - Pre-master secret validated successfully
2025-01-02 12:53:09,821 - INFO - [client.py:291] - Generated digital signature: 6555cbe4dac26c3460a1eb803778fa599685a9664cf6d4062f2523ace03485d1ea0aa4028f438d0c7a55107368ab30357986e0b0bf3a041af5603b0e0a72fa320247fdac99765d9903b1a512638af3c390adc1d4ca7aebd8a1ad4ae5c7d73cc4152963c00d162f89846f642aeacdcccb870cc561c82c4cf8d65e8607076f43a2fc2073e9ef25c1fb7991533a701bfdf5c63d524fe4d4acd33ec9592eea0026c6efb9d14358f8cdfac4429117adb1be8502b7b35867c615caf6c8a786cb06c48e947b1626d9f04fb99920612dedf2b555b09aaeca783522316dca7e0c90c7c6c85a06bafe5d1ed92cbc73a61c871aca43abed17b74061a7233500da0928df5389
2025-01-02 12:53:09,823 - INFO - [client.py:337] - Client ChangeCipherSpec and Finished messages sent
2025-01-02 12:53:09,826 - INFO - [session.py:143] - Client Change Cipher Spec sent successfully
2025-01-02 12:53:09,828 - INFO - [server.py:260] - Pre-master secret validated successfully
2025-01-02 12:53:09,832 - INFO - [server.py:278] - Generated digital signature: 2ea2d45c9b939f34574df06a7996f2d4eda3f1d382933d3e82e94889f71275fd0f29b860c5ed0f096d2fe45e5cf73b4e8ae7fdf6776362c637e6c8d9053b3039852ab9367e04bdf5488afa9f50ddac590707200d9132069a7467d9434dd5f5ed7d17c503e5451637e5c2e05089d8a4b0c55e633988d39b43d07d6e544ed2b23b9f5f6eb9e0358529b62b6b820ecec943948b9a75f572de349d61fe65ecaa79731db31ac4580182cb98710d0291aab876b7eee904b1ab72136ec542e17b8e11daf5b6207a8dee13b153e6c04f9fc2aafc04bef344e72967a57d314a5447e6caef9c78350a5723149b8e1be69dd52fc3c325938bbb788c6877d4778ca96e36cdc2
2025-01-02 12:53:09,836 - INFO - [server.py:324] - Server ChangeCipherSpec and Finished messages sent
2025-01-02 12:53:09,838 - INFO - [session.py:148] - Server Change Cipher Spec received successfully
2025-01-02 12:53:09,839 - INFO - [keys.py:218] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-02 12:53:09,840 - INFO - [session.py:153] - SSL Key Log handled successfully
2025-01-02 12:53:09,841 - INFO - [session.py:157] - TLS Handshake completed successfully
2025-01-02 12:53:09,843 - INFO - [session.py:186] - Found file to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 12:53:09,844 - INFO - [session.py:204] - Handshake completed: True
2025-01-02 12:53:09,845 - INFO - [session.py:205] - Use client cert: True
2025-01-02 12:53:09,847 - INFO - [session.py:206] - File to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 12:53:09,848 - INFO - [session.py:209] - Using encrypted exchange
2025-01-02 12:53:09,849 - INFO - [session.py:224] - Sending encrypted request data
2025-01-02 12:53:09,856 - INFO - [keys.py:185] - TLS Application Data sent from 192.168.1.1:12345 to 10.0.0.1:443
2025-01-02 12:53:09,857 - INFO - [session.py:235] - Sending encrypted response data
2025-01-02 12:53:09,862 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-02 12:53:09,864 - INFO - [session.py:247] - Attempting to send file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 12:53:09,866 - INFO - [session.py:258] - Opening file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 12:53:09,869 - INFO - [session.py:265] - Read 1103 bytes from file
2025-01-02 12:53:09,873 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-02 12:53:09,876 - INFO - [session.py:274] - File sent successfully
2025-01-02 12:53:09,877 - INFO - [session.py:249] - File sent successfully
2025-01-02 12:53:09,879 - INFO - [main.py:96] - Session completed successfully for 192.168.1.1
2025-01-02 12:53:09,880 - INFO - [main.py:88] - 
--- Client Session (no certificate) ---
2025-01-02 12:53:09,884 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-02 12:53:09,886 - INFO - [cert.py:108] - File exists: True
2025-01-02 12:53:09,888 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-02 12:53:09,889 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-02 12:53:09,891 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-02 12:53:09,893 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-02 12:53:09,897 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 12:53:09,900 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-02 12:53:09,902 - INFO - [cert.py:108] - File exists: True
2025-01-02 12:53:09,904 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-02 12:53:09,907 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-02 12:53:09,908 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-02 12:53:09,910 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-02 12:53:09,913 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 12:53:09,975 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-02 12:53:09,977 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-02 12:53:09,977 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-02 12:53:09,979 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-02 12:53:09,980 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-02 12:53:09,981 - INFO - [verify.py:58] - Public key comparison results:
2025-01-02 12:53:09,981 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 12:53:09,983 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 12:53:09,987 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-02 12:53:09,988 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-02 12:53:09,991 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-02 12:53:09,993 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-02 12:53:09,995 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-02 12:53:09,996 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-02 12:53:09,998 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-02 12:53:09,999 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-02 12:53:10,001 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-02 12:53:10,003 - INFO - [session.py:175] - Starting TLS session
2025-01-02 12:53:10,004 - INFO - [session.py:114] - Starting TLS Handshake...
2025-01-02 12:53:10,006 - INFO - [client.py:100] - Generated client_random: 53298a9eb673f87f3c85b5f5c8b2926457125377e527af3292734211397b1a0d
2025-01-02 12:53:10,016 - INFO - [client.py:143] - Client Hello sent from 192.168.1.2
2025-01-02 12:53:10,024 - INFO - [session.py:119] - Client Hello sent successfully
2025-01-02 12:53:10,026 - INFO - [server.py:94] - Generated server_random: 875d188f01bc81d066e7a075e27e3dbfa8ea1008c80f48f479fb278be8e7babf
2025-01-02 12:53:10,038 - INFO - [session.py:124] - Server Hello received successfully
2025-01-02 12:53:10,039 - INFO - [client.py:180] - Prepared empty certificate
2025-01-02 12:53:10,041 - INFO - [client.py:192] - Encrypted pre_master_secret length: 256
2025-01-02 12:53:10,048 - INFO - [session.py:129] - Client handshake messages sent successfully
2025-01-02 12:53:10,050 - INFO - [session.py:134] - Server key pair verified successfully
2025-01-02 12:53:10,050 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-02 12:53:10,054 - INFO - [chain.py:185] - Decrypted pre_master_secret: 0303d76354e3e4b40b112a98cfb66fa9112e50bd912da6533256e4768e33e02d46d9b7fd457b7dfb6a8dc278b4215ad9
2025-01-02 12:53:10,054 - INFO - [chain.py:195] - Generated master secret: d3e376e7f933a7476d03d39e0b9ff0781e41d933167ada46d8acadfb20c1449b99f132ebabd372a67b53fa2d34a40abf
2025-01-02 12:53:10,055 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-02 12:53:10,056 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-02 12:53:10,057 - INFO - [session.py:138] - Master Secret handled successfully
2025-01-02 12:53:10,063 - INFO - [client.py:273] - Pre-master secret validated successfully
2025-01-02 12:53:10,068 - INFO - [client.py:291] - Generated digital signature: 34d23f1cb38360d6950448f225be79a67076f42b3ab5285ab6c9cfaf6831ea8a6e7f4fe2abb25de7e77211e9275b0cbd38014223253796251eac2900bea63779d61a621ea5a8dd90ddf37151ba1baa45e90c752c8332c66f4a4f5ae873009b12f5c06a94c8175855703303b088fb2708d5b737d3d994f4a02eedb5cf472a459af02498b75370fa43939d411ea144c2d8ea80eec0c8e849c4e884396509ccce48f41ec96df4a1f412ef29dbf9f80053271b894e025938faa565671ac2673855016210e3b22b00a08dca3d694d2a40095d9c7efef9018f7d1fe799822c56ce14205a3af006e9d3bb6e6da8e692b0a4c42c2ded1a860f9564fa276cc17dccefda04
2025-01-02 12:53:10,074 - INFO - [client.py:337] - Client ChangeCipherSpec and Finished messages sent
2025-01-02 12:53:10,081 - INFO - [session.py:143] - Client Change Cipher Spec sent successfully
2025-01-02 12:53:10,085 - INFO - [server.py:260] - Pre-master secret validated successfully
2025-01-02 12:53:10,089 - INFO - [server.py:278] - Generated digital signature: caafee35b6c591aa41360780f2711cf98226d86b3100cbdaa3080fd4c0b6741b70b060a1e566def06922f1f231b9a029effea21916e9fca57f3f10139719a18a8388de3b62dc714d1b339d7913f938b3b4b42b311cca50f5216ea8625f7d143fb35356b33cdac72f593a11055002ac0b993ae0b05e77f27c8355ee9a7629d002296cf1540e30ec7bf522c2dd1369934b8c1bf3ccd3b4c85da40009dcec796a02a7e26c3538d0b03a72216cba68e476fbc000bb0351fdba27dd43e6e7c79d235f821001a1172c9f7908339db0252dd064644cf49e5107dfff5a1625ed3cb8de693e57300b6ae43e6c209c848613d25d9a40b75ad427aab9d92a31eaca01036d1d
2025-01-02 12:53:10,094 - INFO - [server.py:324] - Server ChangeCipherSpec and Finished messages sent
2025-01-02 12:53:10,098 - INFO - [session.py:148] - Server Change Cipher Spec received successfully
2025-01-02 12:53:10,101 - INFO - [keys.py:218] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-02 12:53:10,103 - INFO - [session.py:153] - SSL Key Log handled successfully
2025-01-02 12:53:10,103 - INFO - [session.py:157] - TLS Handshake completed successfully
2025-01-02 12:53:10,104 - INFO - [session.py:204] - Handshake completed: True
2025-01-02 12:53:10,104 - INFO - [session.py:205] - Use client cert: False
2025-01-02 12:53:10,105 - INFO - [session.py:206] - File to send: None
2025-01-02 12:53:10,106 - INFO - [session.py:212] - Using unencrypted exchange
2025-01-02 12:53:10,106 - ERROR - [session.py:315] - Failed to send unencrypted data: 'PcapWriter' object has no attribute 'create_tcp_packet'
2025-01-02 12:53:10,107 - ERROR - [session.py:315] - Failed to send unencrypted data: 'PcapWriter' object has no attribute 'create_tcp_packet'
2025-01-02 12:53:10,107 - WARNING - [session.py:289] - Using unencrypted communication
2025-01-02 12:53:10,108 - INFO - [main.py:96] - Session completed successfully for 192.168.1.2
2025-01-02 12:53:10,118 - INFO - [packet_storage.py:79] - Saved 13 valid packets to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-02 12:53:10,119 - INFO - [packet_storage.py:100] - Verifying 13 packets...
2025-01-02 12:53:10,120 - INFO - [packet_storage.py:104] - Packet 1: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 12:53:10,121 - ERROR - [packet_storage.py:108] - Error verifying packet 1: type object 'PacketValidator' has no attribute 'count_tls_records'
2025-01-02 12:53:10,121 - INFO - [packet_storage.py:104] - Packet 2: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 12:53:10,122 - ERROR - [packet_storage.py:108] - Error verifying packet 2: type object 'PacketValidator' has no attribute 'count_tls_records'
2025-01-02 12:53:10,123 - INFO - [packet_storage.py:104] - Packet 3: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 12:53:10,124 - ERROR - [packet_storage.py:108] - Error verifying packet 3: type object 'PacketValidator' has no attribute 'count_tls_records'
2025-01-02 12:53:10,125 - INFO - [packet_storage.py:104] - Packet 4: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 12:53:10,125 - ERROR - [packet_storage.py:108] - Error verifying packet 4: type object 'PacketValidator' has no attribute 'count_tls_records'
2025-01-02 12:53:10,127 - INFO - [packet_storage.py:104] - Packet 5: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 12:53:10,129 - ERROR - [packet_storage.py:108] - Error verifying packet 5: type object 'PacketValidator' has no attribute 'count_tls_records'
2025-01-02 12:53:10,132 - INFO - [packet_storage.py:104] - Packet 6: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 12:53:10,134 - ERROR - [packet_storage.py:108] - Error verifying packet 6: type object 'PacketValidator' has no attribute 'count_tls_records'
2025-01-02 12:53:10,135 - INFO - [packet_storage.py:104] - Packet 7: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 12:53:10,135 - ERROR - [packet_storage.py:108] - Error verifying packet 7: type object 'PacketValidator' has no attribute 'count_tls_records'
2025-01-02 12:53:10,135 - INFO - [packet_storage.py:104] - Packet 8: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 12:53:10,136 - ERROR - [packet_storage.py:108] - Error verifying packet 8: type object 'PacketValidator' has no attribute 'count_tls_records'
2025-01-02 12:53:10,138 - INFO - [packet_storage.py:104] - Packet 9: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-02 12:53:10,138 - ERROR - [packet_storage.py:108] - Error verifying packet 9: type object 'PacketValidator' has no attribute 'count_tls_records'
2025-01-02 12:53:10,139 - INFO - [packet_storage.py:104] - Packet 10: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-02 12:53:10,140 - ERROR - [packet_storage.py:108] - Error verifying packet 10: type object 'PacketValidator' has no attribute 'count_tls_records'
2025-01-02 12:53:10,142 - INFO - [packet_storage.py:104] - Packet 11: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-02 12:53:10,143 - ERROR - [packet_storage.py:108] - Error verifying packet 11: type object 'PacketValidator' has no attribute 'count_tls_records'
2025-01-02 12:53:10,145 - INFO - [packet_storage.py:104] - Packet 12: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-02 12:53:10,148 - ERROR - [packet_storage.py:108] - Error verifying packet 12: type object 'PacketValidator' has no attribute 'count_tls_records'
2025-01-02 12:53:10,150 - INFO - [packet_storage.py:104] - Packet 13: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-02 12:53:10,151 - ERROR - [packet_storage.py:108] - Error verifying packet 13: type object 'PacketValidator' has no attribute 'count_tls_records'
2025-01-02 12:53:10,153 - INFO - [packet_storage.py:111] - Verification complete: 13 valid packets, 0 TLS records
2025-01-02 12:53:10,153 - INFO - [main.py:107] - Results saved to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-02 12:53:10,154 - INFO - [main.py:161] - TLS session simulation completed successfully
2025-01-02 12:57:01,488 - INFO - [logging.py:83] - Logging configured successfully
2025-01-02 12:57:01,489 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-02 12:57:01,490 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-02 12:57:01,490 - INFO - [logging.py:92] - Log level: 20
2025-01-02 12:57:01,490 - INFO - [logging.py:93] - Timestamp: 2025-01-02T12:57:01.490757
2025-01-02 12:57:01,491 - INFO - [logging.py:94] - ==========================
2025-01-02 12:57:01,491 - INFO - [main.py:123] - Starting TLS session simulation
2025-01-02 12:57:01,491 - INFO - [main.py:88] - 
--- Client Session (certificate) ---
2025-01-02 12:57:01,493 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-02 12:57:01,494 - INFO - [cert.py:108] - File exists: True
2025-01-02 12:57:01,494 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-02 12:57:01,496 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-02 12:57:01,496 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-02 12:57:01,497 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-02 12:57:01,502 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 12:57:01,503 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-02 12:57:01,504 - INFO - [cert.py:108] - File exists: True
2025-01-02 12:57:01,504 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-02 12:57:01,506 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-02 12:57:01,507 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-02 12:57:01,508 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-02 12:57:01,509 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 12:57:01,569 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-02 12:57:01,570 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-02 12:57:01,570 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-02 12:57:01,571 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-02 12:57:01,574 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-02 12:57:01,574 - INFO - [verify.py:58] - Public key comparison results:
2025-01-02 12:57:01,575 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 12:57:01,576 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 12:57:01,578 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-02 12:57:01,578 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-02 12:57:01,582 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-02 12:57:01,583 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-02 12:57:01,584 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-02 12:57:01,585 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-02 12:57:01,586 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-02 12:57:01,587 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-02 12:57:01,589 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-02 12:57:01,590 - INFO - [session.py:175] - Starting TLS session
2025-01-02 12:57:01,591 - INFO - [session.py:114] - Starting TLS Handshake...
2025-01-02 12:57:01,591 - INFO - [client.py:100] - Generated client_random: 8178e054b2204c2a8754758141e30b774d43ad95f59bab42d11047352a58fdc5
2025-01-02 12:57:01,594 - INFO - [client.py:143] - Client Hello sent from 192.168.1.1
2025-01-02 12:57:01,597 - INFO - [session.py:119] - Client Hello sent successfully
2025-01-02 12:57:01,598 - INFO - [server.py:94] - Generated server_random: ad25e2b1ab88d9d3f6f0a0009d32fc1f46851569376340c23f4e027df496adba
2025-01-02 12:57:01,603 - INFO - [session.py:124] - Server Hello received successfully
2025-01-02 12:57:01,604 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2025-01-02 12:57:01,605 - INFO - [cert.py:108] - File exists: True
2025-01-02 12:57:01,606 - INFO - [cert.py:109] - File size: 1915 bytes
2025-01-02 12:57:01,607 - INFO - [cert.py:113] - Read 1915 bytes
2025-01-02 12:57:01,608 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2025-01-02 12:57:01,609 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2025-01-02 12:57:01,610 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 12:57:01,612 - INFO - [client.py:177] - Prepared client certificate
2025-01-02 12:57:01,613 - INFO - [client.py:192] - Encrypted pre_master_secret length: 256
2025-01-02 12:57:01,615 - INFO - [session.py:129] - Client handshake messages sent successfully
2025-01-02 12:57:01,618 - INFO - [session.py:134] - Server key pair verified successfully
2025-01-02 12:57:01,618 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-02 12:57:01,620 - INFO - [chain.py:185] - Decrypted pre_master_secret: 0303620c9aaff16f60f178ed413b44849487f9907381cd9e6e681c963d7ed47ac5110ac123fa7a8c703d5faaf6dff581
2025-01-02 12:57:01,620 - INFO - [chain.py:195] - Generated master secret: e9aa9693fdf2c586c1e9eb333f2f771c6125fa468400e8b213b3e3a6e646a09d8ed0272ee5b58b765607ca91a540048a
2025-01-02 12:57:01,621 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-02 12:57:01,622 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-02 12:57:01,622 - INFO - [session.py:138] - Master Secret handled successfully
2025-01-02 12:57:01,623 - INFO - [client.py:273] - Pre-master secret validated successfully
2025-01-02 12:57:01,625 - INFO - [client.py:291] - Generated digital signature: 864c1416c7ad57c7b54f7c344c914ae79f2a55e597994a19aa6c413fd8fdbe519d4eacf33082965e083d2d9f1772a66a515f9dcf15bd03af4def64359eab15598528d58951d6bc4b8809d0418e223f4ca6ae1ff1376083ee90737f897af194bb47e6bbd3cc4c107d009461e84f334c55913395436c57ebc2d8b925da282d4382f742431b782311523c3fcf07e47632056af01cc005f5f7ab9222827f15172af381a9f79300cb57990c4826393154b6d59053ec0f75992f237f34d21805c5f8ffcf5e7c70efa02bf4a8e7279587303838be570b39d0afab4def5eb111bbc2fc5b5e1a0578ca6f150c7faee491bd8bcc4f5855dfd4daad7c9a494909c7ae77ce1d
2025-01-02 12:57:01,629 - INFO - [client.py:337] - Client ChangeCipherSpec and Finished messages sent
2025-01-02 12:57:01,631 - INFO - [session.py:143] - Client Change Cipher Spec sent successfully
2025-01-02 12:57:01,632 - INFO - [server.py:260] - Pre-master secret validated successfully
2025-01-02 12:57:01,634 - INFO - [server.py:278] - Generated digital signature: a4bf41661b7eab349e4f6dca0516ba0de32c3f1f1f19abfd9f93662a9d6f9033224de8819f3bca1cf4487625d753a7a9e85ecfdb79fd2ca837d3c80afce94085b2b2794fa5f8a8b821c3564032cd18c737d09f65bdeca695d3a5570d67cdd2f8b959e0c9019243940873d34034a77f5d8d1cdcab5ba23f84ca9060fbe23797c8ea9939e6a63d99c8370f335155ba4df3a4763c5bdda1633028c2ea7a769625892e26ee5079db2fa3ed2cf55f1e7383945c5389513699d3cf75c0836b26b7de0507f2762442513224f3975add231bb8b3e43c9dca3a52bc2fd1b611812d3ea2a2009d4fddb6f251e4a690dfa71d80d801856fbd513f431c95709b133d16254659
2025-01-02 12:57:01,636 - INFO - [server.py:324] - Server ChangeCipherSpec and Finished messages sent
2025-01-02 12:57:01,639 - INFO - [session.py:148] - Server Change Cipher Spec received successfully
2025-01-02 12:57:01,640 - INFO - [keys.py:218] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-02 12:57:01,641 - INFO - [session.py:153] - SSL Key Log handled successfully
2025-01-02 12:57:01,641 - INFO - [session.py:157] - TLS Handshake completed successfully
2025-01-02 12:57:01,642 - INFO - [session.py:186] - Found file to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 12:57:01,642 - INFO - [session.py:204] - Handshake completed: True
2025-01-02 12:57:01,643 - INFO - [session.py:205] - Use client cert: True
2025-01-02 12:57:01,643 - INFO - [session.py:206] - File to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 12:57:01,644 - INFO - [session.py:209] - Using encrypted exchange
2025-01-02 12:57:01,644 - INFO - [session.py:224] - Sending encrypted request data
2025-01-02 12:57:01,647 - INFO - [keys.py:185] - TLS Application Data sent from 192.168.1.1:12345 to 10.0.0.1:443
2025-01-02 12:57:01,648 - INFO - [session.py:235] - Sending encrypted response data
2025-01-02 12:57:01,650 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-02 12:57:01,651 - INFO - [session.py:247] - Attempting to send file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 12:57:01,652 - INFO - [session.py:258] - Opening file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 12:57:01,654 - INFO - [session.py:265] - Read 1103 bytes from file
2025-01-02 12:57:01,657 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-02 12:57:01,658 - INFO - [session.py:274] - File sent successfully
2025-01-02 12:57:01,658 - INFO - [session.py:249] - File sent successfully
2025-01-02 12:57:01,659 - INFO - [main.py:96] - Session completed successfully for 192.168.1.1
2025-01-02 12:57:01,659 - INFO - [main.py:88] - 
--- Client Session (no certificate) ---
2025-01-02 12:57:01,661 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-02 12:57:01,661 - INFO - [cert.py:108] - File exists: True
2025-01-02 12:57:01,661 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-02 12:57:01,662 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-02 12:57:01,663 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-02 12:57:01,663 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-02 12:57:01,664 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 12:57:01,665 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-02 12:57:01,666 - INFO - [cert.py:108] - File exists: True
2025-01-02 12:57:01,667 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-02 12:57:01,668 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-02 12:57:01,669 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-02 12:57:01,670 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-02 12:57:01,672 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 12:57:01,709 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-02 12:57:01,709 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-02 12:57:01,710 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-02 12:57:01,710 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-02 12:57:01,711 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-02 12:57:01,711 - INFO - [verify.py:58] - Public key comparison results:
2025-01-02 12:57:01,712 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 12:57:01,714 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 12:57:01,715 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-02 12:57:01,716 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-02 12:57:01,717 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-02 12:57:01,717 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-02 12:57:01,717 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-02 12:57:01,718 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-02 12:57:01,718 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-02 12:57:01,719 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-02 12:57:01,720 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-02 12:57:01,720 - INFO - [session.py:175] - Starting TLS session
2025-01-02 12:57:01,721 - INFO - [session.py:114] - Starting TLS Handshake...
2025-01-02 12:57:01,721 - INFO - [client.py:100] - Generated client_random: 0c90f4eac10b2ba8e2bb35c768bb8910da75505fc8fd041e0920941a04ccb698
2025-01-02 12:57:01,723 - INFO - [client.py:143] - Client Hello sent from 192.168.1.2
2025-01-02 12:57:01,727 - INFO - [session.py:119] - Client Hello sent successfully
2025-01-02 12:57:01,727 - INFO - [server.py:94] - Generated server_random: 29af2e625a25cb320b5d8a5882aa17345f3d8437f47a1a9192d3c3cff3788b61
2025-01-02 12:57:01,731 - INFO - [session.py:124] - Server Hello received successfully
2025-01-02 12:57:01,731 - INFO - [client.py:180] - Prepared empty certificate
2025-01-02 12:57:01,732 - INFO - [client.py:192] - Encrypted pre_master_secret length: 256
2025-01-02 12:57:01,734 - INFO - [session.py:129] - Client handshake messages sent successfully
2025-01-02 12:57:01,735 - INFO - [session.py:134] - Server key pair verified successfully
2025-01-02 12:57:01,736 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-02 12:57:01,737 - INFO - [chain.py:185] - Decrypted pre_master_secret: 0303bf0a9c39771fb4a1540d4cdde258e83b50a100242cfe470ee314bb1613a464dfbb03ab43dadfc3accae609b37660
2025-01-02 12:57:01,737 - INFO - [chain.py:195] - Generated master secret: 49fd8441ef67ed94ee0c646f236881e1aa3f2da65d60935b8c99f3b210f7eb0d1736668df5fb4bcf5a9ecec2e06f9c2d
2025-01-02 12:57:01,738 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-02 12:57:01,738 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-02 12:57:01,738 - INFO - [session.py:138] - Master Secret handled successfully
2025-01-02 12:57:01,739 - INFO - [client.py:273] - Pre-master secret validated successfully
2025-01-02 12:57:01,740 - INFO - [client.py:291] - Generated digital signature: 8995ce8860fc928bfefc3c0467b295ed3f3d87cac18cb68e42d4cb7be0d130686f7e46c93cb9477dbf04b011b58b895122eb2c7d8ef17a2de47d3fc30e961fbb32b653aed2d85e7d96525138607763428e8681f9759be8ffe1a3d7a654037f5c23ce94894967e1908c2fa206bd08e84dc450e29c0039733c1d8bdfdf1312bc858d5b1737544d391aa309e61632a9c080c41a757c604b01eebb8f1015982e48b0472d27db660c5a4b46ebb547b9c22e3f049d1edadc4b5513a4095c44b7c95cf76c2865c8aa8b0918e0b188f5e228b5f9282356f84b449730abd6025082317236dc7128ef94e5f6e53246e9320ae0908778d053d40ba40b19a5ea75eb265275bc
2025-01-02 12:57:01,742 - INFO - [client.py:337] - Client ChangeCipherSpec and Finished messages sent
2025-01-02 12:57:01,744 - INFO - [session.py:143] - Client Change Cipher Spec sent successfully
2025-01-02 12:57:01,745 - INFO - [server.py:260] - Pre-master secret validated successfully
2025-01-02 12:57:01,746 - INFO - [server.py:278] - Generated digital signature: c61ba238160677109b4a1d974da495205e7976c8c5e1db5df13b0767c6f4085fc1bec437878047ecee3a6d0692320a0b43fca70818b4d009ccebd0cfede69308febc483482d868a0c314ec4c0e0dda13db2032b7f10cbd1944c494ce331d39f634d36cb88b299574b534cb2453b0ad067467ac82bbeec3fe54a97db20e4fba51595c8573e668b24fec08a20f3820ed7f3802cba41d3d8266e51092719185848d147ea9e531eac510bacecb325612fb53e5fa3f6b34644630d592ce899d9059adad012b2914ee4cf45dabc1193d4742d558f99dcb7da255495e272ada952a9543beda4620402753e6bc811406fd07c27e087f3b7562a6d1749bb66b8b16568859
2025-01-02 12:57:01,749 - INFO - [server.py:324] - Server ChangeCipherSpec and Finished messages sent
2025-01-02 12:57:01,750 - INFO - [session.py:148] - Server Change Cipher Spec received successfully
2025-01-02 12:57:01,751 - INFO - [keys.py:218] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-02 12:57:01,752 - INFO - [session.py:153] - SSL Key Log handled successfully
2025-01-02 12:57:01,752 - INFO - [session.py:157] - TLS Handshake completed successfully
2025-01-02 12:57:01,753 - INFO - [session.py:204] - Handshake completed: True
2025-01-02 12:57:01,754 - INFO - [session.py:205] - Use client cert: False
2025-01-02 12:57:01,754 - INFO - [session.py:206] - File to send: None
2025-01-02 12:57:01,755 - INFO - [session.py:212] - Using unencrypted exchange
2025-01-02 12:57:01,755 - ERROR - [session.py:315] - Failed to send unencrypted data: 'PcapWriter' object has no attribute 'create_tcp_packet'
2025-01-02 12:57:01,756 - ERROR - [session.py:315] - Failed to send unencrypted data: 'PcapWriter' object has no attribute 'create_tcp_packet'
2025-01-02 12:57:01,756 - WARNING - [session.py:289] - Using unencrypted communication
2025-01-02 12:57:01,757 - INFO - [main.py:96] - Session completed successfully for 192.168.1.2
2025-01-02 12:57:01,762 - INFO - [packet_storage.py:79] - Saved 13 valid packets to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-02 12:57:01,762 - INFO - [packet_storage.py:100] - Verifying 13 packets...
2025-01-02 12:57:01,763 - INFO - [packet_storage.py:104] - Packet 1: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 12:57:01,763 - INFO - [packet_storage.py:104] - Packet 2: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 12:57:01,764 - INFO - [packet_storage.py:104] - Packet 3: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 12:57:01,764 - INFO - [packet_storage.py:104] - Packet 4: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 12:57:01,765 - INFO - [packet_storage.py:104] - Packet 5: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 12:57:01,765 - INFO - [packet_storage.py:104] - Packet 6: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 12:57:01,766 - INFO - [packet_storage.py:104] - Packet 7: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 12:57:01,766 - INFO - [packet_storage.py:104] - Packet 8: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 12:57:01,767 - INFO - [packet_storage.py:104] - Packet 9: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-02 12:57:01,767 - INFO - [packet_storage.py:104] - Packet 10: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-02 12:57:01,768 - INFO - [packet_storage.py:104] - Packet 11: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-02 12:57:01,769 - INFO - [packet_storage.py:104] - Packet 12: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-02 12:57:01,769 - INFO - [packet_storage.py:104] - Packet 13: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-02 12:57:01,770 - INFO - [packet_storage.py:111] - Verification complete: 13 valid packets, 13 TLS records
2025-01-02 12:57:01,770 - INFO - [main.py:107] - Results saved to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-02 12:57:01,771 - INFO - [main.py:161] - TLS session simulation completed successfully
2025-01-02 13:02:20,048 - INFO - [logging.py:83] - Logging configured successfully
2025-01-02 13:02:20,049 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-02 13:02:20,050 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-02 13:02:20,050 - INFO - [logging.py:92] - Log level: 20
2025-01-02 13:02:20,050 - INFO - [logging.py:93] - Timestamp: 2025-01-02T13:02:20.050907
2025-01-02 13:02:20,051 - INFO - [logging.py:94] - ==========================
2025-01-02 13:02:20,051 - INFO - [main.py:123] - Starting TLS session simulation
2025-01-02 13:02:20,052 - INFO - [main.py:88] - 
--- Client Session (certificate) ---
2025-01-02 13:02:20,053 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-02 13:02:20,054 - INFO - [cert.py:108] - File exists: True
2025-01-02 13:02:20,055 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-02 13:02:20,056 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-02 13:02:20,057 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-02 13:02:20,058 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-02 13:02:20,060 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 13:02:20,061 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-02 13:02:20,061 - INFO - [cert.py:108] - File exists: True
2025-01-02 13:02:20,062 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-02 13:02:20,063 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-02 13:02:20,063 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-02 13:02:20,064 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-02 13:02:20,065 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 13:02:20,106 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-02 13:02:20,107 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-02 13:02:20,107 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-02 13:02:20,108 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-02 13:02:20,110 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-02 13:02:20,110 - INFO - [verify.py:58] - Public key comparison results:
2025-01-02 13:02:20,111 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 13:02:20,112 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 13:02:20,162 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-02 13:02:20,162 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-02 13:02:20,164 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-02 13:02:20,166 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-02 13:02:20,167 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-02 13:02:20,167 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-02 13:02:20,168 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-02 13:02:20,169 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-02 13:02:20,171 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-02 13:02:20,173 - INFO - [session.py:175] - Starting TLS session
2025-01-02 13:02:20,174 - INFO - [session.py:114] - Starting TLS Handshake...
2025-01-02 13:02:20,175 - INFO - [client.py:100] - Generated client_random: 652b27ef3e0c23831797b4295c80996acf294e1aa0ef4183be81aec55d1e94f2
2025-01-02 13:02:20,180 - INFO - [client.py:143] - Client Hello sent from 192.168.1.1
2025-01-02 13:02:20,184 - INFO - [session.py:119] - Client Hello sent successfully
2025-01-02 13:02:20,185 - INFO - [server.py:94] - Generated server_random: aea6cc9ae38d8ef31997fd84e58dfc16927c5773afe540c740c1ae6f8e386227
2025-01-02 13:02:20,198 - INFO - [session.py:124] - Server Hello received successfully
2025-01-02 13:02:20,199 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2025-01-02 13:02:20,200 - INFO - [cert.py:108] - File exists: True
2025-01-02 13:02:20,201 - INFO - [cert.py:109] - File size: 1915 bytes
2025-01-02 13:02:20,202 - INFO - [cert.py:113] - Read 1915 bytes
2025-01-02 13:02:20,202 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2025-01-02 13:02:20,202 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2025-01-02 13:02:20,203 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 13:02:20,204 - INFO - [client.py:177] - Prepared client certificate
2025-01-02 13:02:20,205 - INFO - [client.py:192] - Encrypted pre_master_secret length: 256
2025-01-02 13:02:20,209 - INFO - [session.py:129] - Client handshake messages sent successfully
2025-01-02 13:02:20,211 - INFO - [session.py:134] - Server key pair verified successfully
2025-01-02 13:02:20,211 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-02 13:02:20,213 - INFO - [chain.py:185] - Decrypted pre_master_secret: 0303f90e0f2f231c38a84719f65921e21b62ea50e592c4e0207b38ca4b1d263e4024fdb6db1203dde66d696d5e063074
2025-01-02 13:02:20,214 - INFO - [chain.py:195] - Generated master secret: 2982b6c67228b8ea801e00b1ab53c0f912a7ae633c12f1297c5131c3ebb4bfc6dfd955099d35f4ff89ed0daa30c96f28
2025-01-02 13:02:20,214 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-02 13:02:20,215 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-02 13:02:20,215 - INFO - [session.py:138] - Master Secret handled successfully
2025-01-02 13:02:20,217 - INFO - [client.py:273] - Pre-master secret validated successfully
2025-01-02 13:02:20,219 - INFO - [client.py:291] - Generated digital signature: 36a52b5afdb0ee5ced91e9dc89c98e2b2eafd82d24ebbf98d19cb552fbe36ca2318a40978a83ccf8d6d80ece16562d848168ab5fb5611221eaa13e9945f8630917679bbe46ce04275f034b2eb0d82fa97d17e263e411336d1ed4e36a806b9a282be4b5994076ea8988949227d874a4e00873db65b87a404bc4cd0bac3612c35c00d295fe4f1a71a51e3cdb02409a1194f98fd0168b0e3561d3fb66745f0fbf473f8fc7ef38291f63031fc1347a0eee22142b15804de5d234e50b137637af2202281b7f9b4d5152b95216f5725ef4b15056724d520307bf8bcc43d721d26a9dbcb7494417c73328e1702fb7f9af1504aec13048841edaac79b06f7572b929f19b
2025-01-02 13:02:20,223 - INFO - [client.py:337] - Client ChangeCipherSpec and Finished messages sent
2025-01-02 13:02:20,228 - INFO - [session.py:143] - Client Change Cipher Spec sent successfully
2025-01-02 13:02:20,231 - INFO - [server.py:260] - Pre-master secret validated successfully
2025-01-02 13:02:20,235 - INFO - [server.py:278] - Generated digital signature: 477d127d399e4c81e69418d53ca1b350f70a570edf3106bf2ca2c476a877c451cafdd14b74cd333744c3f05a47576aa21abba17aa40ec4795218a2b9e41781095cade2439e70c4f4e51428f98f93c23fe6ea9994eb59d0665ced69e6bca1c56bbedad0e1c698e0e9ae4256ca0d74d1f204345ae023b9cb49e3c39f084133cf9fceec556ceb1b3b54773a1f5e12937698c27e7ca3e78647c103c16cfc53fef9b2781d1b5b9decf248de11c8de85640ec96ae13b32cd418afebd80ed86751051f6d2826560fdac889bceb3c615184f8e7eaece0f93393034886f14edea1efe496b730e08965c71051c592dc118bcadb0a47e2d761c75e863999f8bee3d24a7a57f
2025-01-02 13:02:20,239 - INFO - [server.py:324] - Server ChangeCipherSpec and Finished messages sent
2025-01-02 13:02:20,242 - INFO - [session.py:148] - Server Change Cipher Spec received successfully
2025-01-02 13:02:20,243 - INFO - [keys.py:218] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-02 13:02:20,244 - INFO - [session.py:153] - SSL Key Log handled successfully
2025-01-02 13:02:20,244 - INFO - [session.py:157] - TLS Handshake completed successfully
2025-01-02 13:02:20,246 - INFO - [session.py:186] - Found file to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 13:02:20,246 - INFO - [session.py:204] - Handshake completed: True
2025-01-02 13:02:20,247 - INFO - [session.py:205] - Use client cert: True
2025-01-02 13:02:20,248 - INFO - [session.py:206] - File to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 13:02:20,249 - INFO - [session.py:209] - Using encrypted exchange
2025-01-02 13:02:20,249 - INFO - [session.py:224] - Sending encrypted request data
2025-01-02 13:02:20,251 - INFO - [keys.py:185] - TLS Application Data sent from 192.168.1.1:12345 to 10.0.0.1:443
2025-01-02 13:02:20,251 - INFO - [session.py:235] - Sending encrypted response data
2025-01-02 13:02:20,252 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-02 13:02:20,253 - INFO - [session.py:247] - Attempting to send file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 13:02:20,253 - INFO - [session.py:258] - Opening file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 13:02:20,254 - INFO - [session.py:265] - Read 1103 bytes from file
2025-01-02 13:02:20,260 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-02 13:02:20,261 - INFO - [session.py:274] - File sent successfully
2025-01-02 13:02:20,262 - INFO - [session.py:249] - File sent successfully
2025-01-02 13:02:20,263 - INFO - [main.py:96] - Session completed successfully for 192.168.1.1
2025-01-02 13:02:20,264 - INFO - [main.py:88] - 
--- Client Session (no certificate) ---
2025-01-02 13:02:20,265 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-02 13:02:20,265 - INFO - [cert.py:108] - File exists: True
2025-01-02 13:02:20,266 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-02 13:02:20,267 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-02 13:02:20,267 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-02 13:02:20,267 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-02 13:02:20,268 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 13:02:20,269 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-02 13:02:20,270 - INFO - [cert.py:108] - File exists: True
2025-01-02 13:02:20,270 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-02 13:02:20,270 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-02 13:02:20,271 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-02 13:02:20,271 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-02 13:02:20,273 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 13:02:20,307 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-02 13:02:20,308 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-02 13:02:20,309 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-02 13:02:20,310 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-02 13:02:20,311 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-02 13:02:20,311 - INFO - [verify.py:58] - Public key comparison results:
2025-01-02 13:02:20,311 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 13:02:20,313 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 13:02:20,314 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-02 13:02:20,314 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-02 13:02:20,315 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-02 13:02:20,315 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-02 13:02:20,316 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-02 13:02:20,316 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-02 13:02:20,316 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-02 13:02:20,317 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-02 13:02:20,317 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-02 13:02:20,318 - INFO - [session.py:175] - Starting TLS session
2025-01-02 13:02:20,318 - INFO - [session.py:114] - Starting TLS Handshake...
2025-01-02 13:02:20,319 - INFO - [client.py:100] - Generated client_random: 976117e93dadc4d2dad082841b6d399723a2cef675bded68e82cf22865012613
2025-01-02 13:02:20,321 - INFO - [client.py:143] - Client Hello sent from 192.168.1.2
2025-01-02 13:02:20,328 - INFO - [session.py:119] - Client Hello sent successfully
2025-01-02 13:02:20,329 - INFO - [server.py:94] - Generated server_random: bba814f9b1734598a618419816c67dba5d29daabfe0a03320c6647335472390a
2025-01-02 13:02:20,334 - INFO - [session.py:124] - Server Hello received successfully
2025-01-02 13:02:20,334 - INFO - [client.py:180] - Prepared empty certificate
2025-01-02 13:02:20,335 - INFO - [client.py:192] - Encrypted pre_master_secret length: 256
2025-01-02 13:02:20,337 - INFO - [session.py:129] - Client handshake messages sent successfully
2025-01-02 13:02:20,344 - INFO - [session.py:134] - Server key pair verified successfully
2025-01-02 13:02:20,345 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-02 13:02:20,346 - INFO - [chain.py:185] - Decrypted pre_master_secret: 0303eada3e1ceafd08f1f585dae28ae328910b1dd861ca326195c11ac3151d82e7ce07181bcff71982efec7ebcc0c47c
2025-01-02 13:02:20,347 - INFO - [chain.py:195] - Generated master secret: a9da05033b1146348a9b5465de9055b9b54def7275d64e2ae22f8072780917e10fc8135ffcf6ffe67ec83ea039f6def7
2025-01-02 13:02:20,348 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-02 13:02:20,348 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-02 13:02:20,349 - INFO - [session.py:138] - Master Secret handled successfully
2025-01-02 13:02:20,351 - INFO - [client.py:273] - Pre-master secret validated successfully
2025-01-02 13:02:20,352 - INFO - [client.py:291] - Generated digital signature: 9e12129fa58ff5a26ad82bae03f0473a3facfc69df68af690a022d722678c7dfb436ca99fb06e9b36ebb847cb2300d8bf5ac6c1a964bac49c75217990ca4c939a7a337a3103f1a3ae9c69e411155931169215f8a62317de1b612424e4b04b52718a9bbcd840669c361b52d665a85ad3a83d47d4cd43938f17b0a2df69219122fae0bb543bf4edc17ffa85a0a7f0eca571ff35319050049ba824314b16b024dc388d727d6cc2dd4264e6ea3033c0cf1d988d5182f0e0d2c55acbe842f681900dc1cb3d0c4200f268faa8563df4bc90a020aa3f59927849d013c565931620fc8db3e6844a4870ff6d00ec8f8671c3f0289764944fac78486006e312d3e0908b496
2025-01-02 13:02:20,354 - INFO - [client.py:337] - Client ChangeCipherSpec and Finished messages sent
2025-01-02 13:02:20,358 - INFO - [session.py:143] - Client Change Cipher Spec sent successfully
2025-01-02 13:02:20,360 - INFO - [server.py:260] - Pre-master secret validated successfully
2025-01-02 13:02:20,361 - INFO - [server.py:278] - Generated digital signature: c042153bea7fd096038c7852e228eb02679d799a5f2fb462f53f50e8bc683f4b58cd99e6e0ff05d38f52c62003d9a5a9dda4913c705758cc3e4546e1f81afbd4d5d53ce09c84f7c9cbf6e9207cbb0418d45fd74f0b08fc9c83cfc2d721b4b0fb41e59d2abfff4f94c292dd8350702a8ae37be7cf202bcc6fb4ec6c2e196f6e1e10e921968d4cfeabe9b6f61932984064dcc9913933d759ee25eb75b518ef31b5631192881dd18a6c24c40fe1753ae02a3dbf416499e5a453a9a53aa70f265df8d0e02cf5bbf56d61f01b5ccea83991321f35ca1b09fd21a1f18d94a5076e7d798c55de96ea840e74d226dc38501632b8ad9e5b63b3e9d6bd249b4d2ba1ac309f
2025-01-02 13:02:20,363 - INFO - [server.py:324] - Server ChangeCipherSpec and Finished messages sent
2025-01-02 13:02:20,364 - INFO - [session.py:148] - Server Change Cipher Spec received successfully
2025-01-02 13:02:20,365 - INFO - [keys.py:218] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-02 13:02:20,366 - INFO - [session.py:153] - SSL Key Log handled successfully
2025-01-02 13:02:20,366 - INFO - [session.py:157] - TLS Handshake completed successfully
2025-01-02 13:02:20,367 - INFO - [session.py:204] - Handshake completed: True
2025-01-02 13:02:20,368 - INFO - [session.py:205] - Use client cert: False
2025-01-02 13:02:20,368 - INFO - [session.py:206] - File to send: None
2025-01-02 13:02:20,368 - INFO - [session.py:212] - Using unencrypted exchange
2025-01-02 13:02:20,369 - ERROR - [session.py:315] - Failed to send unencrypted data: Failed to create TCP packet: 'SessionState' object has no attribute 'update_seq_ack'
2025-01-02 13:02:20,369 - ERROR - [session.py:315] - Failed to send unencrypted data: Failed to create TCP packet: 'SessionState' object has no attribute 'update_seq_ack'
2025-01-02 13:02:20,369 - WARNING - [session.py:289] - Using unencrypted communication
2025-01-02 13:02:20,370 - INFO - [main.py:96] - Session completed successfully for 192.168.1.2
2025-01-02 13:02:20,380 - INFO - [packet_storage.py:79] - Saved 13 valid packets to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-02 13:02:20,381 - INFO - [packet_storage.py:100] - Verifying 13 packets...
2025-01-02 13:02:20,382 - INFO - [packet_storage.py:104] - Packet 1: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 13:02:20,383 - INFO - [packet_storage.py:104] - Packet 2: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 13:02:20,383 - INFO - [packet_storage.py:104] - Packet 3: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 13:02:20,384 - INFO - [packet_storage.py:104] - Packet 4: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 13:02:20,384 - INFO - [packet_storage.py:104] - Packet 5: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 13:02:20,384 - INFO - [packet_storage.py:104] - Packet 6: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 13:02:20,385 - INFO - [packet_storage.py:104] - Packet 7: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 13:02:20,385 - INFO - [packet_storage.py:104] - Packet 8: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 13:02:20,385 - INFO - [packet_storage.py:104] - Packet 9: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-02 13:02:20,386 - INFO - [packet_storage.py:104] - Packet 10: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-02 13:02:20,386 - INFO - [packet_storage.py:104] - Packet 11: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-02 13:02:20,387 - INFO - [packet_storage.py:104] - Packet 12: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-02 13:02:20,387 - INFO - [packet_storage.py:104] - Packet 13: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-02 13:02:20,388 - INFO - [packet_storage.py:111] - Verification complete: 13 valid packets, 13 TLS records
2025-01-02 13:02:20,389 - INFO - [main.py:107] - Results saved to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-02 13:02:20,390 - INFO - [main.py:161] - TLS session simulation completed successfully
2025-01-02 15:27:20,414 - INFO - [logging.py:83] - Logging configured successfully
2025-01-02 15:27:20,417 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-02 15:27:20,418 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-02 15:27:20,420 - INFO - [logging.py:92] - Log level: 20
2025-01-02 15:27:20,421 - INFO - [logging.py:93] - Timestamp: 2025-01-02T15:27:20.421243
2025-01-02 15:27:20,422 - INFO - [logging.py:94] - ==========================
2025-01-02 15:27:20,423 - INFO - [main.py:123] - Starting TLS session simulation
2025-01-02 15:27:20,427 - INFO - [main.py:88] - 
--- Client Session (certificate) ---
2025-01-02 15:27:20,436 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-02 15:27:20,439 - INFO - [cert.py:108] - File exists: True
2025-01-02 15:27:20,441 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-02 15:27:20,444 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-02 15:27:20,445 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-02 15:27:20,447 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-02 15:27:20,471 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 15:27:20,476 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-02 15:27:20,478 - INFO - [cert.py:108] - File exists: True
2025-01-02 15:27:20,480 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-02 15:27:20,485 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-02 15:27:20,486 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-02 15:27:20,490 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-02 15:27:20,495 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 15:27:20,848 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-02 15:27:20,850 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-02 15:27:20,852 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-02 15:27:20,917 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-02 15:27:20,943 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-02 15:27:20,945 - INFO - [verify.py:58] - Public key comparison results:
2025-01-02 15:27:20,946 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 15:27:20,953 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 15:27:20,956 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-02 15:27:20,963 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-02 15:27:20,983 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-02 15:27:20,988 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-02 15:27:20,992 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-02 15:27:20,994 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-02 15:27:20,999 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-02 15:27:21,002 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-02 15:27:21,010 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-02 15:27:21,012 - INFO - [session.py:175] - Starting TLS session
2025-01-02 15:27:21,014 - INFO - [session.py:114] - Starting TLS Handshake...
2025-01-02 15:27:21,016 - INFO - [client.py:100] - Generated client_random: fe0fda28ffe0799e320464d42c48f3e03fed0e0a10da62b0a0a9051e88fd9e3f
2025-01-02 15:27:21,035 - INFO - [client.py:143] - Client Hello sent from 192.168.1.1
2025-01-02 15:27:21,057 - INFO - [session.py:119] - Client Hello sent successfully
2025-01-02 15:27:21,059 - INFO - [server.py:94] - Generated server_random: d92f952f64e53e9c26be11d9beb33827fb6bca423c2622d3bf26f4302fc57981
2025-01-02 15:27:21,088 - INFO - [session.py:124] - Server Hello received successfully
2025-01-02 15:27:21,090 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2025-01-02 15:27:21,092 - INFO - [cert.py:108] - File exists: True
2025-01-02 15:27:21,094 - INFO - [cert.py:109] - File size: 1915 bytes
2025-01-02 15:27:21,097 - INFO - [cert.py:113] - Read 1915 bytes
2025-01-02 15:27:21,099 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2025-01-02 15:27:21,104 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2025-01-02 15:27:21,107 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 15:27:21,109 - INFO - [client.py:177] - Prepared client certificate
2025-01-02 15:27:21,112 - INFO - [client.py:192] - Encrypted pre_master_secret length: 256
2025-01-02 15:27:21,121 - INFO - [session.py:129] - Client handshake messages sent successfully
2025-01-02 15:27:21,133 - INFO - [session.py:134] - Server key pair verified successfully
2025-01-02 15:27:21,139 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-02 15:27:21,146 - INFO - [chain.py:185] - Decrypted pre_master_secret: 0303b9715f1ada7d61133c35c4387e0bd4a05c6fa08f83a3a229cd008c378c0617fd87ecaf9fb7f6718a12b323eb32f5
2025-01-02 15:27:21,148 - INFO - [chain.py:195] - Generated master secret: 5ffbfd73462fe943a8e1ff8ff62d6b0fdc2aae7c2286f3571c4e72a2fc9d9d22d13a8b15650e7887d3b4e7fd8180a481
2025-01-02 15:27:21,153 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-02 15:27:21,155 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-02 15:27:21,156 - INFO - [session.py:138] - Master Secret handled successfully
2025-01-02 15:27:21,163 - INFO - [client.py:273] - Pre-master secret validated successfully
2025-01-02 15:27:21,175 - INFO - [client.py:291] - Generated digital signature: 481a7baabb475560a75ad932ede5915b6d6b53ffbf79f44f4b4e085086cd213dcb73b813ddd798be0b5a2c926090b2b82cea51bc952e281769c779a631fe238fa9c1193b458ad137e979c2de2b7ee69925028c0b87f2aad0e28a4d38b0a381196bfa3db953c22d2c9e21dee39f9ed3b44bddea5331d3247a6122d661fdbc5fc791c701c23d3a23c913e13b6b96232682282b0a7919fdde092b1bb286366d1d6c33c2fec4051d078b582375df23ca4f23c0a4b6e3b9e5ba1a4676eb99fba6d8a5f2debfcd308a5eb7dbaa2ee9c0aacdbad49610f24094ab5fd279071cf74e83313331b149b4bcd4759fbf95ed0c170e96e34cfb23280fcf3ccf649d5d9a808cf2
2025-01-02 15:27:21,185 - INFO - [client.py:337] - Client ChangeCipherSpec and Finished messages sent
2025-01-02 15:27:21,192 - INFO - [session.py:143] - Client Change Cipher Spec sent successfully
2025-01-02 15:27:21,201 - INFO - [server.py:260] - Pre-master secret validated successfully
2025-01-02 15:27:21,212 - INFO - [server.py:278] - Generated digital signature: 289de256ee561b13e3e497e49bceaf8f42d4d5de6de6fdc2e9f1396cd8d6b892023dddc46c862472d73ff6737d07ef0e46fc945f33f0042816529caa86175f0d9030be0666fbf40f0467e2a82bb2f0cf014ce262775e8c3edb81035ad7e621a9de59e99340c362eb9563994acef2d6cd16492adee8bfa8fe5368b01888d7523599177b03e4ae39ffb6dfe4877359dd481b827cb45b0bbee8648db5e47db751ff2f1b28a813f2f12cee00a163723f30efd3681894a9ae23c23db24fcb452792e5de9966c24ce90de3f46e1d840833069bb53362b70b805f7d7bf7c7836a23a92ed100d7ba375e6d178e4584226bfcc10b862d7407c9e6658c39ca3cb79572d4cc
2025-01-02 15:27:21,226 - INFO - [server.py:324] - Server ChangeCipherSpec and Finished messages sent
2025-01-02 15:27:21,252 - INFO - [session.py:148] - Server Change Cipher Spec received successfully
2025-01-02 15:27:21,266 - INFO - [keys.py:218] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-02 15:27:21,268 - INFO - [session.py:153] - SSL Key Log handled successfully
2025-01-02 15:27:21,274 - INFO - [session.py:157] - TLS Handshake completed successfully
2025-01-02 15:27:21,279 - INFO - [session.py:186] - Found file to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 15:27:21,284 - INFO - [session.py:204] - Handshake completed: True
2025-01-02 15:27:21,287 - INFO - [session.py:205] - Use client cert: True
2025-01-02 15:27:21,288 - INFO - [session.py:206] - File to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 15:27:21,292 - INFO - [session.py:209] - Using encrypted exchange
2025-01-02 15:27:21,295 - INFO - [session.py:224] - Sending encrypted request data
2025-01-02 15:27:21,306 - INFO - [keys.py:185] - TLS Application Data sent from 192.168.1.1:12345 to 10.0.0.1:443
2025-01-02 15:27:21,309 - INFO - [session.py:235] - Sending encrypted response data
2025-01-02 15:27:21,317 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-02 15:27:21,322 - INFO - [session.py:247] - Attempting to send file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 15:27:21,324 - INFO - [session.py:258] - Opening file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 15:27:21,328 - INFO - [session.py:265] - Read 1103 bytes from file
2025-01-02 15:27:21,338 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-02 15:27:21,341 - INFO - [session.py:274] - File sent successfully
2025-01-02 15:27:21,344 - INFO - [session.py:249] - File sent successfully
2025-01-02 15:27:21,345 - INFO - [main.py:96] - Session completed successfully for 192.168.1.1
2025-01-02 15:27:21,346 - INFO - [main.py:88] - 
--- Client Session (no certificate) ---
2025-01-02 15:27:21,350 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-02 15:27:21,353 - INFO - [cert.py:108] - File exists: True
2025-01-02 15:27:21,357 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-02 15:27:21,360 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-02 15:27:21,361 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-02 15:27:21,363 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-02 15:27:21,367 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 15:27:21,369 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-02 15:27:21,372 - INFO - [cert.py:108] - File exists: True
2025-01-02 15:27:21,375 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-02 15:27:21,378 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-02 15:27:21,379 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-02 15:27:21,381 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-02 15:27:21,383 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 15:27:21,705 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-02 15:27:21,708 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-02 15:27:21,709 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-02 15:27:21,710 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-02 15:27:21,712 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-02 15:27:21,715 - INFO - [verify.py:58] - Public key comparison results:
2025-01-02 15:27:21,717 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 15:27:21,724 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 15:27:21,728 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-02 15:27:21,730 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-02 15:27:21,734 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-02 15:27:21,735 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-02 15:27:21,736 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-02 15:27:21,742 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-02 15:27:21,744 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-02 15:27:21,745 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-02 15:27:21,752 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-02 15:27:21,758 - INFO - [session.py:175] - Starting TLS session
2025-01-02 15:27:21,760 - INFO - [session.py:114] - Starting TLS Handshake...
2025-01-02 15:27:21,761 - INFO - [client.py:100] - Generated client_random: a061db5d82959ea0f4bfc0f0f7e2bc5868994703bb8a52d7907a47eaaa9d98f4
2025-01-02 15:27:21,777 - INFO - [client.py:143] - Client Hello sent from 192.168.1.2
2025-01-02 15:27:21,797 - INFO - [session.py:119] - Client Hello sent successfully
2025-01-02 15:27:21,801 - INFO - [server.py:94] - Generated server_random: ab5034afee7e19b84c42f79abfd853a1657c63d65387a18ffa613f74bc445ba0
2025-01-02 15:27:21,832 - INFO - [session.py:124] - Server Hello received successfully
2025-01-02 15:27:21,836 - INFO - [client.py:180] - Prepared empty certificate
2025-01-02 15:27:21,839 - INFO - [client.py:192] - Encrypted pre_master_secret length: 256
2025-01-02 15:27:21,846 - INFO - [session.py:129] - Client handshake messages sent successfully
2025-01-02 15:27:21,859 - INFO - [session.py:134] - Server key pair verified successfully
2025-01-02 15:27:21,861 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-02 15:27:21,868 - INFO - [chain.py:185] - Decrypted pre_master_secret: 0303836b6d805dcbf69487006e9172fe1833dccf5ccd658ce76078c91e3117f8bd06989a03b9ebd505a6f7729b4a08d7
2025-01-02 15:27:21,872 - INFO - [chain.py:195] - Generated master secret: 67bbb01f2640da5672872c7098501c87fd23de621d2cd024b4fca7e7cb0adcfe7ef7a144a8d33ba3966edc88216d17b2
2025-01-02 15:27:21,874 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-02 15:27:21,876 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-02 15:27:21,877 - INFO - [session.py:138] - Master Secret handled successfully
2025-01-02 15:27:21,884 - INFO - [client.py:273] - Pre-master secret validated successfully
2025-01-02 15:27:21,892 - INFO - [client.py:291] - Generated digital signature: cc08299792f99ce3cd01097f1ce5bac99272a654883fce2afd4dda424aba7251eb3300ceac8bb904b5251db72aaa3e974bdbe6930407abf6ef105d05437b6ad599e666b6fb7d412b87b55fd91ea77262712e69240a23f2496f4957c4b98c4e8e2cf418f82136f136480c93d509b6da6761ccaaef9ab82193603851a87837bb9f281df5e02f669a2cc90edac2c942d5639a9a2dece6c0e919d437b9c01925eb0142ad630e65f53014a12572ba7705e14a07b4ab72cccdd5030192f737d27692f9b87552db29d98d9c9db8df808755fecf8c3bbfa0d7cffdeeed0c51208ca9bd0396ec97b5dd8741d8c1ebc689679386b9227800b6e16b6356131989ab36354f36
2025-01-02 15:27:21,900 - INFO - [client.py:337] - Client ChangeCipherSpec and Finished messages sent
2025-01-02 15:27:21,909 - INFO - [session.py:143] - Client Change Cipher Spec sent successfully
2025-01-02 15:27:21,917 - INFO - [server.py:260] - Pre-master secret validated successfully
2025-01-02 15:27:21,925 - INFO - [server.py:278] - Generated digital signature: 1266ad344757dc2bf6df3b284d0d7d93d91bfb9a809f743f9f47217a9795ad53704d79f6d5ad8961779457279276ba3fcac2c54d48710e20efd78c778328318cb8e357734b2d9f6b4d1421a5467194fce9729c37ae7c402b00dbcd73c1fe8540929a245bd6b68466e750ef34838356fd67a47a6ec32c629a2f04efe0921be9c4c0c8772e3e9b898a70d695f5d70f4598153d4f6ec45c86748d448147b6dc2388c0834ed355c4327ae2efe71deabfc7a334819432f7f7b1a1fdf709d371efc041534cfbf87a8f32a6d581e3cb86093175a3e4908d10026b1a3ad6d7fd0632c103415ca088118dd7a1a79c98c87a5221fc73f0277dfa4cb2cf79a9fa944a17ad28
2025-01-02 15:27:21,935 - INFO - [server.py:324] - Server ChangeCipherSpec and Finished messages sent
2025-01-02 15:27:21,943 - INFO - [session.py:148] - Server Change Cipher Spec received successfully
2025-01-02 15:27:21,947 - INFO - [keys.py:218] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-02 15:27:21,948 - INFO - [session.py:153] - SSL Key Log handled successfully
2025-01-02 15:27:21,952 - INFO - [session.py:157] - TLS Handshake completed successfully
2025-01-02 15:27:21,954 - INFO - [session.py:204] - Handshake completed: True
2025-01-02 15:27:21,956 - INFO - [session.py:205] - Use client cert: False
2025-01-02 15:27:21,957 - INFO - [session.py:206] - File to send: None
2025-01-02 15:27:21,958 - INFO - [session.py:212] - Using unencrypted exchange
2025-01-02 15:27:21,960 - ERROR - [session.py:315] - Failed to send unencrypted data: Failed to create TCP packet: 'SessionState' object has no attribute 'update_seq_ack'
2025-01-02 15:27:21,961 - ERROR - [session.py:315] - Failed to send unencrypted data: Failed to create TCP packet: 'SessionState' object has no attribute 'update_seq_ack'
2025-01-02 15:27:21,963 - WARNING - [session.py:289] - Using unencrypted communication
2025-01-02 15:27:21,964 - INFO - [main.py:96] - Session completed successfully for 192.168.1.2
2025-01-02 15:27:21,997 - INFO - [packet_storage.py:79] - Saved 13 valid packets to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-02 15:27:22,000 - INFO - [packet_storage.py:100] - Verifying 13 packets...
2025-01-02 15:27:22,003 - INFO - [packet_storage.py:104] - Packet 1: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 15:27:22,005 - INFO - [packet_storage.py:104] - Packet 2: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 15:27:22,007 - INFO - [packet_storage.py:104] - Packet 3: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 15:27:22,009 - INFO - [packet_storage.py:104] - Packet 4: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 15:27:22,011 - INFO - [packet_storage.py:104] - Packet 5: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 15:27:22,013 - INFO - [packet_storage.py:104] - Packet 6: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 15:27:22,014 - INFO - [packet_storage.py:104] - Packet 7: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 15:27:22,016 - INFO - [packet_storage.py:104] - Packet 8: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 15:27:22,019 - INFO - [packet_storage.py:104] - Packet 9: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-02 15:27:22,021 - INFO - [packet_storage.py:104] - Packet 10: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-02 15:27:22,023 - INFO - [packet_storage.py:104] - Packet 11: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-02 15:27:22,024 - INFO - [packet_storage.py:104] - Packet 12: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-02 15:27:22,026 - INFO - [packet_storage.py:104] - Packet 13: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-02 15:27:22,027 - INFO - [packet_storage.py:111] - Verification complete: 13 valid packets, 13 TLS records
2025-01-02 15:27:22,028 - INFO - [main.py:107] - Results saved to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-02 15:27:22,030 - INFO - [main.py:161] - TLS session simulation completed successfully
2025-01-02 15:52:20,846 - INFO - [logging.py:83] - Logging configured successfully
2025-01-02 15:52:20,848 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-02 15:52:20,849 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-02 15:52:20,850 - INFO - [logging.py:92] - Log level: 20
2025-01-02 15:52:20,851 - INFO - [logging.py:93] - Timestamp: 2025-01-02T15:52:20.851829
2025-01-02 15:52:20,853 - INFO - [logging.py:94] - ==========================
2025-01-02 15:52:20,853 - INFO - [main.py:123] - Starting TLS session simulation
2025-01-02 15:52:20,855 - INFO - [main.py:88] - 
--- Client Session (certificate) ---
2025-01-02 15:52:20,860 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-02 15:52:20,863 - INFO - [cert.py:108] - File exists: True
2025-01-02 15:52:20,865 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-02 15:52:20,868 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-02 15:52:20,869 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-02 15:52:20,871 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-02 15:52:20,887 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 15:52:20,889 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-02 15:52:20,892 - INFO - [cert.py:108] - File exists: True
2025-01-02 15:52:20,894 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-02 15:52:20,896 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-02 15:52:20,898 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-02 15:52:20,900 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-02 15:52:20,903 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 15:52:21,026 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-02 15:52:21,028 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-02 15:52:21,029 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-02 15:52:21,101 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-02 15:52:21,111 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-02 15:52:21,113 - INFO - [verify.py:58] - Public key comparison results:
2025-01-02 15:52:21,114 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 15:52:21,118 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 15:52:21,122 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-02 15:52:21,123 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-02 15:52:21,138 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-02 15:52:21,140 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-02 15:52:21,142 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-02 15:52:21,143 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-02 15:52:21,145 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-02 15:52:21,147 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-02 15:52:21,151 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-02 15:52:21,155 - INFO - [session.py:175] - Starting TLS session
2025-01-02 15:52:21,156 - INFO - [session.py:114] - Starting TLS Handshake...
2025-01-02 15:52:21,157 - INFO - [client.py:100] - Generated client_random: 3561b725ee8005eba4cf2b687b800c695ae86effdf9aa5e7c2ae428e0a518d56
2025-01-02 15:52:21,169 - INFO - [client.py:143] - Client Hello sent from 192.168.1.1
2025-01-02 15:52:21,180 - INFO - [session.py:119] - Client Hello sent successfully
2025-01-02 15:52:21,182 - INFO - [server.py:94] - Generated server_random: acd854c11953749128f26678bf50245960ec4634632ea59a2ff5df62ac988132
2025-01-02 15:52:21,208 - INFO - [session.py:124] - Server Hello received successfully
2025-01-02 15:52:21,210 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2025-01-02 15:52:21,213 - INFO - [cert.py:108] - File exists: True
2025-01-02 15:52:21,215 - INFO - [cert.py:109] - File size: 1915 bytes
2025-01-02 15:52:21,218 - INFO - [cert.py:113] - Read 1915 bytes
2025-01-02 15:52:21,219 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2025-01-02 15:52:21,222 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2025-01-02 15:52:21,225 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 15:52:21,227 - INFO - [client.py:177] - Prepared client certificate
2025-01-02 15:52:21,231 - INFO - [client.py:192] - Encrypted pre_master_secret length: 256
2025-01-02 15:52:21,238 - INFO - [session.py:129] - Client handshake messages sent successfully
2025-01-02 15:52:21,248 - INFO - [session.py:134] - Server key pair verified successfully
2025-01-02 15:52:21,250 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-02 15:52:21,253 - INFO - [chain.py:185] - Decrypted pre_master_secret: 03033921e2b58bd271cebb94403d94be6baa4543abdfbf71155d370780d6aaa8a9c354d71139277437549d9831f7913e
2025-01-02 15:52:21,255 - INFO - [chain.py:195] - Generated master secret: d705c95d8520a2515359716ede09f30149922205cc529fab61a46e33a3f7eaa0daf3549147102e6728e888db6f50749d
2025-01-02 15:52:21,256 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-02 15:52:21,258 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-02 15:52:21,259 - INFO - [session.py:138] - Master Secret handled successfully
2025-01-02 15:52:21,265 - INFO - [client.py:273] - Pre-master secret validated successfully
2025-01-02 15:52:21,268 - INFO - [client.py:291] - Generated digital signature: 5af3a42ba16dfb62978d1bbd9de055562475fd5fac52b07edbc197a8caf298160fa9c25fd24b665ebb2e140c9a8f1221de2ce538fb43d339a9ac8c98a6da2b0bdea7a014f4d398679e4e50cc3ce5347879d8a3aac1fd2a047ed896c37fbc72b24ffcee319de8a964ec1a4a31deaf975cb6ef1d85f84ca7e69ac1b661c691f6e7caecb95d109c6befb2587bd3ee84d2cd526f3dcca7bfbc810bd363eeefda058b9742776646f07ab5ea498b120c88458fa5164c746cd46a25c2b63ef4032cad7acd9573e6e6e2b3ba2f5891b382e02848fd737c7e42b4843bbd2f1b3595986875d006a3d21cd81289daeb01729c109f071e16be4a8949d14fb658a2e4982e0ab3
2025-01-02 15:52:21,274 - INFO - [client.py:337] - Client ChangeCipherSpec and Finished messages sent
2025-01-02 15:52:21,279 - INFO - [session.py:143] - Client Change Cipher Spec sent successfully
2025-01-02 15:52:21,283 - INFO - [server.py:260] - Pre-master secret validated successfully
2025-01-02 15:52:21,286 - INFO - [server.py:278] - Generated digital signature: 5d1bc6414119a10a9b95ba51d37033089eca4a69acb41a67f556fde16ddef2d2ddee075175aa339cfa47f7c523679477767f77c0d08c14dd4c7f9b54a2d02ff0d4b9c59e6f344c9ad6565f749779009d54f5723cc4ffbd87dbec23f9dccbb241cbb7286e3f8856e243ea795ef981db37d332d69fccc42083d06f0c0c7f5bca074200dcf0e927dddec5a9f371a664a135440cc40b284f582d2b0bd4a8a1fb88f4a0588815b30d4d2734d6ae1b471038b039d2514c2efb7301fb83dc1d4769a506db3c9f5601e822d8294433bce45f5e0e0c2bf1736745e38c8300b9651203d45d0df2d11953315e99ce3d1210d36dac67522064dc505c21345dcd8681bef18d84
2025-01-02 15:52:21,291 - INFO - [server.py:324] - Server ChangeCipherSpec and Finished messages sent
2025-01-02 15:52:21,296 - INFO - [session.py:148] - Server Change Cipher Spec received successfully
2025-01-02 15:52:21,300 - INFO - [keys.py:218] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-02 15:52:21,301 - INFO - [session.py:153] - SSL Key Log handled successfully
2025-01-02 15:52:21,303 - INFO - [session.py:157] - TLS Handshake completed successfully
2025-01-02 15:52:21,304 - INFO - [session.py:186] - Found file to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 15:52:21,306 - INFO - [session.py:204] - Handshake completed: True
2025-01-02 15:52:21,307 - INFO - [session.py:205] - Use client cert: True
2025-01-02 15:52:21,309 - INFO - [session.py:206] - File to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 15:52:21,311 - INFO - [session.py:209] - Using encrypted exchange
2025-01-02 15:52:21,312 - INFO - [session.py:224] - Sending encrypted request data
2025-01-02 15:52:21,320 - INFO - [keys.py:185] - TLS Application Data sent from 192.168.1.1:12345 to 10.0.0.1:443
2025-01-02 15:52:21,322 - INFO - [session.py:235] - Sending encrypted response data
2025-01-02 15:52:21,326 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-02 15:52:21,328 - INFO - [session.py:247] - Attempting to send file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 15:52:21,331 - INFO - [session.py:258] - Opening file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 15:52:21,335 - INFO - [session.py:265] - Read 1103 bytes from file
2025-01-02 15:52:21,339 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-02 15:52:21,341 - INFO - [session.py:274] - File sent successfully
2025-01-02 15:52:21,342 - INFO - [session.py:249] - File sent successfully
2025-01-02 15:52:21,344 - INFO - [main.py:96] - Session completed successfully for 192.168.1.1
2025-01-02 15:52:21,345 - INFO - [main.py:88] - 
--- Client Session (no certificate) ---
2025-01-02 15:52:21,349 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-02 15:52:21,352 - INFO - [cert.py:108] - File exists: True
2025-01-02 15:52:21,354 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-02 15:52:21,355 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-02 15:52:21,356 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-02 15:52:21,357 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-02 15:52:21,361 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 15:52:21,364 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-02 15:52:21,366 - INFO - [cert.py:108] - File exists: True
2025-01-02 15:52:21,368 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-02 15:52:21,370 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-02 15:52:21,371 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-02 15:52:21,373 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-02 15:52:21,375 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 15:52:21,491 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-02 15:52:21,493 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-02 15:52:21,495 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-02 15:52:21,496 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-02 15:52:21,497 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-02 15:52:21,498 - INFO - [verify.py:58] - Public key comparison results:
2025-01-02 15:52:21,499 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 15:52:21,502 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 15:52:21,505 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-02 15:52:21,507 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-02 15:52:21,510 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-02 15:52:21,511 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-02 15:52:21,513 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-02 15:52:21,514 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-02 15:52:21,516 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-02 15:52:21,517 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-02 15:52:21,521 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-02 15:52:21,524 - INFO - [session.py:175] - Starting TLS session
2025-01-02 15:52:21,525 - INFO - [session.py:114] - Starting TLS Handshake...
2025-01-02 15:52:21,527 - INFO - [client.py:100] - Generated client_random: 5d9f7945a5ffcd8f6e4e91f574d64a5d465b1956c6cea444ce0937ffac0b85f1
2025-01-02 15:52:21,552 - INFO - [client.py:143] - Client Hello sent from 192.168.1.2
2025-01-02 15:52:21,566 - INFO - [session.py:119] - Client Hello sent successfully
2025-01-02 15:52:21,567 - INFO - [server.py:94] - Generated server_random: 68d0cd595e99d6a0eab6b6acf74798fd2fc19a19414857e60e011d50e577906f
2025-01-02 15:52:21,595 - INFO - [session.py:124] - Server Hello received successfully
2025-01-02 15:52:21,597 - INFO - [client.py:180] - Prepared empty certificate
2025-01-02 15:52:21,599 - INFO - [client.py:192] - Encrypted pre_master_secret length: 256
2025-01-02 15:52:21,610 - INFO - [session.py:129] - Client handshake messages sent successfully
2025-01-02 15:52:21,620 - INFO - [session.py:134] - Server key pair verified successfully
2025-01-02 15:52:21,621 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-02 15:52:21,628 - INFO - [chain.py:185] - Decrypted pre_master_secret: 030351dfc96d2c00cf32fbc2284aa5f1fe0585de71c9334ec166cdbfe03ee3b8c474d811b35c2eb536a528f99993b68b
2025-01-02 15:52:21,631 - INFO - [chain.py:195] - Generated master secret: fd8ea1dabab462bcb4ffc61380ace6399008fdd5a87a807ed3ccc770906325683fde7a81d3c67cd5fa93062bd62528b8
2025-01-02 15:52:21,634 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-02 15:52:21,636 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-02 15:52:21,638 - INFO - [session.py:138] - Master Secret handled successfully
2025-01-02 15:52:21,648 - INFO - [client.py:273] - Pre-master secret validated successfully
2025-01-02 15:52:21,656 - INFO - [client.py:291] - Generated digital signature: 51299ae2c8c7254f088c7a45267d653081078c8aec46032789da1a536f700190edc74531bb85a0d9ee937f5ef9cd43382ad12f57a2b155618f8c8691ef0359af34dd399c5affe70d42e17922a55b113933736b1d12062777e82e93aa4e147b3d60f73cae58e2aaf3ef8f8c279f235152ca048e35881dfdac296dd58eb234b8ef99fd412a6534ac3d959a9cac7ac952c62f5b25d57f14d965201eeafe620e65727626839367babe75b7c8d63e2dd01902951afb4c2147a3070a52743250e4329136986a82d8c7f960b73e27385df76c8ec4114f5eb17b45b8e495e0fd8b40046972df64aeda684d4704580173e2d75fd39ce44951d1117a57ed6f866b724851a6
2025-01-02 15:52:21,665 - INFO - [client.py:337] - Client ChangeCipherSpec and Finished messages sent
2025-01-02 15:52:21,671 - INFO - [session.py:143] - Client Change Cipher Spec sent successfully
2025-01-02 15:52:21,678 - INFO - [server.py:260] - Pre-master secret validated successfully
2025-01-02 15:52:21,684 - INFO - [server.py:278] - Generated digital signature: bdcef2f7e9b76ae330cee7d644f4d2ce904c13ecaf9dd4d524f34d07734a7079aac39a427e32faf5e4c9d8c11e04a2c68498b32ab6b805ef944e117246ca2477899b1c752111b399c8a09f4df8b25ba53e34813c02f8154cd2500bb863a775e3d7dcf1bc272e9a69b36321ca0d5700f18c0ac36961a5c57cbaf8bcab9910760a98eeec878af48ce6b49635e08b71b94fed393de9a5ffa3fc7420158b8bbd316b6d42da270ca09819913b01f2c1b67dd65cccdb0fc2b212d9ca4d6e3df0439f300d04b6ce5724c38e66dd0e07d02cb9d8e0bb4f459f711c8581e5da892528bfea3b7076d1c6f03e07f45cb19a03e664123394d92d7969c51b4f7ea6099bd0bfb4
2025-01-02 15:52:21,690 - INFO - [server.py:324] - Server ChangeCipherSpec and Finished messages sent
2025-01-02 15:52:21,697 - INFO - [session.py:148] - Server Change Cipher Spec received successfully
2025-01-02 15:52:21,700 - INFO - [keys.py:218] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-02 15:52:21,701 - INFO - [session.py:153] - SSL Key Log handled successfully
2025-01-02 15:52:21,702 - INFO - [session.py:157] - TLS Handshake completed successfully
2025-01-02 15:52:21,704 - INFO - [session.py:204] - Handshake completed: True
2025-01-02 15:52:21,705 - INFO - [session.py:205] - Use client cert: False
2025-01-02 15:52:21,706 - INFO - [session.py:206] - File to send: None
2025-01-02 15:52:21,707 - INFO - [session.py:212] - Using unencrypted exchange
2025-01-02 15:52:21,711 - INFO - [session.py:312] - Added request packet
2025-01-02 15:52:21,715 - INFO - [session.py:312] - Added response packet
2025-01-02 15:52:21,717 - WARNING - [session.py:289] - Using unencrypted communication
2025-01-02 15:52:21,718 - INFO - [main.py:96] - Session completed successfully for 192.168.1.2
2025-01-02 15:52:21,721 - INFO - [packet_validator.py:110] - Packet 13: Valid HTTP message
2025-01-02 15:52:21,722 - INFO - [packet_validator.py:110] - Packet 14: Valid HTTP message
2025-01-02 15:52:21,747 - INFO - [packet_storage.py:79] - Saved 15 valid packets to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-02 15:52:21,749 - INFO - [packet_storage.py:100] - Verifying 15 packets...
2025-01-02 15:52:21,750 - INFO - [packet_storage.py:104] - Packet 1: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 15:52:21,752 - INFO - [packet_storage.py:104] - Packet 2: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 15:52:21,753 - INFO - [packet_storage.py:104] - Packet 3: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 15:52:21,754 - INFO - [packet_storage.py:104] - Packet 4: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 15:52:21,756 - INFO - [packet_storage.py:104] - Packet 5: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 15:52:21,758 - INFO - [packet_storage.py:104] - Packet 6: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 15:52:21,759 - INFO - [packet_storage.py:104] - Packet 7: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 15:52:21,760 - INFO - [packet_storage.py:104] - Packet 8: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 15:52:21,762 - INFO - [packet_storage.py:104] - Packet 9: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-02 15:52:21,764 - INFO - [packet_storage.py:104] - Packet 10: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-02 15:52:21,765 - INFO - [packet_storage.py:104] - Packet 11: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-02 15:52:21,767 - INFO - [packet_storage.py:104] - Packet 12: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-02 15:52:21,768 - INFO - [packet_storage.py:104] - Packet 13: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-02 15:52:21,769 - INFO - [packet_storage.py:104] - Packet 14: IP / TCP 192.168.1.2:12346 > 10.0.0.1:http PA / Raw
2025-01-02 15:52:21,770 - INFO - [packet_storage.py:104] - Packet 15: IP / TCP 10.0.0.1:http > 192.168.1.2:12346 PA / Raw
2025-01-02 15:52:21,771 - INFO - [packet_storage.py:111] - Verification complete: 15 valid packets, 13 TLS records
2025-01-02 15:52:21,772 - INFO - [main.py:107] - Results saved to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-02 15:52:21,773 - INFO - [main.py:161] - TLS session simulation completed successfully
2025-01-02 16:03:34,482 - INFO - [logging.py:83] - Logging configured successfully
2025-01-02 16:03:34,485 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-02 16:03:34,487 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-02 16:03:34,488 - INFO - [logging.py:92] - Log level: 20
2025-01-02 16:03:34,490 - INFO - [logging.py:93] - Timestamp: 2025-01-02T16:03:34.489998
2025-01-02 16:03:34,491 - INFO - [logging.py:94] - ==========================
2025-01-02 16:03:34,492 - INFO - [main.py:123] - Starting TLS session simulation
2025-01-02 16:03:34,494 - INFO - [main.py:88] - 
--- Client Session (certificate) ---
2025-01-02 16:03:34,500 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-02 16:03:34,503 - INFO - [cert.py:108] - File exists: True
2025-01-02 16:03:34,505 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-02 16:03:34,507 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-02 16:03:34,508 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-02 16:03:34,510 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-02 16:03:34,521 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 16:03:34,523 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-02 16:03:34,525 - INFO - [cert.py:108] - File exists: True
2025-01-02 16:03:34,526 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-02 16:03:34,529 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-02 16:03:34,530 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-02 16:03:34,532 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-02 16:03:34,535 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 16:03:34,895 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-02 16:03:34,898 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-02 16:03:34,900 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-02 16:03:34,904 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-02 16:03:34,915 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-02 16:03:34,917 - INFO - [verify.py:58] - Public key comparison results:
2025-01-02 16:03:34,919 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 16:03:34,923 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 16:03:34,927 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-02 16:03:34,929 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-02 16:03:34,946 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-02 16:03:34,949 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-02 16:03:34,950 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-02 16:03:34,952 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-02 16:03:34,954 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-02 16:03:34,957 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-02 16:03:34,962 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-02 16:03:34,965 - INFO - [session.py:175] - Starting TLS session
2025-01-02 16:03:34,967 - INFO - [session.py:114] - Starting TLS Handshake...
2025-01-02 16:03:34,969 - INFO - [client.py:100] - Generated client_random: 5b2c85fe990b96db049c1208390323163dd901995921ed069c8450053f5415e9
2025-01-02 16:03:34,982 - INFO - [client.py:143] - Client Hello sent from 192.168.1.1
2025-01-02 16:03:34,995 - INFO - [session.py:119] - Client Hello sent successfully
2025-01-02 16:03:34,997 - INFO - [server.py:94] - Generated server_random: 4b1221f2b26790ce29890da50a0d220aa9200b90b13fd529ccc8221ed9100abc
2025-01-02 16:03:35,024 - INFO - [session.py:124] - Server Hello received successfully
2025-01-02 16:03:35,028 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2025-01-02 16:03:35,030 - INFO - [cert.py:108] - File exists: True
2025-01-02 16:03:35,032 - INFO - [cert.py:109] - File size: 1915 bytes
2025-01-02 16:03:35,035 - INFO - [cert.py:113] - Read 1915 bytes
2025-01-02 16:03:35,037 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2025-01-02 16:03:35,039 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2025-01-02 16:03:35,042 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 16:03:35,045 - INFO - [client.py:177] - Prepared client certificate
2025-01-02 16:03:35,048 - INFO - [client.py:192] - Encrypted pre_master_secret length: 256
2025-01-02 16:03:35,056 - INFO - [session.py:129] - Client handshake messages sent successfully
2025-01-02 16:03:35,067 - INFO - [session.py:134] - Server key pair verified successfully
2025-01-02 16:03:35,070 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-02 16:03:35,079 - INFO - [chain.py:185] - Decrypted pre_master_secret: 03038d7362828dbceca5e675e0ec6a59c7a057dade2e2967ff3733a2a1d7c7e123cd541d3087442b4b5f539e64ea0c60
2025-01-02 16:03:35,082 - INFO - [chain.py:195] - Generated master secret: 27a8b86eb56986bdaf14a31fafa4bbb0a31052146238ed26b3425198159b4c3a99f22ed0cfbc7f0cc98c1cc1c171a3a6
2025-01-02 16:03:35,083 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-02 16:03:35,084 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-02 16:03:35,086 - INFO - [session.py:138] - Master Secret handled successfully
2025-01-02 16:03:35,095 - INFO - [client.py:273] - Pre-master secret validated successfully
2025-01-02 16:03:35,102 - INFO - [client.py:291] - Generated digital signature: be4805f61d7733c77bdad14e4e9d4698f1e5423679467ed50e3e449b80f9703c95d6018063609b3ae1680b3aba3882a37f13da27620177828c169d61063ae0e618ff8ab96cd8fd3e00e700b6349c34145756f0792599fc9f63ac81611c06a28fd6e24004cbb48f8bc6b2f322181f992ec185c5b7972821c994fd86786eacc8d6a4303bc7a018f1c9f124f0204b971b73c0ee27f36f21d8ce43a4b025a0e7b715c7ea59973de0eca32e1041bfa1894c1bbc4bf41b92f98413a7c0cfb7c15bd9216e6b0cbf90b0a1bdc190ec4863a33f7c2bac63d3941e381ca1c6d7db9cb9a80efcb157ec3b3ca1837b474d0c642f6c0fb44efeb7e28e901731552823ada65666
2025-01-02 16:03:35,114 - INFO - [client.py:337] - Client ChangeCipherSpec and Finished messages sent
2025-01-02 16:03:35,120 - INFO - [session.py:143] - Client Change Cipher Spec sent successfully
2025-01-02 16:03:35,127 - INFO - [server.py:260] - Pre-master secret validated successfully
2025-01-02 16:03:35,134 - INFO - [server.py:278] - Generated digital signature: 1c6de0ddce4d5fb4441712a9c7837ccc8f150118522a205c311b2445fb0b949d30b6d942865622527b49f7fbeb0d8e555243e6c83c6827b5d0cab5aa6e3bdd7800de7f446cd5c583dde7788224e1e34f0f4ab73dcdbd07184722abbe253dfea8b11dc376fbae1715fd4a5d718ef7c2c4af2d5ec779852eb6ea0bd85221d69baeb138ac4b944f6a23fc3a2bb44fcb3950424a3cfc4da6a53f1bbc78c9ce2200b6021e539a0b9808d1600f17342e8cf54ae430846ad0aa8de2fb9f76552f2d52e154bfae0aebd3e2307c8eb3c23e59542059a864360a769df7a79772fe21a3b122e7d51e946305989792fccd55fb00220d7630420b9292a59ba66c5c5c282506f9
2025-01-02 16:03:35,146 - INFO - [server.py:324] - Server ChangeCipherSpec and Finished messages sent
2025-01-02 16:03:35,154 - INFO - [session.py:148] - Server Change Cipher Spec received successfully
2025-01-02 16:03:35,161 - INFO - [keys.py:218] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-02 16:03:35,163 - INFO - [session.py:153] - SSL Key Log handled successfully
2025-01-02 16:03:35,164 - INFO - [session.py:157] - TLS Handshake completed successfully
2025-01-02 16:03:35,166 - INFO - [session.py:186] - Found file to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 16:03:35,169 - INFO - [session.py:204] - Handshake completed: True
2025-01-02 16:03:35,171 - INFO - [session.py:205] - Use client cert: True
2025-01-02 16:03:35,173 - INFO - [session.py:206] - File to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 16:03:35,175 - INFO - [session.py:209] - Using encrypted exchange
2025-01-02 16:03:35,177 - INFO - [session.py:224] - Sending encrypted request data
2025-01-02 16:03:35,186 - INFO - [keys.py:185] - TLS Application Data sent from 192.168.1.1:12345 to 10.0.0.1:443
2025-01-02 16:03:35,192 - INFO - [session.py:235] - Sending encrypted response data
2025-01-02 16:03:35,198 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-02 16:03:35,200 - INFO - [session.py:247] - Attempting to send file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 16:03:35,202 - INFO - [session.py:258] - Opening file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 16:03:35,210 - INFO - [session.py:265] - Read 1103 bytes from file
2025-01-02 16:03:35,217 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-02 16:03:35,221 - INFO - [session.py:274] - File sent successfully
2025-01-02 16:03:35,222 - INFO - [session.py:249] - File sent successfully
2025-01-02 16:03:35,224 - INFO - [main.py:96] - Session completed successfully for 192.168.1.1
2025-01-02 16:03:35,226 - INFO - [main.py:88] - 
--- Client Session (no certificate) ---
2025-01-02 16:03:35,229 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-02 16:03:35,231 - INFO - [cert.py:108] - File exists: True
2025-01-02 16:03:35,232 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-02 16:03:35,234 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-02 16:03:35,236 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-02 16:03:35,238 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-02 16:03:35,243 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 16:03:35,245 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-02 16:03:35,247 - INFO - [cert.py:108] - File exists: True
2025-01-02 16:03:35,248 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-02 16:03:35,250 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-02 16:03:35,252 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-02 16:03:35,254 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-02 16:03:35,256 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 16:03:35,596 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-02 16:03:35,599 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-02 16:03:35,600 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-02 16:03:35,602 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-02 16:03:35,604 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-02 16:03:35,606 - INFO - [verify.py:58] - Public key comparison results:
2025-01-02 16:03:35,607 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 16:03:35,610 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 16:03:35,614 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-02 16:03:35,615 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-02 16:03:35,619 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-02 16:03:35,621 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-02 16:03:35,623 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-02 16:03:35,624 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-02 16:03:35,626 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-02 16:03:35,628 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-02 16:03:35,632 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-02 16:03:35,634 - INFO - [session.py:175] - Starting TLS session
2025-01-02 16:03:35,636 - INFO - [session.py:114] - Starting TLS Handshake...
2025-01-02 16:03:35,637 - INFO - [client.py:100] - Generated client_random: 2bfffa244a2e80ce942beb60c8d8553d9ce631c6ed2e594852c4ba1239183385
2025-01-02 16:03:35,649 - INFO - [client.py:143] - Client Hello sent from 192.168.1.2
2025-01-02 16:03:35,660 - INFO - [session.py:119] - Client Hello sent successfully
2025-01-02 16:03:35,661 - INFO - [server.py:94] - Generated server_random: 577e5e76faae853ef2d25c235396a0e1a907342d7b94cb1c2dad8a59151c7e08
2025-01-02 16:03:35,690 - INFO - [session.py:124] - Server Hello received successfully
2025-01-02 16:03:35,692 - INFO - [client.py:180] - Prepared empty certificate
2025-01-02 16:03:35,694 - INFO - [client.py:192] - Encrypted pre_master_secret length: 256
2025-01-02 16:03:35,708 - INFO - [session.py:129] - Client handshake messages sent successfully
2025-01-02 16:03:35,719 - INFO - [session.py:134] - Server key pair verified successfully
2025-01-02 16:03:35,721 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-02 16:03:35,728 - INFO - [chain.py:185] - Decrypted pre_master_secret: 03035cae1e3bbd0bedda545dd68024bea0ac4ca3abcfd0b398c22b1f0622373800f08f7499232a4a180f2a203727f69c
2025-01-02 16:03:35,731 - INFO - [chain.py:195] - Generated master secret: 5580113692f54327f7e620ee70f23a281ae686099f0d4253b293680a37748011010b6be0ab3fe183a76a1fe5c79f965b
2025-01-02 16:03:35,734 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-02 16:03:35,736 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-02 16:03:35,738 - INFO - [session.py:138] - Master Secret handled successfully
2025-01-02 16:03:35,746 - INFO - [client.py:273] - Pre-master secret validated successfully
2025-01-02 16:03:35,753 - INFO - [client.py:291] - Generated digital signature: 09a1635cf6cdae9cbc228d53f9db6ec4e784d6d6a1c0a9b6523781a43afab190bf047cfcb32a1b8f7aa034ff863d4c56bc5c0af4e83de8739cebb6627d613a70542f1d60bf1e27455ed9b18b5c3d8e64924e11b3b379f54a6b589becfc053729a43399c808fcfcf5e1f9bb799c6cb31e64a8367bba738f18b42ceb543250da0765f133a92ba8e0fb48fc6f03513b6455e9a5c810dcc82b28d891d898926cd04be4b7040ade1f68b638f35e04b901d5e2d54f2347f6fb1793147567d1b03af6f92fe02e9157f0a255ce394168cd2de8f3e3d4f14e3598477809ea6f42a4afac490bcd603e493a29f6d758b0972f9e52814afe8c32b77789b23b0cc06ce7f74758
2025-01-02 16:03:35,763 - INFO - [client.py:337] - Client ChangeCipherSpec and Finished messages sent
2025-01-02 16:03:35,771 - INFO - [session.py:143] - Client Change Cipher Spec sent successfully
2025-01-02 16:03:35,779 - INFO - [server.py:260] - Pre-master secret validated successfully
2025-01-02 16:03:35,788 - INFO - [server.py:278] - Generated digital signature: 1a7569e40b990f17ee3e6274520e33044cc2738f7f371392423463b50172a874b93277894fea1aa6d906f929041259f77e9a251e3e4a3e66d60edc6b6520225553482657a7d346adba7871530df3bc83a1539a3393c920500c347db33bd39b6a3dc157607c2b600a42c9de608a1d0d635b7b8a7364ebf35bbf050f62b2a01c02695e1b387bfeed73144294ead70b6f167651bbbe96e171f8ddc592084064e06168ede8e72379d1e9c95f87643c7f8fd5243dda9dbf375a510d559c358ea47a78820e613d0974fd90aef3e8649dcbf12146fd60b6840c78f79edee7c53a9ab2f57cedc1f134d47a18870096006496f219685d9e3b821779652f75952b79734d55
2025-01-02 16:03:35,801 - INFO - [server.py:324] - Server ChangeCipherSpec and Finished messages sent
2025-01-02 16:03:35,816 - INFO - [session.py:148] - Server Change Cipher Spec received successfully
2025-01-02 16:03:35,826 - INFO - [keys.py:218] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-02 16:03:35,828 - INFO - [session.py:153] - SSL Key Log handled successfully
2025-01-02 16:03:35,829 - INFO - [session.py:157] - TLS Handshake completed successfully
2025-01-02 16:03:35,832 - INFO - [session.py:204] - Handshake completed: True
2025-01-02 16:03:35,833 - INFO - [session.py:205] - Use client cert: False
2025-01-02 16:03:35,835 - INFO - [session.py:206] - File to send: None
2025-01-02 16:03:35,839 - INFO - [session.py:212] - Using unencrypted exchange
2025-01-02 16:03:35,843 - INFO - [session.py:312] - Added request packet
2025-01-02 16:03:35,849 - INFO - [session.py:312] - Added response packet
2025-01-02 16:03:35,851 - WARNING - [session.py:289] - Using unencrypted communication
2025-01-02 16:03:35,853 - INFO - [main.py:96] - Session completed successfully for 192.168.1.2
2025-01-02 16:03:35,858 - INFO - [packet_validator.py:110] - Packet 13: Valid HTTP message
2025-01-02 16:03:35,860 - INFO - [packet_validator.py:110] - Packet 14: Valid HTTP message
2025-01-02 16:03:35,902 - INFO - [packet_storage.py:79] - Saved 15 valid packets to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-02 16:03:35,905 - INFO - [packet_storage.py:100] - Verifying 15 packets...
2025-01-02 16:03:35,910 - INFO - [packet_storage.py:104] - Packet 1: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 16:03:35,912 - INFO - [packet_storage.py:104] - Packet 2: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 16:03:35,914 - INFO - [packet_storage.py:104] - Packet 3: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 16:03:35,916 - INFO - [packet_storage.py:104] - Packet 4: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 16:03:35,924 - INFO - [packet_storage.py:104] - Packet 5: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 16:03:35,927 - INFO - [packet_storage.py:104] - Packet 6: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 16:03:35,929 - INFO - [packet_storage.py:104] - Packet 7: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 16:03:35,932 - INFO - [packet_storage.py:104] - Packet 8: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 16:03:35,934 - INFO - [packet_storage.py:104] - Packet 9: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-02 16:03:35,940 - INFO - [packet_storage.py:104] - Packet 10: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-02 16:03:35,942 - INFO - [packet_storage.py:104] - Packet 11: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-02 16:03:35,944 - INFO - [packet_storage.py:104] - Packet 12: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-02 16:03:35,946 - INFO - [packet_storage.py:104] - Packet 13: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-02 16:03:35,948 - INFO - [packet_storage.py:104] - Packet 14: IP / TCP 192.168.1.2:12346 > 10.0.0.1:http PA / Raw
2025-01-02 16:03:35,950 - INFO - [packet_storage.py:104] - Packet 15: IP / TCP 10.0.0.1:http > 192.168.1.2:12346 PA / Raw
2025-01-02 16:03:35,953 - INFO - [packet_storage.py:111] - Verification complete: 15 valid packets, 13 TLS records
2025-01-02 16:03:35,958 - INFO - [main.py:107] - Results saved to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-02 16:03:35,959 - INFO - [main.py:161] - TLS session simulation completed successfully
2025-01-02 16:24:08,754 - INFO - [logging.py:83] - Logging configured successfully
2025-01-02 16:24:08,758 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-02 16:24:08,762 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-02 16:24:08,764 - INFO - [logging.py:92] - Log level: 20
2025-01-02 16:24:08,766 - INFO - [logging.py:93] - Timestamp: 2025-01-02T16:24:08.766263
2025-01-02 16:24:08,768 - INFO - [logging.py:94] - ==========================
2025-01-02 16:24:08,770 - INFO - [main.py:123] - Starting TLS session simulation
2025-01-02 16:24:08,772 - INFO - [main.py:88] - 
--- Client Session (certificate) ---
2025-01-02 16:24:08,777 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-02 16:24:08,780 - INFO - [cert.py:108] - File exists: True
2025-01-02 16:24:08,782 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-02 16:24:08,785 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-02 16:24:08,786 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-02 16:24:08,789 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-02 16:24:08,843 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 16:24:08,846 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-02 16:24:08,848 - INFO - [cert.py:108] - File exists: True
2025-01-02 16:24:08,850 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-02 16:24:08,853 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-02 16:24:08,854 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-02 16:24:08,856 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-02 16:24:08,860 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 16:24:09,212 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-02 16:24:09,275 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-02 16:24:09,277 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-02 16:24:09,281 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-02 16:24:09,315 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-02 16:24:09,320 - INFO - [verify.py:58] - Public key comparison results:
2025-01-02 16:24:09,323 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 16:24:09,335 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 16:24:09,343 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-02 16:24:09,346 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-02 16:24:09,382 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-02 16:24:09,385 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-02 16:24:09,387 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-02 16:24:09,388 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-02 16:24:09,392 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-02 16:24:09,395 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-02 16:24:09,400 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-02 16:24:09,403 - INFO - [session.py:175] - Starting TLS session
2025-01-02 16:24:09,405 - INFO - [session.py:114] - Starting TLS Handshake...
2025-01-02 16:24:09,407 - INFO - [client.py:100] - Generated client_random: 385fc883c12ad0052a8c49533183bb684344cb3653473ba9fbff9bfc982a250c
2025-01-02 16:24:09,426 - INFO - [client.py:143] - Client Hello sent from 192.168.1.1
2025-01-02 16:24:09,443 - INFO - [session.py:119] - Client Hello sent successfully
2025-01-02 16:24:09,447 - INFO - [server.py:94] - Generated server_random: 2c497c7f476f82d1cfc3daa2cb1a4a71d93ea28643bc3e5f6be52030ebfe745f
2025-01-02 16:24:09,482 - INFO - [session.py:124] - Server Hello received successfully
2025-01-02 16:24:09,484 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2025-01-02 16:24:09,486 - INFO - [cert.py:108] - File exists: True
2025-01-02 16:24:09,488 - INFO - [cert.py:109] - File size: 1915 bytes
2025-01-02 16:24:09,494 - INFO - [cert.py:113] - Read 1915 bytes
2025-01-02 16:24:09,496 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2025-01-02 16:24:09,498 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2025-01-02 16:24:09,500 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 16:24:09,502 - INFO - [client.py:177] - Prepared client certificate
2025-01-02 16:24:09,506 - INFO - [client.py:192] - Encrypted pre_master_secret length: 256
2025-01-02 16:24:09,518 - INFO - [session.py:129] - Client handshake messages sent successfully
2025-01-02 16:24:09,534 - INFO - [session.py:134] - Server key pair verified successfully
2025-01-02 16:24:09,544 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-02 16:24:09,555 - INFO - [chain.py:185] - Decrypted pre_master_secret: 0303abd7c716802c32152c84657696f1c2779823a221a82e2ae1050a21d1bae03d1ebd927d0a601d0bdc559e98e43372
2025-01-02 16:24:09,560 - INFO - [chain.py:195] - Generated master secret: ef9e122e378a1243515c3c1352308fbe780e7c4419614898b732d63d62af779e7f2ed03ae0025a8889ebad30e17f12ea
2025-01-02 16:24:09,563 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-02 16:24:09,565 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-02 16:24:09,567 - INFO - [session.py:138] - Master Secret handled successfully
2025-01-02 16:24:09,579 - INFO - [client.py:273] - Pre-master secret validated successfully
2025-01-02 16:24:09,588 - INFO - [client.py:291] - Generated digital signature: 1bceeb0103b85017b4f24bb6a13c4b29e4e54c79113aa3113508ea09af4b057fd0a8e2d52f37dbdb5fba5d155a3b07d06599c5ad08940b62f5f35a298c57e6fa86086316b1a9f0c647006e637d8f1f6dffe13e798a5e88937bb06bb507c2511f36e73f1e902988704ed9ef3058d8dcc509fa1fe80153d0558b7c4cc7ecf773a2f0af9ef7d9d96a3621450dce4bd32a49f1d4dc63ffafe1a5767c7bd6917ebe87ac61a766a1376a036be48186ff0e815141626e11d91d3a3c220baded5a0f585b3b1c308ef69621c691f5bb67fd8708af4be9203658be2d033476b78520bf42e5bf55c4a9ac9155a08ffe4c7c9dc62fb5f53ec851d85dcc57a38a615b8e986b62
2025-01-02 16:24:09,602 - INFO - [client.py:337] - Client ChangeCipherSpec and Finished messages sent
2025-01-02 16:24:09,610 - INFO - [session.py:143] - Client Change Cipher Spec sent successfully
2025-01-02 16:24:09,617 - INFO - [server.py:260] - Pre-master secret validated successfully
2025-01-02 16:24:09,627 - INFO - [server.py:278] - Generated digital signature: 14b7d70ba865f734fb8b85089c892cd41028d33baa39bd2d1d8e06b10a53e73ce8fc0cd61f49033cc3cea06510552e2f9beb2c05286eaf09ac5af0a8273302872c07c39b6ab52bcbd51fd47ee3195aec641d82a7ed33c95b8968f668bd84932403ef06d4b1f2d790006d9cd10f4c275dd944ace34ad41e7b2b69c25cbe543d9aebad5b6a36c105f8ad4a7b9385049c904249755e9f4c8e7a4ca3ccaee0309609d8111d44bee1b35413ef72eabf8ababce8fec6053684aba36acab7cbff6551bff55641c89e96d76db67b54fb28de7713ae6298b4627b82de8f9da04242d5e296d93f652bd1d717a32bfdcda89e474cdc179b44a3951260f7d4c93b3f9af70fe9
2025-01-02 16:24:09,635 - INFO - [server.py:324] - Server ChangeCipherSpec and Finished messages sent
2025-01-02 16:24:09,645 - INFO - [session.py:148] - Server Change Cipher Spec received successfully
2025-01-02 16:24:09,652 - INFO - [keys.py:218] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-02 16:24:09,653 - INFO - [session.py:153] - SSL Key Log handled successfully
2025-01-02 16:24:09,654 - INFO - [session.py:157] - TLS Handshake completed successfully
2025-01-02 16:24:09,657 - INFO - [session.py:186] - Found file to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 16:24:09,659 - INFO - [session.py:204] - Handshake completed: True
2025-01-02 16:24:09,661 - INFO - [session.py:205] - Use client cert: True
2025-01-02 16:24:09,663 - INFO - [session.py:206] - File to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 16:24:09,664 - INFO - [session.py:209] - Using encrypted exchange
2025-01-02 16:24:09,666 - INFO - [session.py:224] - Sending encrypted request data
2025-01-02 16:24:09,673 - INFO - [keys.py:185] - TLS Application Data sent from 192.168.1.1:12345 to 10.0.0.1:443
2025-01-02 16:24:09,675 - INFO - [session.py:235] - Sending encrypted response data
2025-01-02 16:24:09,682 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-02 16:24:09,684 - INFO - [session.py:247] - Attempting to send file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 16:24:09,686 - INFO - [session.py:258] - Opening file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 16:24:09,689 - INFO - [session.py:265] - Read 1103 bytes from file
2025-01-02 16:24:09,699 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-02 16:24:09,701 - INFO - [session.py:274] - File sent successfully
2025-01-02 16:24:09,703 - INFO - [session.py:249] - File sent successfully
2025-01-02 16:24:09,704 - INFO - [main.py:96] - Session completed successfully for 192.168.1.1
2025-01-02 16:24:09,705 - INFO - [main.py:88] - 
--- Client Session (no certificate) ---
2025-01-02 16:24:09,710 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-02 16:24:09,713 - INFO - [cert.py:108] - File exists: True
2025-01-02 16:24:09,715 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-02 16:24:09,717 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-02 16:24:09,718 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-02 16:24:09,719 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-02 16:24:09,722 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 16:24:09,724 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-02 16:24:09,727 - INFO - [cert.py:108] - File exists: True
2025-01-02 16:24:09,731 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-02 16:24:09,733 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-02 16:24:09,734 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-02 16:24:09,736 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-02 16:24:09,741 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 16:24:10,163 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-02 16:24:10,241 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-02 16:24:10,331 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-02 16:24:10,335 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-02 16:24:10,337 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-02 16:24:10,341 - INFO - [verify.py:58] - Public key comparison results:
2025-01-02 16:24:10,345 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 16:24:10,350 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 16:24:10,354 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-02 16:24:10,356 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-02 16:24:10,360 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-02 16:24:10,362 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-02 16:24:10,363 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-02 16:24:10,364 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-02 16:24:10,366 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-02 16:24:10,368 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-02 16:24:10,373 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-02 16:24:10,375 - INFO - [session.py:175] - Starting TLS session
2025-01-02 16:24:10,377 - INFO - [session.py:114] - Starting TLS Handshake...
2025-01-02 16:24:10,378 - INFO - [client.py:100] - Generated client_random: aef1e2ac5044ddf4f4bef6678b2846afc0c263bfcc36d4feb1f1193d70528c76
2025-01-02 16:24:10,390 - INFO - [client.py:143] - Client Hello sent from 192.168.1.2
2025-01-02 16:24:10,403 - INFO - [session.py:119] - Client Hello sent successfully
2025-01-02 16:24:10,457 - INFO - [server.py:94] - Generated server_random: 2cd8e3ed86a1b8d76938dc6b57a6489a2b947f1918514cc505f80180de3c1f95
2025-01-02 16:24:10,484 - INFO - [session.py:124] - Server Hello received successfully
2025-01-02 16:24:10,486 - INFO - [client.py:180] - Prepared empty certificate
2025-01-02 16:24:10,488 - INFO - [client.py:192] - Encrypted pre_master_secret length: 256
2025-01-02 16:24:10,497 - INFO - [session.py:129] - Client handshake messages sent successfully
2025-01-02 16:24:10,508 - INFO - [session.py:134] - Server key pair verified successfully
2025-01-02 16:24:10,510 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-02 16:24:10,517 - INFO - [chain.py:185] - Decrypted pre_master_secret: 03038fce0bd161f324729e9f2eb0fc76f17868b03e415fe8c17a966662875a6b46c076fc1396715b8cf826fae1620bb1
2025-01-02 16:24:10,520 - INFO - [chain.py:195] - Generated master secret: 1f03cec7490501c70f3714fbf3e54ce70f37df6ed67fafd5f15c3c258b1b4198e8025acf67579e44772be3ebee87b89a
2025-01-02 16:24:10,522 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-02 16:24:10,525 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-02 16:24:10,527 - INFO - [session.py:138] - Master Secret handled successfully
2025-01-02 16:24:10,534 - INFO - [client.py:273] - Pre-master secret validated successfully
2025-01-02 16:24:10,544 - INFO - [client.py:291] - Generated digital signature: 007e365f896a910f717dba2161b1802e31140e53a5dbbc9cffc36df9b446d9ccde522d22c4753b5dae93329a478c48680209135cd95459518eff805d59be952a92053b027e83b759c47ddc0893dda5c1704af5b8d43a4a1877d32f85eb2d3f8e9a24ba85b3b28cd08aad472030481e6469434a90c0e387711a6d937ba9389ace7d3938537934d165380dfdf74d05be8871f9c9367b802d4bbeb3e238fdf948be4adcd4e5d8208622340680674cd08d09a5834d33472d2fb66b52ec96006996f14b247171e3361f54f0bbf2510f1229c5f2a110aaf455ed70668bfccc854dfbb05a991ec49be78a958ed7fae153b2b9c575d9b6aea1938ee97e2d705f088dd88f
2025-01-02 16:24:10,552 - INFO - [client.py:337] - Client ChangeCipherSpec and Finished messages sent
2025-01-02 16:24:10,559 - INFO - [session.py:143] - Client Change Cipher Spec sent successfully
2025-01-02 16:24:10,566 - INFO - [server.py:260] - Pre-master secret validated successfully
2025-01-02 16:24:10,574 - INFO - [server.py:278] - Generated digital signature: 6037692ca67bd058e16746860699f3a55fa208fd6d572b7b3d123a6fe353a28a99226ce2f2d1c3ca78b8fd67fa178fb953cd066f319b8136318c22d88ba46e29ff933a78db3ef2f714f41a53c691c998fe3b241f988633f88d3bd65671705cf52bfa9ce98d6d1d8f56566cf2f361f3a43831a853c5e41e073d175598bf53435eaf4fb312ca57f6500d332dc511d51b5734e2998cea138987c189c48c4a315c8c04792985c1c4a0dc4e14d2f59c2c97ce1f92d57a37902a41c7c7dc5b50161db87e15bb2820ca66c69600f808334f63455d6c70ec1fc6dcec61dbaf764f75f34487faa5fa4551ec52d74f5aa4f702f30a597cb180c0c887d05cdf6cb961adef1f
2025-01-02 16:24:10,582 - INFO - [server.py:324] - Server ChangeCipherSpec and Finished messages sent
2025-01-02 16:24:10,588 - INFO - [session.py:148] - Server Change Cipher Spec received successfully
2025-01-02 16:24:10,592 - INFO - [keys.py:218] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-02 16:24:10,593 - INFO - [session.py:153] - SSL Key Log handled successfully
2025-01-02 16:24:10,595 - INFO - [session.py:157] - TLS Handshake completed successfully
2025-01-02 16:24:10,596 - INFO - [session.py:204] - Handshake completed: True
2025-01-02 16:24:10,597 - INFO - [session.py:205] - Use client cert: False
2025-01-02 16:24:10,598 - INFO - [session.py:206] - File to send: None
2025-01-02 16:24:10,600 - INFO - [session.py:212] - Using unencrypted exchange
2025-01-02 16:24:10,604 - INFO - [session.py:312] - Added request packet
2025-01-02 16:24:10,609 - INFO - [session.py:312] - Added response packet
2025-01-02 16:24:10,611 - WARNING - [session.py:289] - Using unencrypted communication
2025-01-02 16:24:10,612 - INFO - [main.py:96] - Session completed successfully for 192.168.1.2
2025-01-02 16:24:10,617 - INFO - [packet_validator.py:110] - Packet 13: Valid HTTP message
2025-01-02 16:24:10,619 - INFO - [packet_validator.py:110] - Packet 14: Valid HTTP message
2025-01-02 16:24:10,650 - INFO - [packet_storage.py:79] - Saved 15 valid packets to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-02 16:24:10,652 - INFO - [packet_storage.py:100] - Verifying 15 packets...
2025-01-02 16:24:10,653 - INFO - [packet_storage.py:104] - Packet 1: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 16:24:10,655 - INFO - [packet_storage.py:104] - Packet 2: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 16:24:10,656 - INFO - [packet_storage.py:104] - Packet 3: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 16:24:10,660 - INFO - [packet_storage.py:104] - Packet 4: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 16:24:10,662 - INFO - [packet_storage.py:104] - Packet 5: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 16:24:10,664 - INFO - [packet_storage.py:104] - Packet 6: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 16:24:10,666 - INFO - [packet_storage.py:104] - Packet 7: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 16:24:10,667 - INFO - [packet_storage.py:104] - Packet 8: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 16:24:10,670 - INFO - [packet_storage.py:104] - Packet 9: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-02 16:24:10,672 - INFO - [packet_storage.py:104] - Packet 10: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-02 16:24:10,674 - INFO - [packet_storage.py:104] - Packet 11: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-02 16:24:10,676 - INFO - [packet_storage.py:104] - Packet 12: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-02 16:24:10,679 - INFO - [packet_storage.py:104] - Packet 13: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-02 16:24:10,681 - INFO - [packet_storage.py:104] - Packet 14: IP / TCP 192.168.1.2:12346 > 10.0.0.1:http PA / Raw
2025-01-02 16:24:10,682 - INFO - [packet_storage.py:104] - Packet 15: IP / TCP 10.0.0.1:http > 192.168.1.2:12346 PA / Raw
2025-01-02 16:24:10,684 - INFO - [packet_storage.py:111] - Verification complete: 15 valid packets, 13 TLS records
2025-01-02 16:24:10,685 - INFO - [main.py:107] - Results saved to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-02 16:24:10,686 - INFO - [main.py:161] - TLS session simulation completed successfully
2025-01-02 17:18:52,634 - INFO - [logging.py:83] - Logging configured successfully
2025-01-02 17:18:52,637 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-02 17:18:52,638 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-02 17:18:52,639 - INFO - [logging.py:92] - Log level: 20
2025-01-02 17:18:52,640 - INFO - [logging.py:93] - Timestamp: 2025-01-02T17:18:52.640721
2025-01-02 17:18:52,641 - INFO - [logging.py:94] - ==========================
2025-01-02 17:18:52,642 - INFO - [main.py:123] - Starting TLS session simulation
2025-01-02 17:18:52,644 - INFO - [main.py:88] - 
--- Client Session (certificate) ---
2025-01-02 17:18:52,648 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-02 17:18:52,650 - INFO - [cert.py:108] - File exists: True
2025-01-02 17:18:52,652 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-02 17:18:52,655 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-02 17:18:52,656 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-02 17:18:52,658 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-02 17:18:52,672 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 17:18:52,675 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-02 17:18:52,677 - INFO - [cert.py:108] - File exists: True
2025-01-02 17:18:52,679 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-02 17:18:52,681 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-02 17:18:52,683 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-02 17:18:52,685 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-02 17:18:52,688 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 17:18:52,847 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-02 17:18:52,848 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-02 17:18:52,849 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-02 17:18:52,851 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-02 17:18:52,859 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-02 17:18:52,861 - INFO - [verify.py:58] - Public key comparison results:
2025-01-02 17:18:52,862 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 17:18:52,866 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 17:18:52,868 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-02 17:18:52,870 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-02 17:18:52,879 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-02 17:18:52,881 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-02 17:18:52,883 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-02 17:18:52,884 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-02 17:18:52,886 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-02 17:18:52,888 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-02 17:18:52,892 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-02 17:18:52,895 - INFO - [session.py:175] - Starting TLS session
2025-01-02 17:18:52,896 - INFO - [session.py:114] - Starting TLS Handshake...
2025-01-02 17:18:52,897 - INFO - [client.py:100] - Generated client_random: 5bf46351dc9919f8f19f9b5c48397ff5721c1993e2018863c57c609046ba6996
2025-01-02 17:18:52,909 - INFO - [client.py:143] - Client Hello sent from 192.168.1.1
2025-01-02 17:18:52,919 - INFO - [session.py:119] - Client Hello sent successfully
2025-01-02 17:18:52,921 - INFO - [server.py:94] - Generated server_random: e06d947ccb3db9eded245079c40fcf1c08cb879b6429a7abe5c10472d8cce6b4
2025-01-02 17:18:52,933 - INFO - [session.py:124] - Server Hello received successfully
2025-01-02 17:18:52,935 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2025-01-02 17:18:52,937 - INFO - [cert.py:108] - File exists: True
2025-01-02 17:18:52,939 - INFO - [cert.py:109] - File size: 1915 bytes
2025-01-02 17:18:52,941 - INFO - [cert.py:113] - Read 1915 bytes
2025-01-02 17:18:52,942 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2025-01-02 17:18:52,943 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2025-01-02 17:18:52,945 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 17:18:52,946 - INFO - [client.py:177] - Prepared client certificate
2025-01-02 17:18:52,948 - INFO - [client.py:192] - Encrypted pre_master_secret length: 256
2025-01-02 17:18:52,952 - INFO - [session.py:129] - Client handshake messages sent successfully
2025-01-02 17:18:52,957 - INFO - [session.py:134] - Server key pair verified successfully
2025-01-02 17:18:52,958 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-02 17:18:52,961 - INFO - [chain.py:185] - Decrypted pre_master_secret: 0303a9e5ab90048771c1eb5ac0ffa9bac86167b0cc9b3050633f4aee694cb478710113bc97b667dcafc7cd32b315bdd1
2025-01-02 17:18:52,962 - INFO - [chain.py:195] - Generated master secret: 3f393fd78d0218f0b39fb58b308e0604947e8c230e8bbd6b0a851e549f4f5f21e1c6f3dacd98f1e28f45c1fc847772a0
2025-01-02 17:18:52,964 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-02 17:18:52,965 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-02 17:18:52,966 - INFO - [session.py:138] - Master Secret handled successfully
2025-01-02 17:18:52,969 - INFO - [client.py:273] - Pre-master secret validated successfully
2025-01-02 17:18:52,972 - INFO - [client.py:291] - Generated digital signature: 7b5f668ec87976fb869063c65a1959e690982edf699ce4de44aff4facaec58ce01ebd61a79414656efcfc97cbf6f3b7ab512f70e4adf768cbb7e394d62b35f4b9d6daffd3c39a57b0765ebba3e38636990de3fa1d47088f9ab48ad5f1115472222fc7ee6dc64b909489d1b6a541557aa87d9450c7db1d0c91fc70f85cee4347ccc0474b8cad6220867aa8713680e3aed245c9cda3a384837fd3bc6f535235485295b9d8d25bbad25a95dc5b0e26efa9a2faf21257b38475dbe66c691834c25d74a0a71d307ea47dbecd08e670b457da4a1401b2060e62292b49acfa2c5ec487267e9ab1cc36c19ec731c51530be25edd5863fd854640f1f41fc9bfb4a3901568
2025-01-02 17:18:52,980 - INFO - [client.py:337] - Client ChangeCipherSpec and Finished messages sent
2025-01-02 17:18:52,983 - INFO - [session.py:143] - Client Change Cipher Spec sent successfully
2025-01-02 17:18:52,986 - INFO - [server.py:260] - Pre-master secret validated successfully
2025-01-02 17:18:52,990 - INFO - [server.py:278] - Generated digital signature: ac6914f92695216b31b77effd0784a4ab04857f0b262d70e279a82e7c58972f7587d1fb980efcca4cd39a48a10506068c0acf24859d12bb8cab97291a08f7bb9e4332b7e62f6ff793abbcbbd21808c45781c04f7fac3a1072a8750d2b29fa2cd256e34adc4ab5f370e914ddc2ec63d90824a0c9133b3bb7a4348ce0bdf6e7eab7a6448c695ebbcc6d82b5597ca8fc54066757efabc64d2a305780cc92d09da5fccdccb92b00179642afe6f624212e76e6ebac82dc2f49d093afca44360d861b08c3366554277c2044714f5e65b73ca1ce27f929a48492b2f2b65bef80381223143502fb14cfecfdc6bb94f3b4c8ff4f89c7a72709891b79ab5261b8d0b7b8ac9
2025-01-02 17:18:52,996 - INFO - [server.py:324] - Server ChangeCipherSpec and Finished messages sent
2025-01-02 17:18:52,999 - INFO - [session.py:148] - Server Change Cipher Spec received successfully
2025-01-02 17:18:53,001 - INFO - [keys.py:218] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-02 17:18:53,002 - INFO - [session.py:153] - SSL Key Log handled successfully
2025-01-02 17:18:53,003 - INFO - [session.py:157] - TLS Handshake completed successfully
2025-01-02 17:18:53,005 - INFO - [session.py:186] - Found file to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 17:18:53,007 - INFO - [session.py:204] - Handshake completed: True
2025-01-02 17:18:53,008 - INFO - [session.py:205] - Use client cert: True
2025-01-02 17:18:53,010 - INFO - [session.py:206] - File to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 17:18:53,011 - INFO - [session.py:209] - Using encrypted exchange
2025-01-02 17:18:53,012 - INFO - [session.py:224] - Sending encrypted request data
2025-01-02 17:18:53,016 - INFO - [keys.py:185] - TLS Application Data sent from 192.168.1.1:12345 to 10.0.0.1:443
2025-01-02 17:18:53,018 - INFO - [session.py:235] - Sending encrypted response data
2025-01-02 17:18:53,023 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-02 17:18:53,025 - INFO - [session.py:247] - Attempting to send file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 17:18:53,026 - INFO - [session.py:258] - Opening file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 17:18:53,028 - INFO - [session.py:265] - Read 1103 bytes from file
2025-01-02 17:18:53,033 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-02 17:18:53,034 - INFO - [session.py:274] - File sent successfully
2025-01-02 17:18:53,035 - INFO - [session.py:249] - File sent successfully
2025-01-02 17:18:53,036 - INFO - [main.py:96] - Session completed successfully for 192.168.1.1
2025-01-02 17:18:53,037 - INFO - [main.py:88] - 
--- Client Session (no certificate) ---
2025-01-02 17:18:53,041 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-02 17:18:53,042 - INFO - [cert.py:108] - File exists: True
2025-01-02 17:18:53,044 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-02 17:18:53,045 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-02 17:18:53,046 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-02 17:18:53,047 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-02 17:18:53,050 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 17:18:53,051 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-02 17:18:53,053 - INFO - [cert.py:108] - File exists: True
2025-01-02 17:18:53,055 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-02 17:18:53,057 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-02 17:18:53,058 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-02 17:18:53,060 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-02 17:18:53,062 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 17:18:53,160 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-02 17:18:53,161 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-02 17:18:53,162 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-02 17:18:53,163 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-02 17:18:53,164 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-02 17:18:53,165 - INFO - [verify.py:58] - Public key comparison results:
2025-01-02 17:18:53,165 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 17:18:53,168 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 17:18:53,171 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-02 17:18:53,172 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-02 17:18:53,174 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-02 17:18:53,176 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-02 17:18:53,178 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-02 17:18:53,179 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-02 17:18:53,181 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-02 17:18:53,182 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-02 17:18:53,184 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-02 17:18:53,186 - INFO - [session.py:175] - Starting TLS session
2025-01-02 17:18:53,187 - INFO - [session.py:114] - Starting TLS Handshake...
2025-01-02 17:18:53,188 - INFO - [client.py:100] - Generated client_random: e338eda717c2ec8d99d19c2bac2384529e8e8941fbff8517909ada38d3e3aaf1
2025-01-02 17:18:53,194 - INFO - [client.py:143] - Client Hello sent from 192.168.1.2
2025-01-02 17:18:53,201 - INFO - [session.py:119] - Client Hello sent successfully
2025-01-02 17:18:53,202 - INFO - [server.py:94] - Generated server_random: eff9254c7ce6375b157f72ecf5702e86741b96a727e83e948df736acbe8310f9
2025-01-02 17:18:53,213 - INFO - [session.py:124] - Server Hello received successfully
2025-01-02 17:18:53,215 - INFO - [client.py:180] - Prepared empty certificate
2025-01-02 17:18:53,217 - INFO - [client.py:192] - Encrypted pre_master_secret length: 256
2025-01-02 17:18:53,224 - INFO - [session.py:129] - Client handshake messages sent successfully
2025-01-02 17:18:53,229 - INFO - [session.py:134] - Server key pair verified successfully
2025-01-02 17:18:53,231 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-02 17:18:53,234 - INFO - [chain.py:185] - Decrypted pre_master_secret: 0303bb23b29e20296bb7b79d924832144f96103b28cbc1ab622e707f561da3ae83a40851d9d4f19f38b817d8e592e124
2025-01-02 17:18:53,236 - INFO - [chain.py:195] - Generated master secret: 96b3e3bdbe5013f64893840dbec3e26010faf7b87359a8fd542b74568b0934601c92bc84c55e9aaabc7d9966f6f5967d
2025-01-02 17:18:53,237 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-02 17:18:53,239 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-02 17:18:53,240 - INFO - [session.py:138] - Master Secret handled successfully
2025-01-02 17:18:53,244 - INFO - [client.py:273] - Pre-master secret validated successfully
2025-01-02 17:18:53,246 - INFO - [client.py:291] - Generated digital signature: 4a022961b224495f8a69458439897ddb86ea32b010e8d820994416b62b8ff1a967e5c0467fb2b9d403394814d8b3810bcf359827aff44efcb5f41e7d8d3e978d516c4d5c208eb3d0122277378544d57efe348d2941cb068c95ff3ae450ddfd63e8631e13f4d047528f9ebdca0c9f8d3f3c1844e2c172cb2684a7e20fe4b5ef32dc9065f9de422ca8e2bdc8beca94954960bbdd3da442f4b48f06e48283a344f542bf91de09990068a177ffd4471a255d735c3e851c94b01fab5f69a7fc8c1617478e0e2b166bad5529be79386b18ed2b87922722eeed39cd51a93309c6224dce326a5347be47aa83dd35cd654c83b543909484ec7cb0e8fa72bd16c11c6c3207
2025-01-02 17:18:53,250 - INFO - [client.py:337] - Client ChangeCipherSpec and Finished messages sent
2025-01-02 17:18:53,253 - INFO - [session.py:143] - Client Change Cipher Spec sent successfully
2025-01-02 17:18:53,256 - INFO - [server.py:260] - Pre-master secret validated successfully
2025-01-02 17:18:53,259 - INFO - [server.py:278] - Generated digital signature: 479d591ff234c6ce5f6a79adfd6e37ee966a9af1c3ad9ea285867b0d208f596458e9e431a6b3bd0d05ba20372e75bb96f1e6e671ce7732b6255ea62f7230411ccf8730b0bdc9852c095ca35577c657dcf22b918cc8dcafd7842da0daa626f24a99829ede2b9fcdba2873c5e3c1da6650d60b25b2829a50620f8e5fa0fe2b8cab99c79b8f830ec2dcadf56f2bb2a51b5e04c18054de2f30162d14f269d1f512f28a8604d4db30a9939350271911fc1e8d491a6766b5a1f6b000952d5c4ab631c3614f317e64b7f46ab3847215686de75410f0768fae3ac8d406b9a62c63918cb23957d7dc344ccd1bc08d9fb078312c59c89bc29a900df8449424d2786849b913
2025-01-02 17:18:53,264 - INFO - [server.py:324] - Server ChangeCipherSpec and Finished messages sent
2025-01-02 17:18:53,269 - INFO - [session.py:148] - Server Change Cipher Spec received successfully
2025-01-02 17:18:53,273 - INFO - [keys.py:218] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-02 17:18:53,274 - INFO - [session.py:153] - SSL Key Log handled successfully
2025-01-02 17:18:53,275 - INFO - [session.py:157] - TLS Handshake completed successfully
2025-01-02 17:18:53,276 - INFO - [session.py:204] - Handshake completed: True
2025-01-02 17:18:53,277 - INFO - [session.py:205] - Use client cert: False
2025-01-02 17:18:53,278 - INFO - [session.py:206] - File to send: None
2025-01-02 17:18:53,279 - INFO - [session.py:212] - Using unencrypted exchange
2025-01-02 17:18:53,280 - INFO - [session.py:312] - Added request packet
2025-01-02 17:18:53,282 - INFO - [session.py:312] - Added response packet
2025-01-02 17:18:53,282 - WARNING - [session.py:289] - Using unencrypted communication
2025-01-02 17:18:53,283 - INFO - [main.py:96] - Session completed successfully for 192.168.1.2
2025-01-02 17:18:53,285 - INFO - [packet_validator.py:110] - Packet 13: Valid HTTP message
2025-01-02 17:18:53,287 - INFO - [packet_validator.py:110] - Packet 14: Valid HTTP message
2025-01-02 17:18:53,303 - INFO - [packet_storage.py:79] - Saved 15 valid packets to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-02 17:18:53,305 - INFO - [packet_storage.py:100] - Verifying 15 packets...
2025-01-02 17:18:53,306 - INFO - [packet_storage.py:104] - Packet 1: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 17:18:53,308 - INFO - [packet_storage.py:104] - Packet 2: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 17:18:53,309 - INFO - [packet_storage.py:104] - Packet 3: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 17:18:53,311 - INFO - [packet_storage.py:104] - Packet 4: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 17:18:53,312 - INFO - [packet_storage.py:104] - Packet 5: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 17:18:53,314 - INFO - [packet_storage.py:104] - Packet 6: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 17:18:53,315 - INFO - [packet_storage.py:104] - Packet 7: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 17:18:53,316 - INFO - [packet_storage.py:104] - Packet 8: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 17:18:53,317 - INFO - [packet_storage.py:104] - Packet 9: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-02 17:18:53,318 - INFO - [packet_storage.py:104] - Packet 10: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-02 17:18:53,319 - INFO - [packet_storage.py:104] - Packet 11: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-02 17:18:53,321 - INFO - [packet_storage.py:104] - Packet 12: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-02 17:18:53,323 - INFO - [packet_storage.py:104] - Packet 13: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-02 17:18:53,324 - INFO - [packet_storage.py:104] - Packet 14: IP / TCP 192.168.1.2:12346 > 10.0.0.1:http PA / Raw
2025-01-02 17:18:53,326 - INFO - [packet_storage.py:104] - Packet 15: IP / TCP 10.0.0.1:http > 192.168.1.2:12346 PA / Raw
2025-01-02 17:18:53,327 - INFO - [packet_storage.py:111] - Verification complete: 15 valid packets, 13 TLS records
2025-01-02 17:18:53,328 - INFO - [main.py:107] - Results saved to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-02 17:18:53,329 - INFO - [main.py:161] - TLS session simulation completed successfully
2025-01-02 17:23:38,982 - INFO - [logging.py:83] - Logging configured successfully
2025-01-02 17:23:38,984 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-02 17:23:38,985 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-02 17:23:38,986 - INFO - [logging.py:92] - Log level: 20
2025-01-02 17:23:38,987 - INFO - [logging.py:93] - Timestamp: 2025-01-02T17:23:38.987740
2025-01-02 17:23:38,988 - INFO - [logging.py:94] - ==========================
2025-01-02 17:23:38,990 - INFO - [main.py:123] - Starting TLS session simulation
2025-01-02 17:23:38,994 - INFO - [main.py:88] - 
--- Client Session (certificate) ---
2025-01-02 17:23:38,997 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-02 17:23:38,999 - INFO - [cert.py:108] - File exists: True
2025-01-02 17:23:39,001 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-02 17:23:39,004 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-02 17:23:39,005 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-02 17:23:39,012 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-02 17:23:39,026 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 17:23:39,029 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-02 17:23:39,031 - INFO - [cert.py:108] - File exists: True
2025-01-02 17:23:39,033 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-02 17:23:39,036 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-02 17:23:39,037 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-02 17:23:39,039 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-02 17:23:39,042 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 17:23:39,160 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-02 17:23:39,161 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-02 17:23:39,162 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-02 17:23:39,164 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-02 17:23:39,172 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-02 17:23:39,173 - INFO - [verify.py:58] - Public key comparison results:
2025-01-02 17:23:39,174 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 17:23:39,178 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 17:23:39,180 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-02 17:23:39,182 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-02 17:23:39,190 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-02 17:23:39,192 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-02 17:23:39,193 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-02 17:23:39,195 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-02 17:23:39,197 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-02 17:23:39,199 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-02 17:23:39,202 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-02 17:23:39,204 - INFO - [session.py:175] - Starting TLS session
2025-01-02 17:23:39,206 - INFO - [session.py:114] - Starting TLS Handshake...
2025-01-02 17:23:39,207 - INFO - [client.py:100] - Generated client_random: 920e664530520db42ad316d10c9ed7b567d8a9459f837861c0051300bd84501c
2025-01-02 17:23:39,219 - INFO - [client.py:143] - Client Hello sent from 192.168.1.1
2025-01-02 17:23:39,227 - INFO - [session.py:119] - Client Hello sent successfully
2025-01-02 17:23:39,228 - INFO - [server.py:94] - Generated server_random: a2ae18c07f869736262dcca9aa1a1bac7fbafe424c853109c272b0204ac515ac
2025-01-02 17:23:39,251 - INFO - [session.py:124] - Server Hello received successfully
2025-01-02 17:23:39,252 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2025-01-02 17:23:39,254 - INFO - [cert.py:108] - File exists: True
2025-01-02 17:23:39,256 - INFO - [cert.py:109] - File size: 1915 bytes
2025-01-02 17:23:39,259 - INFO - [cert.py:113] - Read 1915 bytes
2025-01-02 17:23:39,260 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2025-01-02 17:23:39,263 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2025-01-02 17:23:39,267 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 17:23:39,269 - INFO - [client.py:177] - Prepared client certificate
2025-01-02 17:23:39,271 - INFO - [client.py:192] - Encrypted pre_master_secret length: 256
2025-01-02 17:23:39,277 - INFO - [session.py:129] - Client handshake messages sent successfully
2025-01-02 17:23:39,285 - INFO - [session.py:134] - Server key pair verified successfully
2025-01-02 17:23:39,286 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-02 17:23:39,288 - INFO - [chain.py:185] - Decrypted pre_master_secret: 03030d603439989a215739103fc0caa22d651905fe6d76c3c3caf493f912f6ab53f55a62f682219314266e4e7617c24b
2025-01-02 17:23:39,291 - INFO - [chain.py:195] - Generated master secret: 76254e2ef80b8e08a766bc08992223f8f8296b35014ccadbbe7d4b47be2b7f6a86ba3c35a101d99d38fd34ef68a389f2
2025-01-02 17:23:39,293 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-02 17:23:39,295 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-02 17:23:39,296 - INFO - [session.py:138] - Master Secret handled successfully
2025-01-02 17:23:39,300 - INFO - [client.py:273] - Pre-master secret validated successfully
2025-01-02 17:23:39,303 - INFO - [client.py:291] - Generated digital signature: 1c06b2401b0541f8483636cc5f548857b0b9d25f9db6659a76833d46db1da29aad31dce698da39f8fddc6372e4d11782b8b81c5c716b26c039a2e844443ba048ed4ed6e41fd4563e3fed595403a4eb66dbf56c652637679d584e85892bdc3900b8f42e6f3567113dca2912477dca6357d8c78ebe640668a8fd4aa75ebd8079c58607d61fe37eaa69ff4bdb74c5e39b4528d2113dc3bd3fa3d66c2f58afd32731d0cd603e5277a6428d3be9b4de6d1d5bc843b81be40d79aabfe7af1ef18fcea6db20a60fa993e01f2073ca0cae69047bbdaec3d2c9337889be6071602f721b8996e7e3496e63dc85c391f74fd564d0c71323e547d4443f71362a2fd4c59bf190
2025-01-02 17:23:39,309 - INFO - [client.py:337] - Client ChangeCipherSpec and Finished messages sent
2025-01-02 17:23:39,315 - INFO - [session.py:143] - Client Change Cipher Spec sent successfully
2025-01-02 17:23:39,318 - INFO - [server.py:260] - Pre-master secret validated successfully
2025-01-02 17:23:39,321 - INFO - [server.py:278] - Generated digital signature: 6c857572310c2015e6dcaf1e1ff1fad3c04896e6ffedf00c6b1d080a8994191b3f8a26bfd2c21a96af46d549eaa67781772665bbda12998b496b42a670928ee9cf166c887d99ab6368736d43f8a73984d0fb25b6e60d31ae90172eeeced9795e1202ce7204499715d44959133860a3dbceee2f6ca3b1da1f6bb18b296e621433cc7ad02a7abaeeef0ad411020e574a6bdb7d0c0e2c83904ba1e5acfcbf2871276c2524b6bbb5834c1d964c590a5bceb6a9da1493dbc5e546bcae492f7fbeb114801ab34555aeec783f593f79404f4063ac35f9bfca40af789a71b2ed09368cc1d146384f16977b8f1de29f447594290fa8d9c1154e6344b6d871a7c086517d49
2025-01-02 17:23:39,325 - INFO - [server.py:324] - Server ChangeCipherSpec and Finished messages sent
2025-01-02 17:23:39,330 - INFO - [session.py:148] - Server Change Cipher Spec received successfully
2025-01-02 17:23:39,334 - INFO - [keys.py:218] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-02 17:23:39,335 - INFO - [session.py:153] - SSL Key Log handled successfully
2025-01-02 17:23:39,336 - INFO - [session.py:157] - TLS Handshake completed successfully
2025-01-02 17:23:39,338 - INFO - [session.py:186] - Found file to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 17:23:39,339 - INFO - [session.py:204] - Handshake completed: True
2025-01-02 17:23:39,340 - INFO - [session.py:205] - Use client cert: True
2025-01-02 17:23:39,341 - INFO - [session.py:206] - File to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 17:23:39,342 - INFO - [session.py:209] - Using encrypted exchange
2025-01-02 17:23:39,343 - INFO - [session.py:224] - Sending encrypted request data
2025-01-02 17:23:39,348 - INFO - [keys.py:185] - TLS Application Data sent from 192.168.1.1:12345 to 10.0.0.1:443
2025-01-02 17:23:39,350 - INFO - [session.py:235] - Sending encrypted response data
2025-01-02 17:23:39,353 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-02 17:23:39,354 - INFO - [session.py:247] - Attempting to send file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 17:23:39,355 - INFO - [session.py:258] - Opening file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 17:23:39,357 - INFO - [session.py:265] - Read 1103 bytes from file
2025-01-02 17:23:39,364 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-02 17:23:39,365 - INFO - [session.py:274] - File sent successfully
2025-01-02 17:23:39,366 - INFO - [session.py:249] - File sent successfully
2025-01-02 17:23:39,367 - INFO - [main.py:96] - Session completed successfully for 192.168.1.1
2025-01-02 17:23:39,368 - INFO - [main.py:88] - 
--- Client Session (no certificate) ---
2025-01-02 17:23:39,370 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-02 17:23:39,371 - INFO - [cert.py:108] - File exists: True
2025-01-02 17:23:39,372 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-02 17:23:39,373 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-02 17:23:39,374 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-02 17:23:39,375 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-02 17:23:39,378 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 17:23:39,380 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-02 17:23:39,383 - INFO - [cert.py:108] - File exists: True
2025-01-02 17:23:39,384 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-02 17:23:39,386 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-02 17:23:39,387 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-02 17:23:39,389 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-02 17:23:39,392 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 17:23:39,608 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-02 17:23:39,610 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-02 17:23:39,611 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-02 17:23:39,612 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-02 17:23:39,614 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-02 17:23:39,615 - INFO - [verify.py:58] - Public key comparison results:
2025-01-02 17:23:39,616 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 17:23:39,618 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 17:23:39,621 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-02 17:23:39,622 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-02 17:23:39,625 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-02 17:23:39,626 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-02 17:23:39,627 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-02 17:23:39,628 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-02 17:23:39,631 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-02 17:23:39,633 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-02 17:23:39,638 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-02 17:23:39,639 - INFO - [session.py:175] - Starting TLS session
2025-01-02 17:23:39,643 - INFO - [session.py:114] - Starting TLS Handshake...
2025-01-02 17:23:39,645 - INFO - [client.py:100] - Generated client_random: c2ad9ce5c2b26f5cb433b9be578608c848198fc49594e38bdaacdfd19b02d3f8
2025-01-02 17:23:39,667 - INFO - [client.py:143] - Client Hello sent from 192.168.1.2
2025-01-02 17:23:39,679 - INFO - [session.py:119] - Client Hello sent successfully
2025-01-02 17:23:39,681 - INFO - [server.py:94] - Generated server_random: 78684b962cca51df765d58626402da371e1d6a20cfe815d33b8b173263232dca
2025-01-02 17:23:39,701 - INFO - [session.py:124] - Server Hello received successfully
2025-01-02 17:23:39,703 - INFO - [client.py:180] - Prepared empty certificate
2025-01-02 17:23:39,705 - INFO - [client.py:192] - Encrypted pre_master_secret length: 256
2025-01-02 17:23:39,712 - INFO - [session.py:129] - Client handshake messages sent successfully
2025-01-02 17:23:39,718 - INFO - [session.py:134] - Server key pair verified successfully
2025-01-02 17:23:39,720 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-02 17:23:39,724 - INFO - [chain.py:185] - Decrypted pre_master_secret: 03037de3ff559cd6bed7aeab54a600c9d6c76b0a8eed796cbdb552691395668d2db419eb050f267166012958f1ffb414
2025-01-02 17:23:39,726 - INFO - [chain.py:195] - Generated master secret: 081ba8e6938598f978b537cc4709c372705a7a1e8e04b89533facca6159bfccfb1a99ad7a16a94c4034cadbbad1cc482
2025-01-02 17:23:39,727 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-02 17:23:39,729 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-02 17:23:39,730 - INFO - [session.py:138] - Master Secret handled successfully
2025-01-02 17:23:39,737 - INFO - [client.py:273] - Pre-master secret validated successfully
2025-01-02 17:23:39,744 - INFO - [client.py:291] - Generated digital signature: 58c418bf37a16be89ea6d61fb64aaa507ed7eb905f599c6bd08fde56341cb771e504c1e57cee816625b3553d1eb47610f96d9405996c52c47ce820dcabaca91713dc4c5bf365543a32e5ed91a717fc4761eec44f402bd14d5b8ff85945b17095659d72225151235ad14a6ce92b3243756cab533ea47ccd7c9d28c41b2b739ce8e914a6fa060d225368840652c1641c70aa9ed61a4ff94c60cf3f40640a41943bd8dbd6d77bc3d4a422a23429aa1422429f094320a8335a3965d314b4528f59a14fa3ac68b104bc58d7bfca2a5cd4037250b75024a95608860a4920ae09db2d8379f6b073dc46a4f888e7f09c9e660ed379d875b8f6cd0c83557909d118e2c562
2025-01-02 17:23:39,751 - INFO - [client.py:337] - Client ChangeCipherSpec and Finished messages sent
2025-01-02 17:23:39,754 - INFO - [session.py:143] - Client Change Cipher Spec sent successfully
2025-01-02 17:23:39,756 - INFO - [server.py:260] - Pre-master secret validated successfully
2025-01-02 17:23:39,759 - INFO - [server.py:278] - Generated digital signature: 11d7d8f0fad1c8c0eca91c119c0480f195ece02c5df3351b13a636e30b43bf0a02877b1b264182fa06a13b99393967301cceb545e0c3dbebdd6213b1111e8d4cf04cc661fb95b88fb9308838fec10c5f8ebcb41ebb5ded74569588c67ccd3a4ee440e6d26fedae1a2475a79ae1caba5c2831c789b787f4e6529ee069880b194f520655939ad291f54eca7a7814756c193210a99425439e3c647b05d1b87276ab5319fcfeb38a51a667a468521ef41dbbf076fdcc6e51d8eaf02a4542aa2b76a250178a13a912ce1723792629d33a27604a602709a4d9b4732811baa8234613fe2912f661b19a25d3038b8d3ee6b111d11469577754ca2bf849d7aef2d68acb62
2025-01-02 17:23:39,764 - INFO - [server.py:324] - Server ChangeCipherSpec and Finished messages sent
2025-01-02 17:23:39,767 - INFO - [session.py:148] - Server Change Cipher Spec received successfully
2025-01-02 17:23:39,769 - INFO - [keys.py:218] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-02 17:23:39,770 - INFO - [session.py:153] - SSL Key Log handled successfully
2025-01-02 17:23:39,771 - INFO - [session.py:157] - TLS Handshake completed successfully
2025-01-02 17:23:39,772 - INFO - [session.py:204] - Handshake completed: True
2025-01-02 17:23:39,772 - INFO - [session.py:205] - Use client cert: False
2025-01-02 17:23:39,773 - INFO - [session.py:206] - File to send: None
2025-01-02 17:23:39,773 - INFO - [session.py:212] - Using unencrypted exchange
2025-01-02 17:23:39,775 - INFO - [session.py:312] - Added request packet
2025-01-02 17:23:39,778 - INFO - [session.py:312] - Added response packet
2025-01-02 17:23:39,779 - WARNING - [session.py:289] - Using unencrypted communication
2025-01-02 17:23:39,781 - INFO - [main.py:96] - Session completed successfully for 192.168.1.2
2025-01-02 17:23:39,783 - INFO - [packet_validator.py:110] - Packet 13: Valid HTTP message
2025-01-02 17:23:39,784 - INFO - [packet_validator.py:110] - Packet 14: Valid HTTP message
2025-01-02 17:23:39,799 - INFO - [packet_storage.py:79] - Saved 15 valid packets to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-02 17:23:39,801 - INFO - [packet_storage.py:100] - Verifying 15 packets...
2025-01-02 17:23:39,802 - INFO - [packet_storage.py:104] - Packet 1: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 17:23:39,804 - INFO - [packet_storage.py:104] - Packet 2: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 17:23:39,805 - INFO - [packet_storage.py:104] - Packet 3: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 17:23:39,806 - INFO - [packet_storage.py:104] - Packet 4: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 17:23:39,807 - INFO - [packet_storage.py:104] - Packet 5: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 17:23:39,808 - INFO - [packet_storage.py:104] - Packet 6: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 17:23:39,809 - INFO - [packet_storage.py:104] - Packet 7: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 17:23:39,810 - INFO - [packet_storage.py:104] - Packet 8: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 17:23:39,812 - INFO - [packet_storage.py:104] - Packet 9: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-02 17:23:39,814 - INFO - [packet_storage.py:104] - Packet 10: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-02 17:23:39,815 - INFO - [packet_storage.py:104] - Packet 11: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-02 17:23:39,816 - INFO - [packet_storage.py:104] - Packet 12: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-02 17:23:39,817 - INFO - [packet_storage.py:104] - Packet 13: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-02 17:23:39,818 - INFO - [packet_storage.py:104] - Packet 14: IP / TCP 192.168.1.2:12346 > 10.0.0.1:http PA / Raw
2025-01-02 17:23:39,819 - INFO - [packet_storage.py:104] - Packet 15: IP / TCP 10.0.0.1:http > 192.168.1.2:12346 PA / Raw
2025-01-02 17:23:39,820 - INFO - [packet_storage.py:111] - Verification complete: 15 valid packets, 13 TLS records
2025-01-02 17:23:39,821 - INFO - [main.py:107] - Results saved to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-02 17:23:39,822 - INFO - [main.py:161] - TLS session simulation completed successfully
2025-01-02 17:31:34,646 - INFO - [logging.py:83] - Logging configured successfully
2025-01-02 17:31:34,649 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-02 17:31:34,650 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-02 17:31:34,651 - INFO - [logging.py:92] - Log level: 20
2025-01-02 17:31:34,652 - INFO - [logging.py:93] - Timestamp: 2025-01-02T17:31:34.652613
2025-01-02 17:31:34,653 - INFO - [logging.py:94] - ==========================
2025-01-02 17:31:34,654 - INFO - [main.py:123] - Starting TLS session simulation
2025-01-02 17:31:34,657 - INFO - [main.py:88] - 
--- Client Session (certificate) ---
2025-01-02 17:31:34,661 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-02 17:31:34,663 - INFO - [cert.py:108] - File exists: True
2025-01-02 17:31:34,664 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-02 17:31:34,667 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-02 17:31:34,668 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-02 17:31:34,669 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-02 17:31:34,681 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 17:31:34,683 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-02 17:31:34,685 - INFO - [cert.py:108] - File exists: True
2025-01-02 17:31:34,686 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-02 17:31:34,688 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-02 17:31:34,690 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-02 17:31:34,691 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-02 17:31:34,695 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 17:31:34,816 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-02 17:31:34,818 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-02 17:31:34,819 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-02 17:31:34,821 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-02 17:31:34,829 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-02 17:31:34,830 - INFO - [verify.py:58] - Public key comparison results:
2025-01-02 17:31:34,831 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 17:31:34,834 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 17:31:34,836 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-02 17:31:34,837 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-02 17:31:34,844 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-02 17:31:34,846 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-02 17:31:34,847 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-02 17:31:34,849 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-02 17:31:34,850 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-02 17:31:34,851 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-02 17:31:34,855 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-02 17:31:34,857 - INFO - [session.py:175] - Starting TLS session
2025-01-02 17:31:34,859 - INFO - [session.py:114] - Starting TLS Handshake...
2025-01-02 17:31:34,861 - INFO - [client.py:100] - Generated client_random: 22971b6f0baa7e49703ed6bfff95912644ecd782116edfb3abe85272b4dfd525
2025-01-02 17:31:34,869 - INFO - [client.py:143] - Client Hello sent from 192.168.1.1
2025-01-02 17:31:34,876 - ERROR - [main.py:28] - Session error: Session failed for 192.168.1.1: Session failed: Failed to send Client Hello: Failed to send TLS packet: cannot unpack non-iterable NoneType object
2025-01-02 17:35:20,106 - INFO - [logging.py:83] - Logging configured successfully
2025-01-02 17:35:20,109 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-02 17:35:20,110 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-02 17:35:20,112 - INFO - [logging.py:92] - Log level: 20
2025-01-02 17:35:20,113 - INFO - [logging.py:93] - Timestamp: 2025-01-02T17:35:20.112952
2025-01-02 17:35:20,114 - INFO - [logging.py:94] - ==========================
2025-01-02 17:35:20,115 - INFO - [main.py:123] - Starting TLS session simulation
2025-01-02 17:35:20,116 - INFO - [main.py:88] - 
--- Client Session (certificate) ---
2025-01-02 17:35:20,121 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-02 17:35:20,123 - INFO - [cert.py:108] - File exists: True
2025-01-02 17:35:20,125 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-02 17:35:20,127 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-02 17:35:20,129 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-02 17:35:20,130 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-02 17:35:20,142 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 17:35:20,145 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-02 17:35:20,147 - INFO - [cert.py:108] - File exists: True
2025-01-02 17:35:20,149 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-02 17:35:20,152 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-02 17:35:20,153 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-02 17:35:20,155 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-02 17:35:20,158 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 17:35:20,292 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-02 17:35:20,294 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-02 17:35:20,296 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-02 17:35:20,299 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-02 17:35:20,309 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-02 17:35:20,310 - INFO - [verify.py:58] - Public key comparison results:
2025-01-02 17:35:20,312 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 17:35:20,315 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 17:35:20,318 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-02 17:35:20,319 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-02 17:35:20,328 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-02 17:35:20,330 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-02 17:35:20,331 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-02 17:35:20,332 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-02 17:35:20,334 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-02 17:35:20,336 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-02 17:35:20,340 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-02 17:35:20,342 - INFO - [session.py:175] - Starting TLS session
2025-01-02 17:35:20,343 - INFO - [session.py:114] - Starting TLS Handshake...
2025-01-02 17:35:20,343 - INFO - [client.py:100] - Generated client_random: 3b7b233c5943dac04a02821da55989d6d630a25109736d92bd42c5e42c20b6f4
2025-01-02 17:35:20,350 - INFO - [client.py:143] - Client Hello sent from 192.168.1.1
2025-01-02 17:35:20,359 - INFO - [session.py:119] - Client Hello sent successfully
2025-01-02 17:35:20,360 - INFO - [server.py:94] - Generated server_random: 4ddf140d54990b5fc279aeb451c4da6342dc7018f49f408b6d439f8b9f1e626e
2025-01-02 17:35:20,374 - INFO - [session.py:124] - Server Hello received successfully
2025-01-02 17:35:20,375 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2025-01-02 17:35:20,377 - INFO - [cert.py:108] - File exists: True
2025-01-02 17:35:20,379 - INFO - [cert.py:109] - File size: 1915 bytes
2025-01-02 17:35:20,380 - INFO - [cert.py:113] - Read 1915 bytes
2025-01-02 17:35:20,381 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2025-01-02 17:35:20,382 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2025-01-02 17:35:20,385 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 17:35:20,387 - INFO - [client.py:177] - Prepared client certificate
2025-01-02 17:35:20,389 - INFO - [client.py:192] - Encrypted pre_master_secret length: 256
2025-01-02 17:35:20,394 - INFO - [session.py:129] - Client handshake messages sent successfully
2025-01-02 17:35:20,398 - INFO - [session.py:134] - Server key pair verified successfully
2025-01-02 17:35:20,399 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-02 17:35:20,403 - INFO - [chain.py:185] - Decrypted pre_master_secret: 0303d6a9cef3d6b6cadddb591b83b097bb10c0c7933dcd366652aa7df06e1138737f9404d15e7e4ea8e295d0ae674783
2025-01-02 17:35:20,404 - INFO - [chain.py:195] - Generated master secret: 4ae065e78411a694bb4514c568a6d853e1b7005f79a02e84e9a7a74a142563d571a7535548645c7157f1842713fbabeb
2025-01-02 17:35:20,406 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-02 17:35:20,407 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-02 17:35:20,408 - INFO - [session.py:138] - Master Secret handled successfully
2025-01-02 17:35:20,413 - INFO - [client.py:273] - Pre-master secret validated successfully
2025-01-02 17:35:20,419 - INFO - [client.py:291] - Generated digital signature: c83e14a4c79a206d66a40084813a3f6a92e2d18f27a2f6c853b51c87d795e9d2232b84dbadd56a5a4e5c02fa286c66f69e1a9cfb06d127ca7e4205d36fee78e461c2aa9d73799b980f821030eff2585f7b7245b7a9925e2a562193be4dec9975f3a33214845d6e6fde7cae020b63acd0da5236a6257243c9e9b23363c3aa78ec2ae73fdde9e0849b9e03c1aad96016dfda5a6fc131285c37aef3c2b89e05d65d35f873eeb9f00f7262a864d8847fbc951141b0b5c01dd61c1dafe5f70e5f6a8168b165ebcf4446a9a8c24582a051b20423f21d19553291e52842db6f3b2293d3925e5b891e410168501fbe4e1b39d73b72cc6cff2275b993ef5fd242a3711334
2025-01-02 17:35:20,428 - INFO - [client.py:337] - Client ChangeCipherSpec and Finished messages sent
2025-01-02 17:35:20,431 - INFO - [session.py:143] - Client Change Cipher Spec sent successfully
2025-01-02 17:35:20,435 - INFO - [server.py:260] - Pre-master secret validated successfully
2025-01-02 17:35:20,438 - INFO - [server.py:278] - Generated digital signature: 9ddcadb13498b7584370442877e01344a9a54460fa267b1219987fd69a763ae0a26b76402d942f5ea072366e6532eef8a63dd7e17bc94d13e59cdc556dc82330b2e864da24bc6fcd848e98486f9db557eec429871791445913017c056b50f3c2251c770fb36b48aadfcc56f13acfd4c96badee0a9251d3b6c117cf0b670ebdbebed22f98d5316f2d6d794277921a7be0faf4db4d341ce61ca1fa1d32a246d69915343dd8b437135fea4eea1493e8a85be9192498f9c251aba1743f66bdb2bf0edfa6794a1a46b8f67f9d3755ae53692c5d82d1f1538e53572cb341ab6cc1d12e1bbe4e9073b3dd3e26eba8fa636d07da7e065677add7374667214f730ac0b7d1
2025-01-02 17:35:20,443 - INFO - [server.py:324] - Server ChangeCipherSpec and Finished messages sent
2025-01-02 17:35:20,446 - INFO - [session.py:148] - Server Change Cipher Spec received successfully
2025-01-02 17:35:20,448 - INFO - [keys.py:218] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-02 17:35:20,449 - INFO - [session.py:153] - SSL Key Log handled successfully
2025-01-02 17:35:20,450 - INFO - [session.py:157] - TLS Handshake completed successfully
2025-01-02 17:35:20,452 - INFO - [session.py:186] - Found file to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 17:35:20,453 - INFO - [session.py:204] - Handshake completed: True
2025-01-02 17:35:20,454 - INFO - [session.py:205] - Use client cert: True
2025-01-02 17:35:20,455 - INFO - [session.py:206] - File to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 17:35:20,458 - INFO - [session.py:209] - Using encrypted exchange
2025-01-02 17:35:20,459 - INFO - [session.py:224] - Sending encrypted request data
2025-01-02 17:35:20,464 - INFO - [keys.py:185] - TLS Application Data sent from 192.168.1.1:12345 to 10.0.0.1:443
2025-01-02 17:35:20,465 - INFO - [session.py:235] - Sending encrypted response data
2025-01-02 17:35:20,470 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-02 17:35:20,472 - INFO - [session.py:247] - Attempting to send file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 17:35:20,474 - INFO - [session.py:258] - Opening file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 17:35:20,476 - INFO - [session.py:265] - Read 1103 bytes from file
2025-01-02 17:35:20,480 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-02 17:35:20,481 - INFO - [session.py:274] - File sent successfully
2025-01-02 17:35:20,483 - INFO - [session.py:249] - File sent successfully
2025-01-02 17:35:20,484 - INFO - [main.py:96] - Session completed successfully for 192.168.1.1
2025-01-02 17:35:20,485 - INFO - [main.py:88] - 
--- Client Session (no certificate) ---
2025-01-02 17:35:20,489 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-02 17:35:20,490 - INFO - [cert.py:108] - File exists: True
2025-01-02 17:35:20,491 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-02 17:35:20,493 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-02 17:35:20,494 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-02 17:35:20,495 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-02 17:35:20,497 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 17:35:20,498 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-02 17:35:20,500 - INFO - [cert.py:108] - File exists: True
2025-01-02 17:35:20,502 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-02 17:35:20,503 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-02 17:35:20,505 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-02 17:35:20,506 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-02 17:35:20,508 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 17:35:20,608 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-02 17:35:20,610 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-02 17:35:20,611 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-02 17:35:20,612 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-02 17:35:20,614 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-02 17:35:20,615 - INFO - [verify.py:58] - Public key comparison results:
2025-01-02 17:35:20,616 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 17:35:20,619 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 17:35:20,622 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-02 17:35:20,623 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-02 17:35:20,625 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-02 17:35:20,627 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-02 17:35:20,628 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-02 17:35:20,630 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-02 17:35:20,632 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-02 17:35:20,634 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-02 17:35:20,640 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-02 17:35:20,643 - INFO - [session.py:175] - Starting TLS session
2025-01-02 17:35:20,643 - INFO - [session.py:114] - Starting TLS Handshake...
2025-01-02 17:35:20,644 - INFO - [client.py:100] - Generated client_random: fd1a77eb722d11216d8ed870d451a58593ad0ba315e441a1e70877ff16feb3bf
2025-01-02 17:35:20,652 - INFO - [client.py:143] - Client Hello sent from 192.168.1.2
2025-01-02 17:35:20,657 - INFO - [session.py:119] - Client Hello sent successfully
2025-01-02 17:35:20,658 - INFO - [server.py:94] - Generated server_random: 7e8acf58f1e89fdd89feb0b53e8132708b17cca526d9147b62ceb899f6cd3238
2025-01-02 17:35:20,670 - INFO - [session.py:124] - Server Hello received successfully
2025-01-02 17:35:20,672 - INFO - [client.py:180] - Prepared empty certificate
2025-01-02 17:35:20,673 - INFO - [client.py:192] - Encrypted pre_master_secret length: 256
2025-01-02 17:35:20,678 - INFO - [session.py:129] - Client handshake messages sent successfully
2025-01-02 17:35:20,686 - INFO - [session.py:134] - Server key pair verified successfully
2025-01-02 17:35:20,688 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-02 17:35:20,690 - INFO - [chain.py:185] - Decrypted pre_master_secret: 0303c454e25aab247adbf10d7775c872397a5b0a257d8449a3acd42322b8e9c3cbce273dadfc7669385fe0b72c9140a3
2025-01-02 17:35:20,692 - INFO - [chain.py:195] - Generated master secret: 7762cbf1bdfa0ee2f378b65256ec53270cb3b5b9b072c3179dc4aa9971d2dde2778d545451a2cd53fc756e7c2979b289
2025-01-02 17:35:20,694 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-02 17:35:20,695 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-02 17:35:20,696 - INFO - [session.py:138] - Master Secret handled successfully
2025-01-02 17:35:20,701 - INFO - [client.py:273] - Pre-master secret validated successfully
2025-01-02 17:35:20,705 - INFO - [client.py:291] - Generated digital signature: 4145efe17ef0e16cd94528b7dfdcb04a3f20f4b9fd909630df1d94b2ffc092d06c78d8a2c3739a3040f3efe759c654d2d6168dc807554cff15bbd536df35ec8099bc0ee8c838ad77d25571726f3bc3d3b8d66c97c7997919a0aaa7487209b1cbbee9aea4e8b5551fe04a300a9386e76dda516dba83fef1dbb31ffc25af2c90038998244be533b65a3d03d53e5b7183ba4db4578771b2e0807313f711d8cfb3e458a64d82faab4979f647bcf8f2f447dd336deb1e32bb1ff013b247876a4a6dd3bbd5b34660fcf07137982433d67ea4e629602aa4714e6f0ed213dc0da70c9daf40f9e4deded738923972ea9b4b32ed2342bf26d5cdbe522261a6ec640b082ad0
2025-01-02 17:35:20,711 - INFO - [client.py:337] - Client ChangeCipherSpec and Finished messages sent
2025-01-02 17:35:20,714 - INFO - [session.py:143] - Client Change Cipher Spec sent successfully
2025-01-02 17:35:20,719 - INFO - [server.py:260] - Pre-master secret validated successfully
2025-01-02 17:35:20,725 - INFO - [server.py:278] - Generated digital signature: 63a8d5882f3fad27599254e640588e9ee63b88f1eb4e35b228132c8057f9cd0fceafc891598c6bafc184893efabc890af683b59bb926f5e7d1b48d4808930cc3c8dc52a3ba84b5fdaea1f36d99b55ed40d455ba5679b30aea0746166ab3a28b426e869c0b8a972d82d2f6a84b9aa7e5178a81af75b7473245c34f6041b4dbdd867a8f9c49076179dc9467e3e2ff13bcc53885ce4eed2bf979d19887d69ce79864df07539ffd4dbd60ec1e53621a10b5c5cd63e9924ac38879a2407808e7b9a1328543d223300313286bdf24bbe71ce4b2709a8a1fb90bddd37358318637f67a35790d985735b40b5cd0e2746a4e7e18c1b744d7fcdefb651903dfd76cd99bd8b
2025-01-02 17:35:20,729 - INFO - [server.py:324] - Server ChangeCipherSpec and Finished messages sent
2025-01-02 17:35:20,733 - INFO - [session.py:148] - Server Change Cipher Spec received successfully
2025-01-02 17:35:20,736 - INFO - [keys.py:218] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-02 17:35:20,737 - INFO - [session.py:153] - SSL Key Log handled successfully
2025-01-02 17:35:20,738 - INFO - [session.py:157] - TLS Handshake completed successfully
2025-01-02 17:35:20,740 - INFO - [session.py:204] - Handshake completed: True
2025-01-02 17:35:20,741 - INFO - [session.py:205] - Use client cert: False
2025-01-02 17:35:20,742 - INFO - [session.py:206] - File to send: None
2025-01-02 17:35:20,744 - INFO - [session.py:212] - Using unencrypted exchange
2025-01-02 17:35:20,746 - INFO - [session.py:312] - Added request packet
2025-01-02 17:35:20,748 - INFO - [session.py:312] - Added response packet
2025-01-02 17:35:20,749 - WARNING - [session.py:289] - Using unencrypted communication
2025-01-02 17:35:20,750 - INFO - [main.py:96] - Session completed successfully for 192.168.1.2
2025-01-02 17:35:20,752 - INFO - [packet_validator.py:110] - Packet 13: Valid HTTP message
2025-01-02 17:35:20,753 - INFO - [packet_validator.py:110] - Packet 14: Valid HTTP message
2025-01-02 17:35:20,775 - INFO - [packet_storage.py:79] - Saved 15 valid packets to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-02 17:35:20,777 - INFO - [packet_storage.py:100] - Verifying 15 packets...
2025-01-02 17:35:20,778 - INFO - [packet_storage.py:104] - Packet 1: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 17:35:20,780 - INFO - [packet_storage.py:104] - Packet 2: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 17:35:20,781 - INFO - [packet_storage.py:104] - Packet 3: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 17:35:20,782 - INFO - [packet_storage.py:104] - Packet 4: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 17:35:20,783 - INFO - [packet_storage.py:104] - Packet 5: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 17:35:20,785 - INFO - [packet_storage.py:104] - Packet 6: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 17:35:20,786 - INFO - [packet_storage.py:104] - Packet 7: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 17:35:20,788 - INFO - [packet_storage.py:104] - Packet 8: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 17:35:20,790 - INFO - [packet_storage.py:104] - Packet 9: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-02 17:35:20,799 - INFO - [packet_storage.py:104] - Packet 10: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-02 17:35:20,801 - INFO - [packet_storage.py:104] - Packet 11: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-02 17:35:20,803 - INFO - [packet_storage.py:104] - Packet 12: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-02 17:35:20,804 - INFO - [packet_storage.py:104] - Packet 13: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-02 17:35:20,806 - INFO - [packet_storage.py:104] - Packet 14: IP / TCP 192.168.1.2:12346 > 10.0.0.1:http PA / Raw
2025-01-02 17:35:20,808 - INFO - [packet_storage.py:104] - Packet 15: IP / TCP 10.0.0.1:http > 192.168.1.2:12346 PA / Raw
2025-01-02 17:35:20,809 - INFO - [packet_storage.py:111] - Verification complete: 15 valid packets, 13 TLS records
2025-01-02 17:35:20,810 - INFO - [main.py:107] - Results saved to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-02 17:35:20,812 - INFO - [main.py:161] - TLS session simulation completed successfully
2025-01-02 18:25:11,928 - INFO - [logging.py:83] - Logging configured successfully
2025-01-02 18:25:11,929 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-02 18:25:11,930 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-02 18:25:11,930 - INFO - [logging.py:92] - Log level: 20
2025-01-02 18:25:11,931 - INFO - [logging.py:93] - Timestamp: 2025-01-02T18:25:11.931014
2025-01-02 18:25:11,931 - INFO - [logging.py:94] - ==========================
2025-01-02 18:25:11,931 - INFO - [main.py:123] - Starting TLS session simulation
2025-01-02 18:25:11,932 - INFO - [main.py:88] - 
--- Client Session (certificate) ---
2025-01-02 18:25:11,933 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-02 18:25:11,934 - INFO - [cert.py:108] - File exists: True
2025-01-02 18:25:11,934 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-02 18:25:11,937 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-02 18:25:11,938 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-02 18:25:11,938 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-02 18:25:11,945 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 18:25:11,946 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-02 18:25:11,947 - INFO - [cert.py:108] - File exists: True
2025-01-02 18:25:11,947 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-02 18:25:11,950 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-02 18:25:11,950 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-02 18:25:11,951 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-02 18:25:11,952 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 18:25:12,019 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-02 18:25:12,020 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-02 18:25:12,021 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-02 18:25:12,024 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-02 18:25:12,048 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-02 18:25:12,049 - INFO - [verify.py:59] - Public key comparison results:
2025-01-02 18:25:12,049 - INFO - [verify.py:60] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 18:25:12,051 - INFO - [verify.py:61] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 18:25:12,054 - INFO - [verify.py:62] - Certificate exponent (e): 0x10001
2025-01-02 18:25:12,055 - INFO - [verify.py:63] - Loaded key exponent (e): 0x10001
2025-01-02 18:25:12,063 - INFO - [verify.py:137] - Certificate chain verification successful
2025-01-02 18:25:12,065 - INFO - [verify.py:189] - Server name 'Pasdaran.local' verified successfully.
2025-01-02 18:25:12,066 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-02 18:25:12,067 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-02 18:25:12,067 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-02 18:25:12,068 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-02 18:25:12,071 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-02 18:25:12,073 - INFO - [session.py:207] - Starting TLS session
2025-01-02 18:25:12,075 - INFO - [session.py:116] - Starting TLS Handshake...
2025-01-02 18:25:12,076 - INFO - [client.py:100] - Generated client_random: b6badf78658a351b05df01e4f02cbefd2256ee7995b34d0d4aa1660c59c5c57d
2025-01-02 18:25:12,082 - INFO - [client.py:143] - Client Hello sent from 192.168.1.1
2025-01-02 18:25:12,087 - INFO - [session.py:121] - Client Hello sent successfully
2025-01-02 18:25:12,088 - INFO - [server.py:94] - Generated server_random: b2bd11d30f9f991ed2f4119f514040036cb8911055fdbeaa9e05df38b2c4744b
2025-01-02 18:25:12,113 - INFO - [session.py:126] - Server Hello received successfully
2025-01-02 18:25:12,115 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2025-01-02 18:25:12,117 - INFO - [cert.py:108] - File exists: True
2025-01-02 18:25:12,118 - INFO - [cert.py:109] - File size: 1915 bytes
2025-01-02 18:25:12,137 - INFO - [cert.py:113] - Read 1915 bytes
2025-01-02 18:25:12,138 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2025-01-02 18:25:12,139 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2025-01-02 18:25:12,142 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 18:25:12,144 - INFO - [client.py:177] - Prepared client certificate
2025-01-02 18:25:12,146 - INFO - [client.py:192] - Encrypted pre_master_secret length: 256
2025-01-02 18:25:12,149 - INFO - [session.py:131] - Client handshake messages sent successfully
2025-01-02 18:25:12,153 - INFO - [session.py:136] - Server key pair verified successfully
2025-01-02 18:25:12,154 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-02 18:25:12,157 - INFO - [chain.py:185] - Decrypted pre_master_secret: 03036398cc4fb0a559cc7d8c8694af7a7b3591a79fa3589b66f5ae703b7854bf1562baad69087d26d9a326fb05ae12c8
2025-01-02 18:25:12,159 - INFO - [chain.py:195] - Generated master secret: 094ea88c0136e733e3341fbb36570a041e44c28705ff9eea2dff52611274e7bb62ad1bfc2e7bc25c0d091577ff1fbf77
2025-01-02 18:25:12,161 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-02 18:25:12,162 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-02 18:25:12,163 - INFO - [session.py:140] - Master Secret handled successfully
2025-01-02 18:25:12,165 - INFO - [client.py:273] - Pre-master secret validated successfully
2025-01-02 18:25:12,167 - INFO - [client.py:291] - Generated digital signature: aaa818f3b3483daeaa5b3e42bc6c5534ef054754ab11b15c62a4bcace5ab609e278c357e857c513b579119ef544c3e47bd9f834461cb9979e5803d551f0c7519db9be8a7617b56ff0161dfa2bb86c41e59ee45540c273baa60b811ee368b04bd4fc97e02e30e7beb35b2972b92d39cdcc2abe86e380a037c1cc79eb41d3e466341a11bfed7acbd5ab2c4a21670901a8804f2ae3d37c3023269ab5ee988a3277edb89df3e79dc12d9c8b48f76d00aa580384fd77ee408f9812388947c182c966024341a1b24e4c4ae82e5b39a40f16c020c8a3747e97f395e2fe7c8dad82ead471562455e7a49f343066200e4724e9d9c2317c6aeeff7bc7cd857edc45564e92b
2025-01-02 18:25:12,173 - INFO - [client.py:337] - Client ChangeCipherSpec and Finished messages sent
2025-01-02 18:25:12,176 - INFO - [session.py:145] - Client Change Cipher Spec sent successfully
2025-01-02 18:25:12,179 - INFO - [server.py:260] - Pre-master secret validated successfully
2025-01-02 18:25:12,181 - INFO - [server.py:278] - Generated digital signature: 3a2a44da43eebf25a72d3e0e79d82911aa0d012f14eaffa9fd0a3acdb73f6015953cc4633faf116497706ff5c9155a6192cada6695bf550f9203fa051d9ea853693caed4585ade824b0007ab77a2588917a412c63765728d1629d05fb2407751b830dd792d11b6b80bb74655b3ba7066bc2a1693c7bfcea32dba95a473d7ca2b8cbc3d1a0904eeb908c21344946f226e0fc1b81bf54056dd53d5c3079cc5620151a90ea903a6e888cad777eb6a4ce4553e8d54653cddeaecd3183b257389ea176a310a053c54386ac26f62be57a33cd2bbe96748c8973ae7bc37b3095b9dc8bec95595db8e83b45031bca51db06ff408b045dc6730069fda26061f60659ec36d
2025-01-02 18:25:12,185 - INFO - [server.py:324] - Server ChangeCipherSpec and Finished messages sent
2025-01-02 18:25:12,188 - INFO - [session.py:150] - Server Change Cipher Spec received successfully
2025-01-02 18:25:12,191 - INFO - [keys.py:218] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-02 18:25:12,192 - INFO - [session.py:155] - SSL Key Log handled successfully
2025-01-02 18:25:12,192 - INFO - [session.py:159] - TLS Handshake completed successfully
2025-01-02 18:25:12,193 - INFO - [session.py:218] - Found file to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 18:25:12,194 - INFO - [session.py:236] - Handshake completed: True
2025-01-02 18:25:12,195 - INFO - [session.py:237] - Use client cert: True
2025-01-02 18:25:12,195 - INFO - [session.py:238] - File to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 18:25:12,196 - INFO - [session.py:241] - Using encrypted exchange
2025-01-02 18:25:12,197 - INFO - [session.py:256] - Sending encrypted request data
2025-01-02 18:25:12,199 - INFO - [keys.py:185] - TLS Application Data sent from 192.168.1.1:12345 to 10.0.0.1:443
2025-01-02 18:25:12,200 - INFO - [session.py:267] - Sending encrypted response data
2025-01-02 18:25:12,202 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-02 18:25:12,203 - INFO - [session.py:279] - Attempting to send file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 18:25:12,204 - INFO - [session.py:290] - Opening file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 18:25:12,206 - INFO - [session.py:297] - Read 1103 bytes from file
2025-01-02 18:25:12,210 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-02 18:25:12,211 - INFO - [session.py:306] - File sent successfully
2025-01-02 18:25:12,212 - INFO - [session.py:281] - File sent successfully
2025-01-02 18:25:12,212 - INFO - [main.py:96] - Session completed successfully for 192.168.1.1
2025-01-02 18:25:12,213 - INFO - [main.py:88] - 
--- Client Session (no certificate) ---
2025-01-02 18:25:12,215 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-02 18:25:12,216 - INFO - [cert.py:108] - File exists: True
2025-01-02 18:25:12,217 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-02 18:25:12,217 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-02 18:25:12,218 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-02 18:25:12,218 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-02 18:25:12,219 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 18:25:12,220 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-02 18:25:12,222 - INFO - [cert.py:108] - File exists: True
2025-01-02 18:25:12,223 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-02 18:25:12,225 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-02 18:25:12,226 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-02 18:25:12,227 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-02 18:25:12,228 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 18:25:12,263 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-02 18:25:12,264 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-02 18:25:12,264 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-02 18:25:12,265 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-02 18:25:12,265 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-02 18:25:12,266 - INFO - [verify.py:59] - Public key comparison results:
2025-01-02 18:25:12,266 - INFO - [verify.py:60] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 18:25:12,267 - INFO - [verify.py:61] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 18:25:12,268 - INFO - [verify.py:62] - Certificate exponent (e): 0x10001
2025-01-02 18:25:12,268 - INFO - [verify.py:63] - Loaded key exponent (e): 0x10001
2025-01-02 18:25:12,269 - INFO - [verify.py:137] - Certificate chain verification successful
2025-01-02 18:25:12,269 - INFO - [verify.py:189] - Server name 'Pasdaran.local' verified successfully.
2025-01-02 18:25:12,270 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-02 18:25:12,270 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-02 18:25:12,271 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-02 18:25:12,272 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-02 18:25:12,276 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-02 18:25:12,277 - INFO - [session.py:207] - Starting TLS session
2025-01-02 18:25:12,277 - INFO - [session.py:116] - Starting TLS Handshake...
2025-01-02 18:25:12,278 - INFO - [client.py:100] - Generated client_random: c027b089da0c83ad774e4808563fe5e03b180de424685d6c7fd9abeb3f3c05ba
2025-01-02 18:25:12,280 - INFO - [client.py:143] - Client Hello sent from 192.168.1.2
2025-01-02 18:25:12,283 - INFO - [session.py:121] - Client Hello sent successfully
2025-01-02 18:25:12,283 - INFO - [server.py:94] - Generated server_random: af89f862827aa98b43f7286c0708a519dba0f69b0557d09dbbecf8e55fa3ab37
2025-01-02 18:25:12,287 - INFO - [session.py:126] - Server Hello received successfully
2025-01-02 18:25:12,288 - INFO - [client.py:180] - Prepared empty certificate
2025-01-02 18:25:12,289 - INFO - [client.py:192] - Encrypted pre_master_secret length: 256
2025-01-02 18:25:12,293 - INFO - [session.py:131] - Client handshake messages sent successfully
2025-01-02 18:25:12,297 - INFO - [session.py:136] - Server key pair verified successfully
2025-01-02 18:25:12,298 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-02 18:25:12,300 - INFO - [chain.py:185] - Decrypted pre_master_secret: 03039bb51dc5fe5acc926784bdecf7a21e2c12c7ab2e7d0f31d2814eced903ff2bc02d556a20e3b026a01082d44671be
2025-01-02 18:25:12,301 - INFO - [chain.py:195] - Generated master secret: 7efb30502ef61e4358824c259bc5f4650d82fc179fa0db701c8eb5f9fde66490cc2a9dfb191f9b3a8dab8039a44142b6
2025-01-02 18:25:12,302 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-02 18:25:12,302 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-02 18:25:12,303 - INFO - [session.py:140] - Master Secret handled successfully
2025-01-02 18:25:12,306 - INFO - [client.py:273] - Pre-master secret validated successfully
2025-01-02 18:25:12,308 - INFO - [client.py:291] - Generated digital signature: 1308cd2dfdcc23104a847a8ad6385536589b237cc936e59623d46e525ddefbf72fb563128b798716cf3fa01b7bc55046d024a83b44437d9e84d641bdb43ab836fbee4c003f662f629bff6ef2bdf5fecbdf8e3bad7d11714384caa69147639d2d3d7238e7d492990b356bf7565499b747c835f575defec2a6c56821660ae71980f172178613611e281f4b0fbb92a30334ed581cc6487e5428a6b41526fb307dd1823ffb515e0c2f5f163fab42bffa6bd72db78b812f58ce33d241a51d29c76fa7d78769918b2a76d6c628c94805c0a6cf676fd917ec9d700eb16843df78b4975c765f3d8b4845d9df378c8bf2a70455ff247a5931bfff3a6b44dda13b30435077
2025-01-02 18:25:12,311 - INFO - [client.py:337] - Client ChangeCipherSpec and Finished messages sent
2025-01-02 18:25:12,313 - INFO - [session.py:145] - Client Change Cipher Spec sent successfully
2025-01-02 18:25:12,314 - INFO - [server.py:260] - Pre-master secret validated successfully
2025-01-02 18:25:12,315 - INFO - [server.py:278] - Generated digital signature: 69c70f9ef2da00d656c185fbc41aa999c8998fdfc23b79fa2a34215d659e844b11cce550c269a2bfe4a2cdeea51de687361df777a565f2b64c180f084b1f6e2d109f8a4a4f511d24b61d012d3871504978d529f0d44e312e7243761cb2484d5bd11ec90c5ef018a26c44207a670caa34376ce14811fe936067c2036772fac8e6ba453b2927ecfaf20db9bdf58f5d4356a5fc80ac86226ec4826888133054e1cc279cf5aaed17a6e00caedada1bc7d2873c5542cc43356298b82653eb3bfa5580c071aee411aa4c03bcd28929ed62591671ff496587f2aeed1ae1878edaa56c533aa1d88fa3c214118bb5b56aa25ae7a5f47e786fe08f0a3fdbd5dc10bcc38ed9
2025-01-02 18:25:12,317 - INFO - [server.py:324] - Server ChangeCipherSpec and Finished messages sent
2025-01-02 18:25:12,319 - INFO - [session.py:150] - Server Change Cipher Spec received successfully
2025-01-02 18:25:12,320 - INFO - [keys.py:218] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-02 18:25:12,320 - INFO - [session.py:155] - SSL Key Log handled successfully
2025-01-02 18:25:12,321 - INFO - [session.py:159] - TLS Handshake completed successfully
2025-01-02 18:25:12,321 - INFO - [session.py:236] - Handshake completed: True
2025-01-02 18:25:12,322 - INFO - [session.py:237] - Use client cert: False
2025-01-02 18:25:12,323 - INFO - [session.py:238] - File to send: None
2025-01-02 18:25:12,324 - INFO - [session.py:244] - Using unencrypted exchange
2025-01-02 18:25:12,325 - INFO - [session.py:344] - Added request packet
2025-01-02 18:25:12,327 - INFO - [session.py:344] - Added response packet
2025-01-02 18:25:12,327 - WARNING - [session.py:321] - Using unencrypted communication
2025-01-02 18:25:12,328 - INFO - [main.py:96] - Session completed successfully for 192.168.1.2
2025-01-02 18:25:12,329 - INFO - [packet_validator.py:110] - Packet 13: Valid HTTP message
2025-01-02 18:25:12,329 - INFO - [packet_validator.py:110] - Packet 14: Valid HTTP message
2025-01-02 18:25:12,339 - INFO - [packet_storage.py:79] - Saved 15 valid packets to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-02 18:25:12,341 - INFO - [packet_storage.py:100] - Verifying 15 packets...
2025-01-02 18:25:12,342 - INFO - [packet_storage.py:104] - Packet 1: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 18:25:12,345 - INFO - [packet_storage.py:104] - Packet 2: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 18:25:12,347 - INFO - [packet_storage.py:104] - Packet 3: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 18:25:12,348 - INFO - [packet_storage.py:104] - Packet 4: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 18:25:12,349 - INFO - [packet_storage.py:104] - Packet 5: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 18:25:12,350 - INFO - [packet_storage.py:104] - Packet 6: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 18:25:12,351 - INFO - [packet_storage.py:104] - Packet 7: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 18:25:12,352 - INFO - [packet_storage.py:104] - Packet 8: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 18:25:12,353 - INFO - [packet_storage.py:104] - Packet 9: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-02 18:25:12,354 - INFO - [packet_storage.py:104] - Packet 10: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-02 18:25:12,357 - INFO - [packet_storage.py:104] - Packet 11: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-02 18:25:12,359 - INFO - [packet_storage.py:104] - Packet 12: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-02 18:25:12,362 - INFO - [packet_storage.py:104] - Packet 13: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-02 18:25:12,363 - INFO - [packet_storage.py:104] - Packet 14: IP / TCP 192.168.1.2:12346 > 10.0.0.1:http PA / Raw
2025-01-02 18:25:12,364 - INFO - [packet_storage.py:104] - Packet 15: IP / TCP 10.0.0.1:http > 192.168.1.2:12346 PA / Raw
2025-01-02 18:25:12,365 - INFO - [packet_storage.py:111] - Verification complete: 15 valid packets, 13 TLS records
2025-01-02 18:25:12,366 - INFO - [main.py:107] - Results saved to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-02 18:25:12,368 - INFO - [main.py:161] - TLS session simulation completed successfully
2025-01-02 18:31:45,928 - INFO - [logging.py:83] - Logging configured successfully
2025-01-02 18:31:45,928 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-02 18:31:45,929 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-02 18:31:45,930 - INFO - [logging.py:92] - Log level: 20
2025-01-02 18:31:45,930 - INFO - [logging.py:93] - Timestamp: 2025-01-02T18:31:45.930389
2025-01-02 18:31:45,930 - INFO - [logging.py:94] - ==========================
2025-01-02 18:31:45,931 - INFO - [main.py:123] - Starting TLS session simulation
2025-01-02 18:31:45,931 - INFO - [main.py:88] - 
--- Client Session (certificate) ---
2025-01-02 18:31:45,996 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-02 18:31:45,997 - INFO - [cert.py:108] - File exists: True
2025-01-02 18:31:45,998 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-02 18:31:45,999 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-02 18:31:46,000 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-02 18:31:46,001 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-02 18:31:46,004 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 18:31:46,005 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-02 18:31:46,006 - INFO - [cert.py:108] - File exists: True
2025-01-02 18:31:46,008 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-02 18:31:46,010 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-02 18:31:46,011 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-02 18:31:46,012 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-02 18:31:46,014 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 18:31:46,052 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-02 18:31:46,052 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-02 18:31:46,053 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-02 18:31:46,054 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-02 18:31:46,057 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-02 18:31:46,058 - INFO - [verify.py:59] - Public key comparison results:
2025-01-02 18:31:46,060 - INFO - [verify.py:60] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 18:31:46,063 - INFO - [verify.py:61] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 18:31:46,065 - INFO - [verify.py:62] - Certificate exponent (e): 0x10001
2025-01-02 18:31:46,066 - INFO - [verify.py:63] - Loaded key exponent (e): 0x10001
2025-01-02 18:31:46,067 - INFO - [verify.py:137] - Certificate chain verification successful
2025-01-02 18:31:46,068 - INFO - [verify.py:189] - Server name 'Pasdaran.local' verified successfully.
2025-01-02 18:31:46,068 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-02 18:31:46,069 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-02 18:31:46,069 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-02 18:31:46,070 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-02 18:31:46,072 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-02 18:31:46,073 - INFO - [session.py:207] - Starting TLS session
2025-01-02 18:31:46,074 - INFO - [session.py:116] - Starting TLS Handshake...
2025-01-02 18:31:46,075 - INFO - [client.py:100] - Generated client_random: 9c7b6d7511b3d29dd368332a8fd440eeb378345ddad622da6833d33250fc3f34
2025-01-02 18:31:46,078 - INFO - [client.py:143] - Client Hello sent from 192.168.1.1
2025-01-02 18:31:46,081 - INFO - [session.py:121] - Client Hello sent successfully
2025-01-02 18:31:46,082 - INFO - [server.py:94] - Generated server_random: bab02584f40b0becd324a5e542ba726d0f953caa17588c023e6d98bf19caeff5
2025-01-02 18:31:46,085 - INFO - [session.py:126] - Server Hello received successfully
2025-01-02 18:31:46,086 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2025-01-02 18:31:46,087 - INFO - [cert.py:108] - File exists: True
2025-01-02 18:31:46,087 - INFO - [cert.py:109] - File size: 1915 bytes
2025-01-02 18:31:46,088 - INFO - [cert.py:113] - Read 1915 bytes
2025-01-02 18:31:46,089 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2025-01-02 18:31:46,090 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2025-01-02 18:31:46,092 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 18:31:46,093 - INFO - [client.py:177] - Prepared client certificate
2025-01-02 18:31:46,095 - INFO - [client.py:192] - Encrypted pre_master_secret length: 256
2025-01-02 18:31:46,097 - INFO - [session.py:131] - Client handshake messages sent successfully
2025-01-02 18:31:46,098 - INFO - [session.py:136] - Server key pair verified successfully
2025-01-02 18:31:46,099 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-02 18:31:46,100 - INFO - [chain.py:185] - Decrypted pre_master_secret: 0303085190209924bda9724f8db87360ae13f67497bbf445ff3183f57e2433a7a0800d968f6ea9db99076dc9da075180
2025-01-02 18:31:46,101 - INFO - [chain.py:195] - Generated master secret: 01b9156a5be673c7025c270883fa770814cc38046ca92a13a40ed6b10e72a2d824b719588d4ffcc52bf76f6ac69ae3a4
2025-01-02 18:31:46,101 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-02 18:31:46,102 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-02 18:31:46,102 - INFO - [session.py:140] - Master Secret handled successfully
2025-01-02 18:31:46,103 - INFO - [client.py:273] - Pre-master secret validated successfully
2025-01-02 18:31:46,104 - INFO - [client.py:291] - Generated digital signature: 128073f65a5ad73c8618e273e7b5dbe321509ee9ad86c683523f72ee7ea0bab9b9792e888d0daa305765468f9a58edabc35619cfb2545cb876740f32bd02c89de13900c287c214c82d814ed129d1ab58d15b077d3dbdc8a08899272d57de9b3ae6d6da7ee9a3775301887fb0911170a837da96e3f70a9d73ef17f50b15115d380862a634b75d63f1e630470b645424e1c6f3fcc55ed6e4552b9532eb296a22371158aa209cf49b94be3b0b3091b918dcdd71d2d470c188086ea11e8631f61960ee854e68e16c4aef39d8c15de08eaca2dbce6a5cf574ebb361b3effb3eabd7fb5b54e8312be3674009b7f6602c556604df0e7f9e34bb7c4a5ae544fb4ed468df
2025-01-02 18:31:46,107 - INFO - [client.py:337] - Client ChangeCipherSpec and Finished messages sent
2025-01-02 18:31:46,109 - INFO - [session.py:145] - Client Change Cipher Spec sent successfully
2025-01-02 18:31:46,111 - INFO - [server.py:260] - Pre-master secret validated successfully
2025-01-02 18:31:46,112 - INFO - [server.py:278] - Generated digital signature: 5678c748b694b80ea138c45cc2c5cd6eb17b1af215651a662e401c13b242cf8ce46498799ef577c85bdff8e2262b73933a994cf272831e703eacfbe387a6393d55cfcc3f8bb1cc65430fab8bc4c051bfa2a46e71a399485960366ef20bb718c3a73b03d51baf2f267516bf49f3d2a2b9aad5e95669ddc9f75ac989ac879429d84b0df2086d9d0037ffd6e0ffb8ed58ec905f032ec4d3caa0303285e0e64ce5b2b89ad04b98188ddfb5c6b39f1107e1e1d1c32591e90ee3f9cfb70e2685565c9b4232e26362f9676b6a0b10d2e29a33eab824e25d7cf589f15ed1646d9135194e4af8b8cd0f8e8ea83acc580d01bddaddb8347bab644ae4448e41440c65409943
2025-01-02 18:31:46,113 - INFO - [server.py:324] - Server ChangeCipherSpec and Finished messages sent
2025-01-02 18:31:46,114 - INFO - [session.py:150] - Server Change Cipher Spec received successfully
2025-01-02 18:31:46,115 - INFO - [keys.py:218] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-02 18:31:46,115 - INFO - [session.py:155] - SSL Key Log handled successfully
2025-01-02 18:31:46,116 - INFO - [session.py:159] - TLS Handshake completed successfully
2025-01-02 18:31:46,117 - INFO - [session.py:218] - Found file to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 18:31:46,118 - INFO - [session.py:236] - Handshake completed: True
2025-01-02 18:31:46,118 - INFO - [session.py:237] - Use client cert: True
2025-01-02 18:31:46,118 - INFO - [session.py:238] - File to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 18:31:46,119 - INFO - [session.py:241] - Using encrypted exchange
2025-01-02 18:31:46,119 - INFO - [session.py:256] - Sending encrypted request data
2025-01-02 18:31:46,120 - INFO - [keys.py:185] - TLS Application Data sent from 192.168.1.1:12345 to 10.0.0.1:443
2025-01-02 18:31:46,121 - INFO - [session.py:267] - Sending encrypted response data
2025-01-02 18:31:46,122 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-02 18:31:46,123 - INFO - [session.py:279] - Attempting to send file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 18:31:46,123 - INFO - [session.py:290] - Opening file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 18:31:46,125 - INFO - [session.py:297] - Read 1103 bytes from file
2025-01-02 18:31:46,127 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-02 18:31:46,128 - INFO - [session.py:306] - File sent successfully
2025-01-02 18:31:46,129 - INFO - [session.py:281] - File sent successfully
2025-01-02 18:31:46,129 - INFO - [main.py:96] - Session completed successfully for 192.168.1.1
2025-01-02 18:31:46,131 - INFO - [main.py:88] - 
--- Client Session (no certificate) ---
2025-01-02 18:31:46,131 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-02 18:31:46,132 - INFO - [cert.py:108] - File exists: True
2025-01-02 18:31:46,132 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-02 18:31:46,133 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-02 18:31:46,133 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-02 18:31:46,133 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-02 18:31:46,134 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 18:31:46,134 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-02 18:31:46,135 - INFO - [cert.py:108] - File exists: True
2025-01-02 18:31:46,135 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-02 18:31:46,135 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-02 18:31:46,135 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-02 18:31:46,136 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-02 18:31:46,136 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 18:31:46,165 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-02 18:31:46,166 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-02 18:31:46,167 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-02 18:31:46,167 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-02 18:31:46,167 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-02 18:31:46,168 - INFO - [verify.py:59] - Public key comparison results:
2025-01-02 18:31:46,168 - INFO - [verify.py:60] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 18:31:46,169 - INFO - [verify.py:61] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 18:31:46,170 - INFO - [verify.py:62] - Certificate exponent (e): 0x10001
2025-01-02 18:31:46,170 - INFO - [verify.py:63] - Loaded key exponent (e): 0x10001
2025-01-02 18:31:46,171 - INFO - [verify.py:137] - Certificate chain verification successful
2025-01-02 18:31:46,171 - INFO - [verify.py:189] - Server name 'Pasdaran.local' verified successfully.
2025-01-02 18:31:46,172 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-02 18:31:46,172 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-02 18:31:46,172 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-02 18:31:46,173 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-02 18:31:46,176 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-02 18:31:46,177 - INFO - [session.py:207] - Starting TLS session
2025-01-02 18:31:46,177 - INFO - [session.py:116] - Starting TLS Handshake...
2025-01-02 18:31:46,178 - INFO - [client.py:100] - Generated client_random: 2fd16056931a8e2632e9bd0a15583252662ecff93b90a5e73cc5b5b07452f77b
2025-01-02 18:31:46,180 - INFO - [client.py:143] - Client Hello sent from 192.168.1.2
2025-01-02 18:31:46,182 - INFO - [session.py:121] - Client Hello sent successfully
2025-01-02 18:31:46,182 - INFO - [server.py:94] - Generated server_random: 5fef197b9d77725a7ef4e9acb9afcbec35b6775f143d06bc9943bccb1c063a1d
2025-01-02 18:31:46,185 - INFO - [session.py:126] - Server Hello received successfully
2025-01-02 18:31:46,185 - INFO - [client.py:180] - Prepared empty certificate
2025-01-02 18:31:46,186 - INFO - [client.py:192] - Encrypted pre_master_secret length: 256
2025-01-02 18:31:46,187 - INFO - [session.py:131] - Client handshake messages sent successfully
2025-01-02 18:31:46,189 - INFO - [session.py:136] - Server key pair verified successfully
2025-01-02 18:31:46,189 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-02 18:31:46,190 - INFO - [chain.py:185] - Decrypted pre_master_secret: 0303f279275c42733ec6ec83170a8e426a3b973cee5cec5f8817341ceb4c799258694ccee1422584c79bb6b39ab785bd
2025-01-02 18:31:46,192 - INFO - [chain.py:195] - Generated master secret: 58abc8edd7e2b8eddc4917ab1b4ce1b2ecf57bfcc75bdfa989e0b4984cdef9a2f0ae04b7266856ef07cc34876a67fac9
2025-01-02 18:31:46,193 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-02 18:31:46,194 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-02 18:31:46,194 - INFO - [session.py:140] - Master Secret handled successfully
2025-01-02 18:31:46,196 - INFO - [client.py:273] - Pre-master secret validated successfully
2025-01-02 18:31:46,196 - INFO - [client.py:291] - Generated digital signature: bd89e3e93d3b13336e46ade828a9dced1202e521601f8d60ee6bc0614b72ad040df839c595a6d850617e1894ce340dcf8557185a55ee37ef37dfded1a763fb31a430bc15bd9e80ec37a2eae05953371642c92e9c96f43efa99bec0d81e1c7215bac763d402222bacdc87f629ab90ebf7144063bc4730d37c91c344f4fa853ea66e3d8b99e64bdc5ad2606dce06445127e8cfc8ff8347790697c99a18b080a57af419071135438c8b1bdb29889ab7b03e293f97b76701e0916a94ab0173f79ae5dc46f9dbfd5fff8ffe3239cef69aefb15e96add9e0cf0d95b54ff9ee520c7d8a3fe71add453a47751025474a2ed2b1af540bdf650ab925590d7387e0bd13e320
2025-01-02 18:31:46,198 - INFO - [client.py:337] - Client ChangeCipherSpec and Finished messages sent
2025-01-02 18:31:46,199 - INFO - [session.py:145] - Client Change Cipher Spec sent successfully
2025-01-02 18:31:46,200 - INFO - [server.py:260] - Pre-master secret validated successfully
2025-01-02 18:31:46,202 - INFO - [server.py:278] - Generated digital signature: 8053b04b8ab4aa320dc0af14c8f004bca939f20494d1f048819aafcaa0cc50d64f308a56899a5a0820c54991fd5981d13deabd709852d65d7f52e5087d84a7da1d3585a43aa887ca74b6edceb9f17cb6b65ded54947b5fa350361d8083ed5fcbf1a8e6b7e60090212dd591feea3d2bf115f86decbde2c61f364370189e0eea1834c30112b5115eccb065b2219fbc0aaebb22b031f7b8ca3da4c072501b61b36deee4fbb16d7b849889e735fdccf3c38a72d3e9b0998a7ac4f818d01cad5baddbd407dac08ec15983e8cbbf147373a1c8a0457b7da341e5223cf1a802bb2a3b06941587e6c4eba815594e5fa402e2f2bfcdfcbc428dde9b273d54026925df6823
2025-01-02 18:31:46,203 - INFO - [server.py:324] - Server ChangeCipherSpec and Finished messages sent
2025-01-02 18:31:46,204 - INFO - [session.py:150] - Server Change Cipher Spec received successfully
2025-01-02 18:31:46,205 - INFO - [keys.py:218] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-02 18:31:46,206 - INFO - [session.py:155] - SSL Key Log handled successfully
2025-01-02 18:31:46,206 - INFO - [session.py:159] - TLS Handshake completed successfully
2025-01-02 18:31:46,207 - INFO - [session.py:236] - Handshake completed: True
2025-01-02 18:31:46,208 - INFO - [session.py:237] - Use client cert: False
2025-01-02 18:31:46,209 - INFO - [session.py:238] - File to send: None
2025-01-02 18:31:46,209 - INFO - [session.py:244] - Using unencrypted exchange
2025-01-02 18:31:46,210 - INFO - [session.py:344] - Added request packet
2025-01-02 18:31:46,211 - INFO - [session.py:344] - Added response packet
2025-01-02 18:31:46,211 - WARNING - [session.py:321] - Using unencrypted communication
2025-01-02 18:31:46,211 - INFO - [main.py:96] - Session completed successfully for 192.168.1.2
2025-01-02 18:31:46,212 - INFO - [packet_validator.py:110] - Packet 13: Valid HTTP message
2025-01-02 18:31:46,212 - INFO - [packet_validator.py:110] - Packet 14: Valid HTTP message
2025-01-02 18:31:46,216 - INFO - [packet_storage.py:79] - Saved 15 valid packets to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-02 18:31:46,217 - INFO - [packet_storage.py:100] - Verifying 15 packets...
2025-01-02 18:31:46,217 - INFO - [packet_storage.py:104] - Packet 1: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 18:31:46,218 - INFO - [packet_storage.py:104] - Packet 2: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 18:31:46,218 - INFO - [packet_storage.py:104] - Packet 3: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 18:31:46,219 - INFO - [packet_storage.py:104] - Packet 4: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 18:31:46,219 - INFO - [packet_storage.py:104] - Packet 5: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 18:31:46,219 - INFO - [packet_storage.py:104] - Packet 6: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 18:31:46,220 - INFO - [packet_storage.py:104] - Packet 7: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 18:31:46,220 - INFO - [packet_storage.py:104] - Packet 8: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 18:31:46,220 - INFO - [packet_storage.py:104] - Packet 9: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-02 18:31:46,221 - INFO - [packet_storage.py:104] - Packet 10: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-02 18:31:46,221 - INFO - [packet_storage.py:104] - Packet 11: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-02 18:31:46,222 - INFO - [packet_storage.py:104] - Packet 12: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-02 18:31:46,223 - INFO - [packet_storage.py:104] - Packet 13: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-02 18:31:46,225 - INFO - [packet_storage.py:104] - Packet 14: IP / TCP 192.168.1.2:12346 > 10.0.0.1:http PA / Raw
2025-01-02 18:31:46,226 - INFO - [packet_storage.py:104] - Packet 15: IP / TCP 10.0.0.1:http > 192.168.1.2:12346 PA / Raw
2025-01-02 18:31:46,226 - INFO - [packet_storage.py:111] - Verification complete: 15 valid packets, 13 TLS records
2025-01-02 18:31:46,227 - INFO - [main.py:107] - Results saved to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-02 18:31:46,227 - INFO - [main.py:161] - TLS session simulation completed successfully
2025-01-02 18:42:23,256 - INFO - [logging.py:83] - Logging configured successfully
2025-01-02 18:42:23,260 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-02 18:42:23,261 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-02 18:42:23,263 - INFO - [logging.py:92] - Log level: 20
2025-01-02 18:42:23,265 - INFO - [logging.py:93] - Timestamp: 2025-01-02T18:42:23.265304
2025-01-02 18:42:23,269 - INFO - [logging.py:94] - ==========================
2025-01-02 18:42:23,274 - INFO - [main.py:123] - Starting TLS session simulation
2025-01-02 18:42:23,279 - INFO - [main.py:88] - 
--- Client Session (certificate) ---
2025-01-02 18:42:23,289 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-02 18:42:23,291 - INFO - [cert.py:108] - File exists: True
2025-01-02 18:42:23,293 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-02 18:42:23,295 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-02 18:42:23,296 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-02 18:42:23,296 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-02 18:42:23,313 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 18:42:23,317 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-02 18:42:23,321 - INFO - [cert.py:108] - File exists: True
2025-01-02 18:42:23,325 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-02 18:42:23,328 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-02 18:42:23,330 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-02 18:42:23,330 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-02 18:42:23,334 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 18:42:23,393 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-02 18:42:23,394 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-02 18:42:23,394 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-02 18:42:23,396 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-02 18:42:23,403 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-02 18:42:23,405 - INFO - [verify.py:59] - Public key comparison results:
2025-01-02 18:42:23,408 - INFO - [verify.py:60] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 18:42:23,411 - INFO - [verify.py:61] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 18:42:23,416 - INFO - [verify.py:62] - Certificate exponent (e): 0x10001
2025-01-02 18:42:23,416 - INFO - [verify.py:63] - Loaded key exponent (e): 0x10001
2025-01-02 18:42:23,425 - INFO - [verify.py:137] - Certificate chain verification successful
2025-01-02 18:42:23,427 - INFO - [verify.py:189] - Server name 'Pasdaran.local' verified successfully.
2025-01-02 18:42:23,428 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-02 18:42:23,428 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-02 18:42:23,429 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-02 18:42:23,430 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-02 18:42:23,431 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-02 18:42:23,433 - INFO - [session.py:207] - Starting TLS session
2025-01-02 18:42:23,434 - INFO - [session.py:116] - Starting TLS Handshake...
2025-01-02 18:42:23,434 - INFO - [client.py:100] - Generated client_random: e16742e73792bc2aaba23d31ea6fe609e1f5455df4f4a0045e4ccc361c61e8fc
2025-01-02 18:42:23,440 - INFO - [client.py:143] - Client Hello sent from 192.168.1.1
2025-01-02 18:42:23,446 - INFO - [session.py:121] - Client Hello sent successfully
2025-01-02 18:42:23,446 - INFO - [server.py:94] - Generated server_random: eda2cd3dcf38d3dbf14d8775a7174042e375763353eedca7866057886d89db79
2025-01-02 18:42:23,455 - INFO - [session.py:126] - Server Hello received successfully
2025-01-02 18:42:23,457 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2025-01-02 18:42:23,459 - INFO - [cert.py:108] - File exists: True
2025-01-02 18:42:23,459 - INFO - [cert.py:109] - File size: 1915 bytes
2025-01-02 18:42:23,460 - INFO - [cert.py:113] - Read 1915 bytes
2025-01-02 18:42:23,461 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2025-01-02 18:42:23,461 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2025-01-02 18:42:23,462 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 18:42:23,463 - INFO - [client.py:177] - Prepared client certificate
2025-01-02 18:42:23,464 - INFO - [client.py:192] - Encrypted pre_master_secret length: 256
2025-01-02 18:42:23,468 - INFO - [session.py:131] - Client handshake messages sent successfully
2025-01-02 18:42:23,473 - INFO - [session.py:136] - Server key pair verified successfully
2025-01-02 18:42:23,473 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-02 18:42:23,475 - INFO - [chain.py:185] - Decrypted pre_master_secret: 03031048f1c1081883f2a9fd80281ff2a3e3c15b46cfb93c2841afc54da365586e46e98a2dd6190db54cdb618fc38786
2025-01-02 18:42:23,476 - INFO - [chain.py:195] - Generated master secret: dd4011ec917f152add1166c3f2f58ebd845892816d84c2a25fcc8f7ad2b3eaa150a4ca0515ce8aab22e03c24652e1a93
2025-01-02 18:42:23,476 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-02 18:42:23,477 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-02 18:42:23,477 - INFO - [session.py:140] - Master Secret handled successfully
2025-01-02 18:42:23,478 - INFO - [client.py:273] - Pre-master secret validated successfully
2025-01-02 18:42:23,480 - INFO - [client.py:291] - Generated digital signature: b0edb75cb81e5c38e6c01eede7f409ea4a8b29d11af3a275bde65368dff4e420d0e4315053d641efe2872a0f6edc317c9d81457b3c1f7ef38093d740d8bc3915ab95a96b7e094a019fa44c756174b82043e542eb7320bfa6d1ea1b701b3ddbdfe0f14a345e93ad263ab43cf369730bd5303ec14b763d1d11cc63f86fb0b1ff9a2a253322e31b2c6011e417aa37749ec882eae317e4f80899ca2d7b0ccf41de4f902abb83c69bd962d109636572e0aa88131e0d18223fa50cec20fbd1aca05e21ab62149aa985c673067560d6b8e2af341c189505ddc68ff716e519d7a1fbe7a4cf40746299f128d1c45de409818b38e8086b8b38c5a2f0f1a40934aa3f2adb39
2025-01-02 18:42:23,484 - INFO - [client.py:337] - Client ChangeCipherSpec and Finished messages sent
2025-01-02 18:42:23,488 - INFO - [session.py:145] - Client Change Cipher Spec sent successfully
2025-01-02 18:42:23,491 - INFO - [server.py:260] - Pre-master secret validated successfully
2025-01-02 18:42:23,494 - INFO - [server.py:278] - Generated digital signature: 54d61b42ab3a0899ff8afbaf51a9e188eaf4fa881e03dd839468672c37e2ce0199e23da14a822b1a1ad86e9220d2f3913568250b33cddbf8d539616c8fcb0e43434647a76ed5ae928009c082bc3f5455cda15068dc90090f737a301967955930cd1b2520260f735a49a40dce9880a046639e16b8d313a9bf7876ed92085f7578c6e529337677ad2a0223006e5f469ae6a9ad5bab672da47fc3234288b89a530b17e2bebfa5933815166dc9825e5c8186ce39926f10908d45a75104497eb50897b7b52032c50ca737eb6220fcb71ddd512fe14d8e3f290cdd48cec634c5adbb879f9c7ae22cd25e72957738e620247d858ba1346cccf6350b8fafb0f2e072160a
2025-01-02 18:42:23,497 - INFO - [server.py:324] - Server ChangeCipherSpec and Finished messages sent
2025-01-02 18:42:23,500 - INFO - [session.py:150] - Server Change Cipher Spec received successfully
2025-01-02 18:42:23,504 - INFO - [keys.py:218] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-02 18:42:23,506 - INFO - [session.py:155] - SSL Key Log handled successfully
2025-01-02 18:42:23,507 - INFO - [session.py:159] - TLS Handshake completed successfully
2025-01-02 18:42:23,508 - INFO - [session.py:218] - Found file to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 18:42:23,509 - INFO - [session.py:236] - Handshake completed: True
2025-01-02 18:42:23,509 - INFO - [session.py:237] - Use client cert: True
2025-01-02 18:42:23,510 - INFO - [session.py:238] - File to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 18:42:23,510 - INFO - [session.py:241] - Using encrypted exchange
2025-01-02 18:42:23,510 - INFO - [session.py:256] - Sending encrypted request data
2025-01-02 18:42:23,513 - INFO - [keys.py:185] - TLS Application Data sent from 192.168.1.1:12345 to 10.0.0.1:443
2025-01-02 18:42:23,515 - INFO - [session.py:267] - Sending encrypted response data
2025-01-02 18:42:23,518 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-02 18:42:23,521 - INFO - [session.py:279] - Attempting to send file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 18:42:23,522 - INFO - [session.py:290] - Opening file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 18:42:23,524 - INFO - [session.py:297] - Read 1103 bytes from file
2025-01-02 18:42:23,529 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-02 18:42:23,530 - INFO - [session.py:306] - File sent successfully
2025-01-02 18:42:23,531 - INFO - [session.py:281] - File sent successfully
2025-01-02 18:42:23,531 - INFO - [main.py:96] - Session completed successfully for 192.168.1.1
2025-01-02 18:42:23,532 - INFO - [main.py:88] - 
--- Client Session (no certificate) ---
2025-01-02 18:42:23,533 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-02 18:42:23,535 - INFO - [cert.py:108] - File exists: True
2025-01-02 18:42:23,536 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-02 18:42:23,538 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-02 18:42:23,538 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-02 18:42:23,539 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-02 18:42:23,540 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 18:42:23,542 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-02 18:42:23,544 - INFO - [cert.py:108] - File exists: True
2025-01-02 18:42:23,544 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-02 18:42:23,545 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-02 18:42:23,545 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-02 18:42:23,546 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-02 18:42:23,546 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 18:42:23,579 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-02 18:42:23,580 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-02 18:42:23,580 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-02 18:42:23,580 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-02 18:42:23,581 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-02 18:42:23,581 - INFO - [verify.py:59] - Public key comparison results:
2025-01-02 18:42:23,581 - INFO - [verify.py:60] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 18:42:23,582 - INFO - [verify.py:61] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 18:42:23,584 - INFO - [verify.py:62] - Certificate exponent (e): 0x10001
2025-01-02 18:42:23,589 - INFO - [verify.py:63] - Loaded key exponent (e): 0x10001
2025-01-02 18:42:23,591 - INFO - [verify.py:137] - Certificate chain verification successful
2025-01-02 18:42:23,592 - INFO - [verify.py:189] - Server name 'Pasdaran.local' verified successfully.
2025-01-02 18:42:23,592 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-02 18:42:23,593 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-02 18:42:23,593 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-02 18:42:23,594 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-02 18:42:23,595 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-02 18:42:23,596 - INFO - [session.py:207] - Starting TLS session
2025-01-02 18:42:23,596 - INFO - [session.py:116] - Starting TLS Handshake...
2025-01-02 18:42:23,597 - INFO - [client.py:100] - Generated client_random: ac66998ca49c434c4a3b19f6ef1341975ab2719aa2019eb9c94e6bbf58b3bf58
2025-01-02 18:42:23,600 - INFO - [client.py:143] - Client Hello sent from 192.168.1.2
2025-01-02 18:42:23,605 - INFO - [session.py:121] - Client Hello sent successfully
2025-01-02 18:42:23,606 - INFO - [server.py:94] - Generated server_random: f1227be4e8e5df0a335f7b3c8422bb92ef5c7e6e61def52d87af9a18f57fba3d
2025-01-02 18:42:23,611 - INFO - [session.py:126] - Server Hello received successfully
2025-01-02 18:42:23,612 - INFO - [client.py:180] - Prepared empty certificate
2025-01-02 18:42:23,613 - INFO - [client.py:192] - Encrypted pre_master_secret length: 256
2025-01-02 18:42:23,615 - INFO - [session.py:131] - Client handshake messages sent successfully
2025-01-02 18:42:23,617 - INFO - [session.py:136] - Server key pair verified successfully
2025-01-02 18:42:23,618 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-02 18:42:23,621 - INFO - [chain.py:185] - Decrypted pre_master_secret: 0303c779192dd6118e2536f8a0afad15ebe2e9933027268a4fa730e2677a82d6a356473f79e5782722f4a2e44be6642a
2025-01-02 18:42:23,623 - INFO - [chain.py:195] - Generated master secret: 118ae2e1871bdb0a0502fc5000f4a0d871ff843907153d8909f73103466ea43598bfedc6f4906896ab08147d5d821d13
2025-01-02 18:42:23,623 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-02 18:42:23,624 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-02 18:42:23,624 - INFO - [session.py:140] - Master Secret handled successfully
2025-01-02 18:42:23,625 - INFO - [client.py:273] - Pre-master secret validated successfully
2025-01-02 18:42:23,627 - INFO - [client.py:291] - Generated digital signature: 612565a34c832090d6af2a9fdfd729a2b6d598c1a0745f5a0d3d29e511e03b6d0db7052982f4c3cecf872bf0aa62115c334a9f75ad11c007070e363b4c584870cbca77f5d5079278447968345d437050223b806a5ef4f21dfdf4147cfadd5f709f136318fcda6dfef4a676112383f4a45d1311a59ebe890f3f04433fb4ee3b21c592605779c386720e96f38d1a90c2222b45770042c8ea24223dad3f52f625172e9dcdb08aa47c8a37a989e1dc71098528171383a4379ec97d7ec3e6d2638e2982c3581e9e984546a46f93db6c0dfeec774c3c840b9cb8f80dc09ece66bbf8f7e8b9a5a81c7b89e734695f070644f21e6e540ace425b7b81c22e1fb95a8a28bf
2025-01-02 18:42:23,629 - INFO - [client.py:337] - Client ChangeCipherSpec and Finished messages sent
2025-01-02 18:42:23,630 - INFO - [session.py:145] - Client Change Cipher Spec sent successfully
2025-01-02 18:42:23,632 - INFO - [server.py:260] - Pre-master secret validated successfully
2025-01-02 18:42:23,635 - INFO - [server.py:278] - Generated digital signature: 9586c77184d9e2615e098652383ecd1906a9ed20356a80d524b0c6bd5dda6badbd6f7a5aca2deb44e3b2a0f7a27134b1e03c0a9ae20a23159b5d7bd3cbf2ddcb45c68f0624e0f4150396b0ebb3a1abfa12278aa3b89d2823d6866013ca4d7c94a5168d5ede2339e43c501a2b5a346c96716d5e8423e99207a1f5936c2b7d1ea03a2b650147a3565370d7d62135cdc621eec4e60c88bb6669039810cbb0c9d57f7ea5ba17992fad393dfc326eacaac537e48a9ed29220f30cac66065471d65fb6d9b63659899fefdce274408aec87ac9d6b2fe9259c8de514762c3cf6692d26f0c924dafe73265949c5fcc29c59b01fca64fec3800d377094346e20877a67a31e
2025-01-02 18:42:23,639 - INFO - [server.py:324] - Server ChangeCipherSpec and Finished messages sent
2025-01-02 18:42:23,641 - INFO - [session.py:150] - Server Change Cipher Spec received successfully
2025-01-02 18:42:23,643 - INFO - [keys.py:218] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-02 18:42:23,644 - INFO - [session.py:155] - SSL Key Log handled successfully
2025-01-02 18:42:23,644 - INFO - [session.py:159] - TLS Handshake completed successfully
2025-01-02 18:42:23,645 - INFO - [session.py:236] - Handshake completed: True
2025-01-02 18:42:23,645 - INFO - [session.py:237] - Use client cert: False
2025-01-02 18:42:23,646 - INFO - [session.py:238] - File to send: None
2025-01-02 18:42:23,646 - INFO - [session.py:244] - Using unencrypted exchange
2025-01-02 18:42:23,647 - INFO - [session.py:344] - Added request packet
2025-01-02 18:42:23,648 - INFO - [session.py:344] - Added response packet
2025-01-02 18:42:23,649 - WARNING - [session.py:321] - Using unencrypted communication
2025-01-02 18:42:23,650 - INFO - [main.py:96] - Session completed successfully for 192.168.1.2
2025-01-02 18:42:23,651 - INFO - [packet_validator.py:110] - Packet 13: Valid HTTP message
2025-01-02 18:42:23,652 - INFO - [packet_validator.py:110] - Packet 14: Valid HTTP message
2025-01-02 18:42:23,660 - INFO - [packet_storage.py:79] - Saved 15 valid packets to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-02 18:42:23,661 - INFO - [packet_storage.py:100] - Verifying 15 packets...
2025-01-02 18:42:23,661 - INFO - [packet_storage.py:104] - Packet 1: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 18:42:23,662 - INFO - [packet_storage.py:104] - Packet 2: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 18:42:23,663 - INFO - [packet_storage.py:104] - Packet 3: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 18:42:23,664 - INFO - [packet_storage.py:104] - Packet 4: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 18:42:23,664 - INFO - [packet_storage.py:104] - Packet 5: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 18:42:23,665 - INFO - [packet_storage.py:104] - Packet 6: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 18:42:23,665 - INFO - [packet_storage.py:104] - Packet 7: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 18:42:23,667 - INFO - [packet_storage.py:104] - Packet 8: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 18:42:23,669 - INFO - [packet_storage.py:104] - Packet 9: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-02 18:42:23,671 - INFO - [packet_storage.py:104] - Packet 10: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-02 18:42:23,672 - INFO - [packet_storage.py:104] - Packet 11: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-02 18:42:23,674 - INFO - [packet_storage.py:104] - Packet 12: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-02 18:42:23,676 - INFO - [packet_storage.py:104] - Packet 13: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-02 18:42:23,677 - INFO - [packet_storage.py:104] - Packet 14: IP / TCP 192.168.1.2:12346 > 10.0.0.1:http PA / Raw
2025-01-02 18:42:23,677 - INFO - [packet_storage.py:104] - Packet 15: IP / TCP 10.0.0.1:http > 192.168.1.2:12346 PA / Raw
2025-01-02 18:42:23,678 - INFO - [packet_storage.py:111] - Verification complete: 15 valid packets, 13 TLS records
2025-01-02 18:42:23,678 - INFO - [main.py:107] - Results saved to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-02 18:42:23,679 - INFO - [main.py:161] - TLS session simulation completed successfully
2025-01-02 19:05:35,801 - INFO - [logging.py:83] - Logging configured successfully
2025-01-02 19:05:35,802 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-02 19:05:35,802 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-02 19:05:35,803 - INFO - [logging.py:92] - Log level: 20
2025-01-02 19:05:35,803 - INFO - [logging.py:93] - Timestamp: 2025-01-02T19:05:35.803640
2025-01-02 19:05:35,803 - INFO - [logging.py:94] - ==========================
2025-01-02 19:05:35,804 - INFO - [main.py:123] - Starting TLS session simulation
2025-01-02 19:05:35,805 - INFO - [main.py:88] - 
--- Client Session (certificate) ---
2025-01-02 19:05:35,807 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-02 19:05:35,807 - INFO - [cert.py:108] - File exists: True
2025-01-02 19:05:35,808 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-02 19:05:35,809 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-02 19:05:35,809 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-02 19:05:35,810 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-02 19:05:35,816 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 19:05:35,818 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-02 19:05:35,819 - INFO - [cert.py:108] - File exists: True
2025-01-02 19:05:35,820 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-02 19:05:35,821 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-02 19:05:35,822 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-02 19:05:35,822 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-02 19:05:35,825 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 19:05:35,870 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-02 19:05:35,871 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-02 19:05:35,872 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-02 19:05:35,873 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-02 19:05:35,877 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-02 19:05:35,878 - INFO - [verify.py:59] - Public key comparison results:
2025-01-02 19:05:35,879 - INFO - [verify.py:60] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 19:05:35,880 - INFO - [verify.py:61] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 19:05:35,882 - INFO - [verify.py:62] - Certificate exponent (e): 0x10001
2025-01-02 19:05:35,883 - INFO - [verify.py:63] - Loaded key exponent (e): 0x10001
2025-01-02 19:05:35,889 - INFO - [verify.py:137] - Certificate chain verification successful
2025-01-02 19:05:35,890 - INFO - [verify.py:189] - Server name 'Pasdaran.local' verified successfully.
2025-01-02 19:05:35,891 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-02 19:05:35,892 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-02 19:05:35,892 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-02 19:05:35,893 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-02 19:05:35,894 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-02 19:05:35,894 - INFO - [session.py:207] - Starting TLS session
2025-01-02 19:05:35,894 - INFO - [session.py:116] - Starting TLS Handshake...
2025-01-02 19:05:35,894 - INFO - [client.py:100] - Generated client_random: 0affe7984b3a258d224f0a38fc602b5c0b9ec436ddcdfaad9ad393d874891eb9
2025-01-02 19:05:35,896 - INFO - [client.py:143] - Client Hello sent from 192.168.1.1
2025-01-02 19:05:35,901 - INFO - [session.py:121] - Client Hello sent successfully
2025-01-02 19:05:35,902 - INFO - [server.py:94] - Generated server_random: 917d4e678115dee825ae3b5507c28db67310cf04d2180e857400cd30272406a9
2025-01-02 19:05:35,907 - INFO - [session.py:126] - Server Hello received successfully
2025-01-02 19:05:35,908 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2025-01-02 19:05:35,909 - INFO - [cert.py:108] - File exists: True
2025-01-02 19:05:35,910 - INFO - [cert.py:109] - File size: 1915 bytes
2025-01-02 19:05:35,911 - INFO - [cert.py:113] - Read 1915 bytes
2025-01-02 19:05:35,911 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2025-01-02 19:05:35,912 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2025-01-02 19:05:35,913 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 19:05:35,913 - INFO - [client.py:177] - Prepared client certificate
2025-01-02 19:05:35,914 - INFO - [client.py:192] - Encrypted pre_master_secret length: 256
2025-01-02 19:05:35,918 - INFO - [session.py:131] - Client handshake messages sent successfully
2025-01-02 19:05:35,919 - INFO - [session.py:136] - Server key pair verified successfully
2025-01-02 19:05:35,920 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-02 19:05:35,921 - INFO - [chain.py:185] - Decrypted pre_master_secret: 030336311edd7e474aa0bb16fe183e9bacd0331904574fbd940573719e04e9fe610067351aeb7cda1f18f441a421c4c6
2025-01-02 19:05:35,921 - INFO - [chain.py:195] - Generated master secret: 7fec6b5f3dca6e3d9a35f7dd59b289f6024b686dcff4026015af3092e71cd0ce770a89c7a2269404d30bd97bdeabc3c0
2025-01-02 19:05:35,922 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-02 19:05:35,922 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-02 19:05:35,923 - INFO - [session.py:140] - Master Secret handled successfully
2025-01-02 19:05:35,924 - INFO - [client.py:273] - Pre-master secret validated successfully
2025-01-02 19:05:35,925 - INFO - [client.py:291] - Generated digital signature: 6fd6d5665314d6b4bc7268d609c83181b86daf9f587721799e8a9a527ad0541219573e8c232125da9f2cfb420887e4dbb8250a1016b6dc3638d827bda695d179b2e649eef4e2e38c139bbeef7ad4f7dfd9ccd5fe7e689fb3c47bf7eb114919561cd23df0ec2d72873e503b119f5d92866909dce177dc86b53a76120841b3329039eadf036ce6c4688d449fce1dec58d33a802772b3e6b709601b9040a4ad4849dac53ece7b7fbba856bc3d77b5b2d6ce1c1453ab0313e39f0c5c4464aed86f666a97330aa7e2f629b23d55a9098bbead60b8933e5f930aa33a1b987fb5da0e21c56001642f4df5652aec92894af082b055916cc628c75c32ad190d2a83a84f20
2025-01-02 19:05:35,927 - INFO - [client.py:337] - Client ChangeCipherSpec and Finished messages sent
2025-01-02 19:05:35,928 - INFO - [session.py:145] - Client Change Cipher Spec sent successfully
2025-01-02 19:05:35,929 - INFO - [server.py:260] - Pre-master secret validated successfully
2025-01-02 19:05:35,930 - INFO - [server.py:278] - Generated digital signature: 7815ad85a0305c8a0d7ca28e18d9ba4105f43ccf4326b3f1be339fb3f27d0cfdfdb57d775abbf6355289b5f5f5bbc38f869759d0084c9cdb8c8ce977fda6889965bc5a3b4dd531353808175ef215f1f8bc6993fc2da4fdae1948355cfd6838419b399e0482da63c2476196a9e62f2691d205c8ec2ece16ab10f600dd8f99753cd8289d17299d4df744d6c7e9b1ffae0032bf4974a8237e91c761c08d407483b421c91fc9ecbf03faf91b4fc7d5c4982f4d8169e3842e3b106e47f1bfaed6978f275ebe7f6c7d992d9cf1cd188d8e7bfbcf559a757554ab58bc25e5737f6510a6e5d3828ac3db9613e29ea672a730028ca63d1140cdf127945a7a4829785113c9
2025-01-02 19:05:35,936 - INFO - [server.py:324] - Server ChangeCipherSpec and Finished messages sent
2025-01-02 19:05:35,941 - INFO - [session.py:150] - Server Change Cipher Spec received successfully
2025-01-02 19:05:35,943 - INFO - [keys.py:218] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-02 19:05:35,945 - INFO - [session.py:155] - SSL Key Log handled successfully
2025-01-02 19:05:35,946 - INFO - [session.py:159] - TLS Handshake completed successfully
2025-01-02 19:05:35,947 - INFO - [session.py:218] - Found file to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 19:05:35,949 - INFO - [session.py:236] - Handshake completed: True
2025-01-02 19:05:35,950 - INFO - [session.py:237] - Use client cert: True
2025-01-02 19:05:35,951 - INFO - [session.py:238] - File to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 19:05:35,953 - INFO - [session.py:241] - Using encrypted exchange
2025-01-02 19:05:35,955 - INFO - [session.py:256] - Sending encrypted request data
2025-01-02 19:05:35,960 - INFO - [keys.py:185] - TLS Application Data sent from 192.168.1.1:12345 to 10.0.0.1:443
2025-01-02 19:05:35,962 - INFO - [session.py:267] - Sending encrypted response data
2025-01-02 19:05:35,963 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-02 19:05:35,965 - INFO - [session.py:279] - Attempting to send file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 19:05:35,968 - INFO - [session.py:290] - Opening file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 19:05:35,971 - INFO - [session.py:297] - Read 1103 bytes from file
2025-01-02 19:05:35,974 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-02 19:05:35,976 - INFO - [session.py:306] - File sent successfully
2025-01-02 19:05:35,976 - INFO - [session.py:281] - File sent successfully
2025-01-02 19:05:35,977 - INFO - [main.py:96] - Session completed successfully for 192.168.1.1
2025-01-02 19:05:35,978 - INFO - [main.py:88] - 
--- Client Session (no certificate) ---
2025-01-02 19:05:35,981 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-02 19:05:35,982 - INFO - [cert.py:108] - File exists: True
2025-01-02 19:05:35,983 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-02 19:05:35,985 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-02 19:05:35,987 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-02 19:05:35,989 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-02 19:05:35,993 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 19:05:35,994 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-02 19:05:35,995 - INFO - [cert.py:108] - File exists: True
2025-01-02 19:05:35,996 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-02 19:05:35,997 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-02 19:05:35,999 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-02 19:05:36,001 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-02 19:05:36,005 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 19:05:36,055 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-02 19:05:36,056 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-02 19:05:36,056 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-02 19:05:36,057 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-02 19:05:36,057 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-02 19:05:36,058 - INFO - [verify.py:59] - Public key comparison results:
2025-01-02 19:05:36,059 - INFO - [verify.py:60] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 19:05:36,060 - INFO - [verify.py:61] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 19:05:36,062 - INFO - [verify.py:62] - Certificate exponent (e): 0x10001
2025-01-02 19:05:36,063 - INFO - [verify.py:63] - Loaded key exponent (e): 0x10001
2025-01-02 19:05:36,063 - INFO - [verify.py:137] - Certificate chain verification successful
2025-01-02 19:05:36,064 - INFO - [verify.py:189] - Server name 'Pasdaran.local' verified successfully.
2025-01-02 19:05:36,076 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-02 19:05:36,077 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-02 19:05:36,078 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-02 19:05:36,079 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-02 19:05:36,080 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-02 19:05:36,082 - INFO - [session.py:207] - Starting TLS session
2025-01-02 19:05:36,083 - INFO - [session.py:116] - Starting TLS Handshake...
2025-01-02 19:05:36,085 - INFO - [client.py:100] - Generated client_random: 950bc080b3a217b6a73da32a47f4bc93b387f3148ab605f229177ebb986680ed
2025-01-02 19:05:36,090 - INFO - [client.py:143] - Client Hello sent from 192.168.1.2
2025-01-02 19:05:36,096 - INFO - [session.py:121] - Client Hello sent successfully
2025-01-02 19:05:36,097 - INFO - [server.py:94] - Generated server_random: f895c1b08a222764ae29d03366c61f523c85e2553bf5ad9f780bac58f0e905ed
2025-01-02 19:05:36,105 - INFO - [session.py:126] - Server Hello received successfully
2025-01-02 19:05:36,106 - INFO - [client.py:180] - Prepared empty certificate
2025-01-02 19:05:36,107 - INFO - [client.py:192] - Encrypted pre_master_secret length: 256
2025-01-02 19:05:36,109 - INFO - [session.py:131] - Client handshake messages sent successfully
2025-01-02 19:05:36,111 - INFO - [session.py:136] - Server key pair verified successfully
2025-01-02 19:05:36,112 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-02 19:05:36,113 - INFO - [chain.py:185] - Decrypted pre_master_secret: 03031d9c0ea4728523d3dbcc34cd17db23f954c877f3f783dedd17b66181207095a223f1d265111889d26f106b73df90
2025-01-02 19:05:36,114 - INFO - [chain.py:195] - Generated master secret: 344701a81493078a36820327f0040bb242463879720ad04aa105072dbaee73d2a60a225a9d621a0044f25e684f4bfe77
2025-01-02 19:05:36,114 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-02 19:05:36,115 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-02 19:05:36,116 - INFO - [session.py:140] - Master Secret handled successfully
2025-01-02 19:05:36,119 - INFO - [client.py:273] - Pre-master secret validated successfully
2025-01-02 19:05:36,120 - INFO - [client.py:291] - Generated digital signature: 49fbe10b76580f2a87169647e4cb4859113d0e0bcd878ab7fc35065529c79dd4b591db9bb8ff7bf2ad40d663474aa6ff0c10f4cb3cc014c13d321764624b6d36d7265136dab379bbd35391082f4aae1ab94ea4a1a8c552f583d4e579be5982f1d59952e3786059548074ac4117b56064c2e1aa94ef3d619e81f24952e7fbed41c4a625c9a00e421850b98731e83a6ccc33f3b1e43a586e8b2547f8a8ac76ff9641ee0f91d6ac209f27bac8926d1dabf6406fc0bf96cb11467d4442588475f5c041403b603f1d89ad69a7314d084d91a6714b8579db29cdd62717f62138d5b786a2d3b27fb49dea08f215bf841642ab771d852ab5442cb8ed0e23dcfc173178f3
2025-01-02 19:05:36,122 - INFO - [client.py:337] - Client ChangeCipherSpec and Finished messages sent
2025-01-02 19:05:36,124 - INFO - [session.py:145] - Client Change Cipher Spec sent successfully
2025-01-02 19:05:36,126 - INFO - [server.py:260] - Pre-master secret validated successfully
2025-01-02 19:05:36,127 - INFO - [server.py:278] - Generated digital signature: 9032e26dcf072e0d197aaad3ea0421b1899a64933865c2dd71ced7f4b7c459cd1a0c9d32c9899174c56b6950c223198909336eae1f61acdf1c89e73d941567bc98564f8d45d8983ad1a2fe64352297c2cbd21752f44457df0f07cd33bee74e5137cff9133a27b153dc007ed9155ae2061765692547c19c8ccbd9fd1080d07a764ca3dbedbc7bf5629d83a6d64d7942052b82d80905bf8b54af54bd68361c2897b5a6f8b4a0ac4145d5d7acf6f7c344976d6f1638778b3b63955689718c0f16352e541eb47f1d10ef6a56c5007ea0ce6b3532e4ef31a9fafba5e517f049bb812e552236bc5a0dcc3ccaf55a66872b238aa79abb2f8ccbb93c2f089cf219c3e6d3
2025-01-02 19:05:36,129 - INFO - [server.py:324] - Server ChangeCipherSpec and Finished messages sent
2025-01-02 19:05:36,131 - INFO - [session.py:150] - Server Change Cipher Spec received successfully
2025-01-02 19:05:36,133 - INFO - [keys.py:218] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-02 19:05:36,136 - INFO - [session.py:155] - SSL Key Log handled successfully
2025-01-02 19:05:36,137 - INFO - [session.py:159] - TLS Handshake completed successfully
2025-01-02 19:05:36,138 - INFO - [session.py:236] - Handshake completed: True
2025-01-02 19:05:36,139 - INFO - [session.py:237] - Use client cert: False
2025-01-02 19:05:36,140 - INFO - [session.py:238] - File to send: None
2025-01-02 19:05:36,141 - INFO - [session.py:244] - Using unencrypted exchange
2025-01-02 19:05:36,142 - INFO - [session.py:344] - Added request packet
2025-01-02 19:05:36,143 - INFO - [session.py:344] - Added response packet
2025-01-02 19:05:36,144 - WARNING - [session.py:321] - Using unencrypted communication
2025-01-02 19:05:36,144 - INFO - [main.py:96] - Session completed successfully for 192.168.1.2
2025-01-02 19:05:36,145 - INFO - [packet_validator.py:110] - Packet 13: Valid HTTP message
2025-01-02 19:05:36,146 - INFO - [packet_validator.py:110] - Packet 14: Valid HTTP message
2025-01-02 19:05:36,155 - INFO - [packet_storage.py:79] - Saved 15 valid packets to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-02 19:05:36,156 - INFO - [packet_storage.py:100] - Verifying 15 packets...
2025-01-02 19:05:36,156 - INFO - [packet_storage.py:104] - Packet 1: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 19:05:36,157 - INFO - [packet_storage.py:104] - Packet 2: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 19:05:36,158 - INFO - [packet_storage.py:104] - Packet 3: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 19:05:36,159 - INFO - [packet_storage.py:104] - Packet 4: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 19:05:36,160 - INFO - [packet_storage.py:104] - Packet 5: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 19:05:36,160 - INFO - [packet_storage.py:104] - Packet 6: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 19:05:36,161 - INFO - [packet_storage.py:104] - Packet 7: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 19:05:36,162 - INFO - [packet_storage.py:104] - Packet 8: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 19:05:36,162 - INFO - [packet_storage.py:104] - Packet 9: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-02 19:05:36,163 - INFO - [packet_storage.py:104] - Packet 10: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-02 19:05:36,163 - INFO - [packet_storage.py:104] - Packet 11: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-02 19:05:36,164 - INFO - [packet_storage.py:104] - Packet 12: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-02 19:05:36,164 - INFO - [packet_storage.py:104] - Packet 13: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-02 19:05:36,165 - INFO - [packet_storage.py:104] - Packet 14: IP / TCP 192.168.1.2:12346 > 10.0.0.1:http PA / Raw
2025-01-02 19:05:36,168 - INFO - [packet_storage.py:104] - Packet 15: IP / TCP 10.0.0.1:http > 192.168.1.2:12346 PA / Raw
2025-01-02 19:05:36,169 - INFO - [packet_storage.py:111] - Verification complete: 15 valid packets, 13 TLS records
2025-01-02 19:05:36,170 - INFO - [main.py:107] - Results saved to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-02 19:05:36,171 - INFO - [main.py:161] - TLS session simulation completed successfully
2025-01-02 19:44:26,230 - INFO - [logging.py:83] - Logging configured successfully
2025-01-02 19:44:26,231 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-02 19:44:26,231 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-02 19:44:26,232 - INFO - [logging.py:92] - Log level: 20
2025-01-02 19:44:26,233 - INFO - [logging.py:93] - Timestamp: 2025-01-02T19:44:26.233167
2025-01-02 19:44:26,233 - INFO - [logging.py:94] - ==========================
2025-01-02 19:44:26,234 - INFO - [main.py:123] - Starting TLS session simulation
2025-01-02 19:44:26,234 - INFO - [main.py:88] - 
--- Client Session (certificate) ---
2025-01-02 19:44:26,236 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-02 19:44:26,237 - INFO - [cert.py:108] - File exists: True
2025-01-02 19:44:26,237 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-02 19:44:26,238 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-02 19:44:26,239 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-02 19:44:26,240 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-02 19:44:26,245 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 19:44:26,246 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-02 19:44:26,246 - INFO - [cert.py:108] - File exists: True
2025-01-02 19:44:26,247 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-02 19:44:26,248 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-02 19:44:26,249 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-02 19:44:26,249 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-02 19:44:26,251 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 19:44:26,396 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-02 19:44:26,398 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-02 19:44:26,400 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-02 19:44:26,403 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-02 19:44:26,414 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-02 19:44:26,416 - INFO - [verify.py:59] - Public key comparison results:
2025-01-02 19:44:26,420 - INFO - [verify.py:60] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 19:44:26,425 - INFO - [verify.py:61] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 19:44:26,431 - INFO - [verify.py:62] - Certificate exponent (e): 0x10001
2025-01-02 19:44:26,434 - INFO - [verify.py:63] - Loaded key exponent (e): 0x10001
2025-01-02 19:44:26,451 - INFO - [verify.py:137] - Certificate chain verification successful
2025-01-02 19:44:26,454 - INFO - [verify.py:189] - Server name 'Pasdaran.local' verified successfully.
2025-01-02 19:44:26,455 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-02 19:44:26,457 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-02 19:44:26,458 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-02 19:44:26,459 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-02 19:44:26,465 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-02 19:44:26,468 - INFO - [session.py:207] - Starting TLS session
2025-01-02 19:44:26,485 - INFO - [session.py:116] - Starting TLS Handshake...
2025-01-02 19:44:26,488 - INFO - [client.py:100] - Generated client_random: 0e772267a87ca93cd0b9ad1e1a5aadb60d62b38669e2642222f5f025904e598c
2025-01-02 19:44:26,504 - INFO - [client.py:143] - Client Hello sent from 192.168.1.1
2025-01-02 19:44:26,516 - INFO - [session.py:121] - Client Hello sent successfully
2025-01-02 19:44:26,518 - INFO - [server.py:94] - Generated server_random: 20b948a44197c026429bf09c76d46d3307b7314776d83d1ab11be375a5fcd8f7
2025-01-02 19:44:26,530 - INFO - [session.py:126] - Server Hello received successfully
2025-01-02 19:44:26,532 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2025-01-02 19:44:26,533 - INFO - [cert.py:108] - File exists: True
2025-01-02 19:44:26,534 - INFO - [cert.py:109] - File size: 1915 bytes
2025-01-02 19:44:26,535 - INFO - [cert.py:113] - Read 1915 bytes
2025-01-02 19:44:26,535 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2025-01-02 19:44:26,536 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2025-01-02 19:44:26,537 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 19:44:26,538 - INFO - [client.py:177] - Prepared client certificate
2025-01-02 19:44:26,539 - INFO - [client.py:192] - Encrypted pre_master_secret length: 256
2025-01-02 19:44:26,541 - INFO - [session.py:131] - Client handshake messages sent successfully
2025-01-02 19:44:26,544 - INFO - [session.py:136] - Server key pair verified successfully
2025-01-02 19:44:26,544 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-02 19:44:26,547 - INFO - [chain.py:185] - Decrypted pre_master_secret: 030350ed154f4ad44b8fda2b8988c9fcc9ef2d9b6950ca448713619916967c97a8ab9000fdf11b848a194aa6c3200e3c
2025-01-02 19:44:26,548 - INFO - [chain.py:195] - Generated master secret: 3d99006048332a5b4ee8630530b908c235899932bba421c391d8cdac720341bb23ef603a968d7729d5de61d48661a1f0
2025-01-02 19:44:26,549 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-02 19:44:26,550 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-02 19:44:26,550 - INFO - [session.py:140] - Master Secret handled successfully
2025-01-02 19:44:26,552 - INFO - [client.py:273] - Pre-master secret validated successfully
2025-01-02 19:44:26,553 - INFO - [client.py:291] - Generated digital signature: a6932c0adb33e853812d016136594345ff9a509baedd5bdd431ab901ebd035b6d849a1a1e112c277c8c88aec8d4779f3fef5215dd94a7ded0a365fed3a54e406dee58c439ed36f30ffb56d6a1870191520d2533c81ff98f59860bf7526aa9a8741e0a8283ce0f3acc962c20efa07dea2152c996a3bbf0ffb84426ecc3c91629e241837b24c53ade7703b23cec09dc9f4969d23bce5617c60ee8e65b3387e2e6311655f8e07212ce59110f024360fa09e44240717981948e1d88f27131a1f4f3bb193d68b767056cf806f0af4f9577c24e00420e3a6f63b615a19c29a5d10e52ceb68253c834ae89b098abcb7df39c578e953552a35cb92b281ea9eda8a4bfada
2025-01-02 19:44:26,556 - INFO - [client.py:337] - Client ChangeCipherSpec and Finished messages sent
2025-01-02 19:44:26,557 - INFO - [session.py:145] - Client Change Cipher Spec sent successfully
2025-01-02 19:44:26,559 - INFO - [server.py:260] - Pre-master secret validated successfully
2025-01-02 19:44:26,560 - INFO - [server.py:278] - Generated digital signature: 78ad6a00bcbd6d591a6229f1f56b2e4348f0a5961fd5bc8f40aa1f7f4fee588de4102b90d2ab99f4506ec02da593414f4f3a580a65b1c8931e4ca49407f9960debb9af623dff0b4ccc9c4506dc6e6186c24d4bb518308a2fa423b3d97624d4b5fad38b8a69298845565948edc88163ee69fde0c4ad828f75378771f74673c714100c1370e41e85c1daf7d542cc1e88c267e68e192241ba5fa4236fa5f71630e23764e0569ee9f975e890fb6486d2c10c1ced7ded7f5aaca2d0ef64a17124ebd80c49e3c39484c5fbadb287657007221896d46dc74a5487ee567664c62bb8a1c0f78a4b758d1b8b110a4e556b1d1600c57b489b6f33b629b591ee80067158335b
2025-01-02 19:44:26,566 - INFO - [server.py:324] - Server ChangeCipherSpec and Finished messages sent
2025-01-02 19:44:26,574 - INFO - [session.py:150] - Server Change Cipher Spec received successfully
2025-01-02 19:44:26,581 - INFO - [keys.py:218] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-02 19:44:26,582 - INFO - [session.py:155] - SSL Key Log handled successfully
2025-01-02 19:44:26,583 - INFO - [session.py:159] - TLS Handshake completed successfully
2025-01-02 19:44:26,584 - INFO - [session.py:218] - Found file to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 19:44:26,585 - INFO - [session.py:236] - Handshake completed: True
2025-01-02 19:44:26,585 - INFO - [session.py:237] - Use client cert: True
2025-01-02 19:44:26,586 - INFO - [session.py:238] - File to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 19:44:26,587 - INFO - [session.py:241] - Using encrypted exchange
2025-01-02 19:44:26,587 - INFO - [session.py:256] - Sending encrypted request data
2025-01-02 19:44:26,592 - INFO - [keys.py:185] - TLS Application Data sent from 192.168.1.1:12345 to 10.0.0.1:443
2025-01-02 19:44:26,594 - INFO - [session.py:267] - Sending encrypted response data
2025-01-02 19:44:26,598 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-02 19:44:26,599 - INFO - [session.py:279] - Attempting to send file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 19:44:26,601 - INFO - [session.py:290] - Opening file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 19:44:26,603 - INFO - [session.py:297] - Read 1103 bytes from file
2025-01-02 19:44:26,606 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-02 19:44:26,607 - INFO - [session.py:306] - File sent successfully
2025-01-02 19:44:26,608 - INFO - [session.py:281] - File sent successfully
2025-01-02 19:44:26,608 - INFO - [main.py:96] - Session completed successfully for 192.168.1.1
2025-01-02 19:44:26,609 - INFO - [main.py:88] - 
--- Client Session (no certificate) ---
2025-01-02 19:44:26,610 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-02 19:44:26,611 - INFO - [cert.py:108] - File exists: True
2025-01-02 19:44:26,611 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-02 19:44:26,613 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-02 19:44:26,613 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-02 19:44:26,614 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-02 19:44:26,615 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 19:44:26,617 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-02 19:44:26,618 - INFO - [cert.py:108] - File exists: True
2025-01-02 19:44:26,618 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-02 19:44:26,619 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-02 19:44:26,620 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-02 19:44:26,620 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-02 19:44:26,622 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 19:44:26,691 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-02 19:44:26,691 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-02 19:44:26,692 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-02 19:44:26,692 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-02 19:44:26,693 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-02 19:44:26,693 - INFO - [verify.py:59] - Public key comparison results:
2025-01-02 19:44:26,693 - INFO - [verify.py:60] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 19:44:26,695 - INFO - [verify.py:61] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 19:44:26,697 - INFO - [verify.py:62] - Certificate exponent (e): 0x10001
2025-01-02 19:44:26,698 - INFO - [verify.py:63] - Loaded key exponent (e): 0x10001
2025-01-02 19:44:26,700 - INFO - [verify.py:137] - Certificate chain verification successful
2025-01-02 19:44:26,700 - INFO - [verify.py:189] - Server name 'Pasdaran.local' verified successfully.
2025-01-02 19:44:26,701 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-02 19:44:26,701 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-02 19:44:26,702 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-02 19:44:26,703 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-02 19:44:26,704 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-02 19:44:26,705 - INFO - [session.py:207] - Starting TLS session
2025-01-02 19:44:26,705 - INFO - [session.py:116] - Starting TLS Handshake...
2025-01-02 19:44:26,705 - INFO - [client.py:100] - Generated client_random: e6888538621008392be053706393d19476b8685089bb5d87cf4bb90136f54d6a
2025-01-02 19:44:26,708 - INFO - [client.py:143] - Client Hello sent from 192.168.1.2
2025-01-02 19:44:26,711 - INFO - [session.py:121] - Client Hello sent successfully
2025-01-02 19:44:26,711 - INFO - [server.py:94] - Generated server_random: 6c8feca489e3bfc8624737e74cbb578f8b989f36cc682647a0830c5204cef96f
2025-01-02 19:44:26,719 - INFO - [session.py:126] - Server Hello received successfully
2025-01-02 19:44:26,719 - INFO - [client.py:180] - Prepared empty certificate
2025-01-02 19:44:26,720 - INFO - [client.py:192] - Encrypted pre_master_secret length: 256
2025-01-02 19:44:26,722 - INFO - [session.py:131] - Client handshake messages sent successfully
2025-01-02 19:44:26,725 - INFO - [session.py:136] - Server key pair verified successfully
2025-01-02 19:44:26,725 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-02 19:44:26,727 - INFO - [chain.py:185] - Decrypted pre_master_secret: 03035e591cfaa9e365c67bd316af5b759c83b4ee95f9ca450cadef8f41d43d0775498549514854200157e6f5f9c9b8d9
2025-01-02 19:44:26,728 - INFO - [chain.py:195] - Generated master secret: 6bf9f84cd0890093af3b0fb3d831004dbd00299af45c05f0a01a795fc24fd0672e129b815ef641097f4930810f837d21
2025-01-02 19:44:26,729 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-02 19:44:26,729 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-02 19:44:26,730 - INFO - [session.py:140] - Master Secret handled successfully
2025-01-02 19:44:26,732 - INFO - [client.py:273] - Pre-master secret validated successfully
2025-01-02 19:44:26,734 - INFO - [client.py:291] - Generated digital signature: d67bcc81f1949e87d25018202db44bb9b10b567a5f8e7d4a162509e77efffc9f19fde81bd7b56ea3a1a4132b41d23ef50ead84710c639801f69130d114d22ace7412fc9117e6d21e31cff6d8ad485a8f040fa58041af4da2f9d1a5349fc0b34b773ae3e7ca5ef7fbdeb179e967c1f78febf605dd7f30e259c85296a4783231e9fee8609c0221822df1fb018aab0778a778b4ce521d7caa562d9ae5881c57e3e633697fc935182e5cbe0a862049b41b1bd840e59726a8aa3ac742cecd5bf2b32a7497829c11d91e60746289ce9a8d8eb3c921a7df56063969fd83c504868eb10d202532f1c7b3b72c1c6390d1ddf3b768f127572d4ff744cc68f96191e33c5de2
2025-01-02 19:44:26,736 - INFO - [client.py:337] - Client ChangeCipherSpec and Finished messages sent
2025-01-02 19:44:26,738 - INFO - [session.py:145] - Client Change Cipher Spec sent successfully
2025-01-02 19:44:26,739 - INFO - [server.py:260] - Pre-master secret validated successfully
2025-01-02 19:44:26,741 - INFO - [server.py:278] - Generated digital signature: 6255bf57eda74b624c3535c0eb6c5a1ece963b72bf02497d1a60d627206797f5f8eb852255619dc8f97e54938c2aa8859b1e5f40662fa0de9980d439aa1a24e1b778ca9e639ce153181fc29e655a8fd25763f4cee320470b91d4b8bf9b50a998ae90c1a0462d560eabd2181f605ac5afec86ae99e4416af5095a64090224501d93d95c53925f1827f1ba46ba8d9594dab96a700486bbf82f9597939dcfcc24aa1201a91ec0974873a059ab8a580990e8322a8337d230324bb2c455dc67d0d499ec1134c5559b872fa38f69045108d5bba5edb77eeea10acd5b61772e15e4527e5668b42fa0171cb0f6a83b6541abd22919d018a7b6289bdd0b7a8271a702d584
2025-01-02 19:44:26,742 - INFO - [server.py:324] - Server ChangeCipherSpec and Finished messages sent
2025-01-02 19:44:26,744 - INFO - [session.py:150] - Server Change Cipher Spec received successfully
2025-01-02 19:44:26,745 - INFO - [keys.py:218] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-02 19:44:26,746 - INFO - [session.py:155] - SSL Key Log handled successfully
2025-01-02 19:44:26,746 - INFO - [session.py:159] - TLS Handshake completed successfully
2025-01-02 19:44:26,747 - INFO - [session.py:236] - Handshake completed: True
2025-01-02 19:44:26,747 - INFO - [session.py:237] - Use client cert: False
2025-01-02 19:44:26,748 - INFO - [session.py:238] - File to send: None
2025-01-02 19:44:26,748 - INFO - [session.py:244] - Using unencrypted exchange
2025-01-02 19:44:26,750 - INFO - [session.py:344] - Added request packet
2025-01-02 19:44:26,751 - INFO - [session.py:344] - Added response packet
2025-01-02 19:44:26,752 - WARNING - [session.py:321] - Using unencrypted communication
2025-01-02 19:44:26,752 - INFO - [main.py:96] - Session completed successfully for 192.168.1.2
2025-01-02 19:44:26,753 - INFO - [packet_validator.py:110] - Packet 13: Valid HTTP message
2025-01-02 19:44:26,753 - INFO - [packet_validator.py:110] - Packet 14: Valid HTTP message
2025-01-02 19:44:26,760 - INFO - [packet_storage.py:79] - Saved 15 valid packets to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-02 19:44:26,760 - INFO - [packet_storage.py:100] - Verifying 15 packets...
2025-01-02 19:44:26,761 - INFO - [packet_storage.py:104] - Packet 1: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 19:44:26,761 - INFO - [packet_storage.py:104] - Packet 2: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 19:44:26,762 - INFO - [packet_storage.py:104] - Packet 3: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 19:44:26,763 - INFO - [packet_storage.py:104] - Packet 4: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 19:44:26,764 - INFO - [packet_storage.py:104] - Packet 5: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 19:44:26,765 - INFO - [packet_storage.py:104] - Packet 6: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 19:44:26,766 - INFO - [packet_storage.py:104] - Packet 7: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 19:44:26,768 - INFO - [packet_storage.py:104] - Packet 8: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 19:44:26,768 - INFO - [packet_storage.py:104] - Packet 9: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-02 19:44:26,769 - INFO - [packet_storage.py:104] - Packet 10: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-02 19:44:26,769 - INFO - [packet_storage.py:104] - Packet 11: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-02 19:44:26,770 - INFO - [packet_storage.py:104] - Packet 12: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-02 19:44:26,770 - INFO - [packet_storage.py:104] - Packet 13: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-02 19:44:26,771 - INFO - [packet_storage.py:104] - Packet 14: IP / TCP 192.168.1.2:12346 > 10.0.0.1:http PA / Raw
2025-01-02 19:44:26,772 - INFO - [packet_storage.py:104] - Packet 15: IP / TCP 10.0.0.1:http > 192.168.1.2:12346 PA / Raw
2025-01-02 19:44:26,772 - INFO - [packet_storage.py:111] - Verification complete: 15 valid packets, 13 TLS records
2025-01-02 19:44:26,773 - INFO - [main.py:107] - Results saved to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-02 19:44:26,773 - INFO - [main.py:161] - TLS session simulation completed successfully
2025-01-02 19:49:24,722 - INFO - [logging.py:83] - Logging configured successfully
2025-01-02 19:49:24,723 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-02 19:49:24,724 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-02 19:49:24,724 - INFO - [logging.py:92] - Log level: 20
2025-01-02 19:49:24,725 - INFO - [logging.py:93] - Timestamp: 2025-01-02T19:49:24.725164
2025-01-02 19:49:24,725 - INFO - [logging.py:94] - ==========================
2025-01-02 19:49:24,726 - INFO - [main.py:123] - Starting TLS session simulation
2025-01-02 19:49:24,726 - INFO - [main.py:88] - 
--- Client Session (certificate) ---
2025-01-02 19:49:24,728 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-02 19:49:24,728 - INFO - [cert.py:108] - File exists: True
2025-01-02 19:49:24,729 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-02 19:49:24,730 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-02 19:49:24,731 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-02 19:49:24,731 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-02 19:49:24,738 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 19:49:24,739 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-02 19:49:24,740 - INFO - [cert.py:108] - File exists: True
2025-01-02 19:49:24,741 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-02 19:49:24,742 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-02 19:49:24,742 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-02 19:49:24,742 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-02 19:49:24,744 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 19:49:24,807 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-02 19:49:24,808 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-02 19:49:24,808 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-02 19:49:24,809 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-02 19:49:24,812 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-02 19:49:24,813 - INFO - [verify.py:59] - Public key comparison results:
2025-01-02 19:49:24,814 - INFO - [verify.py:60] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 19:49:24,815 - INFO - [verify.py:61] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 19:49:24,816 - INFO - [verify.py:62] - Certificate exponent (e): 0x10001
2025-01-02 19:49:24,816 - INFO - [verify.py:63] - Loaded key exponent (e): 0x10001
2025-01-02 19:49:24,822 - INFO - [verify.py:137] - Certificate chain verification successful
2025-01-02 19:49:24,823 - INFO - [verify.py:189] - Server name 'Pasdaran.local' verified successfully.
2025-01-02 19:49:24,824 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-02 19:49:24,824 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-02 19:49:24,825 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-02 19:49:24,826 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-02 19:49:24,827 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-02 19:49:24,828 - INFO - [session.py:207] - Starting TLS session
2025-01-02 19:49:24,829 - INFO - [session.py:116] - Starting TLS Handshake...
2025-01-02 19:49:24,829 - INFO - [client.py:100] - Generated client_random: 841a0d5a29ae858a90c2c380f11666b7b006ec5a9070e46a0fba3ec508bf80f1
2025-01-02 19:49:24,832 - INFO - [client.py:143] - Client Hello sent from 192.168.1.1
2025-01-02 19:49:24,835 - INFO - [session.py:121] - Client Hello sent successfully
2025-01-02 19:49:24,836 - INFO - [server.py:94] - Generated server_random: 6ff96fa6adc7c1a3188fe4f8fc06de05bae5d2f240b07427b1374338c44a1fc6
2025-01-02 19:49:24,842 - INFO - [session.py:126] - Server Hello received successfully
2025-01-02 19:49:24,843 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2025-01-02 19:49:24,844 - INFO - [cert.py:108] - File exists: True
2025-01-02 19:49:24,844 - INFO - [cert.py:109] - File size: 1915 bytes
2025-01-02 19:49:24,845 - INFO - [cert.py:113] - Read 1915 bytes
2025-01-02 19:49:24,846 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2025-01-02 19:49:24,846 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2025-01-02 19:49:24,848 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 19:49:24,849 - INFO - [client.py:177] - Prepared client certificate
2025-01-02 19:49:24,850 - INFO - [client.py:192] - Encrypted pre_master_secret length: 256
2025-01-02 19:49:24,852 - INFO - [session.py:131] - Client handshake messages sent successfully
2025-01-02 19:49:24,854 - INFO - [session.py:136] - Server key pair verified successfully
2025-01-02 19:49:24,854 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-02 19:49:24,856 - INFO - [chain.py:185] - Decrypted pre_master_secret: 0303df273da1d2997117f0d675d0be552c66eda75cf66ea92791733cc2404082626f94196e5ff67c45419c95219904ca
2025-01-02 19:49:24,856 - INFO - [chain.py:195] - Generated master secret: 80aeff0a7197ea9dce23af150a4ae460b265cc514d9496468e0c7088b76536f539dcb0d044bbd79cefd00eeaeee55950
2025-01-02 19:49:24,857 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-02 19:49:24,857 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-02 19:49:24,857 - INFO - [session.py:140] - Master Secret handled successfully
2025-01-02 19:49:24,858 - INFO - [client.py:273] - Pre-master secret validated successfully
2025-01-02 19:49:24,859 - INFO - [client.py:291] - Generated digital signature: 4fb0aecff4eaa4b9a6a70a242f5aa271f9f3f09b7ab5607afd070f821256d1cbb5c3b215d938fa9147bfcf54625d1b1158650b40986441670ced847d5a705f822b501f31ad94066166e1e77878ce6e6d5395d439dca4bb4fcf83192fbe2fc417f3a6b50a35e48e85b6df0eb18bc4412e6ee4aeb1fc0badb36b78e267f883a0c87ca95999747db166c71e9f7a6b49fbc181c2b37fd1b3103193c562a961197cd5191018d07d8bd10f856ee0e56b58dc5d8577742329948deb72905cbfe7ebdabbd0e68e422c115054a82923bca5300d26cc175ea10ad60357a4c48739f0009167412ea59c1f1c646e54fb0e440ed3c3c7ef8228fd529c5a90f6bded8f3b58855b
2025-01-02 19:49:24,861 - INFO - [client.py:337] - Client ChangeCipherSpec and Finished messages sent
2025-01-02 19:49:24,863 - INFO - [session.py:145] - Client Change Cipher Spec sent successfully
2025-01-02 19:49:24,864 - INFO - [server.py:260] - Pre-master secret validated successfully
2025-01-02 19:49:24,865 - INFO - [server.py:278] - Generated digital signature: 95401b3e9c162341dd21918058b4fa32670d9782b4bb7d98f1195654d22a0409211470875d93e6442443aee718079e33353f26ee5f5bf494c4c48a948d5f7a105f3ceb2be6df8cd7087951a6b0e0bae70cbbf60177df430aacb6bf5f9e1307c408b49f654dd3e77064e1de7cf3a6b397313cc97864092a9dd119d6ab8bc453c12642d070f70f6df80aac2ed0dbc073216a77b1dff8e5745757e2f49e3aefaa63416b24fbde5e0f2bf606a986ac094fc891b02bcef33f8a98667ecf7e463b9bc55ac8926748d0eac0aca7d440de8298756e9e72c839fc987fcafeea704568205173ab04c8107407f23a34f2217ee6da273945bf9664ff9828965a87ef091c5eb1
2025-01-02 19:49:24,867 - INFO - [server.py:324] - Server ChangeCipherSpec and Finished messages sent
2025-01-02 19:49:24,868 - INFO - [session.py:150] - Server Change Cipher Spec received successfully
2025-01-02 19:49:24,870 - INFO - [keys.py:218] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-02 19:49:24,871 - INFO - [session.py:155] - SSL Key Log handled successfully
2025-01-02 19:49:24,872 - INFO - [session.py:159] - TLS Handshake completed successfully
2025-01-02 19:49:24,873 - INFO - [session.py:218] - Found file to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 19:49:24,873 - INFO - [session.py:236] - Handshake completed: True
2025-01-02 19:49:24,874 - INFO - [session.py:237] - Use client cert: True
2025-01-02 19:49:24,874 - INFO - [session.py:238] - File to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 19:49:24,875 - INFO - [session.py:241] - Using encrypted exchange
2025-01-02 19:49:24,875 - INFO - [session.py:256] - Sending encrypted request data
2025-01-02 19:49:24,877 - INFO - [keys.py:185] - TLS Application Data sent from 192.168.1.1:12345 to 10.0.0.1:443
2025-01-02 19:49:24,878 - INFO - [session.py:267] - Sending encrypted response data
2025-01-02 19:49:24,879 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-02 19:49:24,880 - INFO - [session.py:279] - Attempting to send file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 19:49:24,881 - INFO - [session.py:290] - Opening file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-02 19:49:24,882 - INFO - [session.py:297] - Read 1103 bytes from file
2025-01-02 19:49:24,884 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-02 19:49:24,885 - INFO - [session.py:306] - File sent successfully
2025-01-02 19:49:24,886 - INFO - [session.py:281] - File sent successfully
2025-01-02 19:49:24,886 - INFO - [main.py:96] - Session completed successfully for 192.168.1.1
2025-01-02 19:49:24,888 - INFO - [main.py:88] - 
--- Client Session (no certificate) ---
2025-01-02 19:49:24,889 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-02 19:49:24,890 - INFO - [cert.py:108] - File exists: True
2025-01-02 19:49:24,890 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-02 19:49:24,890 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-02 19:49:24,891 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-02 19:49:24,891 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-02 19:49:24,893 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 19:49:24,893 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-02 19:49:24,894 - INFO - [cert.py:108] - File exists: True
2025-01-02 19:49:24,894 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-02 19:49:24,895 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-02 19:49:24,895 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-02 19:49:24,895 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-02 19:49:24,896 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-02 19:49:24,927 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-02 19:49:24,928 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-02 19:49:24,928 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-02 19:49:24,928 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-02 19:49:24,929 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-02 19:49:24,929 - INFO - [verify.py:59] - Public key comparison results:
2025-01-02 19:49:24,930 - INFO - [verify.py:60] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 19:49:24,931 - INFO - [verify.py:61] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-02 19:49:24,931 - INFO - [verify.py:62] - Certificate exponent (e): 0x10001
2025-01-02 19:49:24,931 - INFO - [verify.py:63] - Loaded key exponent (e): 0x10001
2025-01-02 19:49:24,932 - INFO - [verify.py:137] - Certificate chain verification successful
2025-01-02 19:49:24,932 - INFO - [verify.py:189] - Server name 'Pasdaran.local' verified successfully.
2025-01-02 19:49:24,933 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-02 19:49:24,933 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-02 19:49:24,933 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-02 19:49:24,934 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-02 19:49:24,936 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-02 19:49:24,937 - INFO - [session.py:207] - Starting TLS session
2025-01-02 19:49:24,937 - INFO - [session.py:116] - Starting TLS Handshake...
2025-01-02 19:49:24,938 - INFO - [client.py:100] - Generated client_random: bdd384eedb083d0663f8843be65fe17cf8abf7f668e52788d1de9fcd81c566fa
2025-01-02 19:49:24,940 - INFO - [client.py:143] - Client Hello sent from 192.168.1.2
2025-01-02 19:49:24,942 - INFO - [session.py:121] - Client Hello sent successfully
2025-01-02 19:49:24,942 - INFO - [server.py:94] - Generated server_random: bc10ff1b7e2f326e601da91a81fdc7eb584e9c19681f603738a7c9de3368311b
2025-01-02 19:49:24,945 - INFO - [session.py:126] - Server Hello received successfully
2025-01-02 19:49:24,945 - INFO - [client.py:180] - Prepared empty certificate
2025-01-02 19:49:24,946 - INFO - [client.py:192] - Encrypted pre_master_secret length: 256
2025-01-02 19:49:24,947 - INFO - [session.py:131] - Client handshake messages sent successfully
2025-01-02 19:49:24,949 - INFO - [session.py:136] - Server key pair verified successfully
2025-01-02 19:49:24,949 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-02 19:49:24,950 - INFO - [chain.py:185] - Decrypted pre_master_secret: 0303e0459f96f4001fcf48727fcb8f0f657dc8e77e5cef8ec8fe8409945491132d190b043d44d5462024c95f0b4361f4
2025-01-02 19:49:24,950 - INFO - [chain.py:195] - Generated master secret: e9f7e0c8abc112c30342f6d867de11e3b1094b8bf9a0c5ed2bac4eac4e948851096fedf5e1807aa823d27ce70a2ff046
2025-01-02 19:49:24,951 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-02 19:49:24,951 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-02 19:49:24,952 - INFO - [session.py:140] - Master Secret handled successfully
2025-01-02 19:49:24,954 - INFO - [client.py:273] - Pre-master secret validated successfully
2025-01-02 19:49:24,955 - INFO - [client.py:291] - Generated digital signature: abc0aa037eb8326a8dfbc3a0f0348c356434b59b57525d78b6947faca729ce8a8866d09879efd185a1a534df20d3bf9e7b6ae98184b3699d9316debd4ce1c7924d1a36874cc923148aa39be14ebc2996c4a4f291936dc90e8ed119e7f29daac500ff3ff41f821841c38fd408380c68773033f20a542a94639e3319fad0bb9b4873cbe9945997ac7cb1cb59fe93ae9c03cd2e6388f4bc8bb107c2a1000f13b72452f1a14c08bb59c4e81e9777c745bdbe3930df67cbe45493ad584a0b072036dbb0fb9da00fff88f318518b5d744262938fef44bea587acf6fe93bad6afb7ecd3dc1bb3610fabe30964ed2cfd9da3ffab002ebd3adf9029f8e5b9459469fb3560
2025-01-02 19:49:24,957 - INFO - [client.py:337] - Client ChangeCipherSpec and Finished messages sent
2025-01-02 19:49:24,958 - INFO - [session.py:145] - Client Change Cipher Spec sent successfully
2025-01-02 19:49:24,959 - INFO - [server.py:260] - Pre-master secret validated successfully
2025-01-02 19:49:24,960 - INFO - [server.py:278] - Generated digital signature: 03e36fd3c365d19f60fe43aecf9b4ecacd7cd3d77ab5cb983a234e9bd836cb0d326e559026f75ddb62e5e1417350fcdc64cc852ba4fe7059d1986982573cf771d364f73228d3089fcc7dd46a29a883cb039a85ea97060a883f23619abad966424af612de76046830c99e04bbdb563a687bded2abd3f1fba8c567272d88b3bfc1049819f06ee113787692111560af81b8b56fe50f78d9b1e6988365cd41a43addce897666ac0a94e503068136374befb3aa21730f3a852d4e9ca7b76c58c859606ed66316dd1086f2b0b5c90127953542c8034cc38093d43fc07e52e52bc0b319c71f25799d7a53fdbbbf027d430667fc92708ed526f16d25f99d7f9737c58be5
2025-01-02 19:49:24,962 - INFO - [server.py:324] - Server ChangeCipherSpec and Finished messages sent
2025-01-02 19:49:24,963 - INFO - [session.py:150] - Server Change Cipher Spec received successfully
2025-01-02 19:49:24,964 - INFO - [keys.py:218] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-02 19:49:24,965 - INFO - [session.py:155] - SSL Key Log handled successfully
2025-01-02 19:49:24,965 - INFO - [session.py:159] - TLS Handshake completed successfully
2025-01-02 19:49:24,966 - INFO - [session.py:236] - Handshake completed: True
2025-01-02 19:49:24,966 - INFO - [session.py:237] - Use client cert: False
2025-01-02 19:49:24,967 - INFO - [session.py:238] - File to send: None
2025-01-02 19:49:24,967 - INFO - [session.py:244] - Using unencrypted exchange
2025-01-02 19:49:24,968 - INFO - [session.py:344] - Added request packet
2025-01-02 19:49:24,970 - INFO - [session.py:344] - Added response packet
2025-01-02 19:49:24,972 - WARNING - [session.py:321] - Using unencrypted communication
2025-01-02 19:49:24,974 - INFO - [main.py:96] - Session completed successfully for 192.168.1.2
2025-01-02 19:49:24,976 - INFO - [packet_validator.py:110] - Packet 13: Valid HTTP message
2025-01-02 19:49:24,977 - INFO - [packet_validator.py:110] - Packet 14: Valid HTTP message
2025-01-02 19:49:24,984 - INFO - [packet_storage.py:79] - Saved 15 valid packets to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-02 19:49:24,985 - INFO - [packet_storage.py:100] - Verifying 15 packets...
2025-01-02 19:49:24,986 - INFO - [packet_storage.py:104] - Packet 1: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 19:49:24,987 - INFO - [packet_storage.py:104] - Packet 2: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 19:49:24,989 - INFO - [packet_storage.py:104] - Packet 3: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 19:49:24,989 - INFO - [packet_storage.py:104] - Packet 4: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 19:49:24,990 - INFO - [packet_storage.py:104] - Packet 5: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 19:49:24,991 - INFO - [packet_storage.py:104] - Packet 6: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-02 19:49:24,992 - INFO - [packet_storage.py:104] - Packet 7: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 19:49:24,993 - INFO - [packet_storage.py:104] - Packet 8: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-02 19:49:24,993 - INFO - [packet_storage.py:104] - Packet 9: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-02 19:49:24,994 - INFO - [packet_storage.py:104] - Packet 10: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-02 19:49:24,995 - INFO - [packet_storage.py:104] - Packet 11: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-02 19:49:24,995 - INFO - [packet_storage.py:104] - Packet 12: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-02 19:49:24,996 - INFO - [packet_storage.py:104] - Packet 13: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-02 19:49:24,997 - INFO - [packet_storage.py:104] - Packet 14: IP / TCP 192.168.1.2:12346 > 10.0.0.1:http PA / Raw
2025-01-02 19:49:24,997 - INFO - [packet_storage.py:104] - Packet 15: IP / TCP 10.0.0.1:http > 192.168.1.2:12346 PA / Raw
2025-01-02 19:49:24,998 - INFO - [packet_storage.py:111] - Verification complete: 15 valid packets, 13 TLS records
2025-01-02 19:49:24,998 - INFO - [main.py:107] - Results saved to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-02 19:49:24,999 - INFO - [main.py:161] - TLS session simulation completed successfully
2025-01-08 08:56:35,280 - INFO - [logging.py:83] - Logging configured successfully
2025-01-08 08:56:35,280 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-08 08:56:35,281 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-08 08:56:35,281 - INFO - [logging.py:92] - Log level: 20
2025-01-08 08:56:35,281 - INFO - [logging.py:93] - Timestamp: 2025-01-08T08:56:35.281574
2025-01-08 08:56:35,281 - INFO - [logging.py:94] - ==========================
2025-01-08 08:56:35,281 - INFO - [main.py:123] - Starting TLS session simulation
2025-01-08 08:56:35,281 - INFO - [main.py:88] - 
--- Client Session (certificate) ---
2025-01-08 08:56:35,282 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-08 08:56:35,283 - INFO - [cert.py:108] - File exists: True
2025-01-08 08:56:35,283 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-08 08:56:35,295 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-08 08:56:35,296 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-08 08:56:35,297 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-08 08:56:35,304 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-08 08:56:35,305 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-08 08:56:35,307 - INFO - [cert.py:108] - File exists: True
2025-01-08 08:56:35,308 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-08 08:56:35,320 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-08 08:56:35,321 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-08 08:56:35,322 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-08 08:56:35,324 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-08 08:56:35,384 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-08 08:56:35,384 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-08 08:56:35,385 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-08 08:56:35,386 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-08 08:56:35,388 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-08 08:56:35,388 - INFO - [verify.py:59] - Public key comparison results:
2025-01-08 08:56:35,388 - INFO - [verify.py:60] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-08 08:56:35,389 - INFO - [verify.py:61] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-08 08:56:35,390 - INFO - [verify.py:62] - Certificate exponent (e): 0x10001
2025-01-08 08:56:35,391 - INFO - [verify.py:63] - Loaded key exponent (e): 0x10001
2025-01-08 08:56:35,394 - INFO - [verify.py:137] - Certificate chain verification successful
2025-01-08 08:56:35,395 - INFO - [verify.py:189] - Server name 'Pasdaran.local' verified successfully.
2025-01-08 08:56:35,396 - INFO - [chain.py:99] - Certificate chain verification passed
2025-01-08 08:56:35,396 - INFO - [chain.py:106] - Certificate chain loaded successfully
2025-01-08 08:56:35,397 - INFO - [chain.py:107] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-08 08:56:35,397 - INFO - [chain.py:108] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-08 08:56:35,399 - INFO - [chain.py:112] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-08 08:56:35,400 - INFO - [session.py:192] - Starting TLS session
2025-01-08 08:56:35,400 - INFO - [session.py:101] - Starting TLS Handshake...
2025-01-08 08:56:35,401 - INFO - [client.py:100] - Generated client_random: 5cd00bdecd27b85949a6ce497cbd4e24a8bf6b86086ac6b04e4645d65851b0a7
2025-01-08 08:56:35,407 - INFO - [client.py:143] - Client Hello sent from 192.168.1.1
2025-01-08 08:56:35,414 - INFO - [session.py:106] - Client Hello sent successfully
2025-01-08 08:56:35,415 - INFO - [server.py:94] - Generated server_random: 8d447084b217333b0652316276877928b878656d9726db5efc19cded331f55c1
2025-01-08 08:56:35,419 - INFO - [session.py:111] - Server Hello received successfully
2025-01-08 08:56:35,420 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2025-01-08 08:56:35,421 - INFO - [cert.py:108] - File exists: True
2025-01-08 08:56:35,422 - INFO - [cert.py:109] - File size: 1915 bytes
2025-01-08 08:56:35,434 - INFO - [cert.py:113] - Read 1915 bytes
2025-01-08 08:56:35,435 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2025-01-08 08:56:35,435 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2025-01-08 08:56:35,436 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-08 08:56:35,438 - INFO - [client.py:177] - Prepared client certificate
2025-01-08 08:56:35,440 - INFO - [client.py:192] - Encrypted pre_master_secret length: 256
2025-01-08 08:56:35,441 - INFO - [session.py:116] - Client handshake messages sent successfully
2025-01-08 08:56:35,442 - INFO - [session.py:121] - Server key pair verified successfully
2025-01-08 08:56:35,442 - INFO - [keys.py:350] - Starting Master Secret generation.
2025-01-08 08:56:35,444 - INFO - [keys.py:301] - Decrypted pre_master_secret: 0303a8e64cda5bd95952a0fff3ae3a75724363edde3249ed183c714d3527c01606590a6f513a813c471e02c59912709f
2025-01-08 08:56:35,444 - INFO - [keys.py:311] - Generated master secret: 166c061648aeca839f506b9ce6de93ad838deb8b2293246157cb1ee040dce477d0d0e1998ac5a0b93b9a9f2a04740723
2025-01-08 08:56:35,445 - INFO - [keys.py:312] - Master secret length: 48 bytes
2025-01-08 08:56:35,445 - INFO - [keys.py:371] - Master Secret generation completed successfully.
2025-01-08 08:56:35,446 - INFO - [session.py:125] - Master Secret handled successfully
2025-01-08 08:56:35,447 - INFO - [client.py:273] - Pre-master secret validated successfully
2025-01-08 08:56:35,448 - INFO - [client.py:291] - Generated digital signature: 3b7738c5f8dd5bbb4d866cebe57985a86b5b190d97c4606fdcfd1c2bb05a699ef61f76549f68df05fd89127b464642abb95a05c748cfcfb011a5aa4cc20be46b5c10851583ded261cfa1ad4ad50032603e67a2dd1fdcaa8028379bb19f406913b0677da7396e9943105846229e40203ebd68d92461b5ffc627d787cee200e7e15cdc652eb7b8a591ff2364b6c5f28c211310791ce2f8c83a728d07af2c39fe380f3bac0a8942a07cc849eaa0a0231266d85f545be73bdb50ed9df62ad13c5dc14456e0c15327156e3a1c72de4265aba98e7debe9f85000e49c1230566cee22bec03fcab0ce90029cb89cfb208a53b829c6d86ddfec31598b62bfd9828633b16a
2025-01-08 08:56:35,451 - INFO - [client.py:337] - Client ChangeCipherSpec and Finished messages sent
2025-01-08 08:56:35,453 - INFO - [session.py:130] - Client Change Cipher Spec sent successfully
2025-01-08 08:56:35,454 - INFO - [server.py:260] - Pre-master secret validated successfully
2025-01-08 08:56:35,455 - INFO - [server.py:278] - Generated digital signature: 5aa2bca33b6ec5608ad1eb67c3cea080b31fdcccdb9a855f0132eef79f3ad9e3e2739d0052b27a1bb49cec2a0cc956d942b123b4a501df359832b3319f12fb680a041b0ea7b77ec96eb7bccf9bb0b8272a488b8cc3c787e8fd41ecee55d9ea6a2a7c0fc27583afa6ab9fc6bae6dc3a244f40d04aaaf9da4fe6fa74ea6aa2c7aceb6717a24951f8792b45a0d44c8d37642d01986396d60ac6e3fc164da66c989d5468a633e75acb57d1e6a9d4750e3e70fa5c67a3012040b3b35f8f876fd41f2625d208f6b871175aec71cc32b4e0b84b02ac75105a02331859b3b3b6333f31b0a8aa22404e9c69dda558f2ed87f109e6e5aa818a9249dcc509994bc32104d883
2025-01-08 08:56:35,457 - INFO - [server.py:324] - Server ChangeCipherSpec and Finished messages sent
2025-01-08 08:56:35,458 - INFO - [session.py:135] - Server Change Cipher Spec received successfully
2025-01-08 08:56:35,459 - INFO - [keys.py:219] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-08 08:56:35,459 - INFO - [session.py:140] - SSL Key Log handled successfully
2025-01-08 08:56:35,460 - INFO - [session.py:144] - TLS Handshake completed successfully
2025-01-08 08:56:35,460 - INFO - [session.py:203] - Found file to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-08 08:56:35,461 - INFO - [session.py:221] - Handshake completed: True
2025-01-08 08:56:35,462 - INFO - [session.py:222] - Use client cert: True
2025-01-08 08:56:35,462 - INFO - [session.py:223] - File to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-08 08:56:35,463 - INFO - [session.py:226] - Using encrypted exchange
2025-01-08 08:56:35,463 - INFO - [session.py:241] - Sending encrypted request data
2025-01-08 08:56:35,467 - INFO - [keys.py:186] - TLS Application Data sent from 192.168.1.1:12345 to 10.0.0.1:443
2025-01-08 08:56:35,467 - INFO - [session.py:252] - Sending encrypted response data
2025-01-08 08:56:35,470 - INFO - [keys.py:186] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-08 08:56:35,471 - INFO - [session.py:264] - Attempting to send file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-08 08:56:35,472 - INFO - [session.py:275] - Opening file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-08 08:56:35,473 - INFO - [session.py:282] - Read 1103 bytes from file
2025-01-08 08:56:35,474 - INFO - [keys.py:186] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-08 08:56:35,474 - INFO - [session.py:291] - File sent successfully
2025-01-08 08:56:35,475 - INFO - [session.py:266] - File sent successfully
2025-01-08 08:56:35,475 - INFO - [main.py:96] - Session completed successfully for 192.168.1.1
2025-01-08 08:56:35,475 - INFO - [main.py:88] - 
--- Client Session (no certificate) ---
2025-01-08 08:56:35,476 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-08 08:56:35,477 - INFO - [cert.py:108] - File exists: True
2025-01-08 08:56:35,478 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-08 08:56:35,478 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-08 08:56:35,478 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-08 08:56:35,479 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-08 08:56:35,480 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-08 08:56:35,481 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-08 08:56:35,481 - INFO - [cert.py:108] - File exists: True
2025-01-08 08:56:35,481 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-08 08:56:35,482 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-08 08:56:35,482 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-08 08:56:35,482 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-08 08:56:35,483 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-08 08:56:35,514 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-08 08:56:35,515 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-08 08:56:35,515 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-08 08:56:35,516 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-08 08:56:35,516 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-08 08:56:35,516 - INFO - [verify.py:59] - Public key comparison results:
2025-01-08 08:56:35,517 - INFO - [verify.py:60] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-08 08:56:35,517 - INFO - [verify.py:61] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-08 08:56:35,518 - INFO - [verify.py:62] - Certificate exponent (e): 0x10001
2025-01-08 08:56:35,518 - INFO - [verify.py:63] - Loaded key exponent (e): 0x10001
2025-01-08 08:56:35,518 - INFO - [verify.py:137] - Certificate chain verification successful
2025-01-08 08:56:35,519 - INFO - [verify.py:189] - Server name 'Pasdaran.local' verified successfully.
2025-01-08 08:56:35,519 - INFO - [chain.py:99] - Certificate chain verification passed
2025-01-08 08:56:35,519 - INFO - [chain.py:106] - Certificate chain loaded successfully
2025-01-08 08:56:35,520 - INFO - [chain.py:107] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-08 08:56:35,520 - INFO - [chain.py:108] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-08 08:56:35,522 - INFO - [chain.py:112] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-08 08:56:35,523 - INFO - [session.py:192] - Starting TLS session
2025-01-08 08:56:35,523 - INFO - [session.py:101] - Starting TLS Handshake...
2025-01-08 08:56:35,523 - INFO - [client.py:100] - Generated client_random: 2519d59a9430c4245f6aaa7748bafc19264ae95fffd77ce4b571d05054f3e729
2025-01-08 08:56:35,525 - INFO - [client.py:143] - Client Hello sent from 192.168.1.2
2025-01-08 08:56:35,528 - INFO - [session.py:106] - Client Hello sent successfully
2025-01-08 08:56:35,529 - INFO - [server.py:94] - Generated server_random: 769602a4320e50be86f12473ed8599d7d9f9ffc2e22db11a2e50b6e4ced74fc9
2025-01-08 08:56:35,533 - INFO - [session.py:111] - Server Hello received successfully
2025-01-08 08:56:35,534 - INFO - [client.py:180] - Prepared empty certificate
2025-01-08 08:56:35,534 - INFO - [client.py:192] - Encrypted pre_master_secret length: 256
2025-01-08 08:56:35,535 - INFO - [session.py:116] - Client handshake messages sent successfully
2025-01-08 08:56:35,537 - INFO - [session.py:121] - Server key pair verified successfully
2025-01-08 08:56:35,537 - INFO - [keys.py:350] - Starting Master Secret generation.
2025-01-08 08:56:35,538 - INFO - [keys.py:301] - Decrypted pre_master_secret: 03038f7852e0186d178929f037fd38b63a2fc231bec994fe7a5ad17493bf9a3a4b3592c6f03c0b359379092316f6a69e
2025-01-08 08:56:35,538 - INFO - [keys.py:311] - Generated master secret: 25de2fcbb2a75f02627bf9241979973d00fa445911071a00f83f1a1ec081952877593dba8c33496ef26434562e03d178
2025-01-08 08:56:35,539 - INFO - [keys.py:312] - Master secret length: 48 bytes
2025-01-08 08:56:35,539 - INFO - [keys.py:371] - Master Secret generation completed successfully.
2025-01-08 08:56:35,539 - INFO - [session.py:125] - Master Secret handled successfully
2025-01-08 08:56:35,540 - INFO - [client.py:273] - Pre-master secret validated successfully
2025-01-08 08:56:35,541 - INFO - [client.py:291] - Generated digital signature: 49bf3c3084a1e2debc84d2c6e4b5d97a7b6e1d1a998954c70e8b588f4b0fb554fd1ce05312ca6ba63b7851ed6585db635efb9781d8abb89f5781772734e51695b02f8296ffe81c8f923ca651626254158c443122cb06d99060268f9800a118bde399c816805f7d650e70cbce579f0f5765067c58043f73280d60678c6a1e3f6dbe391d1c6c0c8cbf4e86a02428c32d40c52960094cc9c4332bfa869a0c85fab59311669d14a44c30d215ca8bb36e8808a550a15293c0557a34d09171f42ddac42d18b1803debd23ed0f6e2bed50c16d4f95d46792af65c972e370927e89c90b76145f0ef37bc612c98343b08880a4f009c112846f3a96d9df1b6d00da9653466
2025-01-08 08:56:35,542 - INFO - [client.py:337] - Client ChangeCipherSpec and Finished messages sent
2025-01-08 08:56:35,543 - INFO - [session.py:130] - Client Change Cipher Spec sent successfully
2025-01-08 08:56:35,544 - INFO - [server.py:260] - Pre-master secret validated successfully
2025-01-08 08:56:35,546 - INFO - [server.py:278] - Generated digital signature: 1f2821adc9ea42d8729d0dbd40f8284ff55ce105dc637fbe9dc13a900dd44de6f226c939cbc8607a9a16ed5fc3da0aac531b113204f90663562eb6fd1350298464427051b3e130b272d047db599eb9f5c45e23da752f381cbd33717ae4cc186c44feaac8cc921cc3d80b92a5f756776568d0fcffd97781b57d3e8899bfbc95964e52604f239b2434017341da7f403197bd3d202cf0d498886d93f441e26007919ea4f8af7ec63561c9aa563ed7c2c3c4edce185ea62154a665f979ddc707e5bddcdb2243d105a98933afb490118d2340848cf95bb683def3a6dd970af90db9b692ba68e79983823e7c7284f37cac03bcbe30ce01705e816467c9acb14146175e
2025-01-08 08:56:35,549 - INFO - [server.py:324] - Server ChangeCipherSpec and Finished messages sent
2025-01-08 08:56:35,550 - INFO - [session.py:135] - Server Change Cipher Spec received successfully
2025-01-08 08:56:35,550 - INFO - [keys.py:219] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-08 08:56:35,551 - INFO - [session.py:140] - SSL Key Log handled successfully
2025-01-08 08:56:35,551 - INFO - [session.py:144] - TLS Handshake completed successfully
2025-01-08 08:56:35,551 - INFO - [session.py:221] - Handshake completed: True
2025-01-08 08:56:35,552 - INFO - [session.py:222] - Use client cert: False
2025-01-08 08:56:35,552 - INFO - [session.py:223] - File to send: None
2025-01-08 08:56:35,553 - INFO - [session.py:229] - Using unencrypted exchange
2025-01-08 08:56:35,553 - INFO - [session.py:329] - Added request packet
2025-01-08 08:56:35,554 - INFO - [session.py:329] - Added response packet
2025-01-08 08:56:35,554 - WARNING - [session.py:306] - Using unencrypted communication
2025-01-08 08:56:35,555 - INFO - [main.py:96] - Session completed successfully for 192.168.1.2
2025-01-08 08:56:35,555 - INFO - [packet_validator.py:110] - Packet 13: Valid HTTP message
2025-01-08 08:56:35,555 - INFO - [packet_validator.py:110] - Packet 14: Valid HTTP message
2025-01-08 08:56:35,560 - INFO - [packet_storage.py:79] - Saved 15 valid packets to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-08 08:56:35,561 - INFO - [packet_storage.py:100] - Verifying 15 packets...
2025-01-08 08:56:35,562 - INFO - [packet_storage.py:104] - Packet 1: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-08 08:56:35,563 - INFO - [packet_storage.py:104] - Packet 2: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-08 08:56:35,563 - INFO - [packet_storage.py:104] - Packet 3: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-08 08:56:35,564 - INFO - [packet_storage.py:104] - Packet 4: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-08 08:56:35,564 - INFO - [packet_storage.py:104] - Packet 5: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-08 08:56:35,565 - INFO - [packet_storage.py:104] - Packet 6: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-08 08:56:35,565 - INFO - [packet_storage.py:104] - Packet 7: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-08 08:56:35,565 - INFO - [packet_storage.py:104] - Packet 8: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-08 08:56:35,566 - INFO - [packet_storage.py:104] - Packet 9: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-08 08:56:35,566 - INFO - [packet_storage.py:104] - Packet 10: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-08 08:56:35,567 - INFO - [packet_storage.py:104] - Packet 11: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-08 08:56:35,567 - INFO - [packet_storage.py:104] - Packet 12: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-08 08:56:35,568 - INFO - [packet_storage.py:104] - Packet 13: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-08 08:56:35,568 - INFO - [packet_storage.py:104] - Packet 14: IP / TCP 192.168.1.2:12346 > 10.0.0.1:http PA / Raw
2025-01-08 08:56:35,569 - INFO - [packet_storage.py:104] - Packet 15: IP / TCP 10.0.0.1:http > 192.168.1.2:12346 PA / Raw
2025-01-08 08:56:35,569 - INFO - [packet_storage.py:111] - Verification complete: 15 valid packets, 13 TLS records
2025-01-08 08:56:35,569 - INFO - [main.py:107] - Results saved to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-08 08:56:35,570 - INFO - [main.py:161] - TLS session simulation completed successfully
2025-01-09 01:06:00,590 - INFO - [logging.py:83] - Logging configured successfully
2025-01-09 01:06:00,591 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-09 01:06:00,591 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-09 01:06:00,591 - INFO - [logging.py:92] - Log level: 20
2025-01-09 01:06:00,591 - INFO - [logging.py:93] - Timestamp: 2025-01-09T01:06:00.591725
2025-01-09 01:06:00,591 - INFO - [logging.py:94] - ==========================
2025-01-09 01:06:00,591 - INFO - [main.py:123] - Starting TLS session simulation
2025-01-09 01:06:00,592 - INFO - [main.py:88] - 
--- Client Session (certificate) ---
2025-01-09 01:06:00,593 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-09 01:06:00,594 - INFO - [cert.py:108] - File exists: True
2025-01-09 01:06:00,594 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-09 01:06:00,600 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-09 01:06:00,600 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-09 01:06:00,601 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-09 01:06:00,605 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-09 01:06:00,606 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-09 01:06:00,606 - INFO - [cert.py:108] - File exists: True
2025-01-09 01:06:00,606 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-09 01:06:00,617 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-09 01:06:00,617 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-09 01:06:00,617 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-09 01:06:00,618 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-09 01:06:00,657 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-09 01:06:00,658 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-09 01:06:00,658 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-09 01:06:00,659 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-09 01:06:00,663 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-09 01:06:00,663 - INFO - [verify.py:59] - Public key comparison results:
2025-01-09 01:06:00,663 - INFO - [verify.py:60] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-09 01:06:00,664 - INFO - [verify.py:61] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-09 01:06:00,665 - INFO - [verify.py:62] - Certificate exponent (e): 0x10001
2025-01-09 01:06:00,665 - INFO - [verify.py:63] - Loaded key exponent (e): 0x10001
2025-01-09 01:06:00,668 - INFO - [verify.py:137] - Certificate chain verification successful
2025-01-09 01:06:00,668 - INFO - [verify.py:189] - Server name 'Pasdaran.local' verified successfully.
2025-01-09 01:06:00,669 - INFO - [chain.py:99] - Certificate chain verification passed
2025-01-09 01:06:00,669 - INFO - [chain.py:106] - Certificate chain loaded successfully
2025-01-09 01:06:00,669 - INFO - [chain.py:107] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-09 01:06:00,670 - INFO - [chain.py:108] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-09 01:06:00,670 - INFO - [chain.py:112] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-09 01:06:00,671 - INFO - [session.py:192] - Starting TLS session
2025-01-09 01:06:00,671 - INFO - [session.py:101] - Starting TLS Handshake...
2025-01-09 01:06:00,671 - INFO - [client.py:100] - Generated client_random: 45a811de16979694b9d37ecf669d599d926c9f8cb10144442d06bbd1b77c54d1
2025-01-09 01:06:00,673 - INFO - [client.py:143] - Client Hello sent from 192.168.1.1
2025-01-09 01:06:00,675 - INFO - [session.py:106] - Client Hello sent successfully
2025-01-09 01:06:00,675 - INFO - [server.py:94] - Generated server_random: ab069de274f3307e6edd8afe761fd61476892aecc362974139d8e0ca040d6ff5
2025-01-09 01:06:00,682 - INFO - [session.py:111] - Server Hello received successfully
2025-01-09 01:06:00,683 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2025-01-09 01:06:00,683 - INFO - [cert.py:108] - File exists: True
2025-01-09 01:06:00,684 - INFO - [cert.py:109] - File size: 1915 bytes
2025-01-09 01:06:00,696 - INFO - [cert.py:113] - Read 1915 bytes
2025-01-09 01:06:00,697 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2025-01-09 01:06:00,697 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2025-01-09 01:06:00,698 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-09 01:06:00,698 - INFO - [client.py:177] - Prepared client certificate
2025-01-09 01:06:00,699 - INFO - [client.py:192] - Encrypted pre_master_secret length: 256
2025-01-09 01:06:00,701 - INFO - [session.py:116] - Client handshake messages sent successfully
2025-01-09 01:06:00,702 - INFO - [session.py:121] - Server key pair verified successfully
2025-01-09 01:06:00,702 - INFO - [keys.py:350] - Starting Master Secret generation.
2025-01-09 01:06:00,703 - INFO - [keys.py:301] - Decrypted pre_master_secret: 030326b994d8d6767ee18baa980c2edff062f09a0b88952f84ded2c94af95a5d03b6c9310273b664c795777dbe77f42d
2025-01-09 01:06:00,704 - INFO - [keys.py:311] - Generated master secret: 1391c79f9756b7b5130cc89f3beb0b66de6e8dee4e67296b9b527b59eacdf6b13f62e0d1f1c6d726f75f1f5b043c5950
2025-01-09 01:06:00,704 - INFO - [keys.py:312] - Master secret length: 48 bytes
2025-01-09 01:06:00,704 - INFO - [keys.py:371] - Master Secret generation completed successfully.
2025-01-09 01:06:00,704 - INFO - [session.py:125] - Master Secret handled successfully
2025-01-09 01:06:00,705 - INFO - [client.py:273] - Pre-master secret validated successfully
2025-01-09 01:06:00,706 - INFO - [client.py:291] - Generated digital signature: 1526f9cb03be11fa1a8b308fea233388bc2df99ed96387835156eb19de5ad0cbd14ff430d4d4f265bbfcc07e0752c54c40350659db48afea876ad4017a2ea94abe40f346817dcd589b493642602d3ea1ee868bfbeee4f33057016cce39c59f0fb34602454a73970fb87a5fcb861ad1c101d5bf8a86c43cefb07d6907ca416c96f6a7fb78fdcc2355cbe311cbf6d5bd8d9d53a9a14ef00b3b041aaaf4703bb1d9db137eda9a59b3b72176f4b6df8bdebd6b9e60e2feea040c04f7f55ceeb432e3cbc8979d51a2ead3e13224f72cc0d29af1300a83cddf36531f67575631270c4ae646a40eb92d30e8a94134f47f1c9b331281ad9ebd4779ff2cc9e8974d753462
2025-01-09 01:06:00,708 - INFO - [client.py:337] - Client ChangeCipherSpec and Finished messages sent
2025-01-09 01:06:00,710 - INFO - [session.py:130] - Client Change Cipher Spec sent successfully
2025-01-09 01:06:00,714 - INFO - [server.py:260] - Pre-master secret validated successfully
2025-01-09 01:06:00,715 - INFO - [server.py:278] - Generated digital signature: 81dd0bce5298703ca1de2bdeca34633b9219ffc12437e672102b6bcbb464064be7c44267ef2d13b1b38cf7691df375ad7cbe997f99f25564d5759c753ffd614454a474edb3995a5ddacedf293698b0183a9c235c827e1e00bb5764748c94eb5ec550f0fd2db02adf4057fcee6bc8593e8894de24512abd0ac014115e7176642adba0632979b8678ce67bdfa3bc64233ffbe9d12ac061fff3615645340396265fba8b87a17eb0a4eec31b5299f5fb5ad2f5ed04c0c7a3bce87138aa88957a4cf1027ec4f97deae2c8408a97ed3e396c18f2fa6a6e076dacdf5bf9ecd6db591b1402a14fed0fc1cc8f5a5795e1db709df03eb71d6eb12f9748157470b225b9b54b
2025-01-09 01:06:00,716 - INFO - [server.py:324] - Server ChangeCipherSpec and Finished messages sent
2025-01-09 01:06:00,717 - INFO - [session.py:135] - Server Change Cipher Spec received successfully
2025-01-09 01:06:00,720 - INFO - [keys.py:219] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-09 01:06:00,721 - INFO - [session.py:140] - SSL Key Log handled successfully
2025-01-09 01:06:00,722 - INFO - [session.py:144] - TLS Handshake completed successfully
2025-01-09 01:06:00,723 - INFO - [session.py:203] - Found file to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-09 01:06:00,723 - INFO - [session.py:221] - Handshake completed: True
2025-01-09 01:06:00,724 - INFO - [session.py:222] - Use client cert: True
2025-01-09 01:06:00,724 - INFO - [session.py:223] - File to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-09 01:06:00,725 - INFO - [session.py:226] - Using encrypted exchange
2025-01-09 01:06:00,725 - INFO - [session.py:241] - Sending encrypted request data
2025-01-09 01:06:00,733 - INFO - [keys.py:186] - TLS Application Data sent from 192.168.1.1:12345 to 10.0.0.1:443
2025-01-09 01:06:00,735 - INFO - [session.py:252] - Sending encrypted response data
2025-01-09 01:06:00,737 - INFO - [keys.py:186] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-09 01:06:00,738 - INFO - [session.py:264] - Attempting to send file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-09 01:06:00,739 - INFO - [session.py:275] - Opening file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-09 01:06:00,741 - INFO - [session.py:282] - Read 1103 bytes from file
2025-01-09 01:06:00,748 - INFO - [keys.py:186] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-09 01:06:00,749 - INFO - [session.py:291] - File sent successfully
2025-01-09 01:06:00,750 - INFO - [session.py:266] - File sent successfully
2025-01-09 01:06:00,750 - INFO - [main.py:96] - Session completed successfully for 192.168.1.1
2025-01-09 01:06:00,751 - INFO - [main.py:88] - 
--- Client Session (no certificate) ---
2025-01-09 01:06:00,752 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-09 01:06:00,752 - INFO - [cert.py:108] - File exists: True
2025-01-09 01:06:00,753 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-09 01:06:00,754 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-09 01:06:00,754 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-09 01:06:00,755 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-09 01:06:00,756 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-09 01:06:00,757 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-09 01:06:00,757 - INFO - [cert.py:108] - File exists: True
2025-01-09 01:06:00,758 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-09 01:06:00,759 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-09 01:06:00,760 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-09 01:06:00,762 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-09 01:06:00,763 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-09 01:06:00,807 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-09 01:06:00,808 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-09 01:06:00,808 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-09 01:06:00,809 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-09 01:06:00,810 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-09 01:06:00,811 - INFO - [verify.py:59] - Public key comparison results:
2025-01-09 01:06:00,811 - INFO - [verify.py:60] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-09 01:06:00,813 - INFO - [verify.py:61] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-09 01:06:00,814 - INFO - [verify.py:62] - Certificate exponent (e): 0x10001
2025-01-09 01:06:00,814 - INFO - [verify.py:63] - Loaded key exponent (e): 0x10001
2025-01-09 01:06:00,815 - INFO - [verify.py:137] - Certificate chain verification successful
2025-01-09 01:06:00,815 - INFO - [verify.py:189] - Server name 'Pasdaran.local' verified successfully.
2025-01-09 01:06:00,816 - INFO - [chain.py:99] - Certificate chain verification passed
2025-01-09 01:06:00,816 - INFO - [chain.py:106] - Certificate chain loaded successfully
2025-01-09 01:06:00,817 - INFO - [chain.py:107] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-09 01:06:00,817 - INFO - [chain.py:108] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-09 01:06:00,818 - INFO - [chain.py:112] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-09 01:06:00,818 - INFO - [session.py:192] - Starting TLS session
2025-01-09 01:06:00,818 - INFO - [session.py:101] - Starting TLS Handshake...
2025-01-09 01:06:00,819 - INFO - [client.py:100] - Generated client_random: 077c0c90c63eb08cb81b3422900ccfd54dbc707510ee9f41d8edfb427cce778b
2025-01-09 01:06:00,821 - INFO - [client.py:143] - Client Hello sent from 192.168.1.2
2025-01-09 01:06:00,822 - INFO - [session.py:106] - Client Hello sent successfully
2025-01-09 01:06:00,823 - INFO - [server.py:94] - Generated server_random: 8f8f37e3bcf415983a1fb827e8ee530d4a640036cf4b0d886210ac54156ad045
2025-01-09 01:06:00,830 - INFO - [session.py:111] - Server Hello received successfully
2025-01-09 01:06:00,831 - INFO - [client.py:180] - Prepared empty certificate
2025-01-09 01:06:00,832 - INFO - [client.py:192] - Encrypted pre_master_secret length: 256
2025-01-09 01:06:00,833 - INFO - [session.py:116] - Client handshake messages sent successfully
2025-01-09 01:06:00,834 - INFO - [session.py:121] - Server key pair verified successfully
2025-01-09 01:06:00,835 - INFO - [keys.py:350] - Starting Master Secret generation.
2025-01-09 01:06:00,835 - INFO - [keys.py:301] - Decrypted pre_master_secret: 030326824cba4652adc0d8572208b21298dcef6b37f0d3956e12a1d1dd3bb95569208d4624ed903ca2078ed4c3037998
2025-01-09 01:06:00,836 - INFO - [keys.py:311] - Generated master secret: 45456e13bf352893e3006346c0f3a9b8adb09666fc83fb25174d17dc7d49caa5fc9ee2786d1d6845a4015ca6f5028358
2025-01-09 01:06:00,836 - INFO - [keys.py:312] - Master secret length: 48 bytes
2025-01-09 01:06:00,836 - INFO - [keys.py:371] - Master Secret generation completed successfully.
2025-01-09 01:06:00,836 - INFO - [session.py:125] - Master Secret handled successfully
2025-01-09 01:06:00,837 - INFO - [client.py:273] - Pre-master secret validated successfully
2025-01-09 01:06:00,838 - INFO - [client.py:291] - Generated digital signature: 798fc74ccebdb545cf47f1861198df0a574591b7c37e98add939717c97d63b0700826198bbb80f78ef7751e78d2a1bac23b868f972e633ea0d5fa11f12fb86f6e9e67e1b9d578559fdaf7926ebc1481523cb856813ed90f4c6c1f9b843354246d50be8d9d8ee9a653de04bb5f497e4dc3ef6ed5dbd3891535783963dc777118869e31287d0ca4dba9697d77f11632268e78272dfcdd2347df4b1b5b1e6deab16cf33121d42d41402a5da102fe6b1635a01fcb47f8c5d2f287b000ad59166dd6b492290d122eafd475da1e5ec159e572282f1db533e54265f90745939955b1098f528ca8fb95b1fc333381ae0a1e0e05100dd97c474ab3dd50571c9309dd8cee0
2025-01-09 01:06:00,840 - INFO - [client.py:337] - Client ChangeCipherSpec and Finished messages sent
2025-01-09 01:06:00,841 - INFO - [session.py:130] - Client Change Cipher Spec sent successfully
2025-01-09 01:06:00,841 - INFO - [server.py:260] - Pre-master secret validated successfully
2025-01-09 01:06:00,844 - INFO - [server.py:278] - Generated digital signature: 17e198aec30cb121b0ccbc758e096642c4e3ef98757878f884752d0b5972f8a21e211a3cc7e83c112960ddb1809d68f60a4841e5f7a3fe9b3824a929b4ea05507ff8c22f23dbfacc1127c24a0a16c9c2692d984c0cdabb12ea2ad9c61b583fd9b177d7d7ba40e072c66642390bc6c1b312de80313e6ded646caef20624506ad7e9545c868188000c085e6bcc39b8338a9b3b165f6c0956a72da60e72b9c21d0fea1c5cc9fe63c03893005d436f94626607ad623b2b9907fae276bf31001fcbb1311716ca14b6a0983f61575a15d6f90be13d52828e7396f46e25b856392d7da1c4a76e2dc2496e19aca3e5b69e6fba160acebee4e7aa71be6f42f86d7617b24d
2025-01-09 01:06:00,846 - INFO - [server.py:324] - Server ChangeCipherSpec and Finished messages sent
2025-01-09 01:06:00,847 - INFO - [session.py:135] - Server Change Cipher Spec received successfully
2025-01-09 01:06:00,848 - INFO - [keys.py:219] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-09 01:06:00,848 - INFO - [session.py:140] - SSL Key Log handled successfully
2025-01-09 01:06:00,849 - INFO - [session.py:144] - TLS Handshake completed successfully
2025-01-09 01:06:00,849 - INFO - [session.py:221] - Handshake completed: True
2025-01-09 01:06:00,849 - INFO - [session.py:222] - Use client cert: False
2025-01-09 01:06:00,849 - INFO - [session.py:223] - File to send: None
2025-01-09 01:06:00,849 - INFO - [session.py:229] - Using unencrypted exchange
2025-01-09 01:06:00,850 - INFO - [session.py:329] - Added request packet
2025-01-09 01:06:00,850 - INFO - [session.py:329] - Added response packet
2025-01-09 01:06:00,851 - WARNING - [session.py:306] - Using unencrypted communication
2025-01-09 01:06:00,851 - INFO - [main.py:96] - Session completed successfully for 192.168.1.2
2025-01-09 01:06:00,852 - INFO - [packet_validator.py:110] - Packet 13: Valid HTTP message
2025-01-09 01:06:00,852 - INFO - [packet_validator.py:110] - Packet 14: Valid HTTP message
2025-01-09 01:06:00,856 - INFO - [packet_storage.py:79] - Saved 15 valid packets to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-09 01:06:00,856 - INFO - [packet_storage.py:100] - Verifying 15 packets...
2025-01-09 01:06:00,856 - INFO - [packet_storage.py:104] - Packet 1: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-09 01:06:00,857 - INFO - [packet_storage.py:104] - Packet 2: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-09 01:06:00,857 - INFO - [packet_storage.py:104] - Packet 3: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-09 01:06:00,857 - INFO - [packet_storage.py:104] - Packet 4: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-09 01:06:00,858 - INFO - [packet_storage.py:104] - Packet 5: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-09 01:06:00,858 - INFO - [packet_storage.py:104] - Packet 6: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-09 01:06:00,858 - INFO - [packet_storage.py:104] - Packet 7: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-09 01:06:00,858 - INFO - [packet_storage.py:104] - Packet 8: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-09 01:06:00,859 - INFO - [packet_storage.py:104] - Packet 9: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-09 01:06:00,860 - INFO - [packet_storage.py:104] - Packet 10: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-09 01:06:00,860 - INFO - [packet_storage.py:104] - Packet 11: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-09 01:06:00,861 - INFO - [packet_storage.py:104] - Packet 12: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-09 01:06:00,862 - INFO - [packet_storage.py:104] - Packet 13: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-09 01:06:00,863 - INFO - [packet_storage.py:104] - Packet 14: IP / TCP 192.168.1.2:12346 > 10.0.0.1:http PA / Raw
2025-01-09 01:06:00,863 - INFO - [packet_storage.py:104] - Packet 15: IP / TCP 10.0.0.1:http > 192.168.1.2:12346 PA / Raw
2025-01-09 01:06:00,863 - INFO - [packet_storage.py:111] - Verification complete: 15 valid packets, 13 TLS records
2025-01-09 01:06:00,864 - INFO - [main.py:107] - Results saved to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-09 01:06:00,864 - INFO - [main.py:161] - TLS session simulation completed successfully
2025-01-09 01:06:38,511 - INFO - [logging.py:83] - Logging configured successfully
2025-01-09 01:06:38,512 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-09 01:06:38,512 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-09 01:06:38,513 - INFO - [logging.py:92] - Log level: 20
2025-01-09 01:06:38,513 - INFO - [logging.py:93] - Timestamp: 2025-01-09T01:06:38.513349
2025-01-09 01:06:38,513 - INFO - [logging.py:94] - ==========================
2025-01-09 01:06:38,513 - INFO - [main.py:123] - Starting TLS session simulation
2025-01-09 01:06:38,514 - INFO - [main.py:88] - 
--- Client Session (certificate) ---
2025-01-09 01:06:38,515 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-09 01:06:38,515 - INFO - [cert.py:108] - File exists: True
2025-01-09 01:06:38,515 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-09 01:06:38,516 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-09 01:06:38,516 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-09 01:06:38,516 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-09 01:06:38,517 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-09 01:06:38,517 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-09 01:06:38,518 - INFO - [cert.py:108] - File exists: True
2025-01-09 01:06:38,518 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-09 01:06:38,518 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-09 01:06:38,518 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-09 01:06:38,519 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-09 01:06:38,519 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-09 01:06:38,549 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-09 01:06:38,549 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-09 01:06:38,550 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-09 01:06:38,550 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-09 01:06:38,551 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-09 01:06:38,552 - INFO - [verify.py:59] - Public key comparison results:
2025-01-09 01:06:38,552 - INFO - [verify.py:60] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-09 01:06:38,552 - INFO - [verify.py:61] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-09 01:06:38,553 - INFO - [verify.py:62] - Certificate exponent (e): 0x10001
2025-01-09 01:06:38,553 - INFO - [verify.py:63] - Loaded key exponent (e): 0x10001
2025-01-09 01:06:38,554 - INFO - [verify.py:137] - Certificate chain verification successful
2025-01-09 01:06:38,554 - INFO - [verify.py:189] - Server name 'Pasdaran.local' verified successfully.
2025-01-09 01:06:38,554 - INFO - [chain.py:99] - Certificate chain verification passed
2025-01-09 01:06:38,554 - INFO - [chain.py:106] - Certificate chain loaded successfully
2025-01-09 01:06:38,555 - INFO - [chain.py:107] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-09 01:06:38,556 - INFO - [chain.py:108] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-09 01:06:38,557 - INFO - [chain.py:112] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-09 01:06:38,557 - INFO - [session.py:192] - Starting TLS session
2025-01-09 01:06:38,558 - INFO - [session.py:101] - Starting TLS Handshake...
2025-01-09 01:06:38,558 - INFO - [client.py:100] - Generated client_random: ab672ba3f497453b03360283890cc6089458c4a6c67bd359aacb15f301f05f7b
2025-01-09 01:06:38,561 - INFO - [client.py:143] - Client Hello sent from 192.168.1.1
2025-01-09 01:06:38,563 - INFO - [session.py:106] - Client Hello sent successfully
2025-01-09 01:06:38,564 - INFO - [server.py:94] - Generated server_random: 7d01f36d30cc42b88d86698268ffacf5d81988ab0344ed4faac514b7c292ec08
2025-01-09 01:06:38,567 - INFO - [session.py:111] - Server Hello received successfully
2025-01-09 01:06:38,567 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2025-01-09 01:06:38,568 - INFO - [cert.py:108] - File exists: True
2025-01-09 01:06:38,568 - INFO - [cert.py:109] - File size: 1915 bytes
2025-01-09 01:06:38,568 - INFO - [cert.py:113] - Read 1915 bytes
2025-01-09 01:06:38,568 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2025-01-09 01:06:38,569 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2025-01-09 01:06:38,569 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-09 01:06:38,570 - INFO - [client.py:177] - Prepared client certificate
2025-01-09 01:06:38,570 - INFO - [client.py:192] - Encrypted pre_master_secret length: 256
2025-01-09 01:06:38,572 - INFO - [session.py:116] - Client handshake messages sent successfully
2025-01-09 01:06:38,573 - INFO - [session.py:121] - Server key pair verified successfully
2025-01-09 01:06:38,573 - INFO - [keys.py:350] - Starting Master Secret generation.
2025-01-09 01:06:38,574 - INFO - [keys.py:301] - Decrypted pre_master_secret: 0303b4ceb4d4b83719af8cfe88f0aa44b844cbf936bee3cdc1664961f362f751fa0bc036bab6ce5b519208e96c21748b
2025-01-09 01:06:38,574 - INFO - [keys.py:311] - Generated master secret: 80e001308135099df241fdfa2eb9587b55de0b4528e2a5b8aa1cdc0da804496dc2c9e4fa817093cec8a987b19f83cca5
2025-01-09 01:06:38,575 - INFO - [keys.py:312] - Master secret length: 48 bytes
2025-01-09 01:06:38,575 - INFO - [keys.py:371] - Master Secret generation completed successfully.
2025-01-09 01:06:38,576 - INFO - [session.py:125] - Master Secret handled successfully
2025-01-09 01:06:38,577 - INFO - [client.py:273] - Pre-master secret validated successfully
2025-01-09 01:06:38,578 - INFO - [client.py:291] - Generated digital signature: 29ebcca3ef8109cb1e0d26449d773ec16b7f4b825295557adbc48ee64d1c3e587d04fb0e829e02326813e784c2e97cf71ce05a95bf7e89efa4ac6475c9cfc1a3a276c13b78749fb14613022934d639242e6b34b43560965c960cfaa5bce26deaf4042325019e03dfdb60527a551b2366f6a5d7c24070773bf87f72b74c49bbef596ca4ff950daecdffa436b730d0523e0a18fa231dfaa9c3b0139669bac1354086760f739c45cafa2a7a05be292db42e1b0f9552f704485272f10096bb79734382039aeafd9ba248f56419a8ab17edf6952bce96bcb21a41a602c4deee602ff6c634e2bd65c9fcb82325ce0a0e8f64e80d05de031634e65b1c780d1a9343a9c7
2025-01-09 01:06:38,580 - INFO - [client.py:337] - Client ChangeCipherSpec and Finished messages sent
2025-01-09 01:06:38,581 - INFO - [session.py:130] - Client Change Cipher Spec sent successfully
2025-01-09 01:06:38,582 - INFO - [server.py:260] - Pre-master secret validated successfully
2025-01-09 01:06:38,583 - INFO - [server.py:278] - Generated digital signature: 2176701737b4d1026b59256c25228f35e8d64ae5ab58448c25d7acd62252b5a17cc4c6987046ef2c756193e13b480cf5c73889c0454b6408751835bdd3c0bf34b6b171b7b92ae116dcb87fa2f94af904feb7482ac79eb0c2ef33249a8f43e6915bc0679398df911bf50cc0a170771847e5714514908a349dafaef3a23ce011dcd53a5b69b0d44007b3f60a7bf3d40008d50faa2f7208891c7a13c51db25c99de69e440ee1502df71896b60723a49bb9792dddd2823fc2da281c15a983e694ce706830d3494e1c4851dd7cf306ff07ab0413affbbdbdb262b221881a5f62f1926541aab3e0fffb3c7fe357a6f8ec6435a79747f8ebff30c858da00b7363f57b93
2025-01-09 01:06:38,584 - INFO - [server.py:324] - Server ChangeCipherSpec and Finished messages sent
2025-01-09 01:06:38,585 - INFO - [session.py:135] - Server Change Cipher Spec received successfully
2025-01-09 01:06:38,586 - INFO - [keys.py:219] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-09 01:06:38,586 - INFO - [session.py:140] - SSL Key Log handled successfully
2025-01-09 01:06:38,587 - INFO - [session.py:144] - TLS Handshake completed successfully
2025-01-09 01:06:38,587 - INFO - [session.py:203] - Found file to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-09 01:06:38,587 - INFO - [session.py:221] - Handshake completed: True
2025-01-09 01:06:38,588 - INFO - [session.py:222] - Use client cert: True
2025-01-09 01:06:38,588 - INFO - [session.py:223] - File to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-09 01:06:38,588 - INFO - [session.py:226] - Using encrypted exchange
2025-01-09 01:06:38,588 - INFO - [session.py:241] - Sending encrypted request data
2025-01-09 01:06:38,589 - INFO - [keys.py:186] - TLS Application Data sent from 192.168.1.1:12345 to 10.0.0.1:443
2025-01-09 01:06:38,590 - INFO - [session.py:252] - Sending encrypted response data
2025-01-09 01:06:38,591 - INFO - [keys.py:186] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-09 01:06:38,592 - INFO - [session.py:264] - Attempting to send file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-09 01:06:38,593 - INFO - [session.py:275] - Opening file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-09 01:06:38,594 - INFO - [session.py:282] - Read 1103 bytes from file
2025-01-09 01:06:38,595 - INFO - [keys.py:186] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-09 01:06:38,595 - INFO - [session.py:291] - File sent successfully
2025-01-09 01:06:38,596 - INFO - [session.py:266] - File sent successfully
2025-01-09 01:06:38,596 - INFO - [main.py:96] - Session completed successfully for 192.168.1.1
2025-01-09 01:06:38,596 - INFO - [main.py:88] - 
--- Client Session (no certificate) ---
2025-01-09 01:06:38,597 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-09 01:06:38,597 - INFO - [cert.py:108] - File exists: True
2025-01-09 01:06:38,598 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-09 01:06:38,598 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-09 01:06:38,598 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-09 01:06:38,599 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-09 01:06:38,599 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-09 01:06:38,600 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-09 01:06:38,600 - INFO - [cert.py:108] - File exists: True
2025-01-09 01:06:38,600 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-09 01:06:38,600 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-09 01:06:38,601 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-09 01:06:38,601 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-09 01:06:38,601 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-09 01:06:38,630 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-09 01:06:38,631 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-09 01:06:38,631 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-09 01:06:38,631 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-09 01:06:38,632 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-09 01:06:38,632 - INFO - [verify.py:59] - Public key comparison results:
2025-01-09 01:06:38,633 - INFO - [verify.py:60] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-09 01:06:38,633 - INFO - [verify.py:61] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-09 01:06:38,655 - INFO - [verify.py:62] - Certificate exponent (e): 0x10001
2025-01-09 01:06:38,655 - INFO - [verify.py:63] - Loaded key exponent (e): 0x10001
2025-01-09 01:06:38,656 - INFO - [verify.py:137] - Certificate chain verification successful
2025-01-09 01:06:38,656 - INFO - [verify.py:189] - Server name 'Pasdaran.local' verified successfully.
2025-01-09 01:06:38,656 - INFO - [chain.py:99] - Certificate chain verification passed
2025-01-09 01:06:38,657 - INFO - [chain.py:106] - Certificate chain loaded successfully
2025-01-09 01:06:38,659 - INFO - [chain.py:107] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-09 01:06:38,659 - INFO - [chain.py:108] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-09 01:06:38,661 - INFO - [chain.py:112] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-09 01:06:38,661 - INFO - [session.py:192] - Starting TLS session
2025-01-09 01:06:38,662 - INFO - [session.py:101] - Starting TLS Handshake...
2025-01-09 01:06:38,662 - INFO - [client.py:100] - Generated client_random: 605f4180cccf8756b65687aef0cb42513d191082d004a02ab222262e951dd9fe
2025-01-09 01:06:38,664 - INFO - [client.py:143] - Client Hello sent from 192.168.1.2
2025-01-09 01:06:38,667 - INFO - [session.py:106] - Client Hello sent successfully
2025-01-09 01:06:38,667 - INFO - [server.py:94] - Generated server_random: a856d9bb3dc3938af26fef68b0e0aac435fc53535bea4b8412f9a41136a1e430
2025-01-09 01:06:38,670 - INFO - [session.py:111] - Server Hello received successfully
2025-01-09 01:06:38,670 - INFO - [client.py:180] - Prepared empty certificate
2025-01-09 01:06:38,670 - INFO - [client.py:192] - Encrypted pre_master_secret length: 256
2025-01-09 01:06:38,671 - INFO - [session.py:116] - Client handshake messages sent successfully
2025-01-09 01:06:38,672 - INFO - [session.py:121] - Server key pair verified successfully
2025-01-09 01:06:38,673 - INFO - [keys.py:350] - Starting Master Secret generation.
2025-01-09 01:06:38,674 - INFO - [keys.py:301] - Decrypted pre_master_secret: 03033e7b260ee4f09e4217972b2779e4cfad5c462681308a2c2b28fb2b3015a8217239a1a028b68c001d279685bdaf53
2025-01-09 01:06:38,675 - INFO - [keys.py:311] - Generated master secret: 420b3d05dadee41b30dfca96d4f104e2cdb9da594767205d8336c8f77c378284047b717ce9be6d099c7a44e820e7eb29
2025-01-09 01:06:38,676 - INFO - [keys.py:312] - Master secret length: 48 bytes
2025-01-09 01:06:38,676 - INFO - [keys.py:371] - Master Secret generation completed successfully.
2025-01-09 01:06:38,677 - INFO - [session.py:125] - Master Secret handled successfully
2025-01-09 01:06:38,678 - INFO - [client.py:273] - Pre-master secret validated successfully
2025-01-09 01:06:38,678 - INFO - [client.py:291] - Generated digital signature: ced068cced42e6f1e940c51e019941bcc3888295b9a1afe56751cdbf36354c8cd56f71a62e3924bbbad498dd11d911915b2da33a0aad83d3900061721f1da2947fedeea926929933f3655e4d70cfc9ef8ba052be52b6e0db471751bd2eb5075f7ac98acf81137ad757a7487579de62a3acb2478279cf25aaefa79954f84379ea9210632d5d53aa1fe244796ea0d8a33db2da00cb278789d2b6158533a3d9e2c67acccf85db88538714edd8eccac7b24293d4ef81c0715efe1e3db8eff9e92157e642db850adc68002a628b066b893f3c5671b0fc6cb8262c010fc5487d6b679e1050d4e2d04934a909efec0923468ca6e8c01e9473b129c81de093ad4c424bbe
2025-01-09 01:06:38,680 - INFO - [client.py:337] - Client ChangeCipherSpec and Finished messages sent
2025-01-09 01:06:38,682 - INFO - [session.py:130] - Client Change Cipher Spec sent successfully
2025-01-09 01:06:38,683 - INFO - [server.py:260] - Pre-master secret validated successfully
2025-01-09 01:06:38,684 - INFO - [server.py:278] - Generated digital signature: 5cb208288d24c32538116185c3c55fdb21655aac00be1569c251e5c3347ac7c4bfdcc964582f7da4ce8d9ee0e62e8db275576c3bf6348cafe441e9845f1826d3ff7e9803884cc8778e24aad8501d6565fce79f6bedf76505aee840406e8520c9481f430016ff3fea9b75e8e76c9fd3d74714aa8fb566c556cf3cb0370d17102588d3096d9a65d02300a7953d031aed6c54fd580a1f2eaaeb46e8d95fbde1b6ebbb019843772547df4b77ce866b711002c81272b70389745129da4724a3d14569a32cee3e58c8f8109db22df64e74162465906089882924a07e6d02fa8303edbe23328a16ab68d4cd383c0cbb6d2a9d3c84f58f3b5c27c259bc60f821fd87167d
2025-01-09 01:06:38,686 - INFO - [server.py:324] - Server ChangeCipherSpec and Finished messages sent
2025-01-09 01:06:38,687 - INFO - [session.py:135] - Server Change Cipher Spec received successfully
2025-01-09 01:06:38,687 - INFO - [keys.py:219] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-09 01:06:38,687 - INFO - [session.py:140] - SSL Key Log handled successfully
2025-01-09 01:06:38,688 - INFO - [session.py:144] - TLS Handshake completed successfully
2025-01-09 01:06:38,688 - INFO - [session.py:221] - Handshake completed: True
2025-01-09 01:06:38,688 - INFO - [session.py:222] - Use client cert: False
2025-01-09 01:06:38,688 - INFO - [session.py:223] - File to send: None
2025-01-09 01:06:38,688 - INFO - [session.py:229] - Using unencrypted exchange
2025-01-09 01:06:38,689 - INFO - [session.py:329] - Added request packet
2025-01-09 01:06:38,689 - INFO - [session.py:329] - Added response packet
2025-01-09 01:06:38,689 - WARNING - [session.py:306] - Using unencrypted communication
2025-01-09 01:06:38,690 - INFO - [main.py:96] - Session completed successfully for 192.168.1.2
2025-01-09 01:06:38,690 - INFO - [packet_validator.py:110] - Packet 13: Valid HTTP message
2025-01-09 01:06:38,691 - INFO - [packet_validator.py:110] - Packet 14: Valid HTTP message
2025-01-09 01:06:38,697 - INFO - [packet_storage.py:79] - Saved 15 valid packets to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-09 01:06:38,698 - INFO - [packet_storage.py:100] - Verifying 15 packets...
2025-01-09 01:06:38,698 - INFO - [packet_storage.py:104] - Packet 1: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-09 01:06:38,698 - INFO - [packet_storage.py:104] - Packet 2: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-09 01:06:38,699 - INFO - [packet_storage.py:104] - Packet 3: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-09 01:06:38,699 - INFO - [packet_storage.py:104] - Packet 4: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-09 01:06:38,699 - INFO - [packet_storage.py:104] - Packet 5: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-09 01:06:38,699 - INFO - [packet_storage.py:104] - Packet 6: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-09 01:06:38,700 - INFO - [packet_storage.py:104] - Packet 7: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-09 01:06:38,700 - INFO - [packet_storage.py:104] - Packet 8: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-09 01:06:38,700 - INFO - [packet_storage.py:104] - Packet 9: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-09 01:06:38,700 - INFO - [packet_storage.py:104] - Packet 10: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-09 01:06:38,701 - INFO - [packet_storage.py:104] - Packet 11: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-09 01:06:38,701 - INFO - [packet_storage.py:104] - Packet 12: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-09 01:06:38,701 - INFO - [packet_storage.py:104] - Packet 13: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-09 01:06:38,701 - INFO - [packet_storage.py:104] - Packet 14: IP / TCP 192.168.1.2:12346 > 10.0.0.1:http PA / Raw
2025-01-09 01:06:38,701 - INFO - [packet_storage.py:104] - Packet 15: IP / TCP 10.0.0.1:http > 192.168.1.2:12346 PA / Raw
2025-01-09 01:06:38,701 - INFO - [packet_storage.py:111] - Verification complete: 15 valid packets, 13 TLS records
2025-01-09 01:06:38,702 - INFO - [main.py:107] - Results saved to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-09 01:06:38,702 - INFO - [main.py:161] - TLS session simulation completed successfully
2025-04-18 12:25:21,585 - INFO - [logging.py:85] - Logging configured successfully
2025-04-18 12:25:21,586 - INFO - [logging.py:92] - === Logging Configuration ===
2025-04-18 12:25:21,586 - INFO - [logging.py:93] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-04-18 12:25:21,587 - INFO - [logging.py:94] - Log level: 20
2025-04-18 12:25:21,587 - INFO - [logging.py:95] - Timestamp: 2025-04-18T12:25:21.587753
2025-04-18 12:25:21,588 - INFO - [logging.py:96] - ==========================
2025-04-18 12:25:21,588 - INFO - [main.py:123] - Starting TLS session simulation
2025-04-18 12:25:21,589 - INFO - [main.py:88] - 
--- Client Session (certificate) ---
2025-04-18 12:25:21,591 - INFO - [cert.py:109] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-04-18 12:25:21,592 - INFO - [cert.py:110] - File exists: True
2025-04-18 12:25:21,593 - INFO - [cert.py:111] - File size: 1912 bytes
2025-04-18 12:25:21,594 - INFO - [cert.py:115] - Read 1912 bytes
2025-04-18 12:25:21,595 - INFO - [cert.py:119] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-04-18 12:25:21,596 - INFO - [cert.py:122] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-04-18 12:25:21,602 - INFO - [cert.py:132] - Successfully loaded as PEM
2025-04-18 12:25:21,603 - INFO - [cert.py:109] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-04-18 12:25:21,604 - INFO - [cert.py:110] - File exists: True
2025-04-18 12:25:21,605 - INFO - [cert.py:111] - File size: 1643 bytes
2025-04-18 12:25:21,607 - INFO - [cert.py:115] - Read 1643 bytes
2025-04-18 12:25:21,608 - INFO - [cert.py:119] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-04-18 12:25:21,608 - INFO - [cert.py:122] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-04-18 12:25:21,609 - INFO - [cert.py:132] - Successfully loaded as PEM
2025-04-18 12:25:21,694 - INFO - [cert.py:215] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-04-18 12:25:21,695 - INFO - [cert.py:216] - Key type: RSAPrivateKey
2025-04-18 12:25:21,695 - INFO - [cert.py:217] - Key size: 2048 bits
2025-04-18 12:25:21,696 - INFO - [cert.py:219] - Public exponent: 65537
2025-04-18 12:25:21,699 - INFO - [cert.py:248] - Certificate and keys loaded and validated successfully
2025-04-18 12:25:21,699 - INFO - [verify.py:62] - Public key comparison results:
2025-04-18 12:25:21,699 - INFO - [verify.py:63] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-04-18 12:25:21,700 - INFO - [verify.py:64] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-04-18 12:25:21,701 - INFO - [verify.py:65] - Certificate exponent (e): 0x10001
2025-04-18 12:25:21,701 - INFO - [verify.py:66] - Loaded key exponent (e): 0x10001
2025-04-18 12:25:21,708 - INFO - [verify.py:140] - Certificate chain verification successful
2025-04-18 12:25:21,709 - INFO - [verify.py:192] - Server name 'Pasdaran.local' verified successfully.
2025-04-18 12:25:21,709 - INFO - [chain.py:101] - Certificate chain verification passed
2025-04-18 12:25:21,710 - INFO - [chain.py:108] - Certificate chain loaded successfully
2025-04-18 12:25:21,711 - INFO - [chain.py:109] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-04-18 12:25:21,711 - INFO - [chain.py:110] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-04-18 12:25:21,712 - INFO - [chain.py:114] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-04-18 12:25:21,712 - INFO - [session.py:195] - Starting TLS session
2025-04-18 12:25:21,712 - INFO - [session.py:104] - Starting TLS Handshake...
2025-04-18 12:25:21,712 - INFO - [client.py:102] - Generated client_random: 940e2b67c6f57c95995a6a24150f106f545f2cad32a52713defa42a55697e5b7
2025-04-18 12:25:21,714 - INFO - [client.py:145] - Client Hello sent from 192.168.1.1
2025-04-18 12:25:21,716 - INFO - [session.py:109] - Client Hello sent successfully
2025-04-18 12:25:21,717 - INFO - [server.py:96] - Generated server_random: 202aed459ccf00d5c28b6ee6a1d863ec49f31bef39667e36d7c7d5758a594de5
2025-04-18 12:25:21,724 - INFO - [session.py:114] - Server Hello received successfully
2025-04-18 12:25:21,724 - INFO - [cert.py:109] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2025-04-18 12:25:21,725 - INFO - [cert.py:110] - File exists: True
2025-04-18 12:25:21,725 - INFO - [cert.py:111] - File size: 1623 bytes
2025-04-18 12:25:21,726 - INFO - [cert.py:115] - Read 1623 bytes
2025-04-18 12:25:21,726 - INFO - [cert.py:119] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEgDCCAmgCFFeaE4J3cZV1/bmf8fOlTPfvC3BkMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-04-18 12:25:21,726 - INFO - [cert.py:122] - File content as text: -----BEGIN CERTIFICATE-----
MIIEgDCCAmgCFFeaE4J3cZV1/bmf8fOlTPfvC3BkMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-04-18 12:25:21,727 - INFO - [cert.py:132] - Successfully loaded as PEM
2025-04-18 12:25:21,727 - INFO - [client.py:179] - Prepared client certificate
2025-04-18 12:25:21,728 - INFO - [client.py:194] - Encrypted pre_master_secret length: 256
2025-04-18 12:25:21,729 - INFO - [session.py:119] - Client handshake messages sent successfully
2025-04-18 12:25:21,731 - INFO - [session.py:124] - Server key pair verified successfully
2025-04-18 12:25:21,731 - INFO - [keys.py:352] - Starting Master Secret generation.
2025-04-18 12:25:21,732 - INFO - [keys.py:303] - Decrypted pre_master_secret: 03033bd2ccc8190f28bd3b955ea6b8b78538c054614398d0c76499eb60b41378d7e583a1bb6bd3a74ccd89c7a5d512bf
2025-04-18 12:25:21,732 - INFO - [keys.py:313] - Generated master secret: 624b6577ffb5ce2ca6718b47d46ea61719a4d536c2d2184e0611254f034b3a669a9de774f1f44b1736a276aecb55f949
2025-04-18 12:25:21,733 - INFO - [keys.py:314] - Master secret length: 48 bytes
2025-04-18 12:25:21,733 - INFO - [keys.py:373] - Master Secret generation completed successfully.
2025-04-18 12:25:21,734 - INFO - [session.py:128] - Master Secret handled successfully
2025-04-18 12:25:21,735 - INFO - [client.py:275] - Pre-master secret validated successfully
2025-04-18 12:25:21,736 - INFO - [client.py:293] - Generated digital signature: 8e98dd19f71a0beaca0e76d68cf34d7e34766fa32b953828cae2873192de48761e685eee3a3d8ef8ba22a2c4e366fe572419a3ee7a09b0cf19d439ceca173a78da1840455d7632c87ea1213a05f0fbfb91129dffe4df0c48aa823283cc80e8c93861f749b3bdcf50f2f5a7a37226e8ab7cf51ae341e96b703045ad95604dd98df3332d963273740a70a3561878e5bcb1b1332f6b5335739753daba34b69b670f2b59ae1059c716257cbb96a152f32050abeef53b619361f259708ba08938772aac986944968d8993ec4b474e4e95cd23f0743f966b1aeb58efaa296ab170d9891d2ea2db2884818362bf608de98683fb4383caa32633ce8699959df27565fada
2025-04-18 12:25:21,740 - INFO - [client.py:339] - Client ChangeCipherSpec and Finished messages sent
2025-04-18 12:25:21,741 - INFO - [session.py:133] - Client Change Cipher Spec sent successfully
2025-04-18 12:25:21,743 - INFO - [server.py:262] - Pre-master secret validated successfully
2025-04-18 12:25:21,744 - INFO - [server.py:280] - Generated digital signature: 487d8a36d9f46c4fcafbd4c682c27f4940ea357606e9194e98dd327087cbfa8a464d343b4c561e58a413dfe6baf82732bfea61e5911db46d4631144b69f6bfd17c70c20725d61188e83bf207b9a54be83d161b59f12b93fa63577cd5b4853a20b9f45ca80da44279c8bcba2575625af94c2ff5c01a6a8c5bc10300cbfae9c3e6d17b917ae9c03315152c97aac2a7db8cf7ee40e6240750ce181c22530d0c6aed4fc83eb4df0ef638583e1022374f2ba542919ccb552dd4fe3d645d9271f3d394ea13364c924b949eacc446efba68de1278893213fb47e709271506eac54fee5968d20f3e42f572b40285660bda92c1d4c50d48b37ecb28ff1edcf6ebc0c37a12
2025-04-18 12:25:21,745 - INFO - [server.py:326] - Server ChangeCipherSpec and Finished messages sent
2025-04-18 12:25:21,746 - INFO - [session.py:138] - Server Change Cipher Spec received successfully
2025-04-18 12:25:21,747 - INFO - [keys.py:221] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-04-18 12:25:21,748 - INFO - [session.py:143] - SSL Key Log handled successfully
2025-04-18 12:25:21,748 - INFO - [session.py:147] - TLS Handshake completed successfully
2025-04-18 12:25:21,749 - INFO - [session.py:206] - Found file to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-04-18 12:25:21,749 - INFO - [session.py:224] - Handshake completed: True
2025-04-18 12:25:21,749 - INFO - [session.py:225] - Use client cert: True
2025-04-18 12:25:21,750 - INFO - [session.py:226] - File to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-04-18 12:25:21,750 - INFO - [session.py:229] - Using encrypted exchange
2025-04-18 12:25:21,751 - INFO - [session.py:244] - Sending encrypted request data
2025-04-18 12:25:21,752 - INFO - [keys.py:188] - TLS Application Data sent from 192.168.1.1:12345 to 10.0.0.1:443
2025-04-18 12:25:21,753 - INFO - [session.py:255] - Sending encrypted response data
2025-04-18 12:25:21,755 - INFO - [keys.py:188] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-04-18 12:25:21,755 - INFO - [session.py:267] - Attempting to send file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-04-18 12:25:21,756 - INFO - [session.py:278] - Opening file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-04-18 12:25:21,756 - INFO - [session.py:285] - Read 1103 bytes from file
2025-04-18 12:25:21,758 - INFO - [keys.py:188] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-04-18 12:25:21,758 - INFO - [session.py:294] - File sent successfully
2025-04-18 12:25:21,758 - INFO - [session.py:269] - File sent successfully
2025-04-18 12:25:21,759 - INFO - [main.py:96] - Session completed successfully for 192.168.1.1
2025-04-18 12:25:21,759 - INFO - [main.py:88] - 
--- Client Session (no certificate) ---
2025-04-18 12:25:21,760 - INFO - [cert.py:109] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-04-18 12:25:21,761 - INFO - [cert.py:110] - File exists: True
2025-04-18 12:25:21,761 - INFO - [cert.py:111] - File size: 1912 bytes
2025-04-18 12:25:21,761 - INFO - [cert.py:115] - Read 1912 bytes
2025-04-18 12:25:21,762 - INFO - [cert.py:119] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-04-18 12:25:21,762 - INFO - [cert.py:122] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-04-18 12:25:21,763 - INFO - [cert.py:132] - Successfully loaded as PEM
2025-04-18 12:25:21,763 - INFO - [cert.py:109] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-04-18 12:25:21,763 - INFO - [cert.py:110] - File exists: True
2025-04-18 12:25:21,763 - INFO - [cert.py:111] - File size: 1643 bytes
2025-04-18 12:25:21,764 - INFO - [cert.py:115] - Read 1643 bytes
2025-04-18 12:25:21,764 - INFO - [cert.py:119] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-04-18 12:25:21,765 - INFO - [cert.py:122] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-04-18 12:25:21,765 - INFO - [cert.py:132] - Successfully loaded as PEM
2025-04-18 12:25:21,805 - INFO - [cert.py:215] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-04-18 12:25:21,806 - INFO - [cert.py:216] - Key type: RSAPrivateKey
2025-04-18 12:25:21,806 - INFO - [cert.py:217] - Key size: 2048 bits
2025-04-18 12:25:21,806 - INFO - [cert.py:219] - Public exponent: 65537
2025-04-18 12:25:21,807 - INFO - [cert.py:248] - Certificate and keys loaded and validated successfully
2025-04-18 12:25:21,807 - INFO - [verify.py:62] - Public key comparison results:
2025-04-18 12:25:21,807 - INFO - [verify.py:63] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-04-18 12:25:21,808 - INFO - [verify.py:64] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-04-18 12:25:21,808 - INFO - [verify.py:65] - Certificate exponent (e): 0x10001
2025-04-18 12:25:21,809 - INFO - [verify.py:66] - Loaded key exponent (e): 0x10001
2025-04-18 12:25:21,810 - INFO - [verify.py:140] - Certificate chain verification successful
2025-04-18 12:25:21,811 - INFO - [verify.py:192] - Server name 'Pasdaran.local' verified successfully.
2025-04-18 12:25:21,812 - INFO - [chain.py:101] - Certificate chain verification passed
2025-04-18 12:25:21,812 - INFO - [chain.py:108] - Certificate chain loaded successfully
2025-04-18 12:25:21,813 - INFO - [chain.py:109] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-04-18 12:25:21,814 - INFO - [chain.py:110] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-04-18 12:25:21,815 - INFO - [chain.py:114] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-04-18 12:25:21,815 - INFO - [session.py:195] - Starting TLS session
2025-04-18 12:25:21,816 - INFO - [session.py:104] - Starting TLS Handshake...
2025-04-18 12:25:21,816 - INFO - [client.py:102] - Generated client_random: fc55e8175e9e485a3c62bfbe18c870b6905d4e36e01beacb24d4f5f82749e998
2025-04-18 12:25:21,823 - INFO - [client.py:145] - Client Hello sent from 192.168.1.2
2025-04-18 12:25:21,827 - INFO - [session.py:109] - Client Hello sent successfully
2025-04-18 12:25:21,827 - INFO - [server.py:96] - Generated server_random: 6dca64d2a33e9c948a6c9b9024a8667e7d93ac1d1648d7f467c9ce3a09ed01c5
2025-04-18 12:25:21,834 - INFO - [session.py:114] - Server Hello received successfully
2025-04-18 12:25:21,835 - INFO - [client.py:182] - Prepared empty certificate
2025-04-18 12:25:21,836 - INFO - [client.py:194] - Encrypted pre_master_secret length: 256
2025-04-18 12:25:21,838 - INFO - [session.py:119] - Client handshake messages sent successfully
2025-04-18 12:25:21,840 - INFO - [session.py:124] - Server key pair verified successfully
2025-04-18 12:25:21,841 - INFO - [keys.py:352] - Starting Master Secret generation.
2025-04-18 12:25:21,844 - INFO - [keys.py:303] - Decrypted pre_master_secret: 030308adf5cc8bc8381b1257d6673967eda0ad76ae0573ec7c785e5c784931c521ccbeb45ab3c51af9fb931b650eec03
2025-04-18 12:25:21,844 - INFO - [keys.py:313] - Generated master secret: 2d58a57ab7123e607a1755ada47b8697045000936184c627109656ee246d7c6e456b9b851e51fab27e4276cdf3c93dd5
2025-04-18 12:25:21,845 - INFO - [keys.py:314] - Master secret length: 48 bytes
2025-04-18 12:25:21,845 - INFO - [keys.py:373] - Master Secret generation completed successfully.
2025-04-18 12:25:21,845 - INFO - [session.py:128] - Master Secret handled successfully
2025-04-18 12:25:21,846 - INFO - [client.py:275] - Pre-master secret validated successfully
2025-04-18 12:25:21,847 - INFO - [client.py:293] - Generated digital signature: baf6d6594f145c1defb40a490e6012cda79790cd3a06d9882a859ed09e7a8a76d215f5525fd11dfcad73cdb5f0878c64ebf6453d4867852e4ecc4c933ba88fbbf89a30fccc22d4fae5ec7b32f371bf79fdab77792108e4b70fa0b04d74d3852b2f08db311235f62a5ce53f388c37793e3b8124b4b9e009e0e7381eff914221b04dc9eb82ab169e8ca40b95fa49ad0bb6b202c20b67883e152ec5d23a2a4d6f38c86fe9b989d9ce6ea5150670ccaf38fd1798944ee502ddcda579a81a4823a160ba93c294c35b1d28505944bc74c60181b9cbec42cd03b604a1632f89c87a79079cb429eb3231507165b639a1610d73bdc99e2d20fb723aa2d34f819c81d7a3c7
2025-04-18 12:25:21,848 - INFO - [client.py:339] - Client ChangeCipherSpec and Finished messages sent
2025-04-18 12:25:21,850 - INFO - [session.py:133] - Client Change Cipher Spec sent successfully
2025-04-18 12:25:21,854 - INFO - [server.py:262] - Pre-master secret validated successfully
2025-04-18 12:25:21,856 - INFO - [server.py:280] - Generated digital signature: 2ce5811e151d5364203c7d818879ee62fd4c08b3a3dde8021e67c009d3be593bc02c7bb6f4fe57b0eb0a86f24a7c2bb1cdec3d5e4f953637eb3db38a029c9185a46638373f7b680ffd1f59cd6b2699fdd855e2428b68f1192a553ed53e47d2062f63e7a31e6a7babe55c03b85fa98f8b96e0735032f90c07e1f7e69002704dcc14320389f2afd03bee81baa40062f792a8c2f64797a5eb32415985ad16c6b8a1f9c98894a56dceaf22ada6bd3ba56cdd1b8abe17431101952b6dda4a14e9b5a81d4474432661dda0f012d63274c14cdafc079d70b3ba0ba2cfc35ff9b8edc352b4634c5d7a8723fe9096271d43a9aa0dc7fc5f997af399dbe6375e6b925ad9c7
2025-04-18 12:25:21,862 - INFO - [server.py:326] - Server ChangeCipherSpec and Finished messages sent
2025-04-18 12:25:21,864 - INFO - [session.py:138] - Server Change Cipher Spec received successfully
2025-04-18 12:25:21,865 - INFO - [keys.py:221] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-04-18 12:25:21,866 - INFO - [session.py:143] - SSL Key Log handled successfully
2025-04-18 12:25:21,866 - INFO - [session.py:147] - TLS Handshake completed successfully
2025-04-18 12:25:21,866 - INFO - [session.py:224] - Handshake completed: True
2025-04-18 12:25:21,867 - INFO - [session.py:225] - Use client cert: False
2025-04-18 12:25:21,867 - INFO - [session.py:226] - File to send: None
2025-04-18 12:25:21,868 - INFO - [session.py:232] - Using unencrypted exchange
2025-04-18 12:25:21,869 - INFO - [session.py:332] - Added request packet
2025-04-18 12:25:21,871 - INFO - [session.py:332] - Added response packet
2025-04-18 12:25:21,872 - WARNING - [session.py:309] - Using unencrypted communication
2025-04-18 12:25:21,873 - INFO - [main.py:96] - Session completed successfully for 192.168.1.2
2025-04-18 12:25:21,875 - INFO - [packet_validator.py:112] - Packet 13: Valid HTTP message
2025-04-18 12:25:21,875 - INFO - [packet_validator.py:112] - Packet 14: Valid HTTP message
2025-04-18 12:25:21,887 - INFO - [packet_storage.py:81] - Saved 15 valid packets to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-04-18 12:25:21,888 - INFO - [packet_storage.py:102] - Verifying 15 packets...
2025-04-18 12:25:21,889 - INFO - [packet_storage.py:106] - Packet 1: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-04-18 12:25:21,889 - INFO - [packet_storage.py:106] - Packet 2: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-04-18 12:25:21,891 - INFO - [packet_storage.py:106] - Packet 3: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-04-18 12:25:21,892 - INFO - [packet_storage.py:106] - Packet 4: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-04-18 12:25:21,893 - INFO - [packet_storage.py:106] - Packet 5: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-04-18 12:25:21,894 - INFO - [packet_storage.py:106] - Packet 6: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-04-18 12:25:21,895 - INFO - [packet_storage.py:106] - Packet 7: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-04-18 12:25:21,895 - INFO - [packet_storage.py:106] - Packet 8: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-04-18 12:25:21,896 - INFO - [packet_storage.py:106] - Packet 9: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-04-18 12:25:21,896 - INFO - [packet_storage.py:106] - Packet 10: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-04-18 12:25:21,896 - INFO - [packet_storage.py:106] - Packet 11: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-04-18 12:25:21,897 - INFO - [packet_storage.py:106] - Packet 12: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-04-18 12:25:21,897 - INFO - [packet_storage.py:106] - Packet 13: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-04-18 12:25:21,898 - INFO - [packet_storage.py:106] - Packet 14: IP / TCP 192.168.1.2:12346 > 10.0.0.1:http PA / Raw
2025-04-18 12:25:21,898 - INFO - [packet_storage.py:106] - Packet 15: IP / TCP 10.0.0.1:http > 192.168.1.2:12346 PA / Raw
2025-04-18 12:25:21,899 - INFO - [packet_storage.py:113] - Verification complete: 15 valid packets, 13 TLS records
2025-04-18 12:25:21,899 - INFO - [main.py:107] - Results saved to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-04-18 12:25:21,899 - INFO - [main.py:161] - TLS session simulation completed successfully
2025-04-20 23:12:11,674 - INFO - [logging.py:81] - Logging configured successfully
2025-04-20 23:12:11,725 - INFO - [logging.py:88] - === Logging Configuration ===
2025-04-20 23:12:11,726 - INFO - [logging.py:89] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-04-20 23:12:11,728 - INFO - [logging.py:90] - Log level: 20
2025-04-20 23:12:11,729 - INFO - [logging.py:91] - Timestamp: 2025-04-20T23:12:11.728945
2025-04-20 23:12:11,729 - INFO - [logging.py:92] - ==========================
2025-04-20 23:12:11,730 - INFO - [main.py:126] - Starting TLS session simulation
2025-04-20 23:12:11,731 - INFO - [main.py:91] - 
--- Client Session (certificate) ---
2025-04-20 23:12:11,735 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-04-20 23:12:11,736 - INFO - [cert.py:108] - File exists: True
2025-04-20 23:12:11,737 - INFO - [cert.py:109] - File size: 1912 bytes
2025-04-20 23:12:11,761 - INFO - [cert.py:113] - Read 1912 bytes
2025-04-20 23:12:11,762 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-04-20 23:12:11,763 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-04-20 23:12:11,775 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-04-20 23:12:11,778 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-04-20 23:12:11,781 - INFO - [cert.py:108] - File exists: True
2025-04-20 23:12:11,783 - INFO - [cert.py:109] - File size: 1643 bytes
2025-04-20 23:12:11,809 - INFO - [cert.py:113] - Read 1643 bytes
2025-04-20 23:12:11,809 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-04-20 23:12:11,810 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-04-20 23:12:11,810 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-04-20 23:12:11,906 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-04-20 23:12:11,907 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-04-20 23:12:11,907 - INFO - [cert.py:215] - Key size: 2048 bits
2025-04-20 23:12:11,908 - INFO - [cert.py:217] - Public exponent: 65537
2025-04-20 23:12:11,910 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-04-20 23:12:11,910 - INFO - [verify.py:56] - Public key comparison results:
2025-04-20 23:12:11,911 - INFO - [verify.py:57] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-04-20 23:12:11,911 - INFO - [verify.py:58] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-04-20 23:12:11,912 - INFO - [verify.py:59] - Certificate exponent (e): 0x10001
2025-04-20 23:12:11,912 - INFO - [verify.py:60] - Loaded key exponent (e): 0x10001
2025-04-20 23:12:11,919 - INFO - [verify.py:134] - Certificate chain verification successful
2025-04-20 23:12:11,920 - INFO - [verify.py:186] - Server name 'Pasdaran.local' verified successfully.
2025-04-20 23:12:11,920 - INFO - [chain.py:95] - Certificate chain verification passed
2025-04-20 23:12:11,921 - INFO - [chain.py:102] - Certificate chain loaded successfully
2025-04-20 23:12:11,922 - INFO - [chain.py:103] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-04-20 23:12:11,922 - INFO - [chain.py:104] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-04-20 23:12:11,923 - INFO - [chain.py:108] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-04-20 23:12:11,924 - INFO - [session.py:184] - Starting TLS session
2025-04-20 23:12:11,925 - INFO - [session.py:93] - Starting TLS Handshake...
2025-04-20 23:12:11,926 - INFO - [client.py:99] - Generated client_random: 40cc3b2168880920600d230dcab33cecca7e5372653dc4c0704b1fdd2cfe74c6
2025-04-20 23:12:11,938 - INFO - [client.py:142] - Client Hello sent from 192.168.1.1
2025-04-20 23:12:11,941 - INFO - [session.py:98] - Client Hello sent successfully
2025-04-20 23:12:11,942 - INFO - [server.py:93] - Generated server_random: ce8d3f3b8bb3392d663a9891fa15766a180f4f3c84f08d94341deb140fa236d2
2025-04-20 23:12:11,950 - INFO - [session.py:103] - Server Hello received successfully
2025-04-20 23:12:11,950 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2025-04-20 23:12:11,951 - INFO - [cert.py:108] - File exists: True
2025-04-20 23:12:11,952 - INFO - [cert.py:109] - File size: 1623 bytes
2025-04-20 23:12:11,966 - INFO - [cert.py:113] - Read 1623 bytes
2025-04-20 23:12:11,967 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEgDCCAmgCFFeaE4J3cZV1/bmf8fOlTPfvC3BkMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-04-20 23:12:11,968 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEgDCCAmgCFFeaE4J3cZV1/bmf8fOlTPfvC3BkMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-04-20 23:12:11,969 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-04-20 23:12:11,971 - INFO - [client.py:176] - Prepared client certificate
2025-04-20 23:12:11,972 - INFO - [client.py:191] - Encrypted pre_master_secret length: 256
2025-04-20 23:12:11,974 - INFO - [session.py:108] - Client handshake messages sent successfully
2025-04-20 23:12:11,976 - INFO - [session.py:113] - Server key pair verified successfully
2025-04-20 23:12:11,976 - INFO - [keys.py:346] - Starting Master Secret generation.
2025-04-20 23:12:11,978 - INFO - [keys.py:297] - Decrypted pre_master_secret: 0303e37788716994680aa7d47a243756214ebc41a1ac296e4e390bdb01257536cd9c91e20eccac51ced6cb7037a96064
2025-04-20 23:12:11,978 - INFO - [keys.py:307] - Generated master secret: c0370247874e3bbcbece7cb12a8dd984a232de066508e84663b9d3489ebbae03134cac88514805c90397e3ad5e88660a
2025-04-20 23:12:11,978 - INFO - [keys.py:308] - Master secret length: 48 bytes
2025-04-20 23:12:11,979 - INFO - [keys.py:367] - Master Secret generation completed successfully.
2025-04-20 23:12:11,979 - INFO - [session.py:117] - Master Secret handled successfully
2025-04-20 23:12:11,982 - INFO - [client.py:272] - Pre-master secret validated successfully
2025-04-20 23:12:11,983 - INFO - [client.py:290] - Generated digital signature: d4170eb4e011ef998b7a29f71c55f8aa5848286ec5c7d40dc6c59ea7f43b8312407a7240ffdd3f9953a5df5c9a27d07510ce4e983a364246d6438a5acb5674321ec0235040b5e02d04db09cb122799c2d65abae5462f11b1a907b602a43561a4dece2597b8ee88b76f51ef77d1acc03f7c5eba3bef26e8e3424f508c364782fc7b788ac338a8e8ee2793137861fd3ee1486a61cac8e7629140696900dd40e75b9bfb801b4ebfde247d46b9200ebb086d1a2943fa0a960769ee070970285fef8d9098545ffc12e7a40d1c1c83a33c056588a989001a8017dfca1d359803655ee62ed0e2e1905a7218f31cc805ef7f40ae7a5453c24f0af9d55facb4b7a3a50e54
2025-04-20 23:12:11,987 - INFO - [client.py:336] - Client ChangeCipherSpec and Finished messages sent
2025-04-20 23:12:11,989 - INFO - [session.py:122] - Client Change Cipher Spec sent successfully
2025-04-20 23:12:11,990 - INFO - [server.py:259] - Pre-master secret validated successfully
2025-04-20 23:12:11,991 - INFO - [server.py:277] - Generated digital signature: bb8e32fc1e3de8172eea01321474759cef4b57ce16988a39369b13ee34f280b1302a1b4d67c462f960cc4f0107c5dfcad1c18943b4aff9121c02212fb5943b396143e019c5ccadefa31d9eaa3a7cc01be2c44d6bb7c4e7e9c30064cdb5bd75965327fa4a94380df8126a9d142e603f10a2ad790679da4291e1c59662b11cdb581c2d09a3fcc836f7252f22a15b986dabdb84beb592285416cae5dcd7f184e01df6a1f09d2923c523c17fc55cb833a03f5c0ad6b308c3c1052bdeade745ec4128775a334ae1219f5e4126e00befe4b74e79c83a2abecf69ad236920ff44103baa641cb55ed87230fa9584b471b7b5046fb93a309007f09f9b0398383e4da4e92b
2025-04-20 23:12:11,992 - INFO - [server.py:323] - Server ChangeCipherSpec and Finished messages sent
2025-04-20 23:12:11,994 - INFO - [session.py:127] - Server Change Cipher Spec received successfully
2025-04-20 23:12:11,994 - INFO - [keys.py:215] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-04-20 23:12:11,995 - INFO - [session.py:132] - SSL Key Log handled successfully
2025-04-20 23:12:11,995 - INFO - [session.py:136] - TLS Handshake completed successfully
2025-04-20 23:12:11,996 - INFO - [session.py:195] - Found file to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-04-20 23:12:11,996 - INFO - [session.py:213] - Handshake completed: True
2025-04-20 23:12:11,997 - INFO - [session.py:214] - Use client cert: True
2025-04-20 23:12:11,997 - INFO - [session.py:215] - File to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-04-20 23:12:11,998 - INFO - [session.py:218] - Using encrypted exchange
2025-04-20 23:12:11,999 - INFO - [session.py:233] - Sending encrypted request data
2025-04-20 23:12:12,003 - INFO - [keys.py:182] - TLS Application Data sent from 192.168.1.1:12345 to 10.0.0.1:443
2025-04-20 23:12:12,004 - INFO - [session.py:244] - Sending encrypted response data
2025-04-20 23:12:12,007 - INFO - [keys.py:182] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-04-20 23:12:12,008 - INFO - [session.py:256] - Attempting to send file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-04-20 23:12:12,009 - INFO - [session.py:267] - Opening file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-04-20 23:12:12,010 - INFO - [session.py:274] - Read 1103 bytes from file
2025-04-20 23:12:12,012 - INFO - [keys.py:182] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-04-20 23:12:12,014 - INFO - [session.py:283] - File sent successfully
2025-04-20 23:12:12,015 - INFO - [session.py:258] - File sent successfully
2025-04-20 23:12:12,015 - INFO - [main.py:99] - Session completed successfully for 192.168.1.1
2025-04-20 23:12:12,016 - INFO - [main.py:91] - 
--- Client Session (no certificate) ---
2025-04-20 23:12:12,017 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-04-20 23:12:12,019 - INFO - [cert.py:108] - File exists: True
2025-04-20 23:12:12,020 - INFO - [cert.py:109] - File size: 1912 bytes
2025-04-20 23:12:12,020 - INFO - [cert.py:113] - Read 1912 bytes
2025-04-20 23:12:12,021 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-04-20 23:12:12,022 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-04-20 23:12:12,023 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-04-20 23:12:12,024 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-04-20 23:12:12,024 - INFO - [cert.py:108] - File exists: True
2025-04-20 23:12:12,025 - INFO - [cert.py:109] - File size: 1643 bytes
2025-04-20 23:12:12,025 - INFO - [cert.py:113] - Read 1643 bytes
2025-04-20 23:12:12,025 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-04-20 23:12:12,026 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-04-20 23:12:12,026 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-04-20 23:12:12,058 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-04-20 23:12:12,059 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-04-20 23:12:12,059 - INFO - [cert.py:215] - Key size: 2048 bits
2025-04-20 23:12:12,060 - INFO - [cert.py:217] - Public exponent: 65537
2025-04-20 23:12:12,060 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-04-20 23:12:12,060 - INFO - [verify.py:56] - Public key comparison results:
2025-04-20 23:12:12,060 - INFO - [verify.py:57] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-04-20 23:12:12,061 - INFO - [verify.py:58] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-04-20 23:12:12,061 - INFO - [verify.py:59] - Certificate exponent (e): 0x10001
2025-04-20 23:12:12,061 - INFO - [verify.py:60] - Loaded key exponent (e): 0x10001
2025-04-20 23:12:12,062 - INFO - [verify.py:134] - Certificate chain verification successful
2025-04-20 23:12:12,062 - INFO - [verify.py:186] - Server name 'Pasdaran.local' verified successfully.
2025-04-20 23:12:12,063 - INFO - [chain.py:95] - Certificate chain verification passed
2025-04-20 23:12:12,063 - INFO - [chain.py:102] - Certificate chain loaded successfully
2025-04-20 23:12:12,064 - INFO - [chain.py:103] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-04-20 23:12:12,064 - INFO - [chain.py:104] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-04-20 23:12:12,065 - INFO - [chain.py:108] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-04-20 23:12:12,065 - INFO - [session.py:184] - Starting TLS session
2025-04-20 23:12:12,066 - INFO - [session.py:93] - Starting TLS Handshake...
2025-04-20 23:12:12,066 - INFO - [client.py:99] - Generated client_random: dae7cd354f5c3d73dddf05dc3347b31771ddeda8795bec5e03f117356040aa28
2025-04-20 23:12:12,069 - INFO - [client.py:142] - Client Hello sent from 192.168.1.2
2025-04-20 23:12:12,071 - INFO - [session.py:98] - Client Hello sent successfully
2025-04-20 23:12:12,071 - INFO - [server.py:93] - Generated server_random: a4e61ddbfbfa4b2288957afa4e594334cb4d5fc937da8bf37e22d3f732e66250
2025-04-20 23:12:12,074 - INFO - [session.py:103] - Server Hello received successfully
2025-04-20 23:12:12,075 - INFO - [client.py:179] - Prepared empty certificate
2025-04-20 23:12:12,075 - INFO - [client.py:191] - Encrypted pre_master_secret length: 256
2025-04-20 23:12:12,076 - INFO - [session.py:108] - Client handshake messages sent successfully
2025-04-20 23:12:12,077 - INFO - [session.py:113] - Server key pair verified successfully
2025-04-20 23:12:12,078 - INFO - [keys.py:346] - Starting Master Secret generation.
2025-04-20 23:12:12,078 - INFO - [keys.py:297] - Decrypted pre_master_secret: 0303b87cf1c21eae4436254b4fbf588c9800940cca8c60ab6d735f68006da97f36d7e91e29ea5cd74c81bd006640cd69
2025-04-20 23:12:12,079 - INFO - [keys.py:307] - Generated master secret: 95a945349f13b00bf0c3be39b24acd940a66b4d6f1b878c08394ba3e09b0dae5dd6d7636404ce4df7698f8f8e691bb7f
2025-04-20 23:12:12,080 - INFO - [keys.py:308] - Master secret length: 48 bytes
2025-04-20 23:12:12,080 - INFO - [keys.py:367] - Master Secret generation completed successfully.
2025-04-20 23:12:12,080 - INFO - [session.py:117] - Master Secret handled successfully
2025-04-20 23:12:12,082 - INFO - [client.py:272] - Pre-master secret validated successfully
2025-04-20 23:12:12,083 - INFO - [client.py:290] - Generated digital signature: 33b799d2f3a6d8f79e4c3ead54b99d172c9c1000beb64a3409aefad50a826ee37a6da650aae0e97afe5765e57120dce8c939649e3f4b7e00cebe88b143478e5b966938b87fa3a625a0b022c6a273c060428eda4422c4108c268bb7cc1688a1a5f0e4e1c71360df5be04fff26c934b3d901170bc097d9d26d05c24422544a2e7d949feeb873f87a3dd164aeaf4c9e42f5a6fabeb18158da549ef04cf76be311fdc99816e59a82fb987e0173e3276e02817eb098a523991522790f7893ae32d5567a16a312eba48c9e28b9f51aa3f66823fdfdb414d5a627f81f0342ab9cc7ceb587847ad6a41d99d753670520a610dedb8eccd1b666a9ae678e83651118fc129e
2025-04-20 23:12:12,084 - INFO - [client.py:336] - Client ChangeCipherSpec and Finished messages sent
2025-04-20 23:12:12,085 - INFO - [session.py:122] - Client Change Cipher Spec sent successfully
2025-04-20 23:12:12,086 - INFO - [server.py:259] - Pre-master secret validated successfully
2025-04-20 23:12:12,087 - INFO - [server.py:277] - Generated digital signature: 51154c3e688132e4211ff38839638a3bc0e80d3695561b1ad64275cd34923fcc0395bb03cc73d9fdc6b9bd80ae35611a76a252f2c28c842fb7363a1afea760c5c3c9cd830cf0ea09d67baf4e009684730535d4974bd3954f95304590e219897f29b2286fff1dd18561348dd59ce83e2d79c10c3720865f30eec338a1b3905c8f802f1809eb535b144357fbbdec18a8683d17d9db9161806e3ddf4aadb0bedb7fbc1f7137b6d93d2e4e8cd637c19a8e1eaccc1be64ad0a6100c8239891d0a513cc9e9757b15425c4cf69e552ccdaeafa58c9d871233e3312eff1d7ae6953ec189bed1adb3b27704f5bafb0d73620f57c90d1fa4ac6e525d88082021b154603b61
2025-04-20 23:12:12,088 - INFO - [server.py:323] - Server ChangeCipherSpec and Finished messages sent
2025-04-20 23:12:12,089 - INFO - [session.py:127] - Server Change Cipher Spec received successfully
2025-04-20 23:12:12,090 - INFO - [keys.py:215] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-04-20 23:12:12,090 - INFO - [session.py:132] - SSL Key Log handled successfully
2025-04-20 23:12:12,091 - INFO - [session.py:136] - TLS Handshake completed successfully
2025-04-20 23:12:12,091 - INFO - [session.py:213] - Handshake completed: True
2025-04-20 23:12:12,091 - INFO - [session.py:214] - Use client cert: False
2025-04-20 23:12:12,091 - INFO - [session.py:215] - File to send: None
2025-04-20 23:12:12,091 - INFO - [session.py:221] - Using unencrypted exchange
2025-04-20 23:12:12,092 - INFO - [session.py:321] - Added request packet
2025-04-20 23:12:12,093 - INFO - [session.py:321] - Added response packet
2025-04-20 23:12:12,093 - WARNING - [session.py:298] - Using unencrypted communication
2025-04-20 23:12:12,093 - INFO - [main.py:99] - Session completed successfully for 192.168.1.2
2025-04-20 23:12:12,094 - INFO - [packet_validator.py:109] - Packet 13: Valid HTTP message
2025-04-20 23:12:12,094 - INFO - [packet_validator.py:109] - Packet 14: Valid HTTP message
2025-04-20 23:12:12,099 - INFO - [packet_storage.py:78] - Saved 15 valid packets to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-04-20 23:12:12,100 - INFO - [packet_storage.py:99] - Verifying 15 packets...
2025-04-20 23:12:12,101 - INFO - [packet_storage.py:103] - Packet 1: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-04-20 23:12:12,102 - INFO - [packet_storage.py:103] - Packet 2: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-04-20 23:12:12,102 - INFO - [packet_storage.py:103] - Packet 3: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-04-20 23:12:12,102 - INFO - [packet_storage.py:103] - Packet 4: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-04-20 23:12:12,103 - INFO - [packet_storage.py:103] - Packet 5: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-04-20 23:12:12,103 - INFO - [packet_storage.py:103] - Packet 6: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-04-20 23:12:12,103 - INFO - [packet_storage.py:103] - Packet 7: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-04-20 23:12:12,104 - INFO - [packet_storage.py:103] - Packet 8: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-04-20 23:12:12,104 - INFO - [packet_storage.py:103] - Packet 9: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-04-20 23:12:12,104 - INFO - [packet_storage.py:103] - Packet 10: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-04-20 23:12:12,105 - INFO - [packet_storage.py:103] - Packet 11: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-04-20 23:12:12,105 - INFO - [packet_storage.py:103] - Packet 12: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-04-20 23:12:12,105 - INFO - [packet_storage.py:103] - Packet 13: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-04-20 23:12:12,106 - INFO - [packet_storage.py:103] - Packet 14: IP / TCP 192.168.1.2:12346 > 10.0.0.1:http PA / Raw
2025-04-20 23:12:12,106 - INFO - [packet_storage.py:103] - Packet 15: IP / TCP 10.0.0.1:http > 192.168.1.2:12346 PA / Raw
2025-04-20 23:12:12,106 - INFO - [packet_storage.py:110] - Verification complete: 15 valid packets, 13 TLS records
2025-04-20 23:12:12,106 - INFO - [main.py:110] - Results saved to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-04-20 23:12:12,107 - INFO - [main.py:164] - TLS session simulation completed successfully
2025-04-21 21:56:22,157 - INFO - [logging.py:81] - Logging configured successfully
2025-04-21 21:56:22,158 - INFO - [logging.py:88] - === Logging Configuration ===
2025-04-21 21:56:22,159 - INFO - [logging.py:89] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-04-21 21:56:22,159 - INFO - [logging.py:90] - Log level: 20
2025-04-21 21:56:22,159 - INFO - [logging.py:91] - Timestamp: 2025-04-21T21:56:22.159828
2025-04-21 21:56:22,160 - INFO - [logging.py:92] - ==========================
2025-04-21 21:56:22,160 - INFO - [main.py:126] - Starting TLS session simulation
2025-04-21 21:56:22,160 - INFO - [main.py:91] - 
--- Client Session (certificate) ---
2025-04-21 21:56:22,162 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-04-21 21:56:22,162 - INFO - [cert.py:108] - File exists: True
2025-04-21 21:56:22,163 - INFO - [cert.py:109] - File size: 1912 bytes
2025-04-21 21:56:22,170 - INFO - [cert.py:113] - Read 1912 bytes
2025-04-21 21:56:22,170 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-04-21 21:56:22,171 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-04-21 21:56:22,174 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-04-21 21:56:22,175 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-04-21 21:56:22,176 - INFO - [cert.py:108] - File exists: True
2025-04-21 21:56:22,176 - INFO - [cert.py:109] - File size: 1643 bytes
2025-04-21 21:56:22,190 - INFO - [cert.py:113] - Read 1643 bytes
2025-04-21 21:56:22,191 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-04-21 21:56:22,191 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-04-21 21:56:22,192 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-04-21 21:56:22,244 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-04-21 21:56:22,245 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-04-21 21:56:22,245 - INFO - [cert.py:215] - Key size: 2048 bits
2025-04-21 21:56:22,246 - INFO - [cert.py:217] - Public exponent: 65537
2025-04-21 21:56:22,248 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-04-21 21:56:22,248 - INFO - [verify.py:56] - Public key comparison results:
2025-04-21 21:56:22,249 - INFO - [verify.py:57] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-04-21 21:56:22,249 - INFO - [verify.py:58] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-04-21 21:56:22,250 - INFO - [verify.py:59] - Certificate exponent (e): 0x10001
2025-04-21 21:56:22,250 - INFO - [verify.py:60] - Loaded key exponent (e): 0x10001
2025-04-21 21:56:22,254 - INFO - [verify.py:134] - Certificate chain verification successful
2025-04-21 21:56:22,255 - INFO - [verify.py:186] - Server name 'Pasdaran.local' verified successfully.
2025-04-21 21:56:22,255 - INFO - [chain.py:95] - Certificate chain verification passed
2025-04-21 21:56:22,255 - INFO - [chain.py:102] - Certificate chain loaded successfully
2025-04-21 21:56:22,256 - INFO - [chain.py:103] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-04-21 21:56:22,257 - INFO - [chain.py:104] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-04-21 21:56:22,258 - INFO - [chain.py:108] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-04-21 21:56:22,258 - INFO - [session.py:192] - Starting TLS session
2025-04-21 21:56:22,258 - INFO - [session.py:122] - Starting TLS Handshake...
2025-04-21 21:56:22,259 - INFO - [client.py:99] - Generated client_random: 296547f151c667968aecc334c678cc90a89e13983901149b3036cbb0de52be63
2025-04-21 21:56:22,261 - INFO - [client.py:142] - Client Hello sent from 192.168.1.1
2025-04-21 21:56:22,263 - INFO - [session.py:128] - Client Hello sent successfully
2025-04-21 21:56:22,264 - INFO - [server.py:93] - Generated server_random: 98ac290fed99f7708d24380223de15dc7270f187a129149089b9d520241ca75c
2025-04-21 21:56:22,267 - INFO - [session.py:128] - Server Hello received successfully
2025-04-21 21:56:22,268 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2025-04-21 21:56:22,268 - INFO - [cert.py:108] - File exists: True
2025-04-21 21:56:22,268 - INFO - [cert.py:109] - File size: 1623 bytes
2025-04-21 21:56:22,281 - INFO - [cert.py:113] - Read 1623 bytes
2025-04-21 21:56:22,281 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEgDCCAmgCFFeaE4J3cZV1/bmf8fOlTPfvC3BkMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-04-21 21:56:22,282 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEgDCCAmgCFFeaE4J3cZV1/bmf8fOlTPfvC3BkMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-04-21 21:56:22,282 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-04-21 21:56:22,283 - INFO - [client.py:176] - Prepared client certificate
2025-04-21 21:56:22,284 - INFO - [client.py:191] - Encrypted pre_master_secret length: 256
2025-04-21 21:56:22,285 - INFO - [session.py:128] - Client handshake messages sent successfully
2025-04-21 21:56:22,287 - INFO - [session.py:128] - Server key pair verified successfully
2025-04-21 21:56:22,287 - INFO - [keys.py:346] - Starting Master Secret generation.
2025-04-21 21:56:22,288 - INFO - [keys.py:297] - Decrypted pre_master_secret: 03039fd50ae0147b8aec00462ce41e553961a2e17a033931895b2b879e5026fd99474fc99ff582c8aaede83e73c37b45
2025-04-21 21:56:22,289 - INFO - [keys.py:307] - Generated master secret: 18dc769584abb85aa80e567ac08fc2c188181a3477cf5091c6f4441c030955618e70d2e3bb8bd31064f40f2d6e2ac0c0
2025-04-21 21:56:22,289 - INFO - [keys.py:308] - Master secret length: 48 bytes
2025-04-21 21:56:22,290 - INFO - [keys.py:367] - Master Secret generation completed successfully.
2025-04-21 21:56:22,291 - INFO - [session.py:128] - Master Secret handled successfully
2025-04-21 21:56:22,292 - INFO - [client.py:272] - Pre-master secret validated successfully
2025-04-21 21:56:22,293 - INFO - [client.py:290] - Generated digital signature: 6739be70f14071e2de2e88656e0809dfc4ab10d44cb43aa40cdb03bab1ab2c56390d53e3b3835a0ef52a9317b1d2b13a4d79fe132eef91448157bf933b6f5733acf8213f757561022a2d90c5778962460af5262168a9557969eee045f243b72b9183b3f6aeea8839c168ac5ca3193a87c7d532c53b02153fe5e3b001fde00666418e82426b353c16ae091aa1b61224e6238bd403e5d2f8e30e38eb35cc3042b4d7d6ac8781c0c2e046977d352bf192b8ccdf7e1512520155489fe0499f178c4aa6efcc6752550db820cc8d7021273fe20b344e7eb0f898bcb700f61b937f1c563714d2dc1d1b6bb16e8a553a35d2df425668558bde993711ea0634fd999a9c88
2025-04-21 21:56:22,295 - INFO - [client.py:336] - Client ChangeCipherSpec and Finished messages sent
2025-04-21 21:56:22,297 - INFO - [session.py:128] - Client Change Cipher Spec sent successfully
2025-04-21 21:56:22,298 - INFO - [server.py:259] - Pre-master secret validated successfully
2025-04-21 21:56:22,299 - INFO - [server.py:277] - Generated digital signature: 778c0f4fa4f93a591e69f9ac3f0b24dc6213b68801f42f620f03172e23a5a2e8bacba541a891f085c14b0f145bf9270e54aec80ccd7579f6084bae2079491cd31f83498ad267818e01e461d9c6196be9975b2b17a2659f7c89a203cffa128cf4eb45f296f06ab2ab2349ced0c6a7d46a92b9da64067b340bc899eeb88247537f42a8b1b741fdf429b7678f51aebf27641ab05f462a0b8881de633129f27ac3b4fd2f67f98c01b61fde78637a861f14821083bd412517a1420e55b7871aa06ec4c1c09e3fd2d0551e98a72301eea3e0ea0f79ba173b0ad4695bac710af9680d485e354a0fdd05a71a5a585789f4ca43f6f3b74bfd8e637766d9239fad8da41ae2
2025-04-21 21:56:22,300 - INFO - [server.py:323] - Server ChangeCipherSpec and Finished messages sent
2025-04-21 21:56:22,301 - INFO - [session.py:128] - Server Change Cipher Spec received successfully
2025-04-21 21:56:22,303 - INFO - [keys.py:215] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-04-21 21:56:22,303 - INFO - [session.py:128] - SSL Key Log handled successfully
2025-04-21 21:56:22,303 - INFO - [session.py:132] - TLS Handshake completed successfully
2025-04-21 21:56:22,304 - INFO - [session.py:203] - Found file to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-04-21 21:56:22,304 - INFO - [session.py:221] - Handshake completed: True
2025-04-21 21:56:22,305 - INFO - [session.py:222] - Use client cert: True
2025-04-21 21:56:22,306 - INFO - [session.py:223] - File to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-04-21 21:56:22,306 - INFO - [session.py:226] - Using encrypted exchange
2025-04-21 21:56:22,308 - INFO - [session.py:241] - Sending encrypted request data
2025-04-21 21:56:22,313 - INFO - [keys.py:182] - TLS Application Data sent from 192.168.1.1:12345 to 10.0.0.1:443
2025-04-21 21:56:22,313 - INFO - [session.py:252] - Sending encrypted response data
2025-04-21 21:56:22,315 - INFO - [keys.py:182] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-04-21 21:56:22,316 - INFO - [session.py:264] - Attempting to send file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-04-21 21:56:22,316 - INFO - [session.py:275] - Opening file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-04-21 21:56:22,318 - INFO - [session.py:282] - Read 1103 bytes from file
2025-04-21 21:56:22,319 - INFO - [keys.py:182] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-04-21 21:56:22,319 - INFO - [session.py:291] - File sent successfully
2025-04-21 21:56:22,320 - INFO - [session.py:266] - File sent successfully
2025-04-21 21:56:22,320 - INFO - [main.py:99] - Session completed successfully for 192.168.1.1
2025-04-21 21:56:22,321 - INFO - [main.py:91] - 
--- Client Session (no certificate) ---
2025-04-21 21:56:22,322 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-04-21 21:56:22,322 - INFO - [cert.py:108] - File exists: True
2025-04-21 21:56:22,323 - INFO - [cert.py:109] - File size: 1912 bytes
2025-04-21 21:56:22,324 - INFO - [cert.py:113] - Read 1912 bytes
2025-04-21 21:56:22,325 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-04-21 21:56:22,325 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-04-21 21:56:22,326 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-04-21 21:56:22,326 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-04-21 21:56:22,327 - INFO - [cert.py:108] - File exists: True
2025-04-21 21:56:22,327 - INFO - [cert.py:109] - File size: 1643 bytes
2025-04-21 21:56:22,327 - INFO - [cert.py:113] - Read 1643 bytes
2025-04-21 21:56:22,328 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-04-21 21:56:22,328 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-04-21 21:56:22,329 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-04-21 21:56:22,361 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-04-21 21:56:22,362 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-04-21 21:56:22,362 - INFO - [cert.py:215] - Key size: 2048 bits
2025-04-21 21:56:22,363 - INFO - [cert.py:217] - Public exponent: 65537
2025-04-21 21:56:22,363 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-04-21 21:56:22,363 - INFO - [verify.py:56] - Public key comparison results:
2025-04-21 21:56:22,364 - INFO - [verify.py:57] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-04-21 21:56:22,364 - INFO - [verify.py:58] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-04-21 21:56:22,365 - INFO - [verify.py:59] - Certificate exponent (e): 0x10001
2025-04-21 21:56:22,365 - INFO - [verify.py:60] - Loaded key exponent (e): 0x10001
2025-04-21 21:56:22,366 - INFO - [verify.py:134] - Certificate chain verification successful
2025-04-21 21:56:22,366 - INFO - [verify.py:186] - Server name 'Pasdaran.local' verified successfully.
2025-04-21 21:56:22,367 - INFO - [chain.py:95] - Certificate chain verification passed
2025-04-21 21:56:22,367 - INFO - [chain.py:102] - Certificate chain loaded successfully
2025-04-21 21:56:22,367 - INFO - [chain.py:103] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-04-21 21:56:22,368 - INFO - [chain.py:104] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-04-21 21:56:22,368 - INFO - [chain.py:108] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-04-21 21:56:22,369 - INFO - [session.py:192] - Starting TLS session
2025-04-21 21:56:22,369 - INFO - [session.py:122] - Starting TLS Handshake...
2025-04-21 21:56:22,369 - INFO - [client.py:99] - Generated client_random: 7305a6119fed6fd875b96fcaff9a9a46ad82b02ea3f5a4ec0c7eef0ca931e15e
2025-04-21 21:56:22,372 - INFO - [client.py:142] - Client Hello sent from 192.168.1.2
2025-04-21 21:56:22,375 - INFO - [session.py:128] - Client Hello sent successfully
2025-04-21 21:56:22,375 - INFO - [server.py:93] - Generated server_random: 0d24457794ad949529a67741cffdf50c12f1ee12e99c495a7f1bd8490435b2a0
2025-04-21 21:56:22,379 - INFO - [session.py:128] - Server Hello received successfully
2025-04-21 21:56:22,379 - INFO - [client.py:179] - Prepared empty certificate
2025-04-21 21:56:22,380 - INFO - [client.py:191] - Encrypted pre_master_secret length: 256
2025-04-21 21:56:22,381 - INFO - [session.py:128] - Client handshake messages sent successfully
2025-04-21 21:56:22,383 - INFO - [session.py:128] - Server key pair verified successfully
2025-04-21 21:56:22,383 - INFO - [keys.py:346] - Starting Master Secret generation.
2025-04-21 21:56:22,384 - INFO - [keys.py:297] - Decrypted pre_master_secret: 03039a156f234cb5c40b432f044ee6eae2652091c23fa7d522d88c5367f56cbc327d7822254db7d7fbd729776e9e32bc
2025-04-21 21:56:22,385 - INFO - [keys.py:307] - Generated master secret: 4989986c25877d3d77424ee50415ba80988944260290feaf2f1256b81993f725390cd21021331d31a95b0ced7a853623
2025-04-21 21:56:22,385 - INFO - [keys.py:308] - Master secret length: 48 bytes
2025-04-21 21:56:22,385 - INFO - [keys.py:367] - Master Secret generation completed successfully.
2025-04-21 21:56:22,386 - INFO - [session.py:128] - Master Secret handled successfully
2025-04-21 21:56:22,388 - INFO - [client.py:272] - Pre-master secret validated successfully
2025-04-21 21:56:22,390 - INFO - [client.py:290] - Generated digital signature: 8153e39eb245fae3ec530243edaa82c6ba2c29dc7e33d6bb4497bac7595d7903e395d0e5ef744c2c4a3a5cb24b17bd257de46e50afe78f47e938dbf5ca3b61a2b986ffb30ec79c5becb602f4b7f4bf1c889895fc9e7ffdd2afc219216710704e4bd5623c954031e360d7b26160d58630631bdddffea9d31b0d5e59001a35c438a07bbf43f8ec0eefa8c7860a2db0bd0f36d70969103422c3714e629a299887683016e9e08b04d35914d4247d4a121d733317eb8188199ca10df172564a99135379194b4581b1df2daff99e04b21022ac4c49436e39fcc026fb088956c17fec10f3aad31f6fb93a6577fe103bc49646bff29e56532996c2459c89eda9a579b7e1
2025-04-21 21:56:22,392 - INFO - [client.py:336] - Client ChangeCipherSpec and Finished messages sent
2025-04-21 21:56:22,393 - INFO - [session.py:128] - Client Change Cipher Spec sent successfully
2025-04-21 21:56:22,394 - INFO - [server.py:259] - Pre-master secret validated successfully
2025-04-21 21:56:22,395 - INFO - [server.py:277] - Generated digital signature: 5928ae1038a186ca20fe060caab645054b7b94b7bf3ae8dc43e22d420329bfa65d49ce1a604a70023a8a64f672531782f584807636b6bcea8b754b62c4e00ff7581c5df953e3b6ebc35b1dcd1b94192798f5f9d31a9bfcad72a7b2092ebcbaaf1fffb3baa5b64ac632dfd0f539235be368b6b88f25ceef3fb8ef9a47422dad6917abfa2daa82c96ce1cbd72c2f2fc27a41f361d3df49a291a4e26c9940d9df186780b66ea7c2904d6349d99a107d4678ffee75a7bb05697d1fa797ed9f6b19f0b0e53c1203073abf56e6e903ed108ae82b351ff0b2f868a8ebe55202b753842dc5eb73dc020f50613a5e1e11d8d62214837cf5796db98e915cfbca4e4d240ade
2025-04-21 21:56:22,396 - INFO - [server.py:323] - Server ChangeCipherSpec and Finished messages sent
2025-04-21 21:56:22,397 - INFO - [session.py:128] - Server Change Cipher Spec received successfully
2025-04-21 21:56:22,398 - INFO - [keys.py:215] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-04-21 21:56:22,399 - INFO - [session.py:128] - SSL Key Log handled successfully
2025-04-21 21:56:22,399 - INFO - [session.py:132] - TLS Handshake completed successfully
2025-04-21 21:56:22,399 - INFO - [session.py:221] - Handshake completed: True
2025-04-21 21:56:22,400 - INFO - [session.py:222] - Use client cert: False
2025-04-21 21:56:22,400 - INFO - [session.py:223] - File to send: None
2025-04-21 21:56:22,400 - INFO - [session.py:229] - Using unencrypted exchange
2025-04-21 21:56:22,401 - INFO - [session.py:329] - Added request packet
2025-04-21 21:56:22,402 - INFO - [session.py:329] - Added response packet
2025-04-21 21:56:22,402 - WARNING - [session.py:306] - Using unencrypted communication
2025-04-21 21:56:22,402 - INFO - [main.py:99] - Session completed successfully for 192.168.1.2
2025-04-21 21:56:22,403 - INFO - [packet_validator.py:109] - Packet 13: Valid HTTP message
2025-04-21 21:56:22,403 - INFO - [packet_validator.py:109] - Packet 14: Valid HTTP message
2025-04-21 21:56:22,411 - INFO - [packet_storage.py:78] - Saved 15 valid packets to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-04-21 21:56:22,411 - INFO - [packet_storage.py:99] - Verifying 15 packets...
2025-04-21 21:56:22,412 - INFO - [packet_storage.py:103] - Packet 1: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-04-21 21:56:22,412 - INFO - [packet_storage.py:103] - Packet 2: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-04-21 21:56:22,413 - INFO - [packet_storage.py:103] - Packet 3: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-04-21 21:56:22,414 - INFO - [packet_storage.py:103] - Packet 4: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-04-21 21:56:22,414 - INFO - [packet_storage.py:103] - Packet 5: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-04-21 21:56:22,414 - INFO - [packet_storage.py:103] - Packet 6: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-04-21 21:56:22,415 - INFO - [packet_storage.py:103] - Packet 7: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-04-21 21:56:22,415 - INFO - [packet_storage.py:103] - Packet 8: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-04-21 21:56:22,416 - INFO - [packet_storage.py:103] - Packet 9: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-04-21 21:56:22,416 - INFO - [packet_storage.py:103] - Packet 10: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-04-21 21:56:22,416 - INFO - [packet_storage.py:103] - Packet 11: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-04-21 21:56:22,417 - INFO - [packet_storage.py:103] - Packet 12: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-04-21 21:56:22,417 - INFO - [packet_storage.py:103] - Packet 13: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-04-21 21:56:22,418 - INFO - [packet_storage.py:103] - Packet 14: IP / TCP 192.168.1.2:12346 > 10.0.0.1:http PA / Raw
2025-04-21 21:56:22,418 - INFO - [packet_storage.py:103] - Packet 15: IP / TCP 10.0.0.1:http > 192.168.1.2:12346 PA / Raw
2025-04-21 21:56:22,418 - INFO - [packet_storage.py:110] - Verification complete: 15 valid packets, 13 TLS records
2025-04-21 21:56:22,419 - INFO - [main.py:110] - Results saved to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-04-21 21:56:22,419 - INFO - [main.py:164] - TLS session simulation completed successfully
2025-05-29 13:10:22,475 - INFO - [logging.py:81] - Logging configured successfully
2025-05-29 13:10:22,476 - INFO - [logging.py:88] - === Logging Configuration ===
2025-05-29 13:10:22,477 - INFO - [logging.py:89] - Log file: C:\Networks\pcap_repo\scapy-tls-pcap-creator\tls\logs\tls_session.log
2025-05-29 13:10:22,477 - INFO - [logging.py:90] - Log level: 20
2025-05-29 13:10:22,477 - INFO - [logging.py:91] - Timestamp: 2025-05-29T13:10:22.477610
2025-05-29 13:10:22,477 - INFO - [logging.py:92] - ==========================
2025-05-29 13:10:22,478 - INFO - [main.py:126] - Starting TLS session simulation
2025-05-29 13:10:22,478 - INFO - [main.py:91] - 
--- Client Session (certificate) ---
2025-05-29 13:10:22,479 - INFO - [cert.py:107] - Loading certificate from: C:\Networks\pcap_repo\scapy-tls-pcap-creator\tls\certificates\certs\ca.crt
2025-05-29 13:10:22,479 - INFO - [cert.py:108] - File exists: True
2025-05-29 13:10:22,480 - INFO - [cert.py:109] - File size: 1944 bytes
2025-05-29 13:10:22,480 - INFO - [cert.py:113] - Read 1944 bytes
2025-05-29 13:10:22,481 - INFO - [cert.py:117] - First 100 bytes: b'\r\n-----BEGIN CERTIFICATE-----\r\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\r\nUjE'
2025-05-29 13:10:22,481 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxF
2025-05-29 13:10:22,486 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-05-29 13:10:22,487 - INFO - [cert.py:107] - Loading certificate from: C:\Networks\pcap_repo\scapy-tls-pcap-creator\tls\certificates\certs\server.crt
2025-05-29 13:10:22,487 - INFO - [cert.py:108] - File exists: True
2025-05-29 13:10:22,488 - INFO - [cert.py:109] - File size: 1670 bytes
2025-05-29 13:10:22,488 - INFO - [cert.py:113] - Read 1670 bytes
2025-05-29 13:10:22,489 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\r\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\r\nCzAJB'
2025-05-29 13:10:22,489 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJ
2025-05-29 13:10:22,490 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-05-29 13:10:22,529 - INFO - [cert.py:213] - Successfully loaded private key from C:\Networks\pcap_repo\scapy-tls-pcap-creator\tls\certificates\certs\server.key
2025-05-29 13:10:22,530 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-05-29 13:10:22,530 - INFO - [cert.py:215] - Key size: 2048 bits
2025-05-29 13:10:22,532 - INFO - [cert.py:217] - Public exponent: 65537
2025-05-29 13:10:22,534 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-05-29 13:10:22,535 - INFO - [verify.py:56] - Public key comparison results:
2025-05-29 13:10:22,535 - INFO - [verify.py:57] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-05-29 13:10:22,536 - INFO - [verify.py:58] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-05-29 13:10:22,536 - INFO - [verify.py:59] - Certificate exponent (e): 0x10001
2025-05-29 13:10:22,537 - INFO - [verify.py:60] - Loaded key exponent (e): 0x10001
2025-05-29 13:10:22,544 - INFO - [verify.py:134] - Certificate chain verification successful
2025-05-29 13:10:22,545 - INFO - [verify.py:186] - Server name 'Pasdaran.local' verified successfully.
2025-05-29 13:10:22,545 - INFO - [chain.py:95] - Certificate chain verification passed
2025-05-29 13:10:22,546 - INFO - [chain.py:102] - Certificate chain loaded successfully
2025-05-29 13:10:22,547 - INFO - [chain.py:103] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-05-29 13:10:22,547 - INFO - [chain.py:104] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-05-29 13:10:22,547 - INFO - [chain.py:108] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-05-29 13:10:22,548 - INFO - [session.py:192] - Starting TLS session
2025-05-29 13:10:22,548 - INFO - [session.py:122] - Starting TLS Handshake...
2025-05-29 13:10:22,549 - INFO - [client.py:99] - Generated client_random: 9485ecd282c5ca4ea73e7510b2b7b5119e2b07b2b21b096a28f6535e004d9d80
2025-05-29 13:10:22,551 - INFO - [client.py:142] - Client Hello sent from 192.168.1.1
2025-05-29 13:10:22,553 - INFO - [session.py:128] - Client Hello sent successfully
2025-05-29 13:10:22,553 - INFO - [server.py:93] - Generated server_random: 27eed424c07ab6030e9b665c32a1bdaa597dd2293e6e5d52c941f0567b9f45f0
2025-05-29 13:10:22,558 - INFO - [session.py:128] - Server Hello received successfully
2025-05-29 13:10:22,559 - INFO - [cert.py:107] - Loading certificate from: C:\Networks\pcap_repo\scapy-tls-pcap-creator\tls\certificates\certs\client.crt
2025-05-29 13:10:22,560 - INFO - [cert.py:108] - File exists: True
2025-05-29 13:10:22,560 - INFO - [cert.py:109] - File size: 1650 bytes
2025-05-29 13:10:22,561 - INFO - [cert.py:113] - Read 1650 bytes
2025-05-29 13:10:22,561 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\r\nMIIEgDCCAmgCFFeaE4J3cZV1/bmf8fOlTPfvC3BkMA0GCSqGSIb3DQEBCwUAMG0x\r\nCzAJB'
2025-05-29 13:10:22,562 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEgDCCAmgCFFeaE4J3cZV1/bmf8fOlTPfvC3BkMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJ
2025-05-29 13:10:22,562 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-05-29 13:10:22,563 - INFO - [client.py:176] - Prepared client certificate
2025-05-29 13:10:22,563 - INFO - [client.py:191] - Encrypted pre_master_secret length: 256
2025-05-29 13:10:22,565 - INFO - [session.py:128] - Client handshake messages sent successfully
2025-05-29 13:10:22,566 - INFO - [session.py:128] - Server key pair verified successfully
2025-05-29 13:10:22,566 - INFO - [keys.py:346] - Starting Master Secret generation.
2025-05-29 13:10:22,568 - INFO - [keys.py:297] - Decrypted pre_master_secret: 0303882d387a2a44df83c12d78d6e0ddaf67161a5c0dad089f518dde18620ba7c85b7d5823f7a2dd9b271e2634b94744
2025-05-29 13:10:22,569 - INFO - [keys.py:307] - Generated master secret: 38310b3d4eec37e1c3d999193eca3b15b788833f927b487e8d537d67f180c2370ecf7884afaddd4da51850b8fb4b8c20
2025-05-29 13:10:22,569 - INFO - [keys.py:308] - Master secret length: 48 bytes
2025-05-29 13:10:22,570 - INFO - [keys.py:367] - Master Secret generation completed successfully.
2025-05-29 13:10:22,570 - INFO - [session.py:128] - Master Secret handled successfully
2025-05-29 13:10:22,571 - INFO - [client.py:272] - Pre-master secret validated successfully
2025-05-29 13:10:22,573 - INFO - [client.py:290] - Generated digital signature: ae0f676efc67a59dd1b204ce39afe7d9e0003c589fc9b71b76bf87c8fa73b6035921f41ec5223cb3a3455c8b19599aad65ab370a3487cf1101a77f82af1b72469b000a940ffdf5dee274e3d8ccb3ad324bc82fa2f36d84e7753375d960cb30666004282aa1ca7c26deaaffa395bac11e0514440fa1af93b052342d3b8f766acae4822d0446696f2e18717c59fa129c4b559a11a4ac710596eea65a12e642f8abd6f9328cc51a9be5854f19212fb2388c56d5a9c38e6302816f941d9fdc4943516d33353a76e0fe8a4bfbb6a6286ea97861c318a38c5daf74d6a3202ac87407c4d764f7b04e756b757a4c7c994a2477681ee48fb33d992724d84409f384c229b4
2025-05-29 13:10:22,578 - INFO - [client.py:336] - Client ChangeCipherSpec and Finished messages sent
2025-05-29 13:10:22,579 - INFO - [session.py:128] - Client Change Cipher Spec sent successfully
2025-05-29 13:10:22,581 - INFO - [server.py:259] - Pre-master secret validated successfully
2025-05-29 13:10:22,582 - INFO - [server.py:277] - Generated digital signature: 3c6b65cee376ce210fa9b3531342556727145b7f8de89785790462b7cbdb454bc1d4063566b04f5b906daacc96aea92dd2cce9639f692c4651cb14047c445898bbd636bfea185a427967aa48c0adcef9aefec74a358cc75a9f1653a7e7b20733aa93769e0dbe6b6b81d62afe961e3fc56dc260cb9a1d0e83f91a230bddf7fcf997c8975bfed360085331f7689e5e1984c340055c354a4645482c6999fa1accb76f8c91c2918cb7ca9276e103a84a6f5758c22edcd38f25950a4c960e26d0ace9d1fd8e8e5de7441e2db5988ac360fe5dad3912282f032b91b30d800cfafd6b761eb6c8869077121a7a1124ffadc054a05e079daab3369eb3fd0149e6f11c8657
2025-05-29 13:10:22,583 - INFO - [server.py:323] - Server ChangeCipherSpec and Finished messages sent
2025-05-29 13:10:22,584 - INFO - [session.py:128] - Server Change Cipher Spec received successfully
2025-05-29 13:10:22,585 - INFO - [keys.py:215] - SSL keys logged to C:\Networks\pcap_repo\scapy-tls-pcap-creator\tls\logs\ssl_key_log.log
2025-05-29 13:10:22,586 - INFO - [session.py:128] - SSL Key Log handled successfully
2025-05-29 13:10:22,586 - INFO - [session.py:132] - TLS Handshake completed successfully
2025-05-29 13:10:22,587 - INFO - [session.py:203] - Found file to send: C:\Networks\pcap_repo\scapy-tls-pcap-creator\tls\documents\ctf_challenge.gif
2025-05-29 13:10:22,587 - INFO - [session.py:221] - Handshake completed: True
2025-05-29 13:10:22,587 - INFO - [session.py:222] - Use client cert: True
2025-05-29 13:10:22,587 - INFO - [session.py:223] - File to send: C:\Networks\pcap_repo\scapy-tls-pcap-creator\tls\documents\ctf_challenge.gif
2025-05-29 13:10:22,588 - INFO - [session.py:226] - Using encrypted exchange
2025-05-29 13:10:22,588 - INFO - [session.py:241] - Sending encrypted request data
2025-05-29 13:10:22,591 - INFO - [keys.py:182] - TLS Application Data sent from 192.168.1.1:12345 to 10.0.0.1:443
2025-05-29 13:10:22,593 - INFO - [session.py:252] - Sending encrypted response data
2025-05-29 13:10:22,595 - INFO - [keys.py:182] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-05-29 13:10:22,595 - INFO - [session.py:264] - Attempting to send file: C:\Networks\pcap_repo\scapy-tls-pcap-creator\tls\documents\ctf_challenge.gif
2025-05-29 13:10:22,596 - INFO - [session.py:275] - Opening file: C:\Networks\pcap_repo\scapy-tls-pcap-creator\tls\documents\ctf_challenge.gif
2025-05-29 13:10:22,596 - INFO - [session.py:282] - Read 1103 bytes from file
2025-05-29 13:10:22,598 - INFO - [keys.py:182] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-05-29 13:10:22,599 - INFO - [session.py:291] - File sent successfully
2025-05-29 13:10:22,599 - INFO - [session.py:266] - File sent successfully
2025-05-29 13:10:22,599 - INFO - [main.py:99] - Session completed successfully for 192.168.1.1
2025-05-29 13:10:22,600 - INFO - [main.py:91] - 
--- Client Session (no certificate) ---
2025-05-29 13:10:22,600 - INFO - [cert.py:107] - Loading certificate from: C:\Networks\pcap_repo\scapy-tls-pcap-creator\tls\certificates\certs\ca.crt
2025-05-29 13:10:22,601 - INFO - [cert.py:108] - File exists: True
2025-05-29 13:10:22,601 - INFO - [cert.py:109] - File size: 1944 bytes
2025-05-29 13:10:22,602 - INFO - [cert.py:113] - Read 1944 bytes
2025-05-29 13:10:22,602 - INFO - [cert.py:117] - First 100 bytes: b'\r\n-----BEGIN CERTIFICATE-----\r\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\r\nUjE'
2025-05-29 13:10:22,602 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxF
2025-05-29 13:10:22,603 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-05-29 13:10:22,603 - INFO - [cert.py:107] - Loading certificate from: C:\Networks\pcap_repo\scapy-tls-pcap-creator\tls\certificates\certs\server.crt
2025-05-29 13:10:22,604 - INFO - [cert.py:108] - File exists: True
2025-05-29 13:10:22,604 - INFO - [cert.py:109] - File size: 1670 bytes
2025-05-29 13:10:22,605 - INFO - [cert.py:113] - Read 1670 bytes
2025-05-29 13:10:22,605 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\r\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\r\nCzAJB'
2025-05-29 13:10:22,605 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJ
2025-05-29 13:10:22,606 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-05-29 13:10:22,643 - INFO - [cert.py:213] - Successfully loaded private key from C:\Networks\pcap_repo\scapy-tls-pcap-creator\tls\certificates\certs\server.key
2025-05-29 13:10:22,643 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-05-29 13:10:22,644 - INFO - [cert.py:215] - Key size: 2048 bits
2025-05-29 13:10:22,644 - INFO - [cert.py:217] - Public exponent: 65537
2025-05-29 13:10:22,645 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-05-29 13:10:22,645 - INFO - [verify.py:56] - Public key comparison results:
2025-05-29 13:10:22,645 - INFO - [verify.py:57] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-05-29 13:10:22,646 - INFO - [verify.py:58] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-05-29 13:10:22,646 - INFO - [verify.py:59] - Certificate exponent (e): 0x10001
2025-05-29 13:10:22,647 - INFO - [verify.py:60] - Loaded key exponent (e): 0x10001
2025-05-29 13:10:22,647 - INFO - [verify.py:134] - Certificate chain verification successful
2025-05-29 13:10:22,648 - INFO - [verify.py:186] - Server name 'Pasdaran.local' verified successfully.
2025-05-29 13:10:22,648 - INFO - [chain.py:95] - Certificate chain verification passed
2025-05-29 13:10:22,648 - INFO - [chain.py:102] - Certificate chain loaded successfully
2025-05-29 13:10:22,648 - INFO - [chain.py:103] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-05-29 13:10:22,649 - INFO - [chain.py:104] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-05-29 13:10:22,650 - INFO - [chain.py:108] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-05-29 13:10:22,650 - INFO - [session.py:192] - Starting TLS session
2025-05-29 13:10:22,650 - INFO - [session.py:122] - Starting TLS Handshake...
2025-05-29 13:10:22,650 - INFO - [client.py:99] - Generated client_random: 58f3cdb451ea46d310ef9de1448419f01a4ed8d7ed59a24efa0841255bb3aca1
2025-05-29 13:10:22,653 - INFO - [client.py:142] - Client Hello sent from 192.168.1.2
2025-05-29 13:10:22,654 - INFO - [session.py:128] - Client Hello sent successfully
2025-05-29 13:10:22,655 - INFO - [server.py:93] - Generated server_random: ee99617da49bb3f88de96fa2a09083b384a3780b2da469212254b856969b5598
2025-05-29 13:10:22,660 - INFO - [session.py:128] - Server Hello received successfully
2025-05-29 13:10:22,661 - INFO - [client.py:179] - Prepared empty certificate
2025-05-29 13:10:22,661 - INFO - [client.py:191] - Encrypted pre_master_secret length: 256
2025-05-29 13:10:22,663 - INFO - [session.py:128] - Client handshake messages sent successfully
2025-05-29 13:10:22,664 - INFO - [session.py:128] - Server key pair verified successfully
2025-05-29 13:10:22,665 - INFO - [keys.py:346] - Starting Master Secret generation.
2025-05-29 13:10:22,665 - INFO - [keys.py:297] - Decrypted pre_master_secret: 0303a5817ac14b08c14ada86db63f726fdfc9e69d23f93e101b07f1e4c00856b519854ff43fce3dfeee399d2972f98bb
2025-05-29 13:10:22,666 - INFO - [keys.py:307] - Generated master secret: f5d78255e20d6178ffd81d3ce58078ced4604e06a33c2923003cf81396f2a0bdc39fb8307f582af73992b19a70f20c0b
2025-05-29 13:10:22,666 - INFO - [keys.py:308] - Master secret length: 48 bytes
2025-05-29 13:10:22,666 - INFO - [keys.py:367] - Master Secret generation completed successfully.
2025-05-29 13:10:22,666 - INFO - [session.py:128] - Master Secret handled successfully
2025-05-29 13:10:22,667 - INFO - [client.py:272] - Pre-master secret validated successfully
2025-05-29 13:10:22,668 - INFO - [client.py:290] - Generated digital signature: 62a0d3a05e8b8f54dd57e9b7341186d22442c4fb57aa0e0713c928e5369e728360d8cb62f3cc2c89d538204f8990f8a7af7996ae494d941899ec861018215491cc3e4ad7a736d7f1fec9d8491f99c58a0f48c9818fe0453afa8915ddcd82084b12d0512379659dd0e620e81bfc720ed27b86df609806a007caae65e0d0c0404d4a6d129a107928f86467a113abba704b356583a9753e791f351794e179dffdf4ca4e8ecee632485a38491b6492bd40139dcd77fb26a640dbec5c00c6d3a2592216f96c4b03f084b5f30947d38442cf73a2b50b4ccf0b58acea90e7242672c6fb63ef73dc37d72890f09df4f659931ff4e8b7ce13bcf0295949f5e8bcc8714ac0
2025-05-29 13:10:22,669 - INFO - [client.py:336] - Client ChangeCipherSpec and Finished messages sent
2025-05-29 13:10:22,670 - INFO - [session.py:128] - Client Change Cipher Spec sent successfully
2025-05-29 13:10:22,671 - INFO - [server.py:259] - Pre-master secret validated successfully
2025-05-29 13:10:22,673 - INFO - [server.py:277] - Generated digital signature: 632775ea91269d11e7dd356f11519d530bdb4759e0d841a53ac3f1018f7dbd8028baa108372d4453be07c7646cb3cd72b5a93287cf63ed7bb8f9ddbd112391175cd34722dadceec3f7c9321975788b65f89dc3d1a624b3f9e44c5f68f2f1b4dd0bf393cd6b49a18fd16914c54fa57f81a91899e32d408186936e6761cda1e933a70e78c51a5ead55338e03414f6c7c7aaa05adf0bf9ce40afaf5c70e01c19b01f0b166c7267d79fdb6ee1e720d58982969d67dbf8bb54defb967c285e5eaf543c71cb38440631a951fe60aac8bd39a6864c6e66f427222b63f31831d7c50bf32b9b229941d263e1fc1afbf072469fb8517118e180adac39051a7d0bce8f9f4b4
2025-05-29 13:10:22,676 - INFO - [server.py:323] - Server ChangeCipherSpec and Finished messages sent
2025-05-29 13:10:22,678 - INFO - [session.py:128] - Server Change Cipher Spec received successfully
2025-05-29 13:10:22,679 - INFO - [keys.py:215] - SSL keys logged to C:\Networks\pcap_repo\scapy-tls-pcap-creator\tls\logs\ssl_key_log.log
2025-05-29 13:10:22,679 - INFO - [session.py:128] - SSL Key Log handled successfully
2025-05-29 13:10:22,679 - INFO - [session.py:132] - TLS Handshake completed successfully
2025-05-29 13:10:22,680 - INFO - [session.py:221] - Handshake completed: True
2025-05-29 13:10:22,680 - INFO - [session.py:222] - Use client cert: False
2025-05-29 13:10:22,681 - INFO - [session.py:223] - File to send: None
2025-05-29 13:10:22,681 - INFO - [session.py:229] - Using unencrypted exchange
2025-05-29 13:10:22,682 - INFO - [session.py:329] - Added request packet
2025-05-29 13:10:22,682 - INFO - [session.py:329] - Added response packet
2025-05-29 13:10:22,683 - WARNING - [session.py:306] - Using unencrypted communication
2025-05-29 13:10:22,683 - INFO - [main.py:99] - Session completed successfully for 192.168.1.2
2025-05-29 13:10:22,684 - INFO - [packet_validator.py:109] - Packet 13: Valid HTTP message
2025-05-29 13:10:22,684 - INFO - [packet_validator.py:109] - Packet 14: Valid HTTP message
2025-05-29 13:10:22,696 - INFO - [packet_storage.py:78] - Saved 15 valid packets to C:\Networks\pcap_repo\scapy-tls-pcap-creator\tls\output\capture.pcap
2025-05-29 13:10:22,697 - INFO - [packet_storage.py:99] - Verifying 15 packets...
2025-05-29 13:10:22,697 - INFO - [packet_storage.py:103] - Packet 1: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-05-29 13:10:22,697 - INFO - [packet_storage.py:103] - Packet 2: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-05-29 13:10:22,698 - INFO - [packet_storage.py:103] - Packet 3: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-05-29 13:10:22,698 - INFO - [packet_storage.py:103] - Packet 4: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-05-29 13:10:22,699 - INFO - [packet_storage.py:103] - Packet 5: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-05-29 13:10:22,699 - INFO - [packet_storage.py:103] - Packet 6: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-05-29 13:10:22,699 - INFO - [packet_storage.py:103] - Packet 7: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-05-29 13:10:22,700 - INFO - [packet_storage.py:103] - Packet 8: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-05-29 13:10:22,700 - INFO - [packet_storage.py:103] - Packet 9: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-05-29 13:10:22,701 - INFO - [packet_storage.py:103] - Packet 10: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-05-29 13:10:22,701 - INFO - [packet_storage.py:103] - Packet 11: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-05-29 13:10:22,701 - INFO - [packet_storage.py:103] - Packet 12: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-05-29 13:10:22,701 - INFO - [packet_storage.py:103] - Packet 13: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-05-29 13:10:22,702 - INFO - [packet_storage.py:103] - Packet 14: IP / TCP 192.168.1.2:12346 > 10.0.0.1:http PA / Raw
2025-05-29 13:10:22,702 - INFO - [packet_storage.py:103] - Packet 15: IP / TCP 10.0.0.1:http > 192.168.1.2:12346 PA / Raw
2025-05-29 13:10:22,703 - INFO - [packet_storage.py:110] - Verification complete: 15 valid packets, 13 TLS records
2025-05-29 13:10:22,703 - INFO - [main.py:110] - Results saved to C:\Networks\pcap_repo\scapy-tls-pcap-creator\tls\output\capture.pcap
2025-05-29 13:10:22,703 - INFO - [main.py:164] - TLS session simulation completed successfully
