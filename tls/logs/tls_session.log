2024-12-31 01:24:26,072 - INFO - [logging.py:83] - Logging configured successfully
2024-12-31 01:24:26,073 - INFO - [logging.py:90] - === Logging Configuration ===
2024-12-31 01:24:26,073 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2024-12-31 01:24:26,074 - INFO - [logging.py:92] - Log level: 20
2024-12-31 01:24:26,074 - INFO - [logging.py:93] - Timestamp: 2024-12-31T01:24:26.074348
2024-12-31 01:24:26,074 - INFO - [logging.py:94] - ==========================
2024-12-31 01:24:26,075 - INFO - [main.py:122] - Starting TLS session simulation
2024-12-31 01:24:26,076 - INFO - [main.py:87] - 
--- Client Session (certificate) ---
2024-12-31 01:24:26,077 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2024-12-31 01:24:26,077 - INFO - [cert.py:108] - File exists: True
2024-12-31 01:24:26,078 - INFO - [cert.py:109] - File size: 1912 bytes
2024-12-31 01:24:26,079 - INFO - [cert.py:113] - Read 1912 bytes
2024-12-31 01:24:26,079 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2024-12-31 01:24:26,080 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2024-12-31 01:24:26,083 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 01:24:26,085 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2024-12-31 01:24:26,087 - INFO - [cert.py:108] - File exists: True
2024-12-31 01:24:26,088 - INFO - [cert.py:109] - File size: 1643 bytes
2024-12-31 01:24:26,090 - INFO - [cert.py:113] - Read 1643 bytes
2024-12-31 01:24:26,091 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2024-12-31 01:24:26,093 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2024-12-31 01:24:26,096 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 01:24:26,171 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2024-12-31 01:24:26,171 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2024-12-31 01:24:26,172 - INFO - [cert.py:215] - Key size: 2048 bits
2024-12-31 01:24:26,172 - INFO - [cert.py:217] - Public exponent: 65537
2024-12-31 01:24:26,175 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2024-12-31 01:24:26,176 - INFO - [verify.py:58] - Public key comparison results:
2024-12-31 01:24:26,176 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2024-12-31 01:24:26,178 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2024-12-31 01:24:26,179 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2024-12-31 01:24:26,179 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2024-12-31 01:24:26,182 - INFO - [verify.py:136] - Certificate chain verification successful
2024-12-31 01:24:26,183 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2024-12-31 01:24:26,183 - INFO - [chain.py:109] - Certificate chain verification passed
2024-12-31 01:24:26,184 - INFO - [chain.py:116] - Certificate chain loaded successfully
2024-12-31 01:24:26,184 - INFO - [chain.py:117] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2024-12-31 01:24:26,185 - INFO - [chain.py:118] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2024-12-31 01:24:26,186 - INFO - [chain.py:122] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2024-12-31 01:24:26,186 - INFO - [session.py:119] - Starting TLS session
2024-12-31 01:24:26,187 - INFO - [client.py:95] - Generated client_random: 67732baa6c6c6144b0375264c934ff3148fa7d77b948816ea6b427f6fc633fba
2024-12-31 01:24:26,189 - INFO - [client.py:135] - Client Hello sent from 192.168.1.1
2024-12-31 01:24:26,192 - INFO - [server.py:89] - Generated server_random: 67732baaf1fb992879f70e117fae07fdf88e536586168d2ae58fb9186bee82cc
2024-12-31 01:24:26,198 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2024-12-31 01:24:26,199 - INFO - [cert.py:108] - File exists: True
2024-12-31 01:24:26,199 - INFO - [cert.py:109] - File size: 1915 bytes
2024-12-31 01:24:26,200 - INFO - [cert.py:113] - Read 1915 bytes
2024-12-31 01:24:26,200 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2024-12-31 01:24:26,201 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2024-12-31 01:24:26,201 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 01:24:26,201 - INFO - [client.py:178] - Client certificate prepared
2024-12-31 01:24:26,202 - INFO - [client.py:190] - Encrypted pre_master_secret length: 256
2024-12-31 01:24:26,204 - INFO - [chain.py:182] - Decrypted pre_master_secret: 03034f6d464ee0bb699f4e57408c619e100052f74fac8a03e073888abc5f3717343c943c46d20d508879ec5278bb8c7b
2024-12-31 01:24:26,204 - INFO - [chain.py:193] - Generated master secret: 8de37dd057c8cdd5f84078a5b41a60ced6054ebb6f672b3cf3f297f8762fafd0b1ba380cc076171c5061b7ea9aa59ba4
2024-12-31 01:24:26,205 - INFO - [client.py:252] - Client ChangeCipherSpec and Finished messages sent
2024-12-31 01:24:26,207 - INFO - [server.py:239] - Pre-master secret validated successfully
2024-12-31 01:24:26,208 - INFO - [server.py:257] - Generated digital signature: 9b1e5ea778a04555eb5491408f5e34243c23770ac69db80c7269f373b5b65529eb14b074955ad35bb432f8318ba816111ba1f6bb6f0606797d002039349df82fdc1a431018f55503085cdf3a8a6f2a61e63433e2792844e64548c366b94f58144676618b66760002966380a07b13426f2de13f73ba9d807675a0de9842ea8aee38472ac7a8fa87f8f2ea5fe3362b92cf58768f92de8c7e48c195a6666c2325862530d71ce4e04361af37f9986ad5fc61930dcb302cefca3f5f47e3fe6582c9d8f06416ce2d2ffe7dc2b3d1fb7c7950349d2a77bdfbf0f5fbec10d29cb7ca144889aceddda115a34108af66a20c35c37f969fd45910c23b2ddbe0acb353e01bcc
2024-12-31 01:24:26,209 - INFO - [server.py:271] - Server ChangeCipherSpec and Finished messages sent
2024-12-31 01:24:26,211 - INFO - [keys.py:193] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2024-12-31 01:24:26,212 - INFO - [session.py:103] - TLS Handshake completed successfully
2024-12-31 01:24:26,212 - INFO - [session.py:130] - Found file to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2024-12-31 01:24:26,213 - INFO - [session.py:148] - Handshake completed: True
2024-12-31 01:24:26,214 - INFO - [session.py:149] - Use client cert: True
2024-12-31 01:24:26,214 - INFO - [session.py:150] - File to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2024-12-31 01:24:26,215 - INFO - [session.py:153] - Using encrypted exchange
2024-12-31 01:24:26,215 - INFO - [session.py:168] - Sending encrypted request data
2024-12-31 01:24:26,219 - INFO - [keys.py:173] - TLS Application Data sent from 192.168.1.1:12345 to 10.0.0.1:443
2024-12-31 01:24:26,219 - INFO - [session.py:179] - Sending encrypted response data
2024-12-31 01:24:26,221 - INFO - [keys.py:173] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2024-12-31 01:24:26,221 - INFO - [session.py:191] - Attempting to send file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2024-12-31 01:24:26,221 - INFO - [session.py:202] - Opening file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2024-12-31 01:24:26,222 - INFO - [session.py:209] - Read 1103 bytes from file
2024-12-31 01:24:26,223 - INFO - [keys.py:173] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2024-12-31 01:24:26,223 - INFO - [session.py:218] - File sent successfully
2024-12-31 01:24:26,224 - INFO - [session.py:193] - File sent successfully
2024-12-31 01:24:26,224 - INFO - [main.py:95] - Session completed successfully for 192.168.1.1
2024-12-31 01:24:26,224 - INFO - [main.py:87] - 
--- Client Session (no certificate) ---
2024-12-31 01:24:26,226 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2024-12-31 01:24:26,227 - INFO - [cert.py:108] - File exists: True
2024-12-31 01:24:26,227 - INFO - [cert.py:109] - File size: 1912 bytes
2024-12-31 01:24:26,228 - INFO - [cert.py:113] - Read 1912 bytes
2024-12-31 01:24:26,228 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2024-12-31 01:24:26,229 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2024-12-31 01:24:26,230 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 01:24:26,231 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2024-12-31 01:24:26,231 - INFO - [cert.py:108] - File exists: True
2024-12-31 01:24:26,232 - INFO - [cert.py:109] - File size: 1643 bytes
2024-12-31 01:24:26,232 - INFO - [cert.py:113] - Read 1643 bytes
2024-12-31 01:24:26,233 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2024-12-31 01:24:26,233 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2024-12-31 01:24:26,234 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 01:24:26,262 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2024-12-31 01:24:26,263 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2024-12-31 01:24:26,263 - INFO - [cert.py:215] - Key size: 2048 bits
2024-12-31 01:24:26,263 - INFO - [cert.py:217] - Public exponent: 65537
2024-12-31 01:24:26,264 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2024-12-31 01:24:26,264 - INFO - [verify.py:58] - Public key comparison results:
2024-12-31 01:24:26,264 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2024-12-31 01:24:26,265 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2024-12-31 01:24:26,265 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2024-12-31 01:24:26,265 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2024-12-31 01:24:26,266 - INFO - [verify.py:136] - Certificate chain verification successful
2024-12-31 01:24:26,266 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2024-12-31 01:24:26,266 - INFO - [chain.py:109] - Certificate chain verification passed
2024-12-31 01:24:26,266 - INFO - [chain.py:116] - Certificate chain loaded successfully
2024-12-31 01:24:26,267 - INFO - [chain.py:117] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2024-12-31 01:24:26,267 - INFO - [chain.py:118] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2024-12-31 01:24:26,268 - INFO - [chain.py:122] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2024-12-31 01:24:26,268 - INFO - [session.py:119] - Starting TLS session
2024-12-31 01:24:26,268 - INFO - [client.py:95] - Generated client_random: 67732baa38af464fa8b89f5f62046727fd1697181ee9ea8198ab876bb386f8b7
2024-12-31 01:24:26,271 - INFO - [client.py:135] - Client Hello sent from 192.168.1.2
2024-12-31 01:24:26,273 - INFO - [server.py:89] - Generated server_random: 67732baa19d0c2942945e2799a5c812c5b3e437c388def8fdf2c66eb24e036bd
2024-12-31 01:24:26,276 - INFO - [client.py:166] - Sending empty certificate
2024-12-31 01:24:26,277 - INFO - [client.py:178] - Client certificate prepared
2024-12-31 01:24:26,278 - INFO - [client.py:190] - Encrypted pre_master_secret length: 256
2024-12-31 01:24:26,280 - INFO - [chain.py:182] - Decrypted pre_master_secret: 03030e0c0c8d88ffef97507f46537887f40618e0ee38a1abfacae93b6b22928c738912417a589f9e05ace851657efe51
2024-12-31 01:24:26,281 - INFO - [chain.py:193] - Generated master secret: 29fde1dd6814b45d5f4bdbb980612c2937612510feed1756d01700b66754bfef8fa8eb6b7bf973261d6ee9782d934ee4
2024-12-31 01:24:26,282 - INFO - [client.py:252] - Client ChangeCipherSpec and Finished messages sent
2024-12-31 01:24:26,283 - INFO - [server.py:239] - Pre-master secret validated successfully
2024-12-31 01:24:26,285 - INFO - [server.py:257] - Generated digital signature: c5aaa9b98ae94adf9fbef3b082b379e4f18eb1b6f064c9899877fccd9ca211d1aa07b80be36f40f5aa06dea29c152022e3c2975863cfe6c45dceb5ff9af03b601db46cd0f27bd587dc3a8a024c73295dd6d4bc8035758ea57a06e96ece1b896e1d2292c45f31dd91c3826722c28d5908ee4d43a10336b1582c08c898f17ca71ac5775877d5afcc0ad61f321dfc7c14fcaf95b24ae908b416ac8e734d7b460753ca60fa2c2c5990ff5a19d11de9181a47d895c482d0c716caf3c2d731bd80011bfc4ddd6e800bd6b037f300c3cc48324342c14074c65027a90e6422c7545ede5c4892097b0cd998c587e18da61fcce3bf3e805bfdf57151a23d2eebe03adde579
2024-12-31 01:24:26,287 - INFO - [server.py:271] - Server ChangeCipherSpec and Finished messages sent
2024-12-31 01:24:26,291 - INFO - [keys.py:193] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2024-12-31 01:24:26,292 - INFO - [session.py:103] - TLS Handshake completed successfully
2024-12-31 01:24:26,292 - INFO - [session.py:148] - Handshake completed: True
2024-12-31 01:24:26,293 - INFO - [session.py:149] - Use client cert: False
2024-12-31 01:24:26,294 - INFO - [session.py:150] - File to send: None
2024-12-31 01:24:26,294 - INFO - [session.py:156] - Using unencrypted exchange
2024-12-31 01:24:26,296 - INFO - [session.py:256] - Added request packet
2024-12-31 01:24:26,298 - INFO - [session.py:256] - Added response packet
2024-12-31 01:24:26,298 - WARNING - [session.py:233] - Using unencrypted communication
2024-12-31 01:24:26,298 - INFO - [main.py:95] - Session completed successfully for 192.168.1.2
2024-12-31 01:24:26,299 - INFO - [pcap_writer.py:232] - Packet 13: Valid HTTP message
2024-12-31 01:24:26,300 - INFO - [pcap_writer.py:232] - Packet 14: Valid HTTP message
2024-12-31 01:24:26,310 - INFO - [pcap_writer.py:387] - Saved 15 valid packets to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2024-12-31 01:24:26,310 - INFO - [pcap_writer.py:409] - Verifying 15 packets...
2024-12-31 01:24:26,311 - INFO - [pcap_writer.py:413] - Packet 1: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2024-12-31 01:24:26,311 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2024-12-31 01:24:26,312 - INFO - [pcap_writer.py:413] - Packet 2: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2024-12-31 01:24:26,312 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2775
2024-12-31 01:24:26,313 - INFO - [pcap_writer.py:413] - Packet 3: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2024-12-31 01:24:26,313 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 1646
2024-12-31 01:24:26,314 - INFO - [pcap_writer.py:413] - Packet 4: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2024-12-31 01:24:26,314 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2024-12-31 01:24:26,314 - INFO - [pcap_writer.py:413] - Packet 5: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2024-12-31 01:24:26,315 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2024-12-31 01:24:26,315 - INFO - [pcap_writer.py:413] - Packet 6: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2024-12-31 01:24:26,316 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 165
2024-12-31 01:24:26,316 - INFO - [pcap_writer.py:413] - Packet 7: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2024-12-31 01:24:26,316 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 133
2024-12-31 01:24:26,317 - INFO - [pcap_writer.py:413] - Packet 8: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2024-12-31 01:24:26,317 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 1157
2024-12-31 01:24:26,318 - INFO - [pcap_writer.py:413] - Packet 9: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2024-12-31 01:24:26,318 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2024-12-31 01:24:26,319 - INFO - [pcap_writer.py:413] - Packet 10: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2024-12-31 01:24:26,319 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2775
2024-12-31 01:24:26,319 - INFO - [pcap_writer.py:413] - Packet 11: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2024-12-31 01:24:26,319 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 269
2024-12-31 01:24:26,320 - INFO - [pcap_writer.py:413] - Packet 12: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2024-12-31 01:24:26,320 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2024-12-31 01:24:26,321 - INFO - [pcap_writer.py:413] - Packet 13: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2024-12-31 01:24:26,321 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2024-12-31 01:24:26,321 - INFO - [pcap_writer.py:413] - Packet 14: IP / TCP 192.168.1.2:12346 > 10.0.0.1:http PA / Raw
2024-12-31 01:24:26,321 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2024-12-31 01:24:26,322 - INFO - [pcap_writer.py:413] - Packet 15: IP / TCP 10.0.0.1:http > 192.168.1.2:12346 PA / Raw
2024-12-31 01:24:26,322 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2024-12-31 01:24:26,322 - INFO - [pcap_writer.py:427] - Verification complete: 15 valid packets, 15 TLS records
2024-12-31 01:24:26,322 - INFO - [main.py:106] - Results saved to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2024-12-31 01:24:26,322 - INFO - [main.py:160] - TLS session simulation completed successfully
2024-12-31 14:51:48,233 - INFO - [logging.py:83] - Logging configured successfully
2024-12-31 14:51:48,234 - INFO - [logging.py:90] - === Logging Configuration ===
2024-12-31 14:51:48,234 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2024-12-31 14:51:48,235 - INFO - [logging.py:92] - Log level: 20
2024-12-31 14:51:48,235 - INFO - [logging.py:93] - Timestamp: 2024-12-31T14:51:48.235809
2024-12-31 14:51:48,236 - INFO - [logging.py:94] - ==========================
2024-12-31 14:51:48,236 - INFO - [main.py:122] - Starting TLS session simulation
2024-12-31 14:51:48,236 - INFO - [main.py:87] - 
--- Client Session (certificate) ---
2024-12-31 14:51:48,238 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2024-12-31 14:51:48,238 - INFO - [cert.py:108] - File exists: True
2024-12-31 14:51:48,238 - INFO - [cert.py:109] - File size: 1912 bytes
2024-12-31 14:51:48,239 - INFO - [cert.py:113] - Read 1912 bytes
2024-12-31 14:51:48,240 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2024-12-31 14:51:48,240 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2024-12-31 14:51:48,243 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 14:51:48,244 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2024-12-31 14:51:48,245 - INFO - [cert.py:108] - File exists: True
2024-12-31 14:51:48,246 - INFO - [cert.py:109] - File size: 1643 bytes
2024-12-31 14:51:48,247 - INFO - [cert.py:113] - Read 1643 bytes
2024-12-31 14:51:48,248 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2024-12-31 14:51:48,249 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2024-12-31 14:51:48,250 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 14:51:48,282 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2024-12-31 14:51:48,283 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2024-12-31 14:51:48,283 - INFO - [cert.py:215] - Key size: 2048 bits
2024-12-31 14:51:48,284 - INFO - [cert.py:217] - Public exponent: 65537
2024-12-31 14:51:48,287 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2024-12-31 14:51:48,288 - INFO - [verify.py:58] - Public key comparison results:
2024-12-31 14:51:48,289 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2024-12-31 14:51:48,290 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2024-12-31 14:51:48,291 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2024-12-31 14:51:48,292 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2024-12-31 14:51:48,295 - INFO - [verify.py:136] - Certificate chain verification successful
2024-12-31 14:51:48,298 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2024-12-31 14:51:48,298 - INFO - [chain.py:109] - Certificate chain verification passed
2024-12-31 14:51:48,299 - INFO - [chain.py:116] - Certificate chain loaded successfully
2024-12-31 14:51:48,299 - INFO - [chain.py:117] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2024-12-31 14:51:48,300 - INFO - [chain.py:118] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2024-12-31 14:51:48,300 - INFO - [chain.py:122] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2024-12-31 14:51:48,301 - INFO - [session.py:119] - Starting TLS session
2024-12-31 14:51:48,301 - INFO - [client.py:95] - Generated client_random: 6773e8e48a79cf073487a6afbd361748d34574e41bf689979b624aea413854f0
2024-12-31 14:51:48,304 - INFO - [client.py:135] - Client Hello sent from 192.168.1.1
2024-12-31 14:51:48,306 - INFO - [server.py:93] - Generated server_random: 6773e8e47a6dc05cd4361a5fdf780c2b5615528ea1f0c2bf9ddbffee15048456
2024-12-31 14:51:48,310 - ERROR - [main.py:27] - Session error: Session failed for 192.168.1.1: Session failed: send_client_handshake_messages() missing 2 required positional arguments: 'client_certificate' and 'client_key_exchange'
2024-12-31 15:02:36,169 - INFO - [logging.py:83] - Logging configured successfully
2024-12-31 15:02:36,170 - INFO - [logging.py:90] - === Logging Configuration ===
2024-12-31 15:02:36,170 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2024-12-31 15:02:36,170 - INFO - [logging.py:92] - Log level: 20
2024-12-31 15:02:36,171 - INFO - [logging.py:93] - Timestamp: 2024-12-31T15:02:36.171408
2024-12-31 15:02:36,171 - INFO - [logging.py:94] - ==========================
2024-12-31 15:02:36,172 - INFO - [main.py:122] - Starting TLS session simulation
2024-12-31 15:02:36,172 - INFO - [main.py:87] - 
--- Client Session (certificate) ---
2024-12-31 15:02:36,173 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2024-12-31 15:02:36,174 - INFO - [cert.py:108] - File exists: True
2024-12-31 15:02:36,175 - INFO - [cert.py:109] - File size: 1912 bytes
2024-12-31 15:02:36,175 - INFO - [cert.py:113] - Read 1912 bytes
2024-12-31 15:02:36,176 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2024-12-31 15:02:36,177 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2024-12-31 15:02:36,178 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 15:02:36,179 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2024-12-31 15:02:36,179 - INFO - [cert.py:108] - File exists: True
2024-12-31 15:02:36,180 - INFO - [cert.py:109] - File size: 1643 bytes
2024-12-31 15:02:36,180 - INFO - [cert.py:113] - Read 1643 bytes
2024-12-31 15:02:36,181 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2024-12-31 15:02:36,181 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2024-12-31 15:02:36,182 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 15:02:36,223 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2024-12-31 15:02:36,224 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2024-12-31 15:02:36,225 - INFO - [cert.py:215] - Key size: 2048 bits
2024-12-31 15:02:36,226 - INFO - [cert.py:217] - Public exponent: 65537
2024-12-31 15:02:36,229 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2024-12-31 15:02:36,230 - INFO - [verify.py:58] - Public key comparison results:
2024-12-31 15:02:36,231 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2024-12-31 15:02:36,232 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2024-12-31 15:02:36,234 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2024-12-31 15:02:36,234 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2024-12-31 15:02:36,239 - INFO - [verify.py:136] - Certificate chain verification successful
2024-12-31 15:02:36,253 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2024-12-31 15:02:36,255 - INFO - [chain.py:109] - Certificate chain verification passed
2024-12-31 15:02:36,257 - INFO - [chain.py:116] - Certificate chain loaded successfully
2024-12-31 15:02:36,258 - INFO - [chain.py:117] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2024-12-31 15:02:36,260 - INFO - [chain.py:118] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2024-12-31 15:02:36,262 - INFO - [chain.py:122] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2024-12-31 15:02:36,264 - INFO - [session.py:119] - Starting TLS session
2024-12-31 15:02:36,266 - INFO - [client.py:95] - Generated client_random: 6773eb6ce41e39d3d452afc05efe12e82b09d9cbd924bc4eb5cdac04258fe916
2024-12-31 15:02:36,273 - INFO - [client.py:135] - Client Hello sent from 192.168.1.1
2024-12-31 15:02:36,276 - INFO - [server.py:93] - Generated server_random: 6773eb6cc9ca89c98ea641a45237e8d382fde1da640aa832f23d321581626d87
2024-12-31 15:02:36,281 - ERROR - [main.py:27] - Session error: Session failed for 192.168.1.1: Session failed: send_client_handshake_messages() missing 2 required positional arguments: 'client_certificate' and 'client_key_exchange'
2024-12-31 15:03:07,873 - INFO - [logging.py:83] - Logging configured successfully
2024-12-31 15:03:07,874 - INFO - [logging.py:90] - === Logging Configuration ===
2024-12-31 15:03:07,874 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2024-12-31 15:03:07,874 - INFO - [logging.py:92] - Log level: 20
2024-12-31 15:03:07,875 - INFO - [logging.py:93] - Timestamp: 2024-12-31T15:03:07.875082
2024-12-31 15:03:07,875 - INFO - [logging.py:94] - ==========================
2024-12-31 15:03:07,875 - INFO - [main.py:122] - Starting TLS session simulation
2024-12-31 15:03:07,876 - INFO - [main.py:87] - 
--- Client Session (certificate) ---
2024-12-31 15:03:07,876 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2024-12-31 15:03:07,877 - INFO - [cert.py:108] - File exists: True
2024-12-31 15:03:07,877 - INFO - [cert.py:109] - File size: 1912 bytes
2024-12-31 15:03:07,877 - INFO - [cert.py:113] - Read 1912 bytes
2024-12-31 15:03:07,877 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2024-12-31 15:03:07,878 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2024-12-31 15:03:07,878 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 15:03:07,879 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2024-12-31 15:03:07,879 - INFO - [cert.py:108] - File exists: True
2024-12-31 15:03:07,880 - INFO - [cert.py:109] - File size: 1643 bytes
2024-12-31 15:03:07,880 - INFO - [cert.py:113] - Read 1643 bytes
2024-12-31 15:03:07,880 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2024-12-31 15:03:07,881 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2024-12-31 15:03:07,882 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 15:03:07,910 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2024-12-31 15:03:07,911 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2024-12-31 15:03:07,911 - INFO - [cert.py:215] - Key size: 2048 bits
2024-12-31 15:03:07,912 - INFO - [cert.py:217] - Public exponent: 65537
2024-12-31 15:03:07,914 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2024-12-31 15:03:07,914 - INFO - [verify.py:58] - Public key comparison results:
2024-12-31 15:03:07,914 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2024-12-31 15:03:07,915 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2024-12-31 15:03:07,915 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2024-12-31 15:03:07,916 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2024-12-31 15:03:07,917 - INFO - [verify.py:136] - Certificate chain verification successful
2024-12-31 15:03:07,917 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2024-12-31 15:03:07,917 - INFO - [chain.py:109] - Certificate chain verification passed
2024-12-31 15:03:07,917 - INFO - [chain.py:116] - Certificate chain loaded successfully
2024-12-31 15:03:07,918 - INFO - [chain.py:117] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2024-12-31 15:03:07,918 - INFO - [chain.py:118] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2024-12-31 15:03:07,919 - INFO - [chain.py:122] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2024-12-31 15:03:07,919 - INFO - [session.py:119] - Starting TLS session
2024-12-31 15:03:07,919 - INFO - [client.py:95] - Generated client_random: 6773eb8b1919fc5663f6490bbb48d9c27af25ddafd9e3ec155bdc569eb6c0bf8
2024-12-31 15:03:07,924 - INFO - [client.py:135] - Client Hello sent from 192.168.1.1
2024-12-31 15:03:07,926 - INFO - [server.py:93] - Generated server_random: 6773eb8bbf8e51a6a355c0cf3469d9ca08f5902f2a384b581d6828407dccbc5b
2024-12-31 15:03:07,930 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2024-12-31 15:03:07,931 - INFO - [cert.py:108] - File exists: True
2024-12-31 15:03:07,931 - INFO - [cert.py:109] - File size: 1915 bytes
2024-12-31 15:03:07,939 - INFO - [cert.py:113] - Read 1915 bytes
2024-12-31 15:03:07,940 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2024-12-31 15:03:07,941 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2024-12-31 15:03:07,942 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 15:03:07,943 - INFO - [client.py:167] - Prepared client certificate
2024-12-31 15:03:07,945 - INFO - [client.py:182] - Encrypted pre_master_secret length: 256
2024-12-31 15:03:07,948 - INFO - [chain.py:182] - Decrypted pre_master_secret: 0303b52775962ff837c7b7d49a3343009c35b4ee40641190dbb5e20c4e99a17a6e1c87df08ad94f83af650374e6c6558
2024-12-31 15:03:07,949 - INFO - [chain.py:193] - Generated master secret: 6b05dc45a158c2b6b0400cb7395ca008c772a0b0f9e50d4e0a0e533f14eeb373a4d3d7b9007bf4cd1dc6c3f5d85ca3ff
2024-12-31 15:03:07,950 - INFO - [client.py:272] - Client ChangeCipherSpec and Finished messages sent
2024-12-31 15:03:07,951 - INFO - [server.py:254] - Pre-master secret validated successfully
2024-12-31 15:03:07,952 - INFO - [server.py:272] - Generated digital signature: 42ab15777a1d91a806cfe5585fb58656e66746773443a76b54014b2116f8aca7de61f8078a71143548eea62d95f9c33cf4c5b58187248fa54225048ecc716f576cb49c0766c5c751078bcc81c5967932efa4ba36dd46b8deb1780b7bc985afb8d2cafd44047093bca0d66fec819ce8675730892486fe6526bc7b86551fb52704a4acf082dec033351ce9905b260da7d81170ba801e6d61c0a972ccc69ffde0291a201e85fb4b1b0202897e761cd0f028eb73c6f2b6fd31c70dfb2a74250201c37951e60830a4ad429b41a9bd52fa0de1b4f0eae37a279f0fe5be26400f65910eb48ac52f6351e0ba3e4c9da155f040e79dd7795af1ff84d6e81d31d2eb18aeff
2024-12-31 15:03:07,953 - INFO - [server.py:286] - Server ChangeCipherSpec and Finished messages sent
2024-12-31 15:03:07,955 - INFO - [keys.py:193] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2024-12-31 15:03:07,955 - INFO - [session.py:103] - TLS Handshake completed successfully
2024-12-31 15:03:07,956 - INFO - [session.py:130] - Found file to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2024-12-31 15:03:07,957 - INFO - [session.py:148] - Handshake completed: True
2024-12-31 15:03:07,957 - INFO - [session.py:149] - Use client cert: True
2024-12-31 15:03:07,958 - INFO - [session.py:150] - File to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2024-12-31 15:03:07,958 - INFO - [session.py:153] - Using encrypted exchange
2024-12-31 15:03:07,958 - INFO - [session.py:168] - Sending encrypted request data
2024-12-31 15:03:07,962 - INFO - [keys.py:173] - TLS Application Data sent from 192.168.1.1:12345 to 10.0.0.1:443
2024-12-31 15:03:07,962 - INFO - [session.py:179] - Sending encrypted response data
2024-12-31 15:03:07,963 - INFO - [keys.py:173] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2024-12-31 15:03:07,964 - INFO - [session.py:191] - Attempting to send file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2024-12-31 15:03:07,965 - INFO - [session.py:202] - Opening file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2024-12-31 15:03:07,966 - INFO - [session.py:209] - Read 1103 bytes from file
2024-12-31 15:03:07,967 - INFO - [keys.py:173] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2024-12-31 15:03:07,967 - INFO - [session.py:218] - File sent successfully
2024-12-31 15:03:07,967 - INFO - [session.py:193] - File sent successfully
2024-12-31 15:03:07,968 - INFO - [main.py:95] - Session completed successfully for 192.168.1.1
2024-12-31 15:03:07,968 - INFO - [main.py:87] - 
--- Client Session (no certificate) ---
2024-12-31 15:03:07,969 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2024-12-31 15:03:07,969 - INFO - [cert.py:108] - File exists: True
2024-12-31 15:03:07,970 - INFO - [cert.py:109] - File size: 1912 bytes
2024-12-31 15:03:07,970 - INFO - [cert.py:113] - Read 1912 bytes
2024-12-31 15:03:07,971 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2024-12-31 15:03:07,971 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2024-12-31 15:03:07,972 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 15:03:07,972 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2024-12-31 15:03:07,972 - INFO - [cert.py:108] - File exists: True
2024-12-31 15:03:07,973 - INFO - [cert.py:109] - File size: 1643 bytes
2024-12-31 15:03:07,974 - INFO - [cert.py:113] - Read 1643 bytes
2024-12-31 15:03:07,974 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2024-12-31 15:03:07,975 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2024-12-31 15:03:07,976 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 15:03:08,006 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2024-12-31 15:03:08,007 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2024-12-31 15:03:08,007 - INFO - [cert.py:215] - Key size: 2048 bits
2024-12-31 15:03:08,008 - INFO - [cert.py:217] - Public exponent: 65537
2024-12-31 15:03:08,008 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2024-12-31 15:03:08,009 - INFO - [verify.py:58] - Public key comparison results:
2024-12-31 15:03:08,009 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2024-12-31 15:03:08,010 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2024-12-31 15:03:08,011 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2024-12-31 15:03:08,011 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2024-12-31 15:03:08,012 - INFO - [verify.py:136] - Certificate chain verification successful
2024-12-31 15:03:08,012 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2024-12-31 15:03:08,013 - INFO - [chain.py:109] - Certificate chain verification passed
2024-12-31 15:03:08,013 - INFO - [chain.py:116] - Certificate chain loaded successfully
2024-12-31 15:03:08,014 - INFO - [chain.py:117] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2024-12-31 15:03:08,015 - INFO - [chain.py:118] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2024-12-31 15:03:08,017 - INFO - [chain.py:122] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2024-12-31 15:03:08,017 - INFO - [session.py:119] - Starting TLS session
2024-12-31 15:03:08,017 - INFO - [client.py:95] - Generated client_random: 6773eb8c92210db29304ff25c5a2581f5d7f0dd8c0ad03f93cac6b9e4be89210
2024-12-31 15:03:08,019 - INFO - [client.py:135] - Client Hello sent from 192.168.1.2
2024-12-31 15:03:08,022 - INFO - [server.py:93] - Generated server_random: 6773eb8c893d47a702300bdbf66739f1a8ac8c32f0c3d970d93d8f0d3eb24aef
2024-12-31 15:03:08,027 - INFO - [client.py:170] - Prepared empty certificate
2024-12-31 15:03:08,029 - INFO - [client.py:182] - Encrypted pre_master_secret length: 256
2024-12-31 15:03:08,031 - INFO - [chain.py:182] - Decrypted pre_master_secret: 0303a67fd7541f335361cc98fca9ac5081d6da16375ebe82c4197466f933773eab8f3e537c0fd85d13c31dffa07ae6c4
2024-12-31 15:03:08,031 - INFO - [chain.py:193] - Generated master secret: 0595e618da2a66b9d13bfeba7fed380867077760918c60a9b9a4ff410d9fa956706281fa287d03a3a2bd149859cdeaf3
2024-12-31 15:03:08,032 - INFO - [client.py:272] - Client ChangeCipherSpec and Finished messages sent
2024-12-31 15:03:08,034 - INFO - [server.py:254] - Pre-master secret validated successfully
2024-12-31 15:03:08,034 - INFO - [server.py:272] - Generated digital signature: b64dbf62d33ed79aff0d76bdf89d902d4eb34e6757cc849df990468f15e3a990e6772dc7017a29b124116cff3a4208d0aece7a39977f2f394ddd2d800161f33d36171287a17ad7c4c0c33a8980c5b2aa272c9cb08e9547133f137ea3101655b3b8af7b3fe3cc83f62facfa1cd0e9fc50dfeafd8a9f8c54851f2a27dd7ae90acb4beb20c26bd0f6bf59ca1c312789734fcaad060d9707e8f961970c63af5d0d6d8a4123a8a4cc1e8597ebf5673e35fc7c051cd4017912b2a7f546b59d045f27b5009cd783e00e9541925dc773e65fc8aa8fe22347a56c29b3253ca1e0b0fab5bbe43f67c78306920a5e261e62145800a345ddba23f275a0940fbf6176a0e22c79
2024-12-31 15:03:08,036 - INFO - [server.py:286] - Server ChangeCipherSpec and Finished messages sent
2024-12-31 15:03:08,037 - INFO - [keys.py:193] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2024-12-31 15:03:08,038 - INFO - [session.py:103] - TLS Handshake completed successfully
2024-12-31 15:03:08,038 - INFO - [session.py:148] - Handshake completed: True
2024-12-31 15:03:08,038 - INFO - [session.py:149] - Use client cert: False
2024-12-31 15:03:08,038 - INFO - [session.py:150] - File to send: None
2024-12-31 15:03:08,039 - INFO - [session.py:156] - Using unencrypted exchange
2024-12-31 15:03:08,040 - INFO - [session.py:256] - Added request packet
2024-12-31 15:03:08,040 - INFO - [session.py:256] - Added response packet
2024-12-31 15:03:08,041 - WARNING - [session.py:233] - Using unencrypted communication
2024-12-31 15:03:08,041 - INFO - [main.py:95] - Session completed successfully for 192.168.1.2
2024-12-31 15:03:08,042 - INFO - [pcap_writer.py:232] - Packet 13: Valid HTTP message
2024-12-31 15:03:08,042 - INFO - [pcap_writer.py:232] - Packet 14: Valid HTTP message
2024-12-31 15:03:08,048 - INFO - [pcap_writer.py:387] - Saved 15 valid packets to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2024-12-31 15:03:08,049 - INFO - [pcap_writer.py:409] - Verifying 15 packets...
2024-12-31 15:03:08,049 - INFO - [pcap_writer.py:413] - Packet 1: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2024-12-31 15:03:08,050 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2024-12-31 15:03:08,050 - INFO - [pcap_writer.py:413] - Packet 2: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2024-12-31 15:03:08,050 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2775
2024-12-31 15:03:08,050 - INFO - [pcap_writer.py:413] - Packet 3: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2024-12-31 15:03:08,051 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 1646
2024-12-31 15:03:08,051 - INFO - [pcap_writer.py:413] - Packet 4: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2024-12-31 15:03:08,051 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2024-12-31 15:03:08,052 - INFO - [pcap_writer.py:413] - Packet 5: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2024-12-31 15:03:08,052 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2024-12-31 15:03:08,052 - INFO - [pcap_writer.py:413] - Packet 6: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2024-12-31 15:03:08,052 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 165
2024-12-31 15:03:08,053 - INFO - [pcap_writer.py:413] - Packet 7: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2024-12-31 15:03:08,053 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 133
2024-12-31 15:03:08,053 - INFO - [pcap_writer.py:413] - Packet 8: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2024-12-31 15:03:08,053 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 1157
2024-12-31 15:03:08,054 - INFO - [pcap_writer.py:413] - Packet 9: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2024-12-31 15:03:08,054 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2024-12-31 15:03:08,054 - INFO - [pcap_writer.py:413] - Packet 10: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2024-12-31 15:03:08,054 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2775
2024-12-31 15:03:08,055 - INFO - [pcap_writer.py:413] - Packet 11: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2024-12-31 15:03:08,055 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 269
2024-12-31 15:03:08,055 - INFO - [pcap_writer.py:413] - Packet 12: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2024-12-31 15:03:08,056 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2024-12-31 15:03:08,056 - INFO - [pcap_writer.py:413] - Packet 13: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2024-12-31 15:03:08,057 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2024-12-31 15:03:08,057 - INFO - [pcap_writer.py:413] - Packet 14: IP / TCP 192.168.1.2:12346 > 10.0.0.1:http PA / Raw
2024-12-31 15:03:08,057 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2024-12-31 15:03:08,058 - INFO - [pcap_writer.py:413] - Packet 15: IP / TCP 10.0.0.1:http > 192.168.1.2:12346 PA / Raw
2024-12-31 15:03:08,058 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2024-12-31 15:03:08,058 - INFO - [pcap_writer.py:427] - Verification complete: 15 valid packets, 15 TLS records
2024-12-31 15:03:08,059 - INFO - [main.py:106] - Results saved to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2024-12-31 15:03:08,059 - INFO - [main.py:160] - TLS session simulation completed successfully
2024-12-31 15:15:46,447 - INFO - [logging.py:83] - Logging configured successfully
2024-12-31 15:15:46,448 - INFO - [logging.py:90] - === Logging Configuration ===
2024-12-31 15:15:46,448 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2024-12-31 15:15:46,448 - INFO - [logging.py:92] - Log level: 20
2024-12-31 15:15:46,449 - INFO - [logging.py:93] - Timestamp: 2024-12-31T15:15:46.449484
2024-12-31 15:15:46,450 - INFO - [logging.py:94] - ==========================
2024-12-31 15:15:46,450 - INFO - [main.py:122] - Starting TLS session simulation
2024-12-31 15:15:46,451 - INFO - [main.py:87] - 
--- Client Session (certificate) ---
2024-12-31 15:15:46,451 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2024-12-31 15:15:46,452 - INFO - [cert.py:108] - File exists: True
2024-12-31 15:15:46,453 - INFO - [cert.py:109] - File size: 1912 bytes
2024-12-31 15:15:46,453 - INFO - [cert.py:113] - Read 1912 bytes
2024-12-31 15:15:46,454 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2024-12-31 15:15:46,454 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2024-12-31 15:15:46,455 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 15:15:46,456 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2024-12-31 15:15:46,457 - INFO - [cert.py:108] - File exists: True
2024-12-31 15:15:46,457 - INFO - [cert.py:109] - File size: 1643 bytes
2024-12-31 15:15:46,458 - INFO - [cert.py:113] - Read 1643 bytes
2024-12-31 15:15:46,458 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2024-12-31 15:15:46,458 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2024-12-31 15:15:46,459 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 15:15:46,490 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2024-12-31 15:15:46,491 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2024-12-31 15:15:46,492 - INFO - [cert.py:215] - Key size: 2048 bits
2024-12-31 15:15:46,493 - INFO - [cert.py:217] - Public exponent: 65537
2024-12-31 15:15:46,496 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2024-12-31 15:15:46,497 - INFO - [verify.py:58] - Public key comparison results:
2024-12-31 15:15:46,498 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2024-12-31 15:15:46,499 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2024-12-31 15:15:46,500 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2024-12-31 15:15:46,500 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2024-12-31 15:15:46,501 - INFO - [verify.py:136] - Certificate chain verification successful
2024-12-31 15:15:46,502 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2024-12-31 15:15:46,502 - INFO - [chain.py:109] - Certificate chain verification passed
2024-12-31 15:15:46,503 - INFO - [chain.py:116] - Certificate chain loaded successfully
2024-12-31 15:15:46,503 - INFO - [chain.py:117] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2024-12-31 15:15:46,504 - INFO - [chain.py:118] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2024-12-31 15:15:46,505 - INFO - [chain.py:122] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2024-12-31 15:15:46,505 - INFO - [session.py:119] - Starting TLS session
2024-12-31 15:15:46,505 - INFO - [client.py:95] - Generated client_random: 6773ee827e22fc262fd1dc1a68dcafe177b227f1dddfd64f1f903923e311c9b9
2024-12-31 15:15:46,511 - INFO - [client.py:135] - Client Hello sent from 192.168.1.1
2024-12-31 15:15:46,514 - INFO - [server.py:93] - Generated server_random: 6773ee82e339f46d9342557b46e9dddaadbb46043b640f0161c755ceb7715de8
2024-12-31 15:15:46,517 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2024-12-31 15:15:46,518 - INFO - [cert.py:108] - File exists: True
2024-12-31 15:15:46,518 - INFO - [cert.py:109] - File size: 1915 bytes
2024-12-31 15:15:46,519 - INFO - [cert.py:113] - Read 1915 bytes
2024-12-31 15:15:46,519 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2024-12-31 15:15:46,520 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2024-12-31 15:15:46,521 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 15:15:46,521 - INFO - [client.py:169] - Prepared client certificate
2024-12-31 15:15:46,522 - INFO - [client.py:184] - Encrypted pre_master_secret length: 256
2024-12-31 15:15:46,524 - INFO - [chain.py:182] - Decrypted pre_master_secret: 03036e26379818d4f75f3ee735f739fa9e53c5ff47d55b55d4f7ee83164293638745d2d3e89da941f97c7b0d8d4baea6
2024-12-31 15:15:46,524 - INFO - [chain.py:193] - Generated master secret: d0b972351fdd81dba1f01c5d022cddf4606d931ed5cd67844dae707d7aaa4171cbd61257d07fa0fcd850bffeae59205b
2024-12-31 15:15:46,526 - INFO - [client.py:345] - Client ChangeCipherSpec and Finished messages sent
2024-12-31 15:15:46,529 - INFO - [server.py:254] - Pre-master secret validated successfully
2024-12-31 15:15:46,531 - INFO - [server.py:272] - Generated digital signature: 62f04fcd38134bc6a0d7ad5f7727be925f83fdefd047e0bace06b09105cdb6f91edaa762bfec803b88239e286fa85105f833bdbcc95b268094f31ff005b79a68aa66291903105e9244f2c068ff416104bf14cb096f7d33490b25d0031004bb280f5f0cd3e1b645d34c654ac3116e5c034abbc630f0693b94215e654360e8802e12e523b154780dc11c8f659c1d6fddc6680ddc0dc6eb694c5eafbc7e29539577722a621a31ccf1aabbabdf6d652d766725577df221f98de4df71d569bc64f12a8a53f6173d8db5e0fc40717f5df3d33d3bf479aab921d48cff29269a98b0594048f41d6f15379b2a11285baafb4d2014787c4e6146fe34bc8320acd4c12b8732
2024-12-31 15:15:46,532 - INFO - [server.py:309] - Server ChangeCipherSpec and Finished messages sent
2024-12-31 15:15:46,534 - INFO - [keys.py:193] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2024-12-31 15:15:46,534 - INFO - [session.py:103] - TLS Handshake completed successfully
2024-12-31 15:15:46,535 - INFO - [session.py:130] - Found file to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2024-12-31 15:15:46,535 - INFO - [session.py:148] - Handshake completed: True
2024-12-31 15:15:46,536 - INFO - [session.py:149] - Use client cert: True
2024-12-31 15:15:46,536 - INFO - [session.py:150] - File to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2024-12-31 15:15:46,537 - INFO - [session.py:153] - Using encrypted exchange
2024-12-31 15:15:46,537 - INFO - [session.py:168] - Sending encrypted request data
2024-12-31 15:15:46,538 - INFO - [keys.py:173] - TLS Application Data sent from 192.168.1.1:12345 to 10.0.0.1:443
2024-12-31 15:15:46,539 - INFO - [session.py:179] - Sending encrypted response data
2024-12-31 15:15:46,540 - INFO - [keys.py:173] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2024-12-31 15:15:46,541 - INFO - [session.py:191] - Attempting to send file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2024-12-31 15:15:46,541 - INFO - [session.py:202] - Opening file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2024-12-31 15:15:46,542 - INFO - [session.py:209] - Read 1103 bytes from file
2024-12-31 15:15:46,545 - INFO - [keys.py:173] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2024-12-31 15:15:46,545 - INFO - [session.py:218] - File sent successfully
2024-12-31 15:15:46,546 - INFO - [session.py:193] - File sent successfully
2024-12-31 15:15:46,546 - INFO - [main.py:95] - Session completed successfully for 192.168.1.1
2024-12-31 15:15:46,547 - INFO - [main.py:87] - 
--- Client Session (no certificate) ---
2024-12-31 15:15:46,547 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2024-12-31 15:15:46,548 - INFO - [cert.py:108] - File exists: True
2024-12-31 15:15:46,548 - INFO - [cert.py:109] - File size: 1912 bytes
2024-12-31 15:15:46,549 - INFO - [cert.py:113] - Read 1912 bytes
2024-12-31 15:15:46,549 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2024-12-31 15:15:46,550 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2024-12-31 15:15:46,550 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 15:15:46,551 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2024-12-31 15:15:46,552 - INFO - [cert.py:108] - File exists: True
2024-12-31 15:15:46,552 - INFO - [cert.py:109] - File size: 1643 bytes
2024-12-31 15:15:46,553 - INFO - [cert.py:113] - Read 1643 bytes
2024-12-31 15:15:46,553 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2024-12-31 15:15:46,553 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2024-12-31 15:15:46,554 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 15:15:46,581 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2024-12-31 15:15:46,582 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2024-12-31 15:15:46,583 - INFO - [cert.py:215] - Key size: 2048 bits
2024-12-31 15:15:46,583 - INFO - [cert.py:217] - Public exponent: 65537
2024-12-31 15:15:46,583 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2024-12-31 15:15:46,584 - INFO - [verify.py:58] - Public key comparison results:
2024-12-31 15:15:46,584 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2024-12-31 15:15:46,584 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2024-12-31 15:15:46,585 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2024-12-31 15:15:46,585 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2024-12-31 15:15:46,586 - INFO - [verify.py:136] - Certificate chain verification successful
2024-12-31 15:15:46,586 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2024-12-31 15:15:46,586 - INFO - [chain.py:109] - Certificate chain verification passed
2024-12-31 15:15:46,586 - INFO - [chain.py:116] - Certificate chain loaded successfully
2024-12-31 15:15:46,587 - INFO - [chain.py:117] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2024-12-31 15:15:46,587 - INFO - [chain.py:118] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2024-12-31 15:15:46,588 - INFO - [chain.py:122] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2024-12-31 15:15:46,589 - INFO - [session.py:119] - Starting TLS session
2024-12-31 15:15:46,589 - INFO - [client.py:95] - Generated client_random: 6773ee82eb227570edac386b11a4204d49d0f4bdbfb095a3e51edaddbb5a1ad4
2024-12-31 15:15:46,591 - INFO - [client.py:135] - Client Hello sent from 192.168.1.2
2024-12-31 15:15:46,592 - INFO - [server.py:93] - Generated server_random: 6773ee822b54da3dd64f6857f5a02aa2f885f5bf7c95929080f8a71460be4460
2024-12-31 15:15:46,597 - INFO - [client.py:172] - Prepared empty certificate
2024-12-31 15:15:46,598 - INFO - [client.py:184] - Encrypted pre_master_secret length: 256
2024-12-31 15:15:46,600 - INFO - [chain.py:182] - Decrypted pre_master_secret: 0303acb0f29d933658eb8ee5557c7147eba1b28673f4ebcacd5fa85f03d83c96c8b3d42905f99158d854ff047f397c90
2024-12-31 15:15:46,600 - INFO - [chain.py:193] - Generated master secret: 3046ea99855b15d9efb47ccc23b5ae42c94370b9ca72d3fdf72fe398b72448823a702924582d301ed0c7a2b791bc6b82
2024-12-31 15:15:46,601 - INFO - [client.py:345] - Client ChangeCipherSpec and Finished messages sent
2024-12-31 15:15:46,602 - INFO - [server.py:254] - Pre-master secret validated successfully
2024-12-31 15:15:46,603 - INFO - [server.py:272] - Generated digital signature: 2ff443e829b5308f203b2e5c5b71fa7af47f6ff4a0060306242d7ac573353f62fe7e9b847b257f3db952c668dc0d2299fc3f36930170fada07c591ee651642a0a31e4465fd5e94b62339c410aa86f0c1a6eb1f54468421a2b496f5ec03eaa34a6fe4a060c304908dbfaf2f85658ae66c29e58b8dad8c56d780197237e4529220f917d27bf9cb53c2d1216c677919519837e47550b7ce7f51b4f45ef767abda7f912c410b029e20022acefa8af493a40493e79ee2282e43246ff0b539e14aeea384b00138e59e2e05078847cd29e848a17a72539c4d9c905d83179af696acf9bb5f11a615cfb53d3fea06afe102d11045a6230f887194f677ec41aea3d0011b62
2024-12-31 15:15:46,604 - INFO - [server.py:309] - Server ChangeCipherSpec and Finished messages sent
2024-12-31 15:15:46,606 - INFO - [keys.py:193] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2024-12-31 15:15:46,606 - INFO - [session.py:103] - TLS Handshake completed successfully
2024-12-31 15:15:46,607 - INFO - [session.py:148] - Handshake completed: True
2024-12-31 15:15:46,607 - INFO - [session.py:149] - Use client cert: False
2024-12-31 15:15:46,607 - INFO - [session.py:150] - File to send: None
2024-12-31 15:15:46,607 - INFO - [session.py:156] - Using unencrypted exchange
2024-12-31 15:15:46,608 - INFO - [session.py:256] - Added request packet
2024-12-31 15:15:46,609 - INFO - [session.py:256] - Added response packet
2024-12-31 15:15:46,610 - WARNING - [session.py:233] - Using unencrypted communication
2024-12-31 15:15:46,611 - INFO - [main.py:95] - Session completed successfully for 192.168.1.2
2024-12-31 15:15:46,612 - INFO - [pcap_writer.py:232] - Packet 13: Valid HTTP message
2024-12-31 15:15:46,612 - INFO - [pcap_writer.py:232] - Packet 14: Valid HTTP message
2024-12-31 15:15:46,616 - INFO - [pcap_writer.py:387] - Saved 15 valid packets to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2024-12-31 15:15:46,617 - INFO - [pcap_writer.py:409] - Verifying 15 packets...
2024-12-31 15:15:46,617 - INFO - [pcap_writer.py:413] - Packet 1: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2024-12-31 15:15:46,617 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2024-12-31 15:15:46,618 - INFO - [pcap_writer.py:413] - Packet 2: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2024-12-31 15:15:46,618 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2775
2024-12-31 15:15:46,618 - INFO - [pcap_writer.py:413] - Packet 3: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2024-12-31 15:15:46,619 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 1646
2024-12-31 15:15:46,619 - INFO - [pcap_writer.py:413] - Packet 4: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2024-12-31 15:15:46,619 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2024-12-31 15:15:46,619 - INFO - [pcap_writer.py:413] - Packet 5: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2024-12-31 15:15:46,620 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2024-12-31 15:15:46,620 - INFO - [pcap_writer.py:413] - Packet 6: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2024-12-31 15:15:46,620 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 165
2024-12-31 15:15:46,621 - INFO - [pcap_writer.py:413] - Packet 7: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2024-12-31 15:15:46,621 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 133
2024-12-31 15:15:46,621 - INFO - [pcap_writer.py:413] - Packet 8: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2024-12-31 15:15:46,621 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 1157
2024-12-31 15:15:46,622 - INFO - [pcap_writer.py:413] - Packet 9: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2024-12-31 15:15:46,622 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2024-12-31 15:15:46,622 - INFO - [pcap_writer.py:413] - Packet 10: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2024-12-31 15:15:46,623 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2775
2024-12-31 15:15:46,623 - INFO - [pcap_writer.py:413] - Packet 11: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2024-12-31 15:15:46,623 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 269
2024-12-31 15:15:46,623 - INFO - [pcap_writer.py:413] - Packet 12: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2024-12-31 15:15:46,624 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2024-12-31 15:15:46,624 - INFO - [pcap_writer.py:413] - Packet 13: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2024-12-31 15:15:46,624 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2024-12-31 15:15:46,625 - INFO - [pcap_writer.py:413] - Packet 14: IP / TCP 192.168.1.2:12346 > 10.0.0.1:http PA / Raw
2024-12-31 15:15:46,625 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2024-12-31 15:15:46,626 - INFO - [pcap_writer.py:413] - Packet 15: IP / TCP 10.0.0.1:http > 192.168.1.2:12346 PA / Raw
2024-12-31 15:15:46,626 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2024-12-31 15:15:46,627 - INFO - [pcap_writer.py:427] - Verification complete: 15 valid packets, 15 TLS records
2024-12-31 15:15:46,627 - INFO - [main.py:106] - Results saved to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2024-12-31 15:15:46,628 - INFO - [main.py:160] - TLS session simulation completed successfully
2024-12-31 15:16:56,053 - INFO - [logging.py:83] - Logging configured successfully
2024-12-31 15:16:56,053 - INFO - [logging.py:90] - === Logging Configuration ===
2024-12-31 15:16:56,054 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2024-12-31 15:16:56,054 - INFO - [logging.py:92] - Log level: 20
2024-12-31 15:16:56,055 - INFO - [logging.py:93] - Timestamp: 2024-12-31T15:16:56.055046
2024-12-31 15:16:56,055 - INFO - [logging.py:94] - ==========================
2024-12-31 15:16:56,055 - INFO - [main.py:122] - Starting TLS session simulation
2024-12-31 15:16:56,056 - INFO - [main.py:87] - 
--- Client Session (certificate) ---
2024-12-31 15:16:56,057 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2024-12-31 15:16:56,058 - INFO - [cert.py:108] - File exists: True
2024-12-31 15:16:56,059 - INFO - [cert.py:109] - File size: 1912 bytes
2024-12-31 15:16:56,059 - INFO - [cert.py:113] - Read 1912 bytes
2024-12-31 15:16:56,060 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2024-12-31 15:16:56,061 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2024-12-31 15:16:56,062 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 15:16:56,063 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2024-12-31 15:16:56,064 - INFO - [cert.py:108] - File exists: True
2024-12-31 15:16:56,065 - INFO - [cert.py:109] - File size: 1643 bytes
2024-12-31 15:16:56,065 - INFO - [cert.py:113] - Read 1643 bytes
2024-12-31 15:16:56,066 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2024-12-31 15:16:56,066 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2024-12-31 15:16:56,067 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 15:16:56,097 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2024-12-31 15:16:56,098 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2024-12-31 15:16:56,099 - INFO - [cert.py:215] - Key size: 2048 bits
2024-12-31 15:16:56,100 - INFO - [cert.py:217] - Public exponent: 65537
2024-12-31 15:16:56,103 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2024-12-31 15:16:56,104 - INFO - [verify.py:58] - Public key comparison results:
2024-12-31 15:16:56,104 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2024-12-31 15:16:56,106 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2024-12-31 15:16:56,107 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2024-12-31 15:16:56,108 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2024-12-31 15:16:56,112 - INFO - [verify.py:136] - Certificate chain verification successful
2024-12-31 15:16:56,113 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2024-12-31 15:16:56,114 - INFO - [chain.py:109] - Certificate chain verification passed
2024-12-31 15:16:56,114 - INFO - [chain.py:116] - Certificate chain loaded successfully
2024-12-31 15:16:56,115 - INFO - [chain.py:117] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2024-12-31 15:16:56,116 - INFO - [chain.py:118] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2024-12-31 15:16:56,118 - INFO - [chain.py:122] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2024-12-31 15:16:56,119 - INFO - [session.py:119] - Starting TLS session
2024-12-31 15:16:56,119 - INFO - [client.py:95] - Generated client_random: 6773eec896bd4b0683e2060fefa4a8b93707b7627b0bc2885cd115e82d99c8a9
2024-12-31 15:16:56,122 - INFO - [client.py:135] - Client Hello sent from 192.168.1.1
2024-12-31 15:16:56,124 - INFO - [server.py:93] - Generated server_random: 6773eec846b0bbfdfe5d92f4535b683f000e04c1f1d945984dacb401d91c5a56
2024-12-31 15:16:56,129 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2024-12-31 15:16:56,130 - INFO - [cert.py:108] - File exists: True
2024-12-31 15:16:56,131 - INFO - [cert.py:109] - File size: 1915 bytes
2024-12-31 15:16:56,132 - INFO - [cert.py:113] - Read 1915 bytes
2024-12-31 15:16:56,133 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2024-12-31 15:16:56,134 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2024-12-31 15:16:56,135 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 15:16:56,135 - INFO - [client.py:169] - Prepared client certificate
2024-12-31 15:16:56,136 - INFO - [client.py:184] - Encrypted pre_master_secret length: 256
2024-12-31 15:16:56,138 - INFO - [chain.py:182] - Decrypted pre_master_secret: 03038f03e3018f8b7c34992ba8aafa370144d07cef1a7296174195a1db3d2bbb66b094688cf8f1cb9e04b62f15554ad8
2024-12-31 15:16:56,139 - INFO - [chain.py:193] - Generated master secret: b8f6f2198ccf8b3f061b432dfa913ade14ca32ece9d6dc4b7e9e0d1a8c83bb35d4f35dc74f447ee80f11d737df746d40
2024-12-31 15:16:56,140 - INFO - [client.py:345] - Client ChangeCipherSpec and Finished messages sent
2024-12-31 15:16:56,142 - INFO - [server.py:254] - Pre-master secret validated successfully
2024-12-31 15:16:56,144 - INFO - [server.py:272] - Generated digital signature: 07cd6e8a4e021a532ced6ca3a9513aede8af44217d7a9bc94a929620c0c46be1f51681a4f89d83f6af592a8276487c690a2d4543b857d4d091787cc24bf10eb0ecc41d875e367f522d04aed1bebba6e97bb2674bd8f1ae50e1631e1f173c6983d5ebf36cf4cebd9047cdbee41759bb99c05bd0bd2b4f7eff0c56ccda1cf23ad44b5724baf96f166ba9bf304747dc367ff77467806a3a792a29cfc7ac1d29d41f2807dfc11d4ab9f2c2f7a9e61d75c2404ce6e3ea425181d2ccdde52fc33a6474ad1e0bd0a9a5d966f4361c9842cdf8f2e7e3918eca26cf797f9fa855d1e76e7469852929e93f2e2dea027c5621508434db96b37633e8a9c4e0b2be29484d74cc
2024-12-31 15:16:56,145 - INFO - [server.py:309] - Server ChangeCipherSpec and Finished messages sent
2024-12-31 15:16:56,147 - INFO - [keys.py:193] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2024-12-31 15:16:56,147 - INFO - [session.py:103] - TLS Handshake completed successfully
2024-12-31 15:16:56,148 - INFO - [session.py:130] - Found file to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2024-12-31 15:16:56,148 - INFO - [session.py:148] - Handshake completed: True
2024-12-31 15:16:56,148 - INFO - [session.py:149] - Use client cert: True
2024-12-31 15:16:56,148 - INFO - [session.py:150] - File to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2024-12-31 15:16:56,149 - INFO - [session.py:153] - Using encrypted exchange
2024-12-31 15:16:56,149 - INFO - [session.py:168] - Sending encrypted request data
2024-12-31 15:16:56,150 - INFO - [keys.py:173] - TLS Application Data sent from 192.168.1.1:12345 to 10.0.0.1:443
2024-12-31 15:16:56,151 - INFO - [session.py:179] - Sending encrypted response data
2024-12-31 15:16:56,152 - INFO - [keys.py:173] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2024-12-31 15:16:56,152 - INFO - [session.py:191] - Attempting to send file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2024-12-31 15:16:56,153 - INFO - [session.py:202] - Opening file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2024-12-31 15:16:56,153 - INFO - [session.py:209] - Read 1103 bytes from file
2024-12-31 15:16:56,154 - INFO - [keys.py:173] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2024-12-31 15:16:56,155 - INFO - [session.py:218] - File sent successfully
2024-12-31 15:16:56,156 - INFO - [session.py:193] - File sent successfully
2024-12-31 15:16:56,156 - INFO - [main.py:95] - Session completed successfully for 192.168.1.1
2024-12-31 15:16:56,156 - INFO - [main.py:87] - 
--- Client Session (no certificate) ---
2024-12-31 15:16:56,158 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2024-12-31 15:16:56,158 - INFO - [cert.py:108] - File exists: True
2024-12-31 15:16:56,159 - INFO - [cert.py:109] - File size: 1912 bytes
2024-12-31 15:16:56,159 - INFO - [cert.py:113] - Read 1912 bytes
2024-12-31 15:16:56,160 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2024-12-31 15:16:56,160 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2024-12-31 15:16:56,161 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 15:16:56,162 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2024-12-31 15:16:56,162 - INFO - [cert.py:108] - File exists: True
2024-12-31 15:16:56,163 - INFO - [cert.py:109] - File size: 1643 bytes
2024-12-31 15:16:56,163 - INFO - [cert.py:113] - Read 1643 bytes
2024-12-31 15:16:56,164 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2024-12-31 15:16:56,164 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2024-12-31 15:16:56,164 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 15:16:56,195 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2024-12-31 15:16:56,195 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2024-12-31 15:16:56,196 - INFO - [cert.py:215] - Key size: 2048 bits
2024-12-31 15:16:56,196 - INFO - [cert.py:217] - Public exponent: 65537
2024-12-31 15:16:56,197 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2024-12-31 15:16:56,197 - INFO - [verify.py:58] - Public key comparison results:
2024-12-31 15:16:56,198 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2024-12-31 15:16:56,198 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2024-12-31 15:16:56,199 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2024-12-31 15:16:56,200 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2024-12-31 15:16:56,200 - INFO - [verify.py:136] - Certificate chain verification successful
2024-12-31 15:16:56,201 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2024-12-31 15:16:56,201 - INFO - [chain.py:109] - Certificate chain verification passed
2024-12-31 15:16:56,201 - INFO - [chain.py:116] - Certificate chain loaded successfully
2024-12-31 15:16:56,202 - INFO - [chain.py:117] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2024-12-31 15:16:56,202 - INFO - [chain.py:118] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2024-12-31 15:16:56,203 - INFO - [chain.py:122] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2024-12-31 15:16:56,203 - INFO - [session.py:119] - Starting TLS session
2024-12-31 15:16:56,203 - INFO - [client.py:95] - Generated client_random: 6773eec8fb93e54a915b7168a8b123d971098f903c8c600c91b8268fbf9a45e6
2024-12-31 15:16:56,205 - INFO - [client.py:135] - Client Hello sent from 192.168.1.2
2024-12-31 15:16:56,208 - INFO - [server.py:93] - Generated server_random: 6773eec85bdf2fef9e77133aa9889f5b12273d0c4a274f1a5da30e438dd96f31
2024-12-31 15:16:56,213 - INFO - [client.py:172] - Prepared empty certificate
2024-12-31 15:16:56,213 - INFO - [client.py:184] - Encrypted pre_master_secret length: 256
2024-12-31 15:16:56,216 - INFO - [chain.py:182] - Decrypted pre_master_secret: 03033b3ec4d8b51a802b37a53afb3ad2b1f08e7daec025dc0ce3f74bad7d75389649da412b48c2cb4d06720fc50d992a
2024-12-31 15:16:56,216 - INFO - [chain.py:193] - Generated master secret: f502434868003c0fb43ac3bd81806b26a110ad96cde35626abce2289d4dc7f29dac8275eeb8a55614f81d77047e27c5e
2024-12-31 15:16:56,217 - INFO - [client.py:345] - Client ChangeCipherSpec and Finished messages sent
2024-12-31 15:16:56,219 - INFO - [server.py:254] - Pre-master secret validated successfully
2024-12-31 15:16:56,220 - INFO - [server.py:272] - Generated digital signature: 1a068b25aae999161d2ad4f6ecaf2e8be2197689176e9513bfa5d3ef3669b3ae5279376b85ce7119629a70cfa99f96350c0cb42f6e9cd7cdf5e70690b0aab721dd89ce3f5c23b3493d9a18f13357b030cac95820309a399c4ef890970a2f7e643e24971da1dfee2af9382262781925b040fa484be0f61cb51aa0f55d13a63041dfb8d838bb6fff87ce3d06cb9a513d1ab87c2c11644c761a23b9256f9308e267a556b7ad4198f9841d15584f829163c9e779b84cbcac65ad5ce19f8267fddd1f63d6619c34935e878c14ded26248819c05567139f7a3fad819531f7d8737f80e479d8d1f0e7935f6df96e5f2281e2b1791d1391fa857d2d3cb8a4e9302299fc1
2024-12-31 15:16:56,222 - INFO - [server.py:309] - Server ChangeCipherSpec and Finished messages sent
2024-12-31 15:16:56,224 - INFO - [keys.py:193] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2024-12-31 15:16:56,225 - INFO - [session.py:103] - TLS Handshake completed successfully
2024-12-31 15:16:56,225 - INFO - [session.py:148] - Handshake completed: True
2024-12-31 15:16:56,226 - INFO - [session.py:149] - Use client cert: False
2024-12-31 15:16:56,226 - INFO - [session.py:150] - File to send: None
2024-12-31 15:16:56,227 - INFO - [session.py:156] - Using unencrypted exchange
2024-12-31 15:16:56,228 - INFO - [session.py:256] - Added request packet
2024-12-31 15:16:56,228 - INFO - [session.py:256] - Added response packet
2024-12-31 15:16:56,229 - WARNING - [session.py:233] - Using unencrypted communication
2024-12-31 15:16:56,229 - INFO - [main.py:95] - Session completed successfully for 192.168.1.2
2024-12-31 15:16:56,230 - INFO - [pcap_writer.py:232] - Packet 13: Valid HTTP message
2024-12-31 15:16:56,231 - INFO - [pcap_writer.py:232] - Packet 14: Valid HTTP message
2024-12-31 15:16:56,235 - INFO - [pcap_writer.py:387] - Saved 15 valid packets to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2024-12-31 15:16:56,235 - INFO - [pcap_writer.py:409] - Verifying 15 packets...
2024-12-31 15:16:56,236 - INFO - [pcap_writer.py:413] - Packet 1: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2024-12-31 15:16:56,236 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2024-12-31 15:16:56,237 - INFO - [pcap_writer.py:413] - Packet 2: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2024-12-31 15:16:56,237 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2775
2024-12-31 15:16:56,238 - INFO - [pcap_writer.py:413] - Packet 3: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2024-12-31 15:16:56,238 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 1646
2024-12-31 15:16:56,239 - INFO - [pcap_writer.py:413] - Packet 4: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2024-12-31 15:16:56,239 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2024-12-31 15:16:56,240 - INFO - [pcap_writer.py:413] - Packet 5: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2024-12-31 15:16:56,240 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2024-12-31 15:16:56,241 - INFO - [pcap_writer.py:413] - Packet 6: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2024-12-31 15:16:56,241 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 165
2024-12-31 15:16:56,242 - INFO - [pcap_writer.py:413] - Packet 7: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2024-12-31 15:16:56,242 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 133
2024-12-31 15:16:56,243 - INFO - [pcap_writer.py:413] - Packet 8: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2024-12-31 15:16:56,244 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 1157
2024-12-31 15:16:56,244 - INFO - [pcap_writer.py:413] - Packet 9: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2024-12-31 15:16:56,244 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2024-12-31 15:16:56,245 - INFO - [pcap_writer.py:413] - Packet 10: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2024-12-31 15:16:56,245 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2775
2024-12-31 15:16:56,245 - INFO - [pcap_writer.py:413] - Packet 11: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2024-12-31 15:16:56,246 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 269
2024-12-31 15:16:56,246 - INFO - [pcap_writer.py:413] - Packet 12: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2024-12-31 15:16:56,246 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2024-12-31 15:16:56,247 - INFO - [pcap_writer.py:413] - Packet 13: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2024-12-31 15:16:56,247 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2024-12-31 15:16:56,247 - INFO - [pcap_writer.py:413] - Packet 14: IP / TCP 192.168.1.2:12346 > 10.0.0.1:http PA / Raw
2024-12-31 15:16:56,248 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2024-12-31 15:16:56,248 - INFO - [pcap_writer.py:413] - Packet 15: IP / TCP 10.0.0.1:http > 192.168.1.2:12346 PA / Raw
2024-12-31 15:16:56,248 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2024-12-31 15:16:56,248 - INFO - [pcap_writer.py:427] - Verification complete: 15 valid packets, 15 TLS records
2024-12-31 15:16:56,248 - INFO - [main.py:106] - Results saved to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2024-12-31 15:16:56,248 - INFO - [main.py:160] - TLS session simulation completed successfully
2024-12-31 20:58:08,695 - INFO - [logging.py:83] - Logging configured successfully
2024-12-31 20:58:08,697 - INFO - [logging.py:90] - === Logging Configuration ===
2024-12-31 20:58:08,697 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2024-12-31 20:58:08,698 - INFO - [logging.py:92] - Log level: 20
2024-12-31 20:58:08,699 - INFO - [logging.py:93] - Timestamp: 2024-12-31T20:58:08.699003
2024-12-31 20:58:08,700 - INFO - [logging.py:94] - ==========================
2024-12-31 20:58:08,700 - INFO - [main.py:122] - Starting TLS session simulation
2024-12-31 20:58:08,702 - INFO - [main.py:87] - 
--- Client Session (certificate) ---
2024-12-31 20:58:08,707 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2024-12-31 20:58:08,709 - INFO - [cert.py:108] - File exists: True
2024-12-31 20:58:08,710 - INFO - [cert.py:109] - File size: 1912 bytes
2024-12-31 20:58:08,712 - INFO - [cert.py:113] - Read 1912 bytes
2024-12-31 20:58:08,713 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2024-12-31 20:58:08,714 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2024-12-31 20:58:08,731 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 20:58:08,733 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2024-12-31 20:58:08,735 - INFO - [cert.py:108] - File exists: True
2024-12-31 20:58:08,736 - INFO - [cert.py:109] - File size: 1643 bytes
2024-12-31 20:58:08,739 - INFO - [cert.py:113] - Read 1643 bytes
2024-12-31 20:58:08,740 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2024-12-31 20:58:08,744 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2024-12-31 20:58:08,748 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 20:58:08,843 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2024-12-31 20:58:08,844 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2024-12-31 20:58:08,845 - INFO - [cert.py:215] - Key size: 2048 bits
2024-12-31 20:58:08,845 - INFO - [cert.py:217] - Public exponent: 65537
2024-12-31 20:58:08,848 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2024-12-31 20:58:08,848 - INFO - [verify.py:58] - Public key comparison results:
2024-12-31 20:58:08,848 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2024-12-31 20:58:08,849 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2024-12-31 20:58:08,850 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2024-12-31 20:58:08,851 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2024-12-31 20:58:08,866 - INFO - [verify.py:136] - Certificate chain verification successful
2024-12-31 20:58:08,867 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2024-12-31 20:58:08,868 - INFO - [chain.py:109] - Certificate chain verification passed
2024-12-31 20:58:08,869 - INFO - [chain.py:116] - Certificate chain loaded successfully
2024-12-31 20:58:08,869 - INFO - [chain.py:117] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2024-12-31 20:58:08,870 - INFO - [chain.py:118] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2024-12-31 20:58:08,872 - INFO - [chain.py:122] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2024-12-31 20:58:08,873 - INFO - [session.py:119] - Starting TLS session
2024-12-31 20:58:08,875 - INFO - [client.py:95] - Generated client_random: 67743ec0159f5ead8df30427bf8866c897db22b14ba584268293c2a2d369adc9
2024-12-31 20:58:08,885 - INFO - [client.py:135] - Client Hello sent from 192.168.1.1
2024-12-31 20:58:08,890 - INFO - [server.py:93] - Generated server_random: 67743ec04fa9b3768a7581c1ee2cecc87770db1e40d63acc6748d2735581a15b
2024-12-31 20:58:08,902 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2024-12-31 20:58:08,904 - INFO - [cert.py:108] - File exists: True
2024-12-31 20:58:08,905 - INFO - [cert.py:109] - File size: 1915 bytes
2024-12-31 20:58:08,907 - INFO - [cert.py:113] - Read 1915 bytes
2024-12-31 20:58:08,909 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2024-12-31 20:58:08,911 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2024-12-31 20:58:08,914 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 20:58:08,916 - INFO - [client.py:169] - Prepared client certificate
2024-12-31 20:58:08,917 - INFO - [client.py:184] - Encrypted pre_master_secret length: 256
2024-12-31 20:58:08,923 - INFO - [chain.py:182] - Decrypted pre_master_secret: 0303be543e1c8522dee1b02c21bbc733746c89b0def843e78684e02e35c08105685962801f811697daa194cd88196e9d
2024-12-31 20:58:08,925 - INFO - [chain.py:193] - Generated master secret: c456471a7b6c64b3f4cffda8a14e2e99929cf344b315bd19554f63defddb29eae191a90f374f435259696ccf38ad20d1
2024-12-31 20:58:08,929 - INFO - [client.py:345] - Client ChangeCipherSpec and Finished messages sent
2024-12-31 20:58:08,933 - INFO - [server.py:254] - Pre-master secret validated successfully
2024-12-31 20:58:08,936 - INFO - [server.py:272] - Generated digital signature: 54a32a8b92f97eedf953ed211e4467504ec171a9cd80c6aa0b15cb3a28ca91d523255692f72150ebee61fe789b7e0c61b9fea1acb6f93c747b9d82d2d9bf71dd11ae32db1d7c0a984186ecdf493ecb6b593b9388a28114d8966b4100a842965ce51447aee0e215ef464324cb0c16d0ebd66d72aa3f75b3b75686845260e9cf2292dc30993cc94a3b48ef886d04e1da12edb85b76386dbc55908a87761e0b104d3377abadf5ceb64249885d7cf3b8824065c480a63e683fe60fbe5b85b9f7175341caa3967713d1df5ba3dab05db1c7cfd1a3fcf7d79359b1aba76d2235b669518f0fad139679f30ea073b5e6a5284764f1869a50e835a3a344a89f9a5bf9edf7
2024-12-31 20:58:08,939 - INFO - [server.py:309] - Server ChangeCipherSpec and Finished messages sent
2024-12-31 20:58:08,950 - INFO - [keys.py:206] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2024-12-31 20:58:08,951 - INFO - [session.py:103] - TLS Handshake completed successfully
2024-12-31 20:58:08,953 - INFO - [session.py:130] - Found file to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2024-12-31 20:58:08,955 - INFO - [session.py:148] - Handshake completed: True
2024-12-31 20:58:08,957 - INFO - [session.py:149] - Use client cert: True
2024-12-31 20:58:08,958 - INFO - [session.py:150] - File to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2024-12-31 20:58:08,960 - INFO - [session.py:153] - Using encrypted exchange
2024-12-31 20:58:08,962 - INFO - [session.py:168] - Sending encrypted request data
2024-12-31 20:58:08,966 - ERROR - [keys.py:190] - Error in encrypt_and_send_application_data: name 'explicit_iv' is not defined
2024-12-31 20:58:08,969 - ERROR - [session.py:196] - Encrypted exchange failed: Failed to encrypt and send data: name 'explicit_iv' is not defined
2024-12-31 20:58:08,973 - ERROR - [main.py:27] - Session error: Session failed for 192.168.1.1: Session failed: Encrypted exchange failed: Failed to encrypt and send data: name 'explicit_iv' is not defined
2024-12-31 20:58:14,111 - INFO - [logging.py:83] - Logging configured successfully
2024-12-31 20:58:14,111 - INFO - [logging.py:90] - === Logging Configuration ===
2024-12-31 20:58:14,112 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2024-12-31 20:58:14,112 - INFO - [logging.py:92] - Log level: 20
2024-12-31 20:58:14,113 - INFO - [logging.py:93] - Timestamp: 2024-12-31T20:58:14.113160
2024-12-31 20:58:14,113 - INFO - [logging.py:94] - ==========================
2024-12-31 20:58:14,113 - INFO - [main.py:122] - Starting TLS session simulation
2024-12-31 20:58:14,114 - INFO - [main.py:87] - 
--- Client Session (certificate) ---
2024-12-31 20:58:14,114 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2024-12-31 20:58:14,115 - INFO - [cert.py:108] - File exists: True
2024-12-31 20:58:14,115 - INFO - [cert.py:109] - File size: 1912 bytes
2024-12-31 20:58:14,115 - INFO - [cert.py:113] - Read 1912 bytes
2024-12-31 20:58:14,116 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2024-12-31 20:58:14,116 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2024-12-31 20:58:14,117 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 20:58:14,118 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2024-12-31 20:58:14,119 - INFO - [cert.py:108] - File exists: True
2024-12-31 20:58:14,119 - INFO - [cert.py:109] - File size: 1643 bytes
2024-12-31 20:58:14,120 - INFO - [cert.py:113] - Read 1643 bytes
2024-12-31 20:58:14,120 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2024-12-31 20:58:14,121 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2024-12-31 20:58:14,122 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 20:58:14,153 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2024-12-31 20:58:14,154 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2024-12-31 20:58:14,154 - INFO - [cert.py:215] - Key size: 2048 bits
2024-12-31 20:58:14,154 - INFO - [cert.py:217] - Public exponent: 65537
2024-12-31 20:58:14,157 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2024-12-31 20:58:14,158 - INFO - [verify.py:58] - Public key comparison results:
2024-12-31 20:58:14,158 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2024-12-31 20:58:14,160 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2024-12-31 20:58:14,161 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2024-12-31 20:58:14,161 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2024-12-31 20:58:14,168 - INFO - [verify.py:136] - Certificate chain verification successful
2024-12-31 20:58:14,168 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2024-12-31 20:58:14,169 - INFO - [chain.py:109] - Certificate chain verification passed
2024-12-31 20:58:14,169 - INFO - [chain.py:116] - Certificate chain loaded successfully
2024-12-31 20:58:14,170 - INFO - [chain.py:117] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2024-12-31 20:58:14,170 - INFO - [chain.py:118] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2024-12-31 20:58:14,170 - INFO - [chain.py:122] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2024-12-31 20:58:14,171 - INFO - [session.py:119] - Starting TLS session
2024-12-31 20:58:14,171 - INFO - [client.py:95] - Generated client_random: 67743ec6a90d8e4ae2a6ab497e09310ca7da40f84c3a3fe7671fba8789b19977
2024-12-31 20:58:14,174 - INFO - [client.py:135] - Client Hello sent from 192.168.1.1
2024-12-31 20:58:14,177 - INFO - [server.py:93] - Generated server_random: 67743ec6a2e1ecb5f55d9406caca0efdbf6e890676d9538d33fa3234db521db4
2024-12-31 20:58:14,181 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2024-12-31 20:58:14,182 - INFO - [cert.py:108] - File exists: True
2024-12-31 20:58:14,182 - INFO - [cert.py:109] - File size: 1915 bytes
2024-12-31 20:58:14,182 - INFO - [cert.py:113] - Read 1915 bytes
2024-12-31 20:58:14,183 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2024-12-31 20:58:14,183 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2024-12-31 20:58:14,184 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 20:58:14,184 - INFO - [client.py:169] - Prepared client certificate
2024-12-31 20:58:14,185 - INFO - [client.py:184] - Encrypted pre_master_secret length: 256
2024-12-31 20:58:14,187 - INFO - [chain.py:182] - Decrypted pre_master_secret: 0303685949552358b425b734a2e0ac7fe26ec8e801a545d56cb551f0a206e127174d84fa7248aa2be509e06128e2120b
2024-12-31 20:58:14,187 - INFO - [chain.py:193] - Generated master secret: a56bb4e26edfc73cb9d4f68b4e331055121d15dc33d0ac20f04984101733a39923a95fe482420a7c2eeb59a2b788beed
2024-12-31 20:58:14,188 - INFO - [client.py:345] - Client ChangeCipherSpec and Finished messages sent
2024-12-31 20:58:14,190 - INFO - [server.py:254] - Pre-master secret validated successfully
2024-12-31 20:58:14,192 - INFO - [server.py:272] - Generated digital signature: 304b8a6728b43fbb52b28e9548fc7c854030bacac23ae47376fdb2643aaa1531eecd1a4365dc31f91e68b12c7343ff743f11449ad6e407b56aa08bf28c10ac31995712498374ad4b0a2d2a840fe4cb76dce251e3dc717b2e6798a402588151aaf00385af2ad458c6c74c9eb69f349d3f7e1fdde210f328b3ec19000ec4fbdcc7f36eb766c9cc167509cdb176e06007058c63af050d71283a1d3ff1b0e58e5529b04884278d57fd315acfda3c84bb0b3c8f6fb4c316fd244ccac0abeadb1ce3550e80d4d8e074ae63e10f4d82e024801e9c2e0d18cf7445658765c02c550408d0f547269ff67836ab6db15dcdcc6e179c86f1ccca1ef2d786c042b531bd09c293
2024-12-31 20:58:14,194 - INFO - [server.py:309] - Server ChangeCipherSpec and Finished messages sent
2024-12-31 20:58:14,196 - INFO - [keys.py:206] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2024-12-31 20:58:14,196 - INFO - [session.py:103] - TLS Handshake completed successfully
2024-12-31 20:58:14,197 - INFO - [session.py:130] - Found file to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2024-12-31 20:58:14,197 - INFO - [session.py:148] - Handshake completed: True
2024-12-31 20:58:14,198 - INFO - [session.py:149] - Use client cert: True
2024-12-31 20:58:14,198 - INFO - [session.py:150] - File to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2024-12-31 20:58:14,198 - INFO - [session.py:153] - Using encrypted exchange
2024-12-31 20:58:14,198 - INFO - [session.py:168] - Sending encrypted request data
2024-12-31 20:58:14,199 - ERROR - [keys.py:190] - Error in encrypt_and_send_application_data: name 'explicit_iv' is not defined
2024-12-31 20:58:14,199 - ERROR - [session.py:196] - Encrypted exchange failed: Failed to encrypt and send data: name 'explicit_iv' is not defined
2024-12-31 20:58:14,200 - ERROR - [main.py:27] - Session error: Session failed for 192.168.1.1: Session failed: Encrypted exchange failed: Failed to encrypt and send data: name 'explicit_iv' is not defined
2024-12-31 20:59:46,745 - INFO - [logging.py:83] - Logging configured successfully
2024-12-31 20:59:46,746 - INFO - [logging.py:90] - === Logging Configuration ===
2024-12-31 20:59:46,746 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2024-12-31 20:59:46,747 - INFO - [logging.py:92] - Log level: 20
2024-12-31 20:59:46,747 - INFO - [logging.py:93] - Timestamp: 2024-12-31T20:59:46.747416
2024-12-31 20:59:46,747 - INFO - [logging.py:94] - ==========================
2024-12-31 20:59:46,748 - INFO - [main.py:122] - Starting TLS session simulation
2024-12-31 20:59:46,749 - INFO - [main.py:87] - 
--- Client Session (certificate) ---
2024-12-31 20:59:46,750 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2024-12-31 20:59:46,751 - INFO - [cert.py:108] - File exists: True
2024-12-31 20:59:46,751 - INFO - [cert.py:109] - File size: 1912 bytes
2024-12-31 20:59:46,752 - INFO - [cert.py:113] - Read 1912 bytes
2024-12-31 20:59:46,752 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2024-12-31 20:59:46,754 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2024-12-31 20:59:46,755 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 20:59:46,755 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2024-12-31 20:59:46,756 - INFO - [cert.py:108] - File exists: True
2024-12-31 20:59:46,756 - INFO - [cert.py:109] - File size: 1643 bytes
2024-12-31 20:59:46,757 - INFO - [cert.py:113] - Read 1643 bytes
2024-12-31 20:59:46,757 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2024-12-31 20:59:46,758 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2024-12-31 20:59:46,759 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 20:59:46,790 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2024-12-31 20:59:46,792 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2024-12-31 20:59:46,792 - INFO - [cert.py:215] - Key size: 2048 bits
2024-12-31 20:59:46,792 - INFO - [cert.py:217] - Public exponent: 65537
2024-12-31 20:59:46,795 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2024-12-31 20:59:46,795 - INFO - [verify.py:58] - Public key comparison results:
2024-12-31 20:59:46,796 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2024-12-31 20:59:46,797 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2024-12-31 20:59:46,798 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2024-12-31 20:59:46,798 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2024-12-31 20:59:46,801 - INFO - [verify.py:136] - Certificate chain verification successful
2024-12-31 20:59:46,802 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2024-12-31 20:59:46,802 - INFO - [chain.py:109] - Certificate chain verification passed
2024-12-31 20:59:46,803 - INFO - [chain.py:116] - Certificate chain loaded successfully
2024-12-31 20:59:46,803 - INFO - [chain.py:117] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2024-12-31 20:59:46,804 - INFO - [chain.py:118] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2024-12-31 20:59:46,805 - INFO - [chain.py:122] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2024-12-31 20:59:46,806 - INFO - [session.py:119] - Starting TLS session
2024-12-31 20:59:46,806 - INFO - [client.py:95] - Generated client_random: 67743f22ca9eba6f88d19e4ac3a9dcf7beded0e6da2c6065a0383199c190eb82
2024-12-31 20:59:46,811 - INFO - [client.py:135] - Client Hello sent from 192.168.1.1
2024-12-31 20:59:46,815 - INFO - [server.py:93] - Generated server_random: 67743f22b2c893a905b8571a15b74bd46ab88dcb8df9c508404ac35da9c02661
2024-12-31 20:59:46,819 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2024-12-31 20:59:46,820 - INFO - [cert.py:108] - File exists: True
2024-12-31 20:59:46,820 - INFO - [cert.py:109] - File size: 1915 bytes
2024-12-31 20:59:46,821 - INFO - [cert.py:113] - Read 1915 bytes
2024-12-31 20:59:46,821 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2024-12-31 20:59:46,822 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2024-12-31 20:59:46,824 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 20:59:46,824 - INFO - [client.py:169] - Prepared client certificate
2024-12-31 20:59:46,825 - INFO - [client.py:184] - Encrypted pre_master_secret length: 256
2024-12-31 20:59:46,832 - INFO - [chain.py:182] - Decrypted pre_master_secret: 03038b025e4b288179635c2ca158f240632dbd1980c40a8ad0b94cdba0fa462fb3c9e6919c9a8b6efe436b22f78384ce
2024-12-31 20:59:46,833 - INFO - [chain.py:193] - Generated master secret: ff6863353add7758e3dcd72490f356b87bf91d5076a486b5ceac64e260472bba51a756eb83f97e7a6f3a174046a5823d
2024-12-31 20:59:46,834 - INFO - [client.py:345] - Client ChangeCipherSpec and Finished messages sent
2024-12-31 20:59:46,837 - INFO - [server.py:254] - Pre-master secret validated successfully
2024-12-31 20:59:46,839 - INFO - [server.py:272] - Generated digital signature: 401e18d3897eb6f1acfa39f45edb0cf506616db7458579e8766c64b1751412271d91dc97d3b1ddc3e37a74f33f51e8783cf18487095b1a665685ffd848d76b0d25d1732cf7b0ef94cce36e1a34fff34f2b789392c9017cdc805b6d49b6dc83220688a976d77928f1cc221e33cbd84c2c3cd788aaf5a93e093f8cb7a8b5a8cd96fbfa73d6ca3b5e2e5bb592473cf159fe3e0c03e2a59a29ae3b9a23780b0f46fbd73c779232f057044d82d83488daea4080ae81799b71133228ff52582ac84b294b84a5e339abdfcd7166f569b2ab30dccd3e045fd189f05fe74cdf947942fd311e965a843029cf3c5843ab956ae45665148e281f4b6ad4784676f4d6872955cb
2024-12-31 20:59:46,845 - INFO - [server.py:309] - Server ChangeCipherSpec and Finished messages sent
2024-12-31 20:59:46,876 - INFO - [keys.py:198] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2024-12-31 20:59:46,877 - INFO - [session.py:103] - TLS Handshake completed successfully
2024-12-31 20:59:46,878 - INFO - [session.py:130] - Found file to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2024-12-31 20:59:46,880 - INFO - [session.py:148] - Handshake completed: True
2024-12-31 20:59:46,881 - INFO - [session.py:149] - Use client cert: True
2024-12-31 20:59:46,885 - INFO - [session.py:150] - File to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2024-12-31 20:59:46,886 - INFO - [session.py:153] - Using encrypted exchange
2024-12-31 20:59:46,889 - INFO - [session.py:168] - Sending encrypted request data
2024-12-31 20:59:46,914 - INFO - [keys.py:178] - TLS Application Data sent from 192.168.1.1:12345 to 10.0.0.1:443
2024-12-31 20:59:46,922 - INFO - [session.py:179] - Sending encrypted response data
2024-12-31 20:59:46,946 - INFO - [keys.py:178] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2024-12-31 20:59:46,951 - INFO - [session.py:191] - Attempting to send file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2024-12-31 20:59:46,955 - INFO - [session.py:202] - Opening file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2024-12-31 20:59:46,962 - INFO - [session.py:209] - Read 1103 bytes from file
2024-12-31 20:59:46,977 - INFO - [keys.py:178] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2024-12-31 20:59:46,982 - INFO - [session.py:218] - File sent successfully
2024-12-31 20:59:46,983 - INFO - [session.py:193] - File sent successfully
2024-12-31 20:59:46,984 - INFO - [main.py:95] - Session completed successfully for 192.168.1.1
2024-12-31 20:59:46,985 - INFO - [main.py:87] - 
--- Client Session (no certificate) ---
2024-12-31 20:59:46,989 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2024-12-31 20:59:46,996 - INFO - [cert.py:108] - File exists: True
2024-12-31 20:59:46,998 - INFO - [cert.py:109] - File size: 1912 bytes
2024-12-31 20:59:47,000 - INFO - [cert.py:113] - Read 1912 bytes
2024-12-31 20:59:47,001 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2024-12-31 20:59:47,003 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2024-12-31 20:59:47,006 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 20:59:47,010 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2024-12-31 20:59:47,013 - INFO - [cert.py:108] - File exists: True
2024-12-31 20:59:47,015 - INFO - [cert.py:109] - File size: 1643 bytes
2024-12-31 20:59:47,016 - INFO - [cert.py:113] - Read 1643 bytes
2024-12-31 20:59:47,018 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2024-12-31 20:59:47,019 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2024-12-31 20:59:47,022 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 20:59:47,067 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2024-12-31 20:59:47,067 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2024-12-31 20:59:47,067 - INFO - [cert.py:215] - Key size: 2048 bits
2024-12-31 20:59:47,068 - INFO - [cert.py:217] - Public exponent: 65537
2024-12-31 20:59:47,068 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2024-12-31 20:59:47,068 - INFO - [verify.py:58] - Public key comparison results:
2024-12-31 20:59:47,069 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2024-12-31 20:59:47,070 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2024-12-31 20:59:47,071 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2024-12-31 20:59:47,071 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2024-12-31 20:59:47,072 - INFO - [verify.py:136] - Certificate chain verification successful
2024-12-31 20:59:47,072 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2024-12-31 20:59:47,073 - INFO - [chain.py:109] - Certificate chain verification passed
2024-12-31 20:59:47,073 - INFO - [chain.py:116] - Certificate chain loaded successfully
2024-12-31 20:59:47,073 - INFO - [chain.py:117] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2024-12-31 20:59:47,074 - INFO - [chain.py:118] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2024-12-31 20:59:47,074 - INFO - [chain.py:122] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2024-12-31 20:59:47,074 - INFO - [session.py:119] - Starting TLS session
2024-12-31 20:59:47,074 - INFO - [client.py:95] - Generated client_random: 67743f23fc15afab8115dd81723ea2bd48b8b8592763624ec538725f4ba40555
2024-12-31 20:59:47,076 - INFO - [client.py:135] - Client Hello sent from 192.168.1.2
2024-12-31 20:59:47,078 - INFO - [server.py:93] - Generated server_random: 67743f23ff06ed2a178bc5a591b7cfcb67117f3fe04845e2332c058f8e5f9c84
2024-12-31 20:59:47,081 - INFO - [client.py:172] - Prepared empty certificate
2024-12-31 20:59:47,082 - INFO - [client.py:184] - Encrypted pre_master_secret length: 256
2024-12-31 20:59:47,083 - INFO - [chain.py:182] - Decrypted pre_master_secret: 030324909392c11e971b96abf733c7420c64841bc94e0414e40d34f5221962cf74a1f0f5bca919bc984f5608c32cf05b
2024-12-31 20:59:47,084 - INFO - [chain.py:193] - Generated master secret: 1e089f369f9b768c0c05b573038b5e3942ad94d1b0f9acef853664a95e0c8f990428199bf8877bf4b2edf24828c0505d
2024-12-31 20:59:47,084 - INFO - [client.py:345] - Client ChangeCipherSpec and Finished messages sent
2024-12-31 20:59:47,088 - INFO - [server.py:254] - Pre-master secret validated successfully
2024-12-31 20:59:47,089 - INFO - [server.py:272] - Generated digital signature: 72e5772359cff677a3376122abf6f8d8957f9d17d600b48ef7ef4364f48e765b76bac98c1870ff270daf6e295d333d1043449bff511a1e34f208558f88cb81f99e627818f644463100dd0bedbffe16cea3f81b1a35e66dce54ff4605bb5ccfc20130f037ec4188ad93bf16442151b57f89a6d097bfc9c7ed7928eeac533abec5c83248bb8cb506b44bca2138efd870019a744f13a476de7075520f279892bfbcf6d6344298dfd723501dfe69fa01fe35f26f99c151ea0b662963f21d70143342ac6646998d41a639a9b698f5d5994f7d302dbdbff99fcfdb3bb944b6ce2f748c5695c8954b8e8d89a578c2bde029441fc48668b985b1df643ca3e8a8d1930457
2024-12-31 20:59:47,090 - INFO - [server.py:309] - Server ChangeCipherSpec and Finished messages sent
2024-12-31 20:59:47,091 - INFO - [keys.py:198] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2024-12-31 20:59:47,092 - INFO - [session.py:103] - TLS Handshake completed successfully
2024-12-31 20:59:47,092 - INFO - [session.py:148] - Handshake completed: True
2024-12-31 20:59:47,092 - INFO - [session.py:149] - Use client cert: False
2024-12-31 20:59:47,093 - INFO - [session.py:150] - File to send: None
2024-12-31 20:59:47,093 - INFO - [session.py:156] - Using unencrypted exchange
2024-12-31 20:59:47,093 - INFO - [session.py:256] - Added request packet
2024-12-31 20:59:47,094 - INFO - [session.py:256] - Added response packet
2024-12-31 20:59:47,094 - WARNING - [session.py:233] - Using unencrypted communication
2024-12-31 20:59:47,095 - INFO - [main.py:95] - Session completed successfully for 192.168.1.2
2024-12-31 20:59:47,095 - INFO - [pcap_writer.py:232] - Packet 13: Valid HTTP message
2024-12-31 20:59:47,095 - INFO - [pcap_writer.py:232] - Packet 14: Valid HTTP message
2024-12-31 20:59:47,100 - INFO - [pcap_writer.py:387] - Saved 15 valid packets to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2024-12-31 20:59:47,101 - INFO - [pcap_writer.py:409] - Verifying 15 packets...
2024-12-31 20:59:47,101 - INFO - [pcap_writer.py:413] - Packet 1: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2024-12-31 20:59:47,102 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2024-12-31 20:59:47,102 - INFO - [pcap_writer.py:413] - Packet 2: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2024-12-31 20:59:47,103 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2775
2024-12-31 20:59:47,104 - INFO - [pcap_writer.py:413] - Packet 3: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2024-12-31 20:59:47,105 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 1646
2024-12-31 20:59:47,105 - INFO - [pcap_writer.py:413] - Packet 4: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2024-12-31 20:59:47,106 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2024-12-31 20:59:47,106 - INFO - [pcap_writer.py:413] - Packet 5: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2024-12-31 20:59:47,107 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2024-12-31 20:59:47,107 - INFO - [pcap_writer.py:413] - Packet 6: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2024-12-31 20:59:47,107 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 165
2024-12-31 20:59:47,108 - INFO - [pcap_writer.py:413] - Packet 7: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2024-12-31 20:59:47,108 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 133
2024-12-31 20:59:47,108 - INFO - [pcap_writer.py:413] - Packet 8: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2024-12-31 20:59:47,108 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 1157
2024-12-31 20:59:47,109 - INFO - [pcap_writer.py:413] - Packet 9: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2024-12-31 20:59:47,109 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2024-12-31 20:59:47,109 - INFO - [pcap_writer.py:413] - Packet 10: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2024-12-31 20:59:47,109 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2775
2024-12-31 20:59:47,109 - INFO - [pcap_writer.py:413] - Packet 11: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2024-12-31 20:59:47,110 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 269
2024-12-31 20:59:47,110 - INFO - [pcap_writer.py:413] - Packet 12: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2024-12-31 20:59:47,110 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2024-12-31 20:59:47,110 - INFO - [pcap_writer.py:413] - Packet 13: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2024-12-31 20:59:47,110 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2024-12-31 20:59:47,110 - INFO - [pcap_writer.py:413] - Packet 14: IP / TCP 192.168.1.2:12346 > 10.0.0.1:http PA / Raw
2024-12-31 20:59:47,111 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2024-12-31 20:59:47,111 - INFO - [pcap_writer.py:413] - Packet 15: IP / TCP 10.0.0.1:http > 192.168.1.2:12346 PA / Raw
2024-12-31 20:59:47,112 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2024-12-31 20:59:47,112 - INFO - [pcap_writer.py:427] - Verification complete: 15 valid packets, 15 TLS records
2024-12-31 20:59:47,112 - INFO - [main.py:106] - Results saved to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2024-12-31 20:59:47,112 - INFO - [main.py:160] - TLS session simulation completed successfully
2024-12-31 22:08:41,424 - INFO - [logging.py:83] - Logging configured successfully
2024-12-31 22:08:41,425 - INFO - [logging.py:90] - === Logging Configuration ===
2024-12-31 22:08:41,426 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2024-12-31 22:08:41,426 - INFO - [logging.py:92] - Log level: 20
2024-12-31 22:08:41,427 - INFO - [logging.py:93] - Timestamp: 2024-12-31T22:08:41.427104
2024-12-31 22:08:41,427 - INFO - [logging.py:94] - ==========================
2024-12-31 22:08:41,428 - INFO - [main.py:122] - Starting TLS session simulation
2024-12-31 22:08:41,429 - INFO - [main.py:87] - 
--- Client Session (certificate) ---
2024-12-31 22:08:41,432 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2024-12-31 22:08:41,433 - INFO - [cert.py:108] - File exists: True
2024-12-31 22:08:41,433 - INFO - [cert.py:109] - File size: 1912 bytes
2024-12-31 22:08:41,435 - INFO - [cert.py:113] - Read 1912 bytes
2024-12-31 22:08:41,436 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2024-12-31 22:08:41,437 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2024-12-31 22:08:41,442 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 22:08:41,442 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2024-12-31 22:08:41,444 - INFO - [cert.py:108] - File exists: True
2024-12-31 22:08:41,445 - INFO - [cert.py:109] - File size: 1643 bytes
2024-12-31 22:08:41,446 - INFO - [cert.py:113] - Read 1643 bytes
2024-12-31 22:08:41,446 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2024-12-31 22:08:41,446 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2024-12-31 22:08:41,447 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 22:08:41,498 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2024-12-31 22:08:41,498 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2024-12-31 22:08:41,499 - INFO - [cert.py:215] - Key size: 2048 bits
2024-12-31 22:08:41,500 - INFO - [cert.py:217] - Public exponent: 65537
2024-12-31 22:08:41,505 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2024-12-31 22:08:41,505 - INFO - [verify.py:58] - Public key comparison results:
2024-12-31 22:08:41,506 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2024-12-31 22:08:41,506 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2024-12-31 22:08:41,507 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2024-12-31 22:08:41,507 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2024-12-31 22:08:41,513 - INFO - [verify.py:136] - Certificate chain verification successful
2024-12-31 22:08:41,515 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2024-12-31 22:08:41,515 - INFO - [chain.py:110] - Certificate chain verification passed
2024-12-31 22:08:41,515 - INFO - [chain.py:117] - Certificate chain loaded successfully
2024-12-31 22:08:41,516 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2024-12-31 22:08:41,516 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2024-12-31 22:08:41,517 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2024-12-31 22:08:41,518 - INFO - [session.py:120] - Starting TLS session
2024-12-31 22:08:41,518 - INFO - [client.py:95] - Generated client_random: 67744f4916b384d16d6b4b50f6898c5414f56bdef7384ccd3622f0ccab3d7294
2024-12-31 22:08:41,521 - INFO - [client.py:135] - Client Hello sent from 192.168.1.1
2024-12-31 22:08:41,524 - INFO - [server.py:93] - Generated server_random: 67744f495861356c03c371db70a968295ee7cc23afb40dfa2418c1f8e82bf848
2024-12-31 22:08:41,531 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2024-12-31 22:08:41,532 - INFO - [cert.py:108] - File exists: True
2024-12-31 22:08:41,532 - INFO - [cert.py:109] - File size: 1915 bytes
2024-12-31 22:08:41,534 - INFO - [cert.py:113] - Read 1915 bytes
2024-12-31 22:08:41,534 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2024-12-31 22:08:41,535 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2024-12-31 22:08:41,536 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 22:08:41,537 - INFO - [client.py:169] - Prepared client certificate
2024-12-31 22:08:41,538 - INFO - [client.py:184] - Encrypted pre_master_secret length: 256
2024-12-31 22:08:41,541 - INFO - [chain.py:185] - Decrypted pre_master_secret: 0303d3dac765e0c55bfd2ac98130bdd4cb36c689fa75403d842a47194218611ce8b03650cd5fb0129b4382f847142234
2024-12-31 22:08:41,543 - INFO - [chain.py:195] - Generated master secret: df1613bb0218447c85d6444ad26d5e1a7069d0c710ef4a7a4a9c02ebcb4af11bafee1ed0a21a24f3aab275e4c3c0a4be
2024-12-31 22:08:41,544 - INFO - [chain.py:196] - Master secret length: 48 bytes
2024-12-31 22:08:41,546 - INFO - [client.py:345] - Client ChangeCipherSpec and Finished messages sent
2024-12-31 22:08:41,548 - INFO - [server.py:254] - Pre-master secret validated successfully
2024-12-31 22:08:41,549 - INFO - [server.py:272] - Generated digital signature: 8887bb93f08b6c60a5bd843182c2fd365ea26a91091dcf608ef1e1e14969bf8553764eaa90a782c7f54ea216808c0602576c4b31314b5fc6f7889e0b1fc6bcda64afdb7f5398185a25a4613e26c8043e5683776ce1ee427d75629ff4d1b88ba8587e1106afa0f50489a492cf82516f015202f30039f19c8130f4abd64c8d61bdc57083ee91d3e412e994b5644bf406013fb169ffd61da7f472f211c0a222acff2cb06ba4c358537926f802fa2dceaad311a6b88858e0b34245f3e390ef1cc0fcf22bc4bd926cf5029434b562a66f3dd02aeb1c7c04bfe2be0b3f07b215e7a0805af719e275e38aab3ebfadd1bcfbc92935eddb4d7c4e744c5973027a3709903d
2024-12-31 22:08:41,551 - INFO - [server.py:309] - Server ChangeCipherSpec and Finished messages sent
2024-12-31 22:08:41,554 - INFO - [keys.py:200] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2024-12-31 22:08:41,555 - INFO - [session.py:104] - TLS Handshake completed successfully
2024-12-31 22:08:41,556 - INFO - [session.py:131] - Found file to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2024-12-31 22:08:41,557 - INFO - [session.py:149] - Handshake completed: True
2024-12-31 22:08:41,559 - INFO - [session.py:150] - Use client cert: True
2024-12-31 22:08:41,560 - INFO - [session.py:151] - File to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2024-12-31 22:08:41,560 - INFO - [session.py:154] - Using encrypted exchange
2024-12-31 22:08:41,561 - INFO - [session.py:169] - Sending encrypted request data
2024-12-31 22:08:41,563 - INFO - [keys.py:180] - TLS Application Data sent from 192.168.1.1:12345 to 10.0.0.1:443
2024-12-31 22:08:41,564 - INFO - [session.py:180] - Sending encrypted response data
2024-12-31 22:08:41,566 - INFO - [keys.py:180] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2024-12-31 22:08:41,567 - INFO - [session.py:192] - Attempting to send file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2024-12-31 22:08:41,567 - INFO - [session.py:203] - Opening file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2024-12-31 22:08:41,568 - INFO - [session.py:210] - Read 1103 bytes from file
2024-12-31 22:08:41,570 - INFO - [keys.py:180] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2024-12-31 22:08:41,571 - INFO - [session.py:219] - File sent successfully
2024-12-31 22:08:41,572 - INFO - [session.py:194] - File sent successfully
2024-12-31 22:08:41,572 - INFO - [main.py:95] - Session completed successfully for 192.168.1.1
2024-12-31 22:08:41,573 - INFO - [main.py:87] - 
--- Client Session (no certificate) ---
2024-12-31 22:08:41,576 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2024-12-31 22:08:41,578 - INFO - [cert.py:108] - File exists: True
2024-12-31 22:08:41,579 - INFO - [cert.py:109] - File size: 1912 bytes
2024-12-31 22:08:41,579 - INFO - [cert.py:113] - Read 1912 bytes
2024-12-31 22:08:41,580 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2024-12-31 22:08:41,581 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2024-12-31 22:08:41,582 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 22:08:41,582 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2024-12-31 22:08:41,583 - INFO - [cert.py:108] - File exists: True
2024-12-31 22:08:41,583 - INFO - [cert.py:109] - File size: 1643 bytes
2024-12-31 22:08:41,584 - INFO - [cert.py:113] - Read 1643 bytes
2024-12-31 22:08:41,585 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2024-12-31 22:08:41,585 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2024-12-31 22:08:41,587 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 22:08:41,623 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2024-12-31 22:08:41,624 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2024-12-31 22:08:41,625 - INFO - [cert.py:215] - Key size: 2048 bits
2024-12-31 22:08:41,625 - INFO - [cert.py:217] - Public exponent: 65537
2024-12-31 22:08:41,625 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2024-12-31 22:08:41,626 - INFO - [verify.py:58] - Public key comparison results:
2024-12-31 22:08:41,626 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2024-12-31 22:08:41,627 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2024-12-31 22:08:41,628 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2024-12-31 22:08:41,628 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2024-12-31 22:08:41,628 - INFO - [verify.py:136] - Certificate chain verification successful
2024-12-31 22:08:41,629 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2024-12-31 22:08:41,629 - INFO - [chain.py:110] - Certificate chain verification passed
2024-12-31 22:08:41,629 - INFO - [chain.py:117] - Certificate chain loaded successfully
2024-12-31 22:08:41,630 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2024-12-31 22:08:41,630 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2024-12-31 22:08:41,631 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2024-12-31 22:08:41,631 - INFO - [session.py:120] - Starting TLS session
2024-12-31 22:08:41,632 - INFO - [client.py:95] - Generated client_random: 67744f49600418751b823fcfab8bb5893c831e65f9f634ee1196aa13f79fb844
2024-12-31 22:08:41,634 - INFO - [client.py:135] - Client Hello sent from 192.168.1.2
2024-12-31 22:08:41,637 - INFO - [server.py:93] - Generated server_random: 67744f49b76a72ac8a0e85f339d6777fc684474da97529ab5898801043f3631c
2024-12-31 22:08:41,643 - INFO - [client.py:172] - Prepared empty certificate
2024-12-31 22:08:41,647 - INFO - [client.py:184] - Encrypted pre_master_secret length: 256
2024-12-31 22:08:41,649 - INFO - [chain.py:185] - Decrypted pre_master_secret: 03030c7a4d8020ced3ef450282981fae45b6ed6529fcbc3b0282d2eb34c9b61abb4ed4c2856afd156f98d8a66e3dd0b4
2024-12-31 22:08:41,650 - INFO - [chain.py:195] - Generated master secret: 17f4a955c21dda17523d245cbb28f2efa49e9757c34c4610e510f49baeabd2ce59316f67f0265ec5958e49d9523e50a7
2024-12-31 22:08:41,650 - INFO - [chain.py:196] - Master secret length: 48 bytes
2024-12-31 22:08:41,652 - INFO - [client.py:345] - Client ChangeCipherSpec and Finished messages sent
2024-12-31 22:08:41,654 - INFO - [server.py:254] - Pre-master secret validated successfully
2024-12-31 22:08:41,655 - INFO - [server.py:272] - Generated digital signature: 09fe35dd287031e84c07c93488d15be282a4fb49196c704b6c538cdda26529c80c532392e2f48a127ab2cd3d8c7a135f39eb2bf27ef1d10a6b63c44c06ba637e7b9f1729af4aa909d4f80e8bd57a5cf9ad467b5ce859a3cd58da2aaa0178e971e5aca9f300a454fa4b0b65f5f524cdd037eee93d151ac173109773b0c0502dc2abd91c4023ddea651453de14c4209e4fc2b80a2bd48b2dab3206560397d58b3adb8525d04c8b2b097c5b99191427a26361daf485661c669d2dbac9ff464d2987029f0b1162126001d226dde41294ccfedf3036bfbed1975d8f18d564bb4b0d87e9f02c73a3897e9e507ab43dc5642221cee3b389ae71b7bcd52387e691e275cf
2024-12-31 22:08:41,659 - INFO - [server.py:309] - Server ChangeCipherSpec and Finished messages sent
2024-12-31 22:08:41,661 - INFO - [keys.py:200] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2024-12-31 22:08:41,662 - INFO - [session.py:104] - TLS Handshake completed successfully
2024-12-31 22:08:41,662 - INFO - [session.py:149] - Handshake completed: True
2024-12-31 22:08:41,662 - INFO - [session.py:150] - Use client cert: False
2024-12-31 22:08:41,663 - INFO - [session.py:151] - File to send: None
2024-12-31 22:08:41,663 - INFO - [session.py:157] - Using unencrypted exchange
2024-12-31 22:08:41,664 - INFO - [session.py:257] - Added request packet
2024-12-31 22:08:41,664 - INFO - [session.py:257] - Added response packet
2024-12-31 22:08:41,665 - WARNING - [session.py:234] - Using unencrypted communication
2024-12-31 22:08:41,665 - INFO - [main.py:95] - Session completed successfully for 192.168.1.2
2024-12-31 22:08:41,666 - INFO - [pcap_writer.py:232] - Packet 13: Valid HTTP message
2024-12-31 22:08:41,666 - INFO - [pcap_writer.py:232] - Packet 14: Valid HTTP message
2024-12-31 22:08:41,672 - INFO - [pcap_writer.py:387] - Saved 15 valid packets to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2024-12-31 22:08:41,673 - INFO - [pcap_writer.py:409] - Verifying 15 packets...
2024-12-31 22:08:41,674 - INFO - [pcap_writer.py:413] - Packet 1: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2024-12-31 22:08:41,675 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2024-12-31 22:08:41,676 - INFO - [pcap_writer.py:413] - Packet 2: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2024-12-31 22:08:41,676 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2775
2024-12-31 22:08:41,677 - INFO - [pcap_writer.py:413] - Packet 3: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2024-12-31 22:08:41,677 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 1646
2024-12-31 22:08:41,677 - INFO - [pcap_writer.py:413] - Packet 4: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2024-12-31 22:08:41,678 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2024-12-31 22:08:41,678 - INFO - [pcap_writer.py:413] - Packet 5: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2024-12-31 22:08:41,678 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2024-12-31 22:08:41,679 - INFO - [pcap_writer.py:413] - Packet 6: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2024-12-31 22:08:41,679 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 165
2024-12-31 22:08:41,680 - INFO - [pcap_writer.py:413] - Packet 7: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2024-12-31 22:08:41,680 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 133
2024-12-31 22:08:41,680 - INFO - [pcap_writer.py:413] - Packet 8: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2024-12-31 22:08:41,680 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 1157
2024-12-31 22:08:41,681 - INFO - [pcap_writer.py:413] - Packet 9: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2024-12-31 22:08:41,681 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2024-12-31 22:08:41,681 - INFO - [pcap_writer.py:413] - Packet 10: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2024-12-31 22:08:41,682 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2775
2024-12-31 22:08:41,682 - INFO - [pcap_writer.py:413] - Packet 11: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2024-12-31 22:08:41,683 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 269
2024-12-31 22:08:41,683 - INFO - [pcap_writer.py:413] - Packet 12: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2024-12-31 22:08:41,684 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2024-12-31 22:08:41,684 - INFO - [pcap_writer.py:413] - Packet 13: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2024-12-31 22:08:41,685 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2024-12-31 22:08:41,685 - INFO - [pcap_writer.py:413] - Packet 14: IP / TCP 192.168.1.2:12346 > 10.0.0.1:http PA / Raw
2024-12-31 22:08:41,686 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2024-12-31 22:08:41,686 - INFO - [pcap_writer.py:413] - Packet 15: IP / TCP 10.0.0.1:http > 192.168.1.2:12346 PA / Raw
2024-12-31 22:08:41,687 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2024-12-31 22:08:41,687 - INFO - [pcap_writer.py:427] - Verification complete: 15 valid packets, 15 TLS records
2024-12-31 22:08:41,688 - INFO - [main.py:106] - Results saved to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2024-12-31 22:08:41,688 - INFO - [main.py:160] - TLS session simulation completed successfully
2024-12-31 22:16:04,446 - INFO - [logging.py:83] - Logging configured successfully
2024-12-31 22:16:04,447 - INFO - [logging.py:90] - === Logging Configuration ===
2024-12-31 22:16:04,448 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2024-12-31 22:16:04,448 - INFO - [logging.py:92] - Log level: 20
2024-12-31 22:16:04,449 - INFO - [logging.py:93] - Timestamp: 2024-12-31T22:16:04.449291
2024-12-31 22:16:04,449 - INFO - [logging.py:94] - ==========================
2024-12-31 22:16:04,450 - INFO - [main.py:122] - Starting TLS session simulation
2024-12-31 22:16:04,451 - INFO - [main.py:87] - 
--- Client Session (certificate) ---
2024-12-31 22:16:04,453 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2024-12-31 22:16:04,454 - INFO - [cert.py:108] - File exists: True
2024-12-31 22:16:04,454 - INFO - [cert.py:109] - File size: 1912 bytes
2024-12-31 22:16:04,456 - INFO - [cert.py:113] - Read 1912 bytes
2024-12-31 22:16:04,456 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2024-12-31 22:16:04,457 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2024-12-31 22:16:04,462 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 22:16:04,464 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2024-12-31 22:16:04,465 - INFO - [cert.py:108] - File exists: True
2024-12-31 22:16:04,465 - INFO - [cert.py:109] - File size: 1643 bytes
2024-12-31 22:16:04,467 - INFO - [cert.py:113] - Read 1643 bytes
2024-12-31 22:16:04,468 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2024-12-31 22:16:04,469 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2024-12-31 22:16:04,472 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 22:16:04,661 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2024-12-31 22:16:04,663 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2024-12-31 22:16:04,663 - INFO - [cert.py:215] - Key size: 2048 bits
2024-12-31 22:16:04,664 - INFO - [cert.py:217] - Public exponent: 65537
2024-12-31 22:16:04,669 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2024-12-31 22:16:04,670 - INFO - [verify.py:58] - Public key comparison results:
2024-12-31 22:16:04,670 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2024-12-31 22:16:04,671 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2024-12-31 22:16:04,672 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2024-12-31 22:16:04,672 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2024-12-31 22:16:04,677 - INFO - [verify.py:136] - Certificate chain verification successful
2024-12-31 22:16:04,678 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2024-12-31 22:16:04,678 - INFO - [chain.py:110] - Certificate chain verification passed
2024-12-31 22:16:04,678 - INFO - [chain.py:117] - Certificate chain loaded successfully
2024-12-31 22:16:04,679 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2024-12-31 22:16:04,679 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2024-12-31 22:16:04,680 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2024-12-31 22:16:04,681 - INFO - [session.py:120] - Starting TLS session
2024-12-31 22:16:04,681 - INFO - [client.py:95] - Generated client_random: 6774510420a4e3addaae43cb39ca630be3b48fff53725bba68748c31d2283293
2024-12-31 22:16:04,691 - INFO - [client.py:135] - Client Hello sent from 192.168.1.1
2024-12-31 22:16:04,695 - INFO - [server.py:93] - Generated server_random: 67745104b89fc3234e5db9af08594179e971628c137b5ebed8939103748d51ef
2024-12-31 22:16:04,702 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2024-12-31 22:16:04,704 - INFO - [cert.py:108] - File exists: True
2024-12-31 22:16:04,705 - INFO - [cert.py:109] - File size: 1915 bytes
2024-12-31 22:16:04,706 - INFO - [cert.py:113] - Read 1915 bytes
2024-12-31 22:16:04,707 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2024-12-31 22:16:04,708 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2024-12-31 22:16:04,710 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 22:16:04,711 - INFO - [client.py:169] - Prepared client certificate
2024-12-31 22:16:04,712 - INFO - [client.py:184] - Encrypted pre_master_secret length: 256
2024-12-31 22:16:04,716 - INFO - [chain.py:185] - Decrypted pre_master_secret: 03034b08a31dbe6da443f7176f5472769bd3c50eb3423ee3415b412cc28dd369437d732def7ca7553aee8a9ba03ab4f3
2024-12-31 22:16:04,717 - INFO - [chain.py:195] - Generated master secret: affbfd13760499e4f2f309b57d7d131240d2e1bcbf6758262f210086449a761987873e31f6410aa17ebba75f2e6a5d24
2024-12-31 22:16:04,719 - INFO - [chain.py:196] - Master secret length: 48 bytes
2024-12-31 22:16:04,722 - INFO - [client.py:345] - Client ChangeCipherSpec and Finished messages sent
2024-12-31 22:16:04,726 - INFO - [server.py:254] - Pre-master secret validated successfully
2024-12-31 22:16:04,728 - INFO - [server.py:272] - Generated digital signature: 5b296c46a03d4fcd12b435046c06df053378e1bbcada099f4cfae08675c3d9571b7519ad0a12091a97d8500e812812a0689aa331b8a753cb0866a6b392e83e0fb7ef823d68b80ee565a3b65683b012c624e38bef26cb599bb00b24f6db6195356426dfcfd681d8a8d35a4278df4519246d70944a956b854e7af066c4cda8fc5c1f2473dbbcf8e2a840204cf9ded0f6833efd05657c657ecb201c3c5decc8cea8c34b1b23ec491204d8fb679b79cb2fe45eb5dd6be477ac2f67c7a1d1feb86e7c19c9f763902da2ce5de3ecf5331cbd6b094d7ebd632ed28665e2da06fb6a738d7571115534e8cc8afe2c29d9814a9c6a92014014fa52f02bec54360fcc8f2bcd
2024-12-31 22:16:04,731 - INFO - [server.py:309] - Server ChangeCipherSpec and Finished messages sent
2024-12-31 22:16:04,734 - INFO - [keys.py:200] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2024-12-31 22:16:04,736 - INFO - [session.py:104] - TLS Handshake completed successfully
2024-12-31 22:16:04,738 - INFO - [session.py:131] - Found file to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2024-12-31 22:16:04,740 - INFO - [session.py:149] - Handshake completed: True
2024-12-31 22:16:04,742 - INFO - [session.py:150] - Use client cert: True
2024-12-31 22:16:04,743 - INFO - [session.py:151] - File to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2024-12-31 22:16:04,745 - INFO - [session.py:154] - Using encrypted exchange
2024-12-31 22:16:04,746 - INFO - [session.py:169] - Sending encrypted request data
2024-12-31 22:16:04,750 - INFO - [keys.py:180] - TLS Application Data sent from 192.168.1.1:12345 to 10.0.0.1:443
2024-12-31 22:16:04,752 - INFO - [session.py:180] - Sending encrypted response data
2024-12-31 22:16:04,758 - INFO - [keys.py:180] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2024-12-31 22:16:04,760 - INFO - [session.py:192] - Attempting to send file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2024-12-31 22:16:04,761 - INFO - [session.py:203] - Opening file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2024-12-31 22:16:04,762 - INFO - [session.py:210] - Read 1103 bytes from file
2024-12-31 22:16:04,764 - INFO - [keys.py:180] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2024-12-31 22:16:04,766 - INFO - [session.py:219] - File sent successfully
2024-12-31 22:16:04,766 - INFO - [session.py:194] - File sent successfully
2024-12-31 22:16:04,767 - INFO - [main.py:95] - Session completed successfully for 192.168.1.1
2024-12-31 22:16:04,767 - INFO - [main.py:87] - 
--- Client Session (no certificate) ---
2024-12-31 22:16:04,770 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2024-12-31 22:16:04,772 - INFO - [cert.py:108] - File exists: True
2024-12-31 22:16:04,774 - INFO - [cert.py:109] - File size: 1912 bytes
2024-12-31 22:16:04,777 - INFO - [cert.py:113] - Read 1912 bytes
2024-12-31 22:16:04,778 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2024-12-31 22:16:04,779 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2024-12-31 22:16:04,781 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 22:16:04,782 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2024-12-31 22:16:04,783 - INFO - [cert.py:108] - File exists: True
2024-12-31 22:16:04,784 - INFO - [cert.py:109] - File size: 1643 bytes
2024-12-31 22:16:04,786 - INFO - [cert.py:113] - Read 1643 bytes
2024-12-31 22:16:04,787 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2024-12-31 22:16:04,789 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2024-12-31 22:16:04,792 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 22:16:04,853 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2024-12-31 22:16:04,853 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2024-12-31 22:16:04,854 - INFO - [cert.py:215] - Key size: 2048 bits
2024-12-31 22:16:04,854 - INFO - [cert.py:217] - Public exponent: 65537
2024-12-31 22:16:04,854 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2024-12-31 22:16:04,855 - INFO - [verify.py:58] - Public key comparison results:
2024-12-31 22:16:04,855 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2024-12-31 22:16:04,856 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2024-12-31 22:16:04,857 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2024-12-31 22:16:04,857 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2024-12-31 22:16:04,858 - INFO - [verify.py:136] - Certificate chain verification successful
2024-12-31 22:16:04,859 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2024-12-31 22:16:04,859 - INFO - [chain.py:110] - Certificate chain verification passed
2024-12-31 22:16:04,859 - INFO - [chain.py:117] - Certificate chain loaded successfully
2024-12-31 22:16:04,860 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2024-12-31 22:16:04,860 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2024-12-31 22:16:04,862 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2024-12-31 22:16:04,862 - INFO - [session.py:120] - Starting TLS session
2024-12-31 22:16:04,863 - INFO - [client.py:95] - Generated client_random: 67745104ef718a202b3a35bb2554f430b2bb65eaefe1e964203dcc4260c433f5
2024-12-31 22:16:04,866 - INFO - [client.py:135] - Client Hello sent from 192.168.1.2
2024-12-31 22:16:04,871 - INFO - [server.py:93] - Generated server_random: 677451048fef8ee38cd9017b78f16466e476285e9423aa8ea8a9bab295e8b941
2024-12-31 22:16:04,877 - INFO - [client.py:172] - Prepared empty certificate
2024-12-31 22:16:04,878 - INFO - [client.py:184] - Encrypted pre_master_secret length: 256
2024-12-31 22:16:04,882 - INFO - [chain.py:185] - Decrypted pre_master_secret: 0303fde77fedafee8148cb3ef8515c2622359dc304da12cc783c8d32e1392b1d8bc54c89b65ba16066c1273b4ab4d6a8
2024-12-31 22:16:04,883 - INFO - [chain.py:195] - Generated master secret: 43e658f50aa193d036c2d0bbabdb2a826240c5b1e8cebc141141ee441d8499b747e59410b562290cd174fd1757474b4d
2024-12-31 22:16:04,883 - INFO - [chain.py:196] - Master secret length: 48 bytes
2024-12-31 22:16:04,885 - INFO - [client.py:345] - Client ChangeCipherSpec and Finished messages sent
2024-12-31 22:16:04,893 - INFO - [server.py:254] - Pre-master secret validated successfully
2024-12-31 22:16:04,896 - INFO - [server.py:272] - Generated digital signature: 12b12fe507d61f497e6f8cd918cbe6ea178f26c50da7810b123e8a62b0811af89075989180e28e0c699ce127a9415d75caf3116413deb1ce1f08b1e322512b87bfe9b9c1e32a4df93d5b0cce81db5fb0766bdd349eed7969e47c6414bece02d535989328457096180b941e3df11153b3cbfe709b826900897a812184bbf91d80ce6a8056bfe88cada238ce8244d8a1f3fee1098e8c6dd9ce494e8cd664618c3b761ceb04862f8cfd43e7bd1d0b5b1e68cc789c903119fc8bef9a9a9b943cfa4df52e2802b68a6ac33644506f242ab04a1e54d82735dad6368b19739447128376ba61943f49d69c0c03c087043f94f580187f385d6098cc11b51a9ebe5c848de6
2024-12-31 22:16:04,898 - INFO - [server.py:309] - Server ChangeCipherSpec and Finished messages sent
2024-12-31 22:16:04,901 - INFO - [keys.py:200] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2024-12-31 22:16:04,901 - INFO - [session.py:104] - TLS Handshake completed successfully
2024-12-31 22:16:04,903 - INFO - [session.py:149] - Handshake completed: True
2024-12-31 22:16:04,904 - INFO - [session.py:150] - Use client cert: False
2024-12-31 22:16:04,906 - INFO - [session.py:151] - File to send: None
2024-12-31 22:16:04,907 - INFO - [session.py:157] - Using unencrypted exchange
2024-12-31 22:16:04,909 - INFO - [session.py:257] - Added request packet
2024-12-31 22:16:04,911 - INFO - [session.py:257] - Added response packet
2024-12-31 22:16:04,912 - WARNING - [session.py:234] - Using unencrypted communication
2024-12-31 22:16:04,913 - INFO - [main.py:95] - Session completed successfully for 192.168.1.2
2024-12-31 22:16:04,914 - INFO - [pcap_writer.py:232] - Packet 13: Valid HTTP message
2024-12-31 22:16:04,914 - INFO - [pcap_writer.py:232] - Packet 14: Valid HTTP message
2024-12-31 22:16:04,924 - INFO - [pcap_writer.py:387] - Saved 15 valid packets to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2024-12-31 22:16:04,925 - INFO - [pcap_writer.py:409] - Verifying 15 packets...
2024-12-31 22:16:04,927 - INFO - [pcap_writer.py:413] - Packet 1: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2024-12-31 22:16:04,927 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2024-12-31 22:16:04,928 - INFO - [pcap_writer.py:413] - Packet 2: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2024-12-31 22:16:04,928 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2775
2024-12-31 22:16:04,929 - INFO - [pcap_writer.py:413] - Packet 3: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2024-12-31 22:16:04,929 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 1646
2024-12-31 22:16:04,930 - INFO - [pcap_writer.py:413] - Packet 4: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2024-12-31 22:16:04,930 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2024-12-31 22:16:04,930 - INFO - [pcap_writer.py:413] - Packet 5: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2024-12-31 22:16:04,930 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2024-12-31 22:16:04,931 - INFO - [pcap_writer.py:413] - Packet 6: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2024-12-31 22:16:04,931 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 165
2024-12-31 22:16:04,932 - INFO - [pcap_writer.py:413] - Packet 7: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2024-12-31 22:16:04,932 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 133
2024-12-31 22:16:04,933 - INFO - [pcap_writer.py:413] - Packet 8: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2024-12-31 22:16:04,933 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 1157
2024-12-31 22:16:04,934 - INFO - [pcap_writer.py:413] - Packet 9: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2024-12-31 22:16:04,934 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2024-12-31 22:16:04,935 - INFO - [pcap_writer.py:413] - Packet 10: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2024-12-31 22:16:04,935 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2775
2024-12-31 22:16:04,936 - INFO - [pcap_writer.py:413] - Packet 11: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2024-12-31 22:16:04,937 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 269
2024-12-31 22:16:04,937 - INFO - [pcap_writer.py:413] - Packet 12: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2024-12-31 22:16:04,938 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2024-12-31 22:16:04,938 - INFO - [pcap_writer.py:413] - Packet 13: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2024-12-31 22:16:04,939 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2024-12-31 22:16:04,940 - INFO - [pcap_writer.py:413] - Packet 14: IP / TCP 192.168.1.2:12346 > 10.0.0.1:http PA / Raw
2024-12-31 22:16:04,941 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2024-12-31 22:16:04,942 - INFO - [pcap_writer.py:413] - Packet 15: IP / TCP 10.0.0.1:http > 192.168.1.2:12346 PA / Raw
2024-12-31 22:16:04,942 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2024-12-31 22:16:04,943 - INFO - [pcap_writer.py:427] - Verification complete: 15 valid packets, 15 TLS records
2024-12-31 22:16:04,943 - INFO - [main.py:106] - Results saved to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2024-12-31 22:16:04,943 - INFO - [main.py:160] - TLS session simulation completed successfully
2024-12-31 22:19:13,433 - INFO - [logging.py:83] - Logging configured successfully
2024-12-31 22:19:13,435 - INFO - [logging.py:90] - === Logging Configuration ===
2024-12-31 22:19:13,435 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2024-12-31 22:19:13,436 - INFO - [logging.py:92] - Log level: 20
2024-12-31 22:19:13,437 - INFO - [logging.py:93] - Timestamp: 2024-12-31T22:19:13.437568
2024-12-31 22:19:13,438 - INFO - [logging.py:94] - ==========================
2024-12-31 22:19:13,438 - INFO - [main.py:122] - Starting TLS session simulation
2024-12-31 22:19:13,440 - INFO - [main.py:87] - 
--- Client Session (certificate) ---
2024-12-31 22:19:13,442 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2024-12-31 22:19:13,444 - INFO - [cert.py:108] - File exists: True
2024-12-31 22:19:13,445 - INFO - [cert.py:109] - File size: 1912 bytes
2024-12-31 22:19:13,446 - INFO - [cert.py:113] - Read 1912 bytes
2024-12-31 22:19:13,447 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2024-12-31 22:19:13,447 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2024-12-31 22:19:13,456 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 22:19:13,457 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2024-12-31 22:19:13,458 - INFO - [cert.py:108] - File exists: True
2024-12-31 22:19:13,461 - INFO - [cert.py:109] - File size: 1643 bytes
2024-12-31 22:19:13,462 - INFO - [cert.py:113] - Read 1643 bytes
2024-12-31 22:19:13,463 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2024-12-31 22:19:13,467 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2024-12-31 22:19:13,469 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 22:19:13,515 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2024-12-31 22:19:13,516 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2024-12-31 22:19:13,517 - INFO - [cert.py:215] - Key size: 2048 bits
2024-12-31 22:19:13,519 - INFO - [cert.py:217] - Public exponent: 65537
2024-12-31 22:19:13,526 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2024-12-31 22:19:13,527 - INFO - [verify.py:58] - Public key comparison results:
2024-12-31 22:19:13,528 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2024-12-31 22:19:13,530 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2024-12-31 22:19:13,532 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2024-12-31 22:19:13,533 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2024-12-31 22:19:13,540 - INFO - [verify.py:136] - Certificate chain verification successful
2024-12-31 22:19:13,543 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2024-12-31 22:19:13,545 - INFO - [chain.py:110] - Certificate chain verification passed
2024-12-31 22:19:13,545 - INFO - [chain.py:117] - Certificate chain loaded successfully
2024-12-31 22:19:13,546 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2024-12-31 22:19:13,547 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2024-12-31 22:19:13,549 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2024-12-31 22:19:13,550 - INFO - [session.py:120] - Starting TLS session
2024-12-31 22:19:13,551 - INFO - [client.py:95] - Generated client_random: 677451c137dca901fdeb859070950f5827c5717eb1e60926aacbec45cbb0f184
2024-12-31 22:19:13,567 - INFO - [client.py:135] - Client Hello sent from 192.168.1.1
2024-12-31 22:19:13,576 - INFO - [server.py:93] - Generated server_random: 677451c1e0c5e1ee626f776289b04838e37ea90d2612fc5d098f160b1800ab18
2024-12-31 22:19:13,585 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2024-12-31 22:19:13,587 - INFO - [cert.py:108] - File exists: True
2024-12-31 22:19:13,589 - INFO - [cert.py:109] - File size: 1915 bytes
2024-12-31 22:19:13,592 - INFO - [cert.py:113] - Read 1915 bytes
2024-12-31 22:19:13,594 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2024-12-31 22:19:13,596 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2024-12-31 22:19:13,598 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 22:19:13,600 - INFO - [client.py:169] - Prepared client certificate
2024-12-31 22:19:13,604 - INFO - [client.py:184] - Encrypted pre_master_secret length: 256
2024-12-31 22:19:13,614 - INFO - [chain.py:185] - Decrypted pre_master_secret: 030355d7ca9cb00242619414ff89f5f9e10b59824dd000b00acbe4f135fc8c8fc78856bc0dd8bd3870f53a36458f6ae7
2024-12-31 22:19:13,616 - INFO - [chain.py:195] - Generated master secret: 2e0e9e49cddfc943d8c38c574d6d0234559742ffb155a6a44e01577ffdb551cc62d6246e0a7a3fd7460f64a586f3456b
2024-12-31 22:19:13,617 - INFO - [chain.py:196] - Master secret length: 48 bytes
2024-12-31 22:19:13,623 - INFO - [client.py:345] - Client ChangeCipherSpec and Finished messages sent
2024-12-31 22:19:13,627 - INFO - [server.py:254] - Pre-master secret validated successfully
2024-12-31 22:19:13,631 - INFO - [server.py:272] - Generated digital signature: cbaee375506cf0b81f82f53a3afe007c7e46ee2add273d5e57eef8dec109325eb764afa4180c2a3632fb48ed3faa82e33e6fbef0e5849595bb063057f7c22260126f26cc4355d7f2f4533de95d3136fddf61f36f6f7608ee1b01c9896f2949f5d048b3f00aa865d9ae7d3dfe68eb669b0506d33d07fd61c97d131877dfcb51d4be23a601c1ebb5203cdd5949deb7b31ade793c8cec54146db67658f72f8031f0ad9dcaac1bb21da8febd06b6f225fa8be23750bb41ee26f21172b4c6ebcfa53a440cbe2e07881372c6975bd2ae132fa05106f11b7788f11eb8a374424bbf143798a10091aa9e79407eccfe3a4ad3c6e7a18d49b34e8b31b16ffb38a4eaf3f026
2024-12-31 22:19:13,634 - INFO - [server.py:309] - Server ChangeCipherSpec and Finished messages sent
2024-12-31 22:19:13,638 - INFO - [keys.py:200] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2024-12-31 22:19:13,640 - INFO - [session.py:104] - TLS Handshake completed successfully
2024-12-31 22:19:13,642 - INFO - [session.py:131] - Found file to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2024-12-31 22:19:13,645 - INFO - [session.py:149] - Handshake completed: True
2024-12-31 22:19:13,646 - INFO - [session.py:150] - Use client cert: True
2024-12-31 22:19:13,648 - INFO - [session.py:151] - File to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2024-12-31 22:19:13,650 - INFO - [session.py:154] - Using encrypted exchange
2024-12-31 22:19:13,651 - INFO - [session.py:169] - Sending encrypted request data
2024-12-31 22:19:13,659 - INFO - [keys.py:180] - TLS Application Data sent from 192.168.1.1:12345 to 10.0.0.1:443
2024-12-31 22:19:13,662 - INFO - [session.py:180] - Sending encrypted response data
2024-12-31 22:19:13,668 - INFO - [keys.py:180] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2024-12-31 22:19:13,670 - INFO - [session.py:192] - Attempting to send file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2024-12-31 22:19:13,673 - INFO - [session.py:203] - Opening file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2024-12-31 22:19:13,678 - INFO - [session.py:210] - Read 1103 bytes from file
2024-12-31 22:19:13,684 - INFO - [keys.py:180] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2024-12-31 22:19:13,686 - INFO - [session.py:219] - File sent successfully
2024-12-31 22:19:13,688 - INFO - [session.py:194] - File sent successfully
2024-12-31 22:19:13,689 - INFO - [main.py:95] - Session completed successfully for 192.168.1.1
2024-12-31 22:19:13,691 - INFO - [main.py:87] - 
--- Client Session (no certificate) ---
2024-12-31 22:19:13,695 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2024-12-31 22:19:13,698 - INFO - [cert.py:108] - File exists: True
2024-12-31 22:19:13,700 - INFO - [cert.py:109] - File size: 1912 bytes
2024-12-31 22:19:13,701 - INFO - [cert.py:113] - Read 1912 bytes
2024-12-31 22:19:13,703 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2024-12-31 22:19:13,706 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2024-12-31 22:19:13,711 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 22:19:13,713 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2024-12-31 22:19:13,716 - INFO - [cert.py:108] - File exists: True
2024-12-31 22:19:13,718 - INFO - [cert.py:109] - File size: 1643 bytes
2024-12-31 22:19:13,721 - INFO - [cert.py:113] - Read 1643 bytes
2024-12-31 22:19:13,723 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2024-12-31 22:19:13,725 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2024-12-31 22:19:13,728 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 22:19:13,778 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2024-12-31 22:19:13,779 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2024-12-31 22:19:13,780 - INFO - [cert.py:215] - Key size: 2048 bits
2024-12-31 22:19:13,780 - INFO - [cert.py:217] - Public exponent: 65537
2024-12-31 22:19:13,781 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2024-12-31 22:19:13,783 - INFO - [verify.py:58] - Public key comparison results:
2024-12-31 22:19:13,783 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2024-12-31 22:19:13,784 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2024-12-31 22:19:13,786 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2024-12-31 22:19:13,786 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2024-12-31 22:19:13,787 - INFO - [verify.py:136] - Certificate chain verification successful
2024-12-31 22:19:13,788 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2024-12-31 22:19:13,788 - INFO - [chain.py:110] - Certificate chain verification passed
2024-12-31 22:19:13,789 - INFO - [chain.py:117] - Certificate chain loaded successfully
2024-12-31 22:19:13,789 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2024-12-31 22:19:13,790 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2024-12-31 22:19:13,791 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2024-12-31 22:19:13,792 - INFO - [session.py:120] - Starting TLS session
2024-12-31 22:19:13,792 - INFO - [client.py:95] - Generated client_random: 677451c1f5c5e97cc3802da649fd8f37151b6c52775a41bccc77ebff1e5c2e76
2024-12-31 22:19:13,795 - INFO - [client.py:135] - Client Hello sent from 192.168.1.2
2024-12-31 22:19:13,800 - INFO - [server.py:93] - Generated server_random: 677451c1bf4f3c048d3df546bb282436af00637959863e965f8de9db7feaeeac
2024-12-31 22:19:13,805 - INFO - [client.py:172] - Prepared empty certificate
2024-12-31 22:19:13,805 - INFO - [client.py:184] - Encrypted pre_master_secret length: 256
2024-12-31 22:19:13,808 - INFO - [chain.py:185] - Decrypted pre_master_secret: 0303e3f821ff675279fd943e79d957fcf19e7da0a4bbf4ee85a0432fcbf9ec165db327848de53c6331e1191cef18e41d
2024-12-31 22:19:13,808 - INFO - [chain.py:195] - Generated master secret: 38be1b9f6a5df01ce41d6787febfef1b79f4b29c086aa9156877223cd36b9fa01997207e15e013c3f5c00991b99ffe90
2024-12-31 22:19:13,809 - INFO - [chain.py:196] - Master secret length: 48 bytes
2024-12-31 22:19:13,810 - INFO - [client.py:345] - Client ChangeCipherSpec and Finished messages sent
2024-12-31 22:19:13,814 - INFO - [server.py:254] - Pre-master secret validated successfully
2024-12-31 22:19:13,817 - INFO - [server.py:272] - Generated digital signature: ac929a14db24f67517fb51aaa8c3e79dd47bb4108aab36d3c564070696e7cfe0fdc8860c92f8520cb635e8672186d60b1f96f4b4e2ac4425f5232ac3a11cbe590cfb8aa928dd5cd49e8a9090cd0b415a36f14d8133a1c36024e18ef9d60ee52b6216e0907b875d190a77aaab2c54a5effa847291c21b65e404bf6084e5afdfa406d71cf7f402993e2a781b8c5492c89824836dc6e793833f2c2ec290e432cc878cacb95ead9fa7ace6cb322cd0f8e91c8cd470c2d9f28ebb4dfadcf145362805a105e6e416cd8b639a4113093d15946c6ff3121aea8375b2d1888717be65bec390ad54d4698403d71e5a099274649be238f8f28d281713a5f7deff4a66e1a281
2024-12-31 22:19:13,819 - INFO - [server.py:309] - Server ChangeCipherSpec and Finished messages sent
2024-12-31 22:19:13,821 - INFO - [keys.py:200] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2024-12-31 22:19:13,821 - INFO - [session.py:104] - TLS Handshake completed successfully
2024-12-31 22:19:13,822 - INFO - [session.py:149] - Handshake completed: True
2024-12-31 22:19:13,822 - INFO - [session.py:150] - Use client cert: False
2024-12-31 22:19:13,822 - INFO - [session.py:151] - File to send: None
2024-12-31 22:19:13,823 - INFO - [session.py:157] - Using unencrypted exchange
2024-12-31 22:19:13,824 - INFO - [session.py:257] - Added request packet
2024-12-31 22:19:13,825 - INFO - [session.py:257] - Added response packet
2024-12-31 22:19:13,825 - WARNING - [session.py:234] - Using unencrypted communication
2024-12-31 22:19:13,826 - INFO - [main.py:95] - Session completed successfully for 192.168.1.2
2024-12-31 22:19:13,826 - INFO - [pcap_writer.py:232] - Packet 13: Valid HTTP message
2024-12-31 22:19:13,827 - INFO - [pcap_writer.py:232] - Packet 14: Valid HTTP message
2024-12-31 22:19:13,836 - INFO - [pcap_writer.py:387] - Saved 15 valid packets to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2024-12-31 22:19:13,837 - INFO - [pcap_writer.py:409] - Verifying 15 packets...
2024-12-31 22:19:13,837 - INFO - [pcap_writer.py:413] - Packet 1: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2024-12-31 22:19:13,838 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2024-12-31 22:19:13,838 - INFO - [pcap_writer.py:413] - Packet 2: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2024-12-31 22:19:13,839 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2775
2024-12-31 22:19:13,839 - INFO - [pcap_writer.py:413] - Packet 3: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2024-12-31 22:19:13,840 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 1646
2024-12-31 22:19:13,840 - INFO - [pcap_writer.py:413] - Packet 4: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2024-12-31 22:19:13,841 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2024-12-31 22:19:13,841 - INFO - [pcap_writer.py:413] - Packet 5: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2024-12-31 22:19:13,842 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2024-12-31 22:19:13,842 - INFO - [pcap_writer.py:413] - Packet 6: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2024-12-31 22:19:13,842 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 165
2024-12-31 22:19:13,843 - INFO - [pcap_writer.py:413] - Packet 7: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2024-12-31 22:19:13,843 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 133
2024-12-31 22:19:13,844 - INFO - [pcap_writer.py:413] - Packet 8: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2024-12-31 22:19:13,844 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 1157
2024-12-31 22:19:13,845 - INFO - [pcap_writer.py:413] - Packet 9: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2024-12-31 22:19:13,846 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2024-12-31 22:19:13,849 - INFO - [pcap_writer.py:413] - Packet 10: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2024-12-31 22:19:13,851 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2775
2024-12-31 22:19:13,852 - INFO - [pcap_writer.py:413] - Packet 11: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2024-12-31 22:19:13,853 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 269
2024-12-31 22:19:13,854 - INFO - [pcap_writer.py:413] - Packet 12: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2024-12-31 22:19:13,854 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2024-12-31 22:19:13,855 - INFO - [pcap_writer.py:413] - Packet 13: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2024-12-31 22:19:13,855 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2024-12-31 22:19:13,856 - INFO - [pcap_writer.py:413] - Packet 14: IP / TCP 192.168.1.2:12346 > 10.0.0.1:http PA / Raw
2024-12-31 22:19:13,856 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2024-12-31 22:19:13,857 - INFO - [pcap_writer.py:413] - Packet 15: IP / TCP 10.0.0.1:http > 192.168.1.2:12346 PA / Raw
2024-12-31 22:19:13,857 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2024-12-31 22:19:13,858 - INFO - [pcap_writer.py:427] - Verification complete: 15 valid packets, 15 TLS records
2024-12-31 22:19:13,858 - INFO - [main.py:106] - Results saved to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2024-12-31 22:19:13,859 - INFO - [main.py:160] - TLS session simulation completed successfully
2024-12-31 22:46:04,156 - INFO - [logging.py:83] - Logging configured successfully
2024-12-31 22:46:04,157 - INFO - [logging.py:90] - === Logging Configuration ===
2024-12-31 22:46:04,158 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2024-12-31 22:46:04,158 - INFO - [logging.py:92] - Log level: 20
2024-12-31 22:46:04,158 - INFO - [logging.py:93] - Timestamp: 2024-12-31T22:46:04.158529
2024-12-31 22:46:04,158 - INFO - [logging.py:94] - ==========================
2024-12-31 22:46:04,159 - INFO - [main.py:122] - Starting TLS session simulation
2024-12-31 22:46:04,159 - INFO - [main.py:87] - 
--- Client Session (certificate) ---
2024-12-31 22:46:04,160 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2024-12-31 22:46:04,161 - INFO - [cert.py:108] - File exists: True
2024-12-31 22:46:04,161 - INFO - [cert.py:109] - File size: 1912 bytes
2024-12-31 22:46:04,162 - INFO - [cert.py:113] - Read 1912 bytes
2024-12-31 22:46:04,162 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2024-12-31 22:46:04,163 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2024-12-31 22:46:04,168 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 22:46:04,169 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2024-12-31 22:46:04,169 - INFO - [cert.py:108] - File exists: True
2024-12-31 22:46:04,170 - INFO - [cert.py:109] - File size: 1643 bytes
2024-12-31 22:46:04,171 - INFO - [cert.py:113] - Read 1643 bytes
2024-12-31 22:46:04,171 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2024-12-31 22:46:04,172 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2024-12-31 22:46:04,173 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 22:46:04,220 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2024-12-31 22:46:04,221 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2024-12-31 22:46:04,221 - INFO - [cert.py:215] - Key size: 2048 bits
2024-12-31 22:46:04,222 - INFO - [cert.py:217] - Public exponent: 65537
2024-12-31 22:46:04,226 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2024-12-31 22:46:04,228 - INFO - [verify.py:58] - Public key comparison results:
2024-12-31 22:46:04,228 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2024-12-31 22:46:04,229 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2024-12-31 22:46:04,230 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2024-12-31 22:46:04,231 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2024-12-31 22:46:04,234 - INFO - [verify.py:136] - Certificate chain verification successful
2024-12-31 22:46:04,235 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2024-12-31 22:46:04,235 - INFO - [chain.py:110] - Certificate chain verification passed
2024-12-31 22:46:04,236 - INFO - [chain.py:117] - Certificate chain loaded successfully
2024-12-31 22:46:04,237 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2024-12-31 22:46:04,238 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2024-12-31 22:46:04,240 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2024-12-31 22:46:04,243 - INFO - [session.py:120] - Starting TLS session
2024-12-31 22:46:04,243 - INFO - [client.py:95] - Generated client_random: 6774580c8337f550f70d3b313179da561ac22f2669ec310e23d1eae70c353f4d
2024-12-31 22:46:04,248 - INFO - [client.py:135] - Client Hello sent from 192.168.1.1
2024-12-31 22:46:04,254 - INFO - [server.py:93] - Generated server_random: 6774580c37e264a6d78be9b6b29062833c5ac6e35264364405038dc951ff8864
2024-12-31 22:46:04,276 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2024-12-31 22:46:04,278 - INFO - [cert.py:108] - File exists: True
2024-12-31 22:46:04,279 - INFO - [cert.py:109] - File size: 1915 bytes
2024-12-31 22:46:04,282 - INFO - [cert.py:113] - Read 1915 bytes
2024-12-31 22:46:04,283 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2024-12-31 22:46:04,284 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2024-12-31 22:46:04,287 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 22:46:04,290 - INFO - [client.py:169] - Prepared client certificate
2024-12-31 22:46:04,293 - INFO - [client.py:184] - Encrypted pre_master_secret length: 256
2024-12-31 22:46:04,301 - INFO - [chain.py:185] - Decrypted pre_master_secret: 030319890f943abfc7f0b102c064834e46e205909f25c9f94a2c238c6b47dfcf47d53a1cd1da2b52510d5d164761bd46
2024-12-31 22:46:04,302 - INFO - [chain.py:195] - Generated master secret: b4b0b9b978a5a76cb39e6a92d7bcfbb9ec67ab45c871a534e2f2417cc6c67e88cbcfbeae01f3c7d50712e9616741452a
2024-12-31 22:46:04,304 - INFO - [chain.py:196] - Master secret length: 48 bytes
2024-12-31 22:46:04,307 - INFO - [client.py:345] - Client ChangeCipherSpec and Finished messages sent
2024-12-31 22:46:04,314 - INFO - [server.py:254] - Pre-master secret validated successfully
2024-12-31 22:46:04,316 - INFO - [server.py:272] - Generated digital signature: 161cbf730260eca4966c72581991e6cb860c320905bbbf4968ec77ee2a9d7b7aa4d73a0286351ee8428e9bedc117270ea22369c07dc2343b6840206ba39944f70e3c89423d117987dd48aaddb4269291918f7646bc6dbd597f067615f6e0de0470fdfc92ccca8e785e1febdd6bf074b28517d39aec557ddf0334450d5c5805992d8e52fc772b46262bb5c77ee9ecc7ecee680e31ec1aac7fdc8650dee45e7dda1b91ed854dbea8c1f3892b98935fd46399fe777ad2706572f9663d2026117d9694c60c1005b0d63fb57191b456cc2bdd8f3c0578cad2781244c75426dda62e6d4958bab7a291708cd9846ba7fc649082372ed9457c6190cf08426713ddcac35e
2024-12-31 22:46:04,319 - INFO - [server.py:309] - Server ChangeCipherSpec and Finished messages sent
2024-12-31 22:46:04,325 - INFO - [keys.py:200] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2024-12-31 22:46:04,326 - INFO - [session.py:104] - TLS Handshake completed successfully
2024-12-31 22:46:04,326 - INFO - [session.py:131] - Found file to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2024-12-31 22:46:04,327 - INFO - [session.py:149] - Handshake completed: True
2024-12-31 22:46:04,328 - INFO - [session.py:150] - Use client cert: True
2024-12-31 22:46:04,328 - INFO - [session.py:151] - File to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2024-12-31 22:46:04,329 - INFO - [session.py:154] - Using encrypted exchange
2024-12-31 22:46:04,329 - INFO - [session.py:169] - Sending encrypted request data
2024-12-31 22:46:04,331 - INFO - [keys.py:180] - TLS Application Data sent from 192.168.1.1:12345 to 10.0.0.1:443
2024-12-31 22:46:04,332 - INFO - [session.py:180] - Sending encrypted response data
2024-12-31 22:46:04,334 - INFO - [keys.py:180] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2024-12-31 22:46:04,334 - INFO - [session.py:192] - Attempting to send file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2024-12-31 22:46:04,335 - INFO - [session.py:203] - Opening file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2024-12-31 22:46:04,338 - INFO - [session.py:210] - Read 1103 bytes from file
2024-12-31 22:46:04,342 - INFO - [keys.py:180] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2024-12-31 22:46:04,343 - INFO - [session.py:219] - File sent successfully
2024-12-31 22:46:04,343 - INFO - [session.py:194] - File sent successfully
2024-12-31 22:46:04,344 - INFO - [main.py:95] - Session completed successfully for 192.168.1.1
2024-12-31 22:46:04,345 - INFO - [main.py:87] - 
--- Client Session (no certificate) ---
2024-12-31 22:46:04,345 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2024-12-31 22:46:04,346 - INFO - [cert.py:108] - File exists: True
2024-12-31 22:46:04,347 - INFO - [cert.py:109] - File size: 1912 bytes
2024-12-31 22:46:04,347 - INFO - [cert.py:113] - Read 1912 bytes
2024-12-31 22:46:04,348 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2024-12-31 22:46:04,348 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2024-12-31 22:46:04,350 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 22:46:04,350 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2024-12-31 22:46:04,351 - INFO - [cert.py:108] - File exists: True
2024-12-31 22:46:04,352 - INFO - [cert.py:109] - File size: 1643 bytes
2024-12-31 22:46:04,353 - INFO - [cert.py:113] - Read 1643 bytes
2024-12-31 22:46:04,353 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2024-12-31 22:46:04,354 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2024-12-31 22:46:04,357 - INFO - [cert.py:130] - Successfully loaded as PEM
2024-12-31 22:46:04,391 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2024-12-31 22:46:04,392 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2024-12-31 22:46:04,393 - INFO - [cert.py:215] - Key size: 2048 bits
2024-12-31 22:46:04,393 - INFO - [cert.py:217] - Public exponent: 65537
2024-12-31 22:46:04,394 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2024-12-31 22:46:04,394 - INFO - [verify.py:58] - Public key comparison results:
2024-12-31 22:46:04,395 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2024-12-31 22:46:04,395 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2024-12-31 22:46:04,396 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2024-12-31 22:46:04,396 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2024-12-31 22:46:04,397 - INFO - [verify.py:136] - Certificate chain verification successful
2024-12-31 22:46:04,397 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2024-12-31 22:46:04,398 - INFO - [chain.py:110] - Certificate chain verification passed
2024-12-31 22:46:04,398 - INFO - [chain.py:117] - Certificate chain loaded successfully
2024-12-31 22:46:04,398 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2024-12-31 22:46:04,399 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2024-12-31 22:46:04,400 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2024-12-31 22:46:04,400 - INFO - [session.py:120] - Starting TLS session
2024-12-31 22:46:04,400 - INFO - [client.py:95] - Generated client_random: 6774580c69a94c481ce779da7e8eaa6d890800e16c4c93d1f9ca610eba2b0b8a
2024-12-31 22:46:04,404 - INFO - [client.py:135] - Client Hello sent from 192.168.1.2
2024-12-31 22:46:04,410 - INFO - [server.py:93] - Generated server_random: 6774580c63ddb8e3be157bc16ee7aa01724d34706e1f2ea92e30a88ee61ab62a
2024-12-31 22:46:04,413 - INFO - [client.py:172] - Prepared empty certificate
2024-12-31 22:46:04,414 - INFO - [client.py:184] - Encrypted pre_master_secret length: 256
2024-12-31 22:46:04,416 - INFO - [chain.py:185] - Decrypted pre_master_secret: 0303ef378ff09e7ef0e73b62e8d9b8f0b69490e78c19afe5ae53ab3ba614dfd17502fc01bd8bf013582392b17917cd35
2024-12-31 22:46:04,416 - INFO - [chain.py:195] - Generated master secret: 9ef245c2f5d6b12511a19d8fc813c5292b749c3496b73b9ecd46237654661374661600954ba89d60f6d755175e63def0
2024-12-31 22:46:04,417 - INFO - [chain.py:196] - Master secret length: 48 bytes
2024-12-31 22:46:04,418 - INFO - [client.py:345] - Client ChangeCipherSpec and Finished messages sent
2024-12-31 22:46:04,421 - INFO - [server.py:254] - Pre-master secret validated successfully
2024-12-31 22:46:04,424 - INFO - [server.py:272] - Generated digital signature: a729cbd7be1a0f3d0985ff2229d6ce58ad7006944c8deca324681b26ce4518be8a390c29f21606925ecad660f61efd74970567b9ec10c1e2044736a4981029d07cfe1d4535ee22cf12390c691f088b3c7255d8ed058b26854c958233bb7b52da9e5c9a78a3232b30184db318041bab3f40a154aa5f06e2ca01dbba4d26091ae85e4518264a7019ad83e8b3f9b1db31e3c5cf17a51ddcce42380c0b3aa24930d3f394dc9e1eb84d048075499c2dbfc36c49e99f4ead88cd3ab7d57f2b2ec1d38405d0ebd4b58f518c62857e5dae2ff1fe5bb856e2c8e905f4633ebb07bdcd6e07d850448b0a814c097cf043b280c75a16c8fb700a25e4053ce01e40995ed4de11
2024-12-31 22:46:04,425 - INFO - [server.py:309] - Server ChangeCipherSpec and Finished messages sent
2024-12-31 22:46:04,427 - INFO - [keys.py:200] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2024-12-31 22:46:04,427 - INFO - [session.py:104] - TLS Handshake completed successfully
2024-12-31 22:46:04,428 - INFO - [session.py:149] - Handshake completed: True
2024-12-31 22:46:04,428 - INFO - [session.py:150] - Use client cert: False
2024-12-31 22:46:04,428 - INFO - [session.py:151] - File to send: None
2024-12-31 22:46:04,428 - INFO - [session.py:157] - Using unencrypted exchange
2024-12-31 22:46:04,429 - INFO - [session.py:257] - Added request packet
2024-12-31 22:46:04,429 - INFO - [session.py:257] - Added response packet
2024-12-31 22:46:04,430 - WARNING - [session.py:234] - Using unencrypted communication
2024-12-31 22:46:04,430 - INFO - [main.py:95] - Session completed successfully for 192.168.1.2
2024-12-31 22:46:04,430 - INFO - [pcap_writer.py:232] - Packet 13: Valid HTTP message
2024-12-31 22:46:04,431 - INFO - [pcap_writer.py:232] - Packet 14: Valid HTTP message
2024-12-31 22:46:04,436 - INFO - [pcap_writer.py:387] - Saved 15 valid packets to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2024-12-31 22:46:04,437 - INFO - [pcap_writer.py:409] - Verifying 15 packets...
2024-12-31 22:46:04,438 - INFO - [pcap_writer.py:413] - Packet 1: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2024-12-31 22:46:04,439 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2024-12-31 22:46:04,440 - INFO - [pcap_writer.py:413] - Packet 2: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2024-12-31 22:46:04,441 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2775
2024-12-31 22:46:04,441 - INFO - [pcap_writer.py:413] - Packet 3: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2024-12-31 22:46:04,442 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 1646
2024-12-31 22:46:04,442 - INFO - [pcap_writer.py:413] - Packet 4: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2024-12-31 22:46:04,443 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2024-12-31 22:46:04,443 - INFO - [pcap_writer.py:413] - Packet 5: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2024-12-31 22:46:04,443 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2024-12-31 22:46:04,444 - INFO - [pcap_writer.py:413] - Packet 6: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2024-12-31 22:46:04,444 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 165
2024-12-31 22:46:04,444 - INFO - [pcap_writer.py:413] - Packet 7: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2024-12-31 22:46:04,445 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 133
2024-12-31 22:46:04,445 - INFO - [pcap_writer.py:413] - Packet 8: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2024-12-31 22:46:04,445 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 1157
2024-12-31 22:46:04,445 - INFO - [pcap_writer.py:413] - Packet 9: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2024-12-31 22:46:04,446 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2024-12-31 22:46:04,446 - INFO - [pcap_writer.py:413] - Packet 10: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2024-12-31 22:46:04,446 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2775
2024-12-31 22:46:04,447 - INFO - [pcap_writer.py:413] - Packet 11: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2024-12-31 22:46:04,447 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 269
2024-12-31 22:46:04,447 - INFO - [pcap_writer.py:413] - Packet 12: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2024-12-31 22:46:04,448 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2024-12-31 22:46:04,448 - INFO - [pcap_writer.py:413] - Packet 13: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2024-12-31 22:46:04,448 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2024-12-31 22:46:04,449 - INFO - [pcap_writer.py:413] - Packet 14: IP / TCP 192.168.1.2:12346 > 10.0.0.1:http PA / Raw
2024-12-31 22:46:04,449 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2024-12-31 22:46:04,449 - INFO - [pcap_writer.py:413] - Packet 15: IP / TCP 10.0.0.1:http > 192.168.1.2:12346 PA / Raw
2024-12-31 22:46:04,450 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2024-12-31 22:46:04,450 - INFO - [pcap_writer.py:427] - Verification complete: 15 valid packets, 15 TLS records
2024-12-31 22:46:04,450 - INFO - [main.py:106] - Results saved to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2024-12-31 22:46:04,450 - INFO - [main.py:160] - TLS session simulation completed successfully
2025-01-01 00:10:58,094 - INFO - [logging.py:83] - Logging configured successfully
2025-01-01 00:10:58,097 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-01 00:10:58,098 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-01 00:10:58,099 - INFO - [logging.py:92] - Log level: 20
2025-01-01 00:10:58,099 - INFO - [logging.py:93] - Timestamp: 2025-01-01T00:10:58.099892
2025-01-01 00:10:58,100 - INFO - [logging.py:94] - ==========================
2025-01-01 00:10:58,101 - INFO - [main.py:122] - Starting TLS session simulation
2025-01-01 00:10:58,102 - INFO - [main.py:87] - 
--- Client Session (certificate) ---
2025-01-01 00:10:58,106 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-01 00:10:58,107 - INFO - [cert.py:108] - File exists: True
2025-01-01 00:10:58,108 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-01 00:10:58,110 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-01 00:10:58,111 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-01 00:10:58,113 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-01 00:10:58,126 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 00:10:58,127 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-01 00:10:58,128 - INFO - [cert.py:108] - File exists: True
2025-01-01 00:10:58,129 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-01 00:10:58,131 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-01 00:10:58,132 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-01 00:10:58,134 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-01 00:10:58,136 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 00:10:58,207 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-01 00:10:58,208 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-01 00:10:58,208 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-01 00:10:58,209 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-01 00:10:58,212 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-01 00:10:58,212 - INFO - [verify.py:58] - Public key comparison results:
2025-01-01 00:10:58,213 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 00:10:58,213 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 00:10:58,214 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-01 00:10:58,214 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-01 00:10:58,224 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-01 00:10:58,226 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-01 00:10:58,228 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-01 00:10:58,228 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-01 00:10:58,229 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-01 00:10:58,229 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-01 00:10:58,230 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-01 00:10:58,231 - INFO - [session.py:120] - Starting TLS session
2025-01-01 00:10:58,231 - INFO - [client.py:95] - Generated client_random: 67746bf21c0d5b414be71cb59b7decbd6275fcecf4b48531db4102f0dd256a01
2025-01-01 00:10:58,233 - INFO - [client.py:135] - Client Hello sent from 192.168.1.1
2025-01-01 00:10:58,235 - INFO - [server.py:93] - Generated server_random: 67746bf2aeccc1618f52ab22c92d7c2ba2c9aad94e5f840296a8585c6aff8917
2025-01-01 00:10:58,240 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2025-01-01 00:10:58,241 - INFO - [cert.py:108] - File exists: True
2025-01-01 00:10:58,242 - INFO - [cert.py:109] - File size: 1915 bytes
2025-01-01 00:10:58,245 - INFO - [cert.py:113] - Read 1915 bytes
2025-01-01 00:10:58,245 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2025-01-01 00:10:58,246 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2025-01-01 00:10:58,248 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 00:10:58,248 - INFO - [client.py:169] - Prepared client certificate
2025-01-01 00:10:58,249 - INFO - [client.py:184] - Encrypted pre_master_secret length: 256
2025-01-01 00:10:58,253 - INFO - [chain.py:185] - Decrypted pre_master_secret: 0303217ff8fe2180a40f6af9e4ae2e27b443535eaf1a1c1742e761cf4677ae9cf8c5d4c486f0e8230b414188e8b19a2a
2025-01-01 00:10:58,254 - INFO - [chain.py:195] - Generated master secret: 69f06949e823d81faee639b7ee7c3e5395924520fdf19d279158891606237ec68cc58173221e81236f0fbefb2b6ede59
2025-01-01 00:10:58,254 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-01 00:10:58,255 - INFO - [client.py:274] - Client ChangeCipherSpec and Finished messages sent
2025-01-01 00:10:58,258 - INFO - [server.py:254] - Pre-master secret validated successfully
2025-01-01 00:10:58,259 - INFO - [server.py:272] - Generated digital signature: 21f8f696ac9bd2975aa742c9236a38b11e33d46a92db631d0eb70a07342f2505f2b1d6872efaa3dfe333c7662f3f55924f41bab207630dd2f7d59cd7bf1398ec69995d13700d43c517b9a30723026c108306020905997457c1b33be63e542856854fea34790fd0dc29bef915aa3609a56aa360827abd8753844def10ec7e8b9e3b55a01bfd2076f82857e4992fd9bf9fed80771ad71f782583b347560da35418ff1b28ed9282f5304d30810bab29b7496c83435cc52cc382236de3e224faea4410bdcb1f5952413fc18977122e4dbdf5b6120288681f625f646ef164ed41c3d109dac21866e349d91331695c95135bfff6678c774a6153aecbd700f1fc42f791
2025-01-01 00:10:58,261 - INFO - [server.py:309] - Server ChangeCipherSpec and Finished messages sent
2025-01-01 00:10:58,265 - INFO - [keys.py:200] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-01 00:10:58,266 - INFO - [session.py:104] - TLS Handshake completed successfully
2025-01-01 00:10:58,268 - INFO - [session.py:131] - Found file to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 00:10:58,269 - INFO - [session.py:149] - Handshake completed: True
2025-01-01 00:10:58,270 - INFO - [session.py:150] - Use client cert: True
2025-01-01 00:10:58,271 - INFO - [session.py:151] - File to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 00:10:58,272 - INFO - [session.py:154] - Using encrypted exchange
2025-01-01 00:10:58,272 - INFO - [session.py:169] - Sending encrypted request data
2025-01-01 00:10:58,275 - INFO - [keys.py:180] - TLS Application Data sent from 192.168.1.1:12345 to 10.0.0.1:443
2025-01-01 00:10:58,276 - INFO - [session.py:180] - Sending encrypted response data
2025-01-01 00:10:58,277 - INFO - [keys.py:180] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-01 00:10:58,278 - INFO - [session.py:192] - Attempting to send file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 00:10:58,279 - INFO - [session.py:203] - Opening file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 00:10:58,281 - INFO - [session.py:210] - Read 1103 bytes from file
2025-01-01 00:10:58,286 - INFO - [keys.py:180] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-01 00:10:58,288 - INFO - [session.py:219] - File sent successfully
2025-01-01 00:10:58,289 - INFO - [session.py:194] - File sent successfully
2025-01-01 00:10:58,289 - INFO - [main.py:95] - Session completed successfully for 192.168.1.1
2025-01-01 00:10:58,290 - INFO - [main.py:87] - 
--- Client Session (no certificate) ---
2025-01-01 00:10:58,290 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-01 00:10:58,291 - INFO - [cert.py:108] - File exists: True
2025-01-01 00:10:58,292 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-01 00:10:58,292 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-01 00:10:58,293 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-01 00:10:58,293 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-01 00:10:58,295 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 00:10:58,296 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-01 00:10:58,297 - INFO - [cert.py:108] - File exists: True
2025-01-01 00:10:58,298 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-01 00:10:58,299 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-01 00:10:58,299 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-01 00:10:58,300 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-01 00:10:58,302 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 00:10:58,340 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-01 00:10:58,341 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-01 00:10:58,341 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-01 00:10:58,341 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-01 00:10:58,342 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-01 00:10:58,342 - INFO - [verify.py:58] - Public key comparison results:
2025-01-01 00:10:58,342 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 00:10:58,343 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 00:10:58,343 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-01 00:10:58,344 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-01 00:10:58,344 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-01 00:10:58,344 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-01 00:10:58,345 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-01 00:10:58,345 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-01 00:10:58,345 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-01 00:10:58,345 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-01 00:10:58,346 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-01 00:10:58,346 - INFO - [session.py:120] - Starting TLS session
2025-01-01 00:10:58,347 - INFO - [client.py:95] - Generated client_random: 67746bf29b4fe56242d6b2391b4689ce45d52262ed41f7085d75ec3178ddde2c
2025-01-01 00:10:58,350 - INFO - [client.py:135] - Client Hello sent from 192.168.1.2
2025-01-01 00:10:58,353 - INFO - [server.py:93] - Generated server_random: 67746bf26ce3b47bd2a581e4e42736c8fc22f97dea2e6a3c77bf2ae711e2b87c
2025-01-01 00:10:58,357 - INFO - [client.py:172] - Prepared empty certificate
2025-01-01 00:10:58,358 - INFO - [client.py:184] - Encrypted pre_master_secret length: 256
2025-01-01 00:10:58,361 - INFO - [chain.py:185] - Decrypted pre_master_secret: 0303ec2169ea707737943b2a310b6a06c0d1ac9719fb46825d67dc466d95ac34f83b9bfeaf5ecfe59808e2b8e66a42b1
2025-01-01 00:10:58,361 - INFO - [chain.py:195] - Generated master secret: b133795e882d959407ff0d1dff7bf46e8bfb2d7c39c07ad9552beb29042ffe8441fc24e365f621e4e9876e4805c34a46
2025-01-01 00:10:58,361 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-01 00:10:58,363 - INFO - [client.py:274] - Client ChangeCipherSpec and Finished messages sent
2025-01-01 00:10:58,364 - INFO - [server.py:254] - Pre-master secret validated successfully
2025-01-01 00:10:58,365 - INFO - [server.py:272] - Generated digital signature: 6af0109fe88abc185d4556164b3dccd085c89bff284f4445027f1c7910628ab8ee179a3fa438bab181a2d6982273bd025b33b1caec3f0ae6ba7e443fcf7000feb4cf9acd8be966d23a38a1ef9abfa999594154813caaa71c1ec8a8724aa03a700aa17ee7a2be4e145ead27170d71fd35a32cccfcbd33559d88e2edfc2fbc94b961c41d475f19abcd751db24918a5982433e2f7228e8eaff23ec45c810a7a178918959f99fb56b2fbc0835c38f058133fa037bd20c264bf66e527e1ad228237c7e54f5aa525709319abc9d8aa798f2068720d106b7ff59e4988626553b40c07ec27e44035d6e66aae5d5ddc820834e0d46816316feb787f65e01b2cb82081b6a0
2025-01-01 00:10:58,367 - INFO - [server.py:309] - Server ChangeCipherSpec and Finished messages sent
2025-01-01 00:10:58,369 - INFO - [keys.py:200] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-01 00:10:58,370 - INFO - [session.py:104] - TLS Handshake completed successfully
2025-01-01 00:10:58,370 - INFO - [session.py:149] - Handshake completed: True
2025-01-01 00:10:58,371 - INFO - [session.py:150] - Use client cert: False
2025-01-01 00:10:58,371 - INFO - [session.py:151] - File to send: None
2025-01-01 00:10:58,371 - INFO - [session.py:157] - Using unencrypted exchange
2025-01-01 00:10:58,373 - INFO - [session.py:257] - Added request packet
2025-01-01 00:10:58,373 - INFO - [session.py:257] - Added response packet
2025-01-01 00:10:58,374 - WARNING - [session.py:234] - Using unencrypted communication
2025-01-01 00:10:58,374 - INFO - [main.py:95] - Session completed successfully for 192.168.1.2
2025-01-01 00:10:58,375 - INFO - [pcap_writer.py:232] - Packet 13: Valid HTTP message
2025-01-01 00:10:58,375 - INFO - [pcap_writer.py:232] - Packet 14: Valid HTTP message
2025-01-01 00:10:58,381 - INFO - [pcap_writer.py:387] - Saved 15 valid packets to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-01 00:10:58,382 - INFO - [pcap_writer.py:409] - Verifying 15 packets...
2025-01-01 00:10:58,382 - INFO - [pcap_writer.py:413] - Packet 1: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 00:10:58,382 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2025-01-01 00:10:58,383 - INFO - [pcap_writer.py:413] - Packet 2: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 00:10:58,384 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2775
2025-01-01 00:10:58,384 - INFO - [pcap_writer.py:413] - Packet 3: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 00:10:58,385 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 1646
2025-01-01 00:10:58,385 - INFO - [pcap_writer.py:413] - Packet 4: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 00:10:58,385 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2025-01-01 00:10:58,386 - INFO - [pcap_writer.py:413] - Packet 5: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 00:10:58,386 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2025-01-01 00:10:58,387 - INFO - [pcap_writer.py:413] - Packet 6: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 00:10:58,387 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 165
2025-01-01 00:10:58,388 - INFO - [pcap_writer.py:413] - Packet 7: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 00:10:58,388 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 133
2025-01-01 00:10:58,388 - INFO - [pcap_writer.py:413] - Packet 8: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 00:10:58,389 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 1157
2025-01-01 00:10:58,389 - INFO - [pcap_writer.py:413] - Packet 9: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-01 00:10:58,389 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2025-01-01 00:10:58,389 - INFO - [pcap_writer.py:413] - Packet 10: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-01 00:10:58,390 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2775
2025-01-01 00:10:58,390 - INFO - [pcap_writer.py:413] - Packet 11: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-01 00:10:58,391 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 269
2025-01-01 00:10:58,391 - INFO - [pcap_writer.py:413] - Packet 12: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-01 00:10:58,392 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2025-01-01 00:10:58,392 - INFO - [pcap_writer.py:413] - Packet 13: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-01 00:10:58,392 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2025-01-01 00:10:58,393 - INFO - [pcap_writer.py:413] - Packet 14: IP / TCP 192.168.1.2:12346 > 10.0.0.1:http PA / Raw
2025-01-01 00:10:58,393 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2025-01-01 00:10:58,393 - INFO - [pcap_writer.py:413] - Packet 15: IP / TCP 10.0.0.1:http > 192.168.1.2:12346 PA / Raw
2025-01-01 00:10:58,393 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2025-01-01 00:10:58,394 - INFO - [pcap_writer.py:427] - Verification complete: 15 valid packets, 15 TLS records
2025-01-01 00:10:58,394 - INFO - [main.py:106] - Results saved to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-01 00:10:58,394 - INFO - [main.py:160] - TLS session simulation completed successfully
2025-01-01 00:18:36,427 - INFO - [logging.py:83] - Logging configured successfully
2025-01-01 00:18:36,429 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-01 00:18:36,430 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-01 00:18:36,431 - INFO - [logging.py:92] - Log level: 20
2025-01-01 00:18:36,432 - INFO - [logging.py:93] - Timestamp: 2025-01-01T00:18:36.432055
2025-01-01 00:18:36,432 - INFO - [logging.py:94] - ==========================
2025-01-01 00:18:36,433 - INFO - [main.py:122] - Starting TLS session simulation
2025-01-01 00:18:36,434 - INFO - [main.py:87] - 
--- Client Session (certificate) ---
2025-01-01 00:18:36,437 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-01 00:18:36,438 - INFO - [cert.py:108] - File exists: True
2025-01-01 00:18:36,439 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-01 00:18:36,440 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-01 00:18:36,441 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-01 00:18:36,442 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-01 00:18:36,449 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 00:18:36,450 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-01 00:18:36,451 - INFO - [cert.py:108] - File exists: True
2025-01-01 00:18:36,452 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-01 00:18:36,454 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-01 00:18:36,454 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-01 00:18:36,455 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-01 00:18:36,457 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 00:18:36,511 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-01 00:18:36,512 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-01 00:18:36,513 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-01 00:18:36,514 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-01 00:18:36,519 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-01 00:18:36,520 - INFO - [verify.py:58] - Public key comparison results:
2025-01-01 00:18:36,521 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 00:18:36,523 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 00:18:36,525 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-01 00:18:36,525 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-01 00:18:36,531 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-01 00:18:36,532 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-01 00:18:36,533 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-01 00:18:36,534 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-01 00:18:36,534 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-01 00:18:36,536 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-01 00:18:36,538 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-01 00:18:36,539 - INFO - [session.py:120] - Starting TLS session
2025-01-01 00:18:36,539 - INFO - [client.py:95] - Generated client_random: 67746dbc3de129daf3460c963758c0a15058d153530647a8033d000c73886f20
2025-01-01 00:18:36,549 - INFO - [client.py:135] - Client Hello sent from 192.168.1.1
2025-01-01 00:18:36,553 - INFO - [server.py:93] - Generated server_random: 67746dbc2bd690c0ffdfe64127d18064ac60cdc26adf961f8ad5deaea764cb51
2025-01-01 00:18:36,562 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2025-01-01 00:18:36,563 - INFO - [cert.py:108] - File exists: True
2025-01-01 00:18:36,563 - INFO - [cert.py:109] - File size: 1915 bytes
2025-01-01 00:18:36,565 - INFO - [cert.py:113] - Read 1915 bytes
2025-01-01 00:18:36,565 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2025-01-01 00:18:36,565 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2025-01-01 00:18:36,566 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 00:18:36,567 - INFO - [client.py:169] - Prepared client certificate
2025-01-01 00:18:36,568 - INFO - [client.py:184] - Encrypted pre_master_secret length: 256
2025-01-01 00:18:36,572 - INFO - [chain.py:185] - Decrypted pre_master_secret: 0303ebebd5bf1681e63d19584508f2d2345a5b531f0eeaa3bdb44c3a5efcf07ab15ebf1c490ec3ac683a3254b99cdcbb
2025-01-01 00:18:36,573 - INFO - [chain.py:195] - Generated master secret: 7ff904f0fd40a291850ce0cf8daf235b5e6bfe1c87496571fd13e770d820907ef23509884e9abb893ac7f01ca444c3b6
2025-01-01 00:18:36,574 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-01 00:18:36,576 - INFO - [client.py:274] - Client ChangeCipherSpec and Finished messages sent
2025-01-01 00:18:36,578 - INFO - [server.py:254] - Pre-master secret validated successfully
2025-01-01 00:18:36,580 - INFO - [server.py:272] - Generated digital signature: a37f909c311eb55bba8bd1b1181496fbbef7f60c0a56ebf0109e231c980c056865b501a4fe42c07c9110941e0f4d7a170f2b6cea147a4bedd49930bf53cf2b05c22e91a85bd1ba08f03bbbdbc960f94e97104afa721775f6508635de32829104802b8d1334e290e3ef2a641f86e96f815e29bc0cc42871abd5b7cf75f34be15d8dc0e04b235be54761770878c815ced613122e93c4618a1a876001207dce80bb8bbdb2f15defc8ff3d7fd496cf3719812926bbe90fabaec80ce6d87b2b1d41636f97fae7c7f03b5a13d18528d6145ec20086907ee7621bc924cb1e3ed6d9e819312c9bad42dd6e95eb0909b670a2d83f7c51c59dbd00747fcfe9bcd3ca2890b7
2025-01-01 00:18:36,582 - INFO - [server.py:309] - Server ChangeCipherSpec and Finished messages sent
2025-01-01 00:18:36,585 - INFO - [keys.py:200] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-01 00:18:36,586 - INFO - [session.py:104] - TLS Handshake completed successfully
2025-01-01 00:18:36,587 - INFO - [session.py:131] - Found file to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 00:18:36,588 - INFO - [session.py:149] - Handshake completed: True
2025-01-01 00:18:36,589 - INFO - [session.py:150] - Use client cert: True
2025-01-01 00:18:36,590 - INFO - [session.py:151] - File to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 00:18:36,591 - INFO - [session.py:154] - Using encrypted exchange
2025-01-01 00:18:36,592 - INFO - [session.py:169] - Sending encrypted request data
2025-01-01 00:18:36,596 - INFO - [keys.py:180] - TLS Application Data sent from 192.168.1.1:12345 to 10.0.0.1:443
2025-01-01 00:18:36,597 - INFO - [session.py:180] - Sending encrypted response data
2025-01-01 00:18:36,599 - INFO - [keys.py:180] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-01 00:18:36,600 - INFO - [session.py:192] - Attempting to send file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 00:18:36,601 - INFO - [session.py:203] - Opening file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 00:18:36,603 - INFO - [session.py:210] - Read 1103 bytes from file
2025-01-01 00:18:36,605 - INFO - [keys.py:180] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-01 00:18:36,607 - INFO - [session.py:219] - File sent successfully
2025-01-01 00:18:36,608 - INFO - [session.py:194] - File sent successfully
2025-01-01 00:18:36,608 - INFO - [main.py:95] - Session completed successfully for 192.168.1.1
2025-01-01 00:18:36,609 - INFO - [main.py:87] - 
--- Client Session (no certificate) ---
2025-01-01 00:18:36,610 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-01 00:18:36,610 - INFO - [cert.py:108] - File exists: True
2025-01-01 00:18:36,611 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-01 00:18:36,612 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-01 00:18:36,612 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-01 00:18:36,614 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-01 00:18:36,615 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 00:18:36,616 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-01 00:18:36,617 - INFO - [cert.py:108] - File exists: True
2025-01-01 00:18:36,617 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-01 00:18:36,618 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-01 00:18:36,619 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-01 00:18:36,620 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-01 00:18:36,622 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 00:18:36,674 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-01 00:18:36,674 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-01 00:18:36,674 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-01 00:18:36,675 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-01 00:18:36,675 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-01 00:18:36,675 - INFO - [verify.py:58] - Public key comparison results:
2025-01-01 00:18:36,676 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 00:18:36,676 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 00:18:36,677 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-01 00:18:36,677 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-01 00:18:36,677 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-01 00:18:36,678 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-01 00:18:36,678 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-01 00:18:36,678 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-01 00:18:36,678 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-01 00:18:36,679 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-01 00:18:36,680 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-01 00:18:36,680 - INFO - [session.py:120] - Starting TLS session
2025-01-01 00:18:36,680 - INFO - [client.py:95] - Generated client_random: 67746dbcf37ac191939dda448b15f2536503f4446103c8bfbfeb5042c6e309bd
2025-01-01 00:18:36,682 - INFO - [client.py:135] - Client Hello sent from 192.168.1.2
2025-01-01 00:18:36,684 - INFO - [server.py:93] - Generated server_random: 67746dbc1dc9b9a9e6f1ee323706a12d07586e2dda4c85f0e300dcd3a3702cc8
2025-01-01 00:18:36,690 - INFO - [client.py:172] - Prepared empty certificate
2025-01-01 00:18:36,691 - INFO - [client.py:184] - Encrypted pre_master_secret length: 256
2025-01-01 00:18:36,693 - INFO - [chain.py:185] - Decrypted pre_master_secret: 0303f1914c4e7ae4aac7479fd2d48219a493e75bf0341f28ced07f942bcc3d7daff3120092f3cbb3941eac31685272fd
2025-01-01 00:18:36,693 - INFO - [chain.py:195] - Generated master secret: f909e17fc60b7490a3a3bb97a86dc55d2c2daf388566e6bd79627dcba8617ffcbecee04c040681364dd613ab1aa394f0
2025-01-01 00:18:36,694 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-01 00:18:36,694 - INFO - [client.py:274] - Client ChangeCipherSpec and Finished messages sent
2025-01-01 00:18:36,696 - INFO - [server.py:254] - Pre-master secret validated successfully
2025-01-01 00:18:36,697 - INFO - [server.py:272] - Generated digital signature: 249b382eb3d0ad177293ae0276d652fc6f8715a665cd2d894e5132dd4bbfcf84942e74d9d1f77a6ee1d05f62a8a38b4cf5a580024d211151052dd19374148d17fc0f5194775a467601a7254f81462b0a0db1b372ce70f0d1c1c040323da8593dd875c90ae206853494da28a5df26fe5843d21b43f79668d1367b1ea838d60c3256ea3d0a19c2057139a2ff20f457e86985eac99f4e4ba72caf8a7db350ce4f59ab012c6e1cab6b27e9eff2b97ecd932a6cfa9b57d1d9b668a57e15d540e972d2bc743f21583b403d1cbe24f6606eacbe76db639c4b0b9a0de715cb5d9cc01a3e2259e4cdde1c70fad5011ac2eaa28a18f2505aac0d5944a485b4d00cb1999a10
2025-01-01 00:18:36,698 - INFO - [server.py:309] - Server ChangeCipherSpec and Finished messages sent
2025-01-01 00:18:36,700 - INFO - [keys.py:200] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-01 00:18:36,700 - INFO - [session.py:104] - TLS Handshake completed successfully
2025-01-01 00:18:36,700 - INFO - [session.py:149] - Handshake completed: True
2025-01-01 00:18:36,701 - INFO - [session.py:150] - Use client cert: False
2025-01-01 00:18:36,701 - INFO - [session.py:151] - File to send: None
2025-01-01 00:18:36,702 - INFO - [session.py:157] - Using unencrypted exchange
2025-01-01 00:18:36,702 - INFO - [session.py:257] - Added request packet
2025-01-01 00:18:36,703 - INFO - [session.py:257] - Added response packet
2025-01-01 00:18:36,704 - WARNING - [session.py:234] - Using unencrypted communication
2025-01-01 00:18:36,704 - INFO - [main.py:95] - Session completed successfully for 192.168.1.2
2025-01-01 00:18:36,706 - INFO - [pcap_writer.py:232] - Packet 13: Valid HTTP message
2025-01-01 00:18:36,706 - INFO - [pcap_writer.py:232] - Packet 14: Valid HTTP message
2025-01-01 00:18:36,713 - INFO - [pcap_writer.py:387] - Saved 15 valid packets to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-01 00:18:36,714 - INFO - [pcap_writer.py:409] - Verifying 15 packets...
2025-01-01 00:18:36,715 - INFO - [pcap_writer.py:413] - Packet 1: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 00:18:36,716 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2025-01-01 00:18:36,716 - INFO - [pcap_writer.py:413] - Packet 2: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 00:18:36,717 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2775
2025-01-01 00:18:36,717 - INFO - [pcap_writer.py:413] - Packet 3: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 00:18:36,717 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 1646
2025-01-01 00:18:36,718 - INFO - [pcap_writer.py:413] - Packet 4: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 00:18:36,718 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2025-01-01 00:18:36,719 - INFO - [pcap_writer.py:413] - Packet 5: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 00:18:36,720 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2025-01-01 00:18:36,720 - INFO - [pcap_writer.py:413] - Packet 6: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 00:18:36,721 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 160
2025-01-01 00:18:36,721 - INFO - [pcap_writer.py:413] - Packet 7: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 00:18:36,722 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 128
2025-01-01 00:18:36,723 - INFO - [pcap_writer.py:413] - Packet 8: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 00:18:36,723 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 1152
2025-01-01 00:18:36,724 - INFO - [pcap_writer.py:413] - Packet 9: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-01 00:18:36,724 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2025-01-01 00:18:36,725 - INFO - [pcap_writer.py:413] - Packet 10: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-01 00:18:36,725 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2775
2025-01-01 00:18:36,726 - INFO - [pcap_writer.py:413] - Packet 11: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-01 00:18:36,726 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 269
2025-01-01 00:18:36,727 - INFO - [pcap_writer.py:413] - Packet 12: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-01 00:18:36,727 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2025-01-01 00:18:36,728 - INFO - [pcap_writer.py:413] - Packet 13: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-01 00:18:36,728 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2025-01-01 00:18:36,728 - INFO - [pcap_writer.py:413] - Packet 14: IP / TCP 192.168.1.2:12346 > 10.0.0.1:http PA / Raw
2025-01-01 00:18:36,729 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2025-01-01 00:18:36,729 - INFO - [pcap_writer.py:413] - Packet 15: IP / TCP 10.0.0.1:http > 192.168.1.2:12346 PA / Raw
2025-01-01 00:18:36,730 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2025-01-01 00:18:36,730 - INFO - [pcap_writer.py:427] - Verification complete: 15 valid packets, 15 TLS records
2025-01-01 00:18:36,731 - INFO - [main.py:106] - Results saved to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-01 00:18:36,731 - INFO - [main.py:160] - TLS session simulation completed successfully
2025-01-01 00:26:16,270 - INFO - [logging.py:83] - Logging configured successfully
2025-01-01 00:26:16,272 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-01 00:26:16,272 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-01 00:26:16,273 - INFO - [logging.py:92] - Log level: 20
2025-01-01 00:26:16,274 - INFO - [logging.py:93] - Timestamp: 2025-01-01T00:26:16.273955
2025-01-01 00:26:16,274 - INFO - [logging.py:94] - ==========================
2025-01-01 00:26:16,274 - INFO - [main.py:122] - Starting TLS session simulation
2025-01-01 00:26:16,275 - INFO - [main.py:87] - 
--- Client Session (certificate) ---
2025-01-01 00:26:16,277 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-01 00:26:16,277 - INFO - [cert.py:108] - File exists: True
2025-01-01 00:26:16,278 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-01 00:26:16,279 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-01 00:26:16,280 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-01 00:26:16,281 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-01 00:26:16,283 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 00:26:16,284 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-01 00:26:16,285 - INFO - [cert.py:108] - File exists: True
2025-01-01 00:26:16,285 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-01 00:26:16,286 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-01 00:26:16,287 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-01 00:26:16,288 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-01 00:26:16,290 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 00:26:16,330 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-01 00:26:16,330 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-01 00:26:16,330 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-01 00:26:16,331 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-01 00:26:16,332 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-01 00:26:16,333 - INFO - [verify.py:58] - Public key comparison results:
2025-01-01 00:26:16,333 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 00:26:16,333 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 00:26:16,334 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-01 00:26:16,334 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-01 00:26:16,338 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-01 00:26:16,340 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-01 00:26:16,340 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-01 00:26:16,341 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-01 00:26:16,342 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-01 00:26:16,343 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-01 00:26:16,344 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-01 00:26:16,345 - INFO - [session.py:120] - Starting TLS session
2025-01-01 00:26:16,345 - INFO - [client.py:95] - Generated client_random: 67746f88b2393ee227ab826bf04f19a8bd199a333fb46539b0a61a8b196142b9
2025-01-01 00:26:16,348 - INFO - [client.py:135] - Client Hello sent from 192.168.1.1
2025-01-01 00:26:16,350 - INFO - [server.py:93] - Generated server_random: 67746f88b8f9853dbc0074d3a9df3900a84274cdeb378cc7faf6e0f81b1d27a8
2025-01-01 00:26:16,356 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2025-01-01 00:26:16,357 - INFO - [cert.py:108] - File exists: True
2025-01-01 00:26:16,358 - INFO - [cert.py:109] - File size: 1915 bytes
2025-01-01 00:26:16,359 - INFO - [cert.py:113] - Read 1915 bytes
2025-01-01 00:26:16,360 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2025-01-01 00:26:16,360 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2025-01-01 00:26:16,361 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 00:26:16,362 - INFO - [client.py:169] - Prepared client certificate
2025-01-01 00:26:16,363 - INFO - [client.py:184] - Encrypted pre_master_secret length: 256
2025-01-01 00:26:16,366 - INFO - [chain.py:185] - Decrypted pre_master_secret: 0303b6cd6890aeefcf9209f8a00b1a4f2a79eac9c155c0e6c95af538eaee94b7cf4503f3fb119681049629a2e43065ca
2025-01-01 00:26:16,366 - INFO - [chain.py:195] - Generated master secret: b442dfa3b1c344516b1429434391d48181205d8d5f45cc2dd7083bad53135c32dd2c9e3d63ad62cd0e19f6b73b14fdda
2025-01-01 00:26:16,367 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-01 00:26:16,368 - INFO - [client.py:274] - Client ChangeCipherSpec and Finished messages sent
2025-01-01 00:26:16,370 - INFO - [server.py:254] - Pre-master secret validated successfully
2025-01-01 00:26:16,373 - INFO - [server.py:272] - Generated digital signature: 985a4dde9e3ad938812d0f72422fd2dfb0ecb06e4e126c7ea73de8b0a6712b5d8ae417b3b449e16b713a4cd1641b17c302895245fcf8a479e2bc55d8c6e2e7d7eca2bb07943d16280dd52c946cf4078a43976a60cc39a3d700792837684992c669e1759d0cb48a9cfa9e666c43d542a40c7cecb63a1d369496c675e263a700ab59c6003bf482c123fc9a2158f33c7431c2dfca61622ffcbe74cc8aa487483c65f9ee1d24a0e9b65f981fd8413331c11e76ebaebb350eceb66323c4c92fe0d9280a86d602e70f7d9aae6344df15a94df770c21d0eb13f7f8f6fdb3631b847563194afe94c8d86ba5cf2cd4e4ecd1799ad425911d38e20a48607f6bcb6470637fc
2025-01-01 00:26:16,378 - INFO - [server.py:309] - Server ChangeCipherSpec and Finished messages sent
2025-01-01 00:26:16,384 - INFO - [keys.py:205] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-01 00:26:16,386 - INFO - [session.py:104] - TLS Handshake completed successfully
2025-01-01 00:26:16,388 - INFO - [session.py:131] - Found file to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 00:26:16,391 - INFO - [session.py:149] - Handshake completed: True
2025-01-01 00:26:16,393 - INFO - [session.py:150] - Use client cert: True
2025-01-01 00:26:16,395 - INFO - [session.py:151] - File to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 00:26:16,397 - INFO - [session.py:154] - Using encrypted exchange
2025-01-01 00:26:16,399 - INFO - [session.py:169] - Sending encrypted request data
2025-01-01 00:26:16,406 - INFO - [keys.py:185] - TLS Application Data sent from 192.168.1.1:12345 to 10.0.0.1:443
2025-01-01 00:26:16,410 - INFO - [session.py:180] - Sending encrypted response data
2025-01-01 00:26:16,417 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-01 00:26:16,421 - INFO - [session.py:192] - Attempting to send file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 00:26:16,426 - INFO - [session.py:203] - Opening file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 00:26:16,431 - INFO - [session.py:210] - Read 1103 bytes from file
2025-01-01 00:26:16,441 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-01 00:26:16,443 - INFO - [session.py:219] - File sent successfully
2025-01-01 00:26:16,445 - INFO - [session.py:194] - File sent successfully
2025-01-01 00:26:16,446 - INFO - [main.py:95] - Session completed successfully for 192.168.1.1
2025-01-01 00:26:16,448 - INFO - [main.py:87] - 
--- Client Session (no certificate) ---
2025-01-01 00:26:16,452 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-01 00:26:16,455 - INFO - [cert.py:108] - File exists: True
2025-01-01 00:26:16,458 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-01 00:26:16,462 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-01 00:26:16,464 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-01 00:26:16,466 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-01 00:26:16,470 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 00:26:16,473 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-01 00:26:16,476 - INFO - [cert.py:108] - File exists: True
2025-01-01 00:26:16,478 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-01 00:26:16,480 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-01 00:26:16,482 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-01 00:26:16,484 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-01 00:26:16,488 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 00:26:16,548 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-01 00:26:16,549 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-01 00:26:16,550 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-01 00:26:16,550 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-01 00:26:16,550 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-01 00:26:16,551 - INFO - [verify.py:58] - Public key comparison results:
2025-01-01 00:26:16,551 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 00:26:16,552 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 00:26:16,553 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-01 00:26:16,554 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-01 00:26:16,557 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-01 00:26:16,559 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-01 00:26:16,560 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-01 00:26:16,561 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-01 00:26:16,562 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-01 00:26:16,563 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-01 00:26:16,566 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-01 00:26:16,566 - INFO - [session.py:120] - Starting TLS session
2025-01-01 00:26:16,567 - INFO - [client.py:95] - Generated client_random: 67746f88aadfd0b7a8f1b9af85f75372b3756eb490d025ab1ee0358bac4f689c
2025-01-01 00:26:16,569 - INFO - [client.py:135] - Client Hello sent from 192.168.1.2
2025-01-01 00:26:16,575 - INFO - [server.py:93] - Generated server_random: 67746f8874b1039cf675aa2dc42855d74a66447dbb9291207b5d4f6eed0dee72
2025-01-01 00:26:16,580 - INFO - [client.py:172] - Prepared empty certificate
2025-01-01 00:26:16,581 - INFO - [client.py:184] - Encrypted pre_master_secret length: 256
2025-01-01 00:26:16,583 - INFO - [chain.py:185] - Decrypted pre_master_secret: 030392349424ebff3d956fcee993b681e73b35e46d7e02a8aa67a19347f77fae4653aabaaab77147732d9c35a2560e40
2025-01-01 00:26:16,584 - INFO - [chain.py:195] - Generated master secret: 006cd637cf51684bb6d26f0c4cf370263a5c2a9aa6648d400da7b53a40d17688eea5b71f904650f8ee2949e7cfdc2788
2025-01-01 00:26:16,584 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-01 00:26:16,585 - INFO - [client.py:274] - Client ChangeCipherSpec and Finished messages sent
2025-01-01 00:26:16,587 - INFO - [server.py:254] - Pre-master secret validated successfully
2025-01-01 00:26:16,592 - INFO - [server.py:272] - Generated digital signature: cedb2966fe99d4f1f62a2166f2ccf883fac3c752aefb1883353a2568214c0d15a3a5dd598e4037a3ad273e302223cdcf3595f0247731c69cfccd600a0c0f67e92dc3eb08604d7ad6d2aaaf5e67653d4ae3570163f808a6dcd3501058753897af4f5ea6ae25524a8d15e4261845ef8fec98a7417db6dcd39b8ff4ad6041995a323ff0fac51bf2a1a1ac1cdbee2f86b8fe6e72367f4bf65481289db435413be1b199504d254fb9ac412431d69739c1696951221065ad80eb07f04e3bb2279bbf8efb7b4daf6d92a177e5b12320d8003cccc437d8444dc8e335058190071dcc786e237bd59c927bebe91b09202f569a2d7a3a875cee2103a357b20923ad46812148
2025-01-01 00:26:16,594 - INFO - [server.py:309] - Server ChangeCipherSpec and Finished messages sent
2025-01-01 00:26:16,598 - INFO - [keys.py:205] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-01 00:26:16,598 - INFO - [session.py:104] - TLS Handshake completed successfully
2025-01-01 00:26:16,599 - INFO - [session.py:149] - Handshake completed: True
2025-01-01 00:26:16,600 - INFO - [session.py:150] - Use client cert: False
2025-01-01 00:26:16,600 - INFO - [session.py:151] - File to send: None
2025-01-01 00:26:16,601 - INFO - [session.py:157] - Using unencrypted exchange
2025-01-01 00:26:16,602 - INFO - [session.py:257] - Added request packet
2025-01-01 00:26:16,603 - INFO - [session.py:257] - Added response packet
2025-01-01 00:26:16,603 - WARNING - [session.py:234] - Using unencrypted communication
2025-01-01 00:26:16,604 - INFO - [main.py:95] - Session completed successfully for 192.168.1.2
2025-01-01 00:26:16,606 - INFO - [pcap_writer.py:232] - Packet 13: Valid HTTP message
2025-01-01 00:26:16,608 - INFO - [pcap_writer.py:232] - Packet 14: Valid HTTP message
2025-01-01 00:26:16,616 - INFO - [pcap_writer.py:387] - Saved 15 valid packets to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-01 00:26:16,617 - INFO - [pcap_writer.py:409] - Verifying 15 packets...
2025-01-01 00:26:16,618 - INFO - [pcap_writer.py:413] - Packet 1: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 00:26:16,619 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2025-01-01 00:26:16,621 - INFO - [pcap_writer.py:413] - Packet 2: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 00:26:16,622 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2775
2025-01-01 00:26:16,624 - INFO - [pcap_writer.py:413] - Packet 3: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 00:26:16,626 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 1646
2025-01-01 00:26:16,628 - INFO - [pcap_writer.py:413] - Packet 4: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 00:26:16,629 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2025-01-01 00:26:16,630 - INFO - [pcap_writer.py:413] - Packet 5: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 00:26:16,630 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2025-01-01 00:26:16,631 - INFO - [pcap_writer.py:413] - Packet 6: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 00:26:16,632 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 160
2025-01-01 00:26:16,632 - INFO - [pcap_writer.py:413] - Packet 7: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 00:26:16,633 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 128
2025-01-01 00:26:16,633 - INFO - [pcap_writer.py:413] - Packet 8: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 00:26:16,634 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 1152
2025-01-01 00:26:16,634 - INFO - [pcap_writer.py:413] - Packet 9: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-01 00:26:16,635 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2025-01-01 00:26:16,635 - INFO - [pcap_writer.py:413] - Packet 10: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-01 00:26:16,636 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2775
2025-01-01 00:26:16,636 - INFO - [pcap_writer.py:413] - Packet 11: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-01 00:26:16,637 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 269
2025-01-01 00:26:16,638 - INFO - [pcap_writer.py:413] - Packet 12: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-01 00:26:16,640 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2025-01-01 00:26:16,641 - INFO - [pcap_writer.py:413] - Packet 13: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-01 00:26:16,643 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2025-01-01 00:26:16,644 - INFO - [pcap_writer.py:413] - Packet 14: IP / TCP 192.168.1.2:12346 > 10.0.0.1:http PA / Raw
2025-01-01 00:26:16,646 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2025-01-01 00:26:16,648 - INFO - [pcap_writer.py:413] - Packet 15: IP / TCP 10.0.0.1:http > 192.168.1.2:12346 PA / Raw
2025-01-01 00:26:16,648 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2025-01-01 00:26:16,649 - INFO - [pcap_writer.py:427] - Verification complete: 15 valid packets, 15 TLS records
2025-01-01 00:26:16,650 - INFO - [main.py:106] - Results saved to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-01 00:26:16,650 - INFO - [main.py:160] - TLS session simulation completed successfully
2025-01-01 09:42:57,014 - INFO - [logging.py:83] - Logging configured successfully
2025-01-01 09:42:57,017 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-01 09:42:57,018 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-01 09:42:57,018 - INFO - [logging.py:92] - Log level: 20
2025-01-01 09:42:57,019 - INFO - [logging.py:93] - Timestamp: 2025-01-01T09:42:57.019486
2025-01-01 09:42:57,020 - INFO - [logging.py:94] - ==========================
2025-01-01 09:42:57,020 - INFO - [main.py:122] - Starting TLS session simulation
2025-01-01 09:42:57,022 - INFO - [main.py:87] - 
--- Client Session (certificate) ---
2025-01-01 09:42:57,025 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-01 09:42:57,027 - INFO - [cert.py:108] - File exists: True
2025-01-01 09:42:57,028 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-01 09:42:57,048 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-01 09:42:57,049 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-01 09:42:57,051 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-01 09:42:57,063 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 09:42:57,065 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-01 09:42:57,068 - INFO - [cert.py:108] - File exists: True
2025-01-01 09:42:57,070 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-01 09:42:57,102 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-01 09:42:57,103 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-01 09:42:57,105 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-01 09:42:57,108 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 09:42:57,237 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-01 09:42:57,239 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-01 09:42:57,240 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-01 09:42:57,242 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-01 09:42:57,271 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-01 09:42:57,272 - INFO - [verify.py:58] - Public key comparison results:
2025-01-01 09:42:57,273 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 09:42:57,276 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 09:42:57,279 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-01 09:42:57,280 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-01 09:42:57,294 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-01 09:42:57,297 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-01 09:42:57,298 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-01 09:42:57,300 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-01 09:42:57,301 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-01 09:42:57,304 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-01 09:42:57,308 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-01 09:42:57,310 - INFO - [session.py:120] - Starting TLS session
2025-01-01 09:42:57,311 - INFO - [client.py:97] - Generated client_random: 6774f201e861874a1172e23551b6d428c2fe3ee6b11de6699a2f58006d007179
2025-01-01 09:42:57,320 - INFO - [client.py:137] - Client Hello sent from 192.168.1.1
2025-01-01 09:42:57,328 - INFO - [server.py:93] - Generated server_random: 6774f201c0b5ecb9d47b571582002424280b2e8deca0d621e30fdd3bb230211e
2025-01-01 09:42:57,343 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2025-01-01 09:42:57,345 - INFO - [cert.py:108] - File exists: True
2025-01-01 09:42:57,347 - INFO - [cert.py:109] - File size: 1915 bytes
2025-01-01 09:42:57,368 - INFO - [cert.py:113] - Read 1915 bytes
2025-01-01 09:42:57,370 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2025-01-01 09:42:57,371 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2025-01-01 09:42:57,373 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 09:42:57,374 - INFO - [client.py:171] - Prepared client certificate
2025-01-01 09:42:57,376 - INFO - [client.py:186] - Encrypted pre_master_secret length: 256
2025-01-01 09:42:57,384 - INFO - [chain.py:185] - Decrypted pre_master_secret: 0303bff359a1c17b9e59fcfe54f71d202869c8b1e4386140487d9bf004b56814aa3272202f4f4c341bc0bd6591dbe1f8
2025-01-01 09:42:57,386 - INFO - [chain.py:195] - Generated master secret: 28ed510c8804b14242d7020b8708370cbfe6711875315880f5a480617c418b7a853b84a94e58c7da14fff8f82e410a13
2025-01-01 09:42:57,388 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-01 09:42:57,390 - INFO - [client.py:267] - Pre-master secret validated successfully
2025-01-01 09:42:57,395 - INFO - [client.py:285] - Generated digital signature: 6b9a162b229bfa48c343d306c1ce38c7010cd4f18996c54a2a50c44c261b7ea0b738f910d1dee7fca7d1af57f1acfc1ccffd8bfad9c3f8fa4d7c6f3a8dea0b74db28f985bbc0c6bd7b42a47a9958e7988f5de43d090b71fee8fc2bc798cf6943612da78024492d937ad6ea777abaf5c34b977a376a7af351b029c4b892b76f02e06d0d181718ceabbd8a18194f12e1e7cea4b934a21c5194032c3a827ea6d01fdecc1c1b6f3e712614749ddecee3a014d288ad59b496d729fd1461504b92f93c695890bab26a4936ab9e1ed634c31c79be43eb4a4f79a7ee6f32caeaa093f7ac68b7ed9aa0a6ae43d689e96200812beb05973c2a5cf5fe55e4d4d234ce1ef0d0
2025-01-01 09:42:57,401 - INFO - [client.py:324] - Client ChangeCipherSpec and Finished messages sent
2025-01-01 09:42:57,406 - INFO - [server.py:254] - Pre-master secret validated successfully
2025-01-01 09:42:57,408 - INFO - [server.py:272] - Generated digital signature: 877850396dcedc59bcc9ca306021691d3ed4b63543a67591e53cfa7e68b321a7c6a64578a9c337e75818e96637b193a936d5c7854f04f73fdd2ce09fe77d77b4f564acfa6d31c9e1519415aba3f37c5a58f6b3ca51bc92a7a6d5b63275013579544919c1fbcdc687f4f51f867454bd977a2b28b5b670e81b0b214de3f26d690e4b874bdb976d996c5d9316223b7d2782cc9a0de4bc6004e03f184d87f6b28d794f67c66c751f13d0716b707bbad53625aa46147062449b4401c9bfd583cf12505210624c945744ce4d1100f3157c77b9230e40c2ad6b1e287a3b4ffee2e9f0c23e88eeb9897fb169f9e8ca73cda5b6da9437cfa3e0c94ec5c9b8b4fcd0f45c23
2025-01-01 09:42:57,412 - INFO - [server.py:311] - Server ChangeCipherSpec and Finished messages sent
2025-01-01 09:42:57,418 - INFO - [keys.py:205] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-01 09:42:57,419 - INFO - [session.py:104] - TLS Handshake completed successfully
2025-01-01 09:42:57,421 - INFO - [session.py:131] - Found file to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 09:42:57,422 - INFO - [session.py:149] - Handshake completed: True
2025-01-01 09:42:57,423 - INFO - [session.py:150] - Use client cert: True
2025-01-01 09:42:57,423 - INFO - [session.py:151] - File to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 09:42:57,424 - INFO - [session.py:154] - Using encrypted exchange
2025-01-01 09:42:57,424 - INFO - [session.py:169] - Sending encrypted request data
2025-01-01 09:42:57,432 - INFO - [keys.py:185] - TLS Application Data sent from 192.168.1.1:12345 to 10.0.0.1:443
2025-01-01 09:42:57,434 - INFO - [session.py:180] - Sending encrypted response data
2025-01-01 09:42:57,437 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-01 09:42:57,439 - INFO - [session.py:192] - Attempting to send file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 09:42:57,439 - INFO - [session.py:203] - Opening file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 09:42:57,442 - INFO - [session.py:210] - Read 1103 bytes from file
2025-01-01 09:42:57,447 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-01 09:42:57,449 - INFO - [session.py:219] - File sent successfully
2025-01-01 09:42:57,450 - INFO - [session.py:194] - File sent successfully
2025-01-01 09:42:57,451 - INFO - [main.py:95] - Session completed successfully for 192.168.1.1
2025-01-01 09:42:57,452 - INFO - [main.py:87] - 
--- Client Session (no certificate) ---
2025-01-01 09:42:57,455 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-01 09:42:57,456 - INFO - [cert.py:108] - File exists: True
2025-01-01 09:42:57,457 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-01 09:42:57,458 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-01 09:42:57,458 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-01 09:42:57,479 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-01 09:42:57,482 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 09:42:57,485 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-01 09:42:57,487 - INFO - [cert.py:108] - File exists: True
2025-01-01 09:42:57,488 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-01 09:42:57,489 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-01 09:42:57,490 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-01 09:42:57,492 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-01 09:42:57,493 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 09:42:57,590 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-01 09:42:57,592 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-01 09:42:57,593 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-01 09:42:57,594 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-01 09:42:57,595 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-01 09:42:57,596 - INFO - [verify.py:58] - Public key comparison results:
2025-01-01 09:42:57,597 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 09:42:57,600 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 09:42:57,602 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-01 09:42:57,603 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-01 09:42:57,605 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-01 09:42:57,607 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-01 09:42:57,608 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-01 09:42:57,609 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-01 09:42:57,611 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-01 09:42:57,612 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-01 09:42:57,617 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-01 09:42:57,618 - INFO - [session.py:120] - Starting TLS session
2025-01-01 09:42:57,619 - INFO - [client.py:97] - Generated client_random: 6774f20179b6fe95424874326005a432b4b695df5c3c5deb0741c1a3f285ad48
2025-01-01 09:42:57,626 - INFO - [client.py:137] - Client Hello sent from 192.168.1.2
2025-01-01 09:42:57,632 - INFO - [server.py:93] - Generated server_random: 6774f2011c9edcc11414ab801c7c023e3a6f89763fc2b63a4d9f626ea931eb45
2025-01-01 09:42:57,647 - INFO - [client.py:174] - Prepared empty certificate
2025-01-01 09:42:57,650 - INFO - [client.py:186] - Encrypted pre_master_secret length: 256
2025-01-01 09:42:57,657 - INFO - [chain.py:185] - Decrypted pre_master_secret: 03035f43f94268e7334e8602b26ecd379d84ef2f4c5f5d20ba3202da7fb38fa2ba84cfd18236e87be16622949acbdd47
2025-01-01 09:42:57,659 - INFO - [chain.py:195] - Generated master secret: 003726cd2ff643f20da21d6f59b71e4722d33a3519e6cbef70e7212f2c6980d1b220a8449722de86151a4a89c52ace52
2025-01-01 09:42:57,661 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-01 09:42:57,665 - INFO - [client.py:267] - Pre-master secret validated successfully
2025-01-01 09:42:57,671 - INFO - [client.py:285] - Generated digital signature: a5aaf8bd496d8f97b4ce221cade7da13f842c753083db796f7280b78a03047410b13c6b76e6129c09a86f2c24e565e3cdfd660af42480df0609393fc03a37a9414cf3980873c1150df166bc91959a48f376d4fb16fb67de4ae2e0bc35381680586c62f59fe659ee5d053178606b6d3d4e474f32c7f0fd5a6f4464436989e3939d3a037ed83b90a0e69bc39b4fb7a8f97634c3696c4d33b2b81f271e6888d797e15760f72acf756cdc899d1bb43eae5245bad2425cadd4bf134eef1c6db8fc08240d89204db82e8aa05b905a907940754f30902e0df811a7662daa3f9ad8ee2d936108fa438aedc76f9f5067f6af13e5eef5c986269aa591fd2792129e2616ced
2025-01-01 09:42:57,676 - INFO - [client.py:324] - Client ChangeCipherSpec and Finished messages sent
2025-01-01 09:42:57,685 - INFO - [server.py:254] - Pre-master secret validated successfully
2025-01-01 09:42:57,692 - INFO - [server.py:272] - Generated digital signature: 2da8c3082e69a4b71e369c7831473b507faa5570257881f89548d6759f7da9b911363f49eb97830320efd24c8238fd731cc32a19aefc75585c9463bcb4fc7af712542b4a8b584764c414b26f66f3e6a5062d023fb6377be67753963c788efe11022be9435ef5a16d639ec6efdae3f28217debb690e6e20a97c500f601af93c0bb1826cc1e52391d5ba0ddc4b3b24ac9fd23c38c0272f683fa32dbc694025c09573c87a74c9b1b178b82d7378cb1ada0070b071f4fb903023c80a26fff49ad9f6cee5d782f0e595802c0395ae5c4cb916981e71ecb3387daa559557bbe7eb3c12fe894e142d3e1b50b79834ac570f119e4151f374c846388a225462f029ebb286
2025-01-01 09:42:57,697 - INFO - [server.py:311] - Server ChangeCipherSpec and Finished messages sent
2025-01-01 09:42:57,704 - INFO - [keys.py:205] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-01 09:42:57,705 - INFO - [session.py:104] - TLS Handshake completed successfully
2025-01-01 09:42:57,707 - INFO - [session.py:149] - Handshake completed: True
2025-01-01 09:42:57,708 - INFO - [session.py:150] - Use client cert: False
2025-01-01 09:42:57,709 - INFO - [session.py:151] - File to send: None
2025-01-01 09:42:57,710 - INFO - [session.py:157] - Using unencrypted exchange
2025-01-01 09:42:57,713 - INFO - [session.py:257] - Added request packet
2025-01-01 09:42:57,716 - INFO - [session.py:257] - Added response packet
2025-01-01 09:42:57,718 - WARNING - [session.py:234] - Using unencrypted communication
2025-01-01 09:42:57,719 - INFO - [main.py:95] - Session completed successfully for 192.168.1.2
2025-01-01 09:42:57,721 - INFO - [pcap_writer.py:232] - Packet 13: Valid HTTP message
2025-01-01 09:42:57,722 - INFO - [pcap_writer.py:232] - Packet 14: Valid HTTP message
2025-01-01 09:42:57,741 - INFO - [pcap_writer.py:387] - Saved 15 valid packets to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-01 09:42:57,743 - INFO - [pcap_writer.py:409] - Verifying 15 packets...
2025-01-01 09:42:57,744 - INFO - [pcap_writer.py:413] - Packet 1: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 09:42:57,745 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2025-01-01 09:42:57,747 - INFO - [pcap_writer.py:413] - Packet 2: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 09:42:57,748 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2775
2025-01-01 09:42:57,750 - INFO - [pcap_writer.py:413] - Packet 3: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 09:42:57,752 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 1646
2025-01-01 09:42:57,753 - INFO - [pcap_writer.py:413] - Packet 4: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 09:42:57,754 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2025-01-01 09:42:57,756 - INFO - [pcap_writer.py:413] - Packet 5: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 09:42:57,757 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2025-01-01 09:42:57,759 - INFO - [pcap_writer.py:413] - Packet 6: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 09:42:57,760 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 160
2025-01-01 09:42:57,762 - INFO - [pcap_writer.py:413] - Packet 7: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 09:42:57,763 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 128
2025-01-01 09:42:57,765 - INFO - [pcap_writer.py:413] - Packet 8: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 09:42:57,766 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 1152
2025-01-01 09:42:57,768 - INFO - [pcap_writer.py:413] - Packet 9: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-01 09:42:57,770 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2025-01-01 09:42:57,771 - INFO - [pcap_writer.py:413] - Packet 10: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-01 09:42:57,773 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2775
2025-01-01 09:42:57,774 - INFO - [pcap_writer.py:413] - Packet 11: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-01 09:42:57,776 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 269
2025-01-01 09:42:57,777 - INFO - [pcap_writer.py:413] - Packet 12: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-01 09:42:57,778 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2025-01-01 09:42:57,780 - INFO - [pcap_writer.py:413] - Packet 13: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-01 09:42:57,781 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 17
2025-01-01 09:42:57,783 - INFO - [pcap_writer.py:413] - Packet 14: IP / TCP 192.168.1.2:12346 > 10.0.0.1:http PA / Raw
2025-01-01 09:42:57,784 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2025-01-01 09:42:57,786 - INFO - [pcap_writer.py:413] - Packet 15: IP / TCP 10.0.0.1:http > 192.168.1.2:12346 PA / Raw
2025-01-01 09:42:57,787 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2025-01-01 09:42:57,788 - INFO - [pcap_writer.py:427] - Verification complete: 15 valid packets, 15 TLS records
2025-01-01 09:42:57,790 - INFO - [main.py:106] - Results saved to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-01 09:42:57,791 - INFO - [main.py:160] - TLS session simulation completed successfully
2025-01-01 10:01:35,806 - INFO - [logging.py:83] - Logging configured successfully
2025-01-01 10:01:35,808 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-01 10:01:35,808 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-01 10:01:35,809 - INFO - [logging.py:92] - Log level: 20
2025-01-01 10:01:35,810 - INFO - [logging.py:93] - Timestamp: 2025-01-01T10:01:35.809981
2025-01-01 10:01:35,810 - INFO - [logging.py:94] - ==========================
2025-01-01 10:01:35,811 - INFO - [main.py:122] - Starting TLS session simulation
2025-01-01 10:01:35,812 - INFO - [main.py:87] - 
--- Client Session (certificate) ---
2025-01-01 10:01:35,814 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-01 10:01:35,816 - INFO - [cert.py:108] - File exists: True
2025-01-01 10:01:35,817 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-01 10:01:35,818 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-01 10:01:35,819 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-01 10:01:35,821 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-01 10:01:35,829 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 10:01:35,831 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-01 10:01:35,834 - INFO - [cert.py:108] - File exists: True
2025-01-01 10:01:35,836 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-01 10:01:35,838 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-01 10:01:35,839 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-01 10:01:35,840 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-01 10:01:35,841 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 10:01:35,896 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-01 10:01:35,896 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-01 10:01:35,897 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-01 10:01:35,898 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-01 10:01:35,901 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-01 10:01:35,902 - INFO - [verify.py:58] - Public key comparison results:
2025-01-01 10:01:35,902 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 10:01:35,903 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 10:01:35,904 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-01 10:01:35,905 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-01 10:01:35,911 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-01 10:01:35,912 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-01 10:01:35,912 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-01 10:01:35,912 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-01 10:01:35,913 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-01 10:01:35,913 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-01 10:01:35,914 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-01 10:01:35,915 - INFO - [session.py:120] - Starting TLS session
2025-01-01 10:01:35,915 - INFO - [client.py:99] - Generated client_random: 6774f65f7fd690cb9a05479e0faed88d0cd8dd340acbbfbda876810597a2531d
2025-01-01 10:01:35,918 - INFO - [client.py:139] - Client Hello sent from 192.168.1.1
2025-01-01 10:01:35,921 - INFO - [server.py:95] - Generated server_random: 6774f65fca8c344bfb375514dfbcb8adc257d6c02faa7f14a32120080138fe1f
2025-01-01 10:01:35,928 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2025-01-01 10:01:35,928 - INFO - [cert.py:108] - File exists: True
2025-01-01 10:01:35,929 - INFO - [cert.py:109] - File size: 1915 bytes
2025-01-01 10:01:35,930 - INFO - [cert.py:113] - Read 1915 bytes
2025-01-01 10:01:35,930 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2025-01-01 10:01:35,930 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2025-01-01 10:01:35,931 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 10:01:35,931 - INFO - [client.py:173] - Prepared client certificate
2025-01-01 10:01:35,932 - INFO - [client.py:188] - Encrypted pre_master_secret length: 256
2025-01-01 10:01:35,935 - INFO - [chain.py:185] - Decrypted pre_master_secret: 030318e21f44cb27b6d88947dfe04dfec6265c0d63ac43811de62463b7a5fb6f48928e2295d16b20f51568270ddadaae
2025-01-01 10:01:35,936 - INFO - [chain.py:195] - Generated master secret: 95f5ad37dd17fd25dd7c38fd3a65ce25c48266078bef6f87506076dad01199c5351bd8150d8ec20cd4189a9320928be6
2025-01-01 10:01:35,937 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-01 10:01:35,939 - INFO - [client.py:269] - Pre-master secret validated successfully
2025-01-01 10:01:35,940 - INFO - [client.py:287] - Generated digital signature: 568707c5c4d3689757fe631508be2bdcd9f9affe56638c7232ed770cbeaeecd0f42a437ce6548c3246e26eac6f85597de7f25d2ad5d82ca6befb5697a81cfa9bde8564498770d8ac06f46a91b5ee1133c2f5e1b2484ce8cf2f2590caab610dfdb44af1c37341dd86ed1fd3a9cf8c0b72ca923687cf4751ee53f95e7eb2e3768cd2a97c4eda8aeef37407d6c83d0c2cd645a4b4ab71815de03480f9bf5b64dc55abd34ab2a18dad58b2cf54ac2194dcff3bee666faf1b819fb39a42a169303582c3d6ce17e63eb29ad89a6547d76db7803cc8ae7a8dfa326753fd0994eb94ff306351cbc5b1b389a62bdada588d73b91cbbbe2d2066880e9f42034d8069890627
2025-01-01 10:01:35,944 - ERROR - [main.py:27] - Session error: Session failed for 192.168.1.1: Session failed: Failed to send ChangeCipherSpec: Failed to create finished messages: type object 'KeyBlock' has no attribute 'client_key'
2025-01-01 10:04:06,597 - INFO - [logging.py:83] - Logging configured successfully
2025-01-01 10:04:06,597 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-01 10:04:06,598 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-01 10:04:06,598 - INFO - [logging.py:92] - Log level: 20
2025-01-01 10:04:06,599 - INFO - [logging.py:93] - Timestamp: 2025-01-01T10:04:06.599000
2025-01-01 10:04:06,599 - INFO - [logging.py:94] - ==========================
2025-01-01 10:04:06,599 - INFO - [main.py:122] - Starting TLS session simulation
2025-01-01 10:04:06,600 - INFO - [main.py:87] - 
--- Client Session (certificate) ---
2025-01-01 10:04:06,600 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-01 10:04:06,601 - INFO - [cert.py:108] - File exists: True
2025-01-01 10:04:06,601 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-01 10:04:06,602 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-01 10:04:06,602 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-01 10:04:06,603 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-01 10:04:06,604 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 10:04:06,605 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-01 10:04:06,605 - INFO - [cert.py:108] - File exists: True
2025-01-01 10:04:06,606 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-01 10:04:06,606 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-01 10:04:06,607 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-01 10:04:06,607 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-01 10:04:06,608 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 10:04:06,637 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-01 10:04:06,638 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-01 10:04:06,639 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-01 10:04:06,639 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-01 10:04:06,643 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-01 10:04:06,645 - INFO - [verify.py:58] - Public key comparison results:
2025-01-01 10:04:06,645 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 10:04:06,647 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 10:04:06,648 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-01 10:04:06,648 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-01 10:04:06,652 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-01 10:04:06,653 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-01 10:04:06,653 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-01 10:04:06,654 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-01 10:04:06,654 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-01 10:04:06,655 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-01 10:04:06,657 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-01 10:04:06,658 - INFO - [session.py:120] - Starting TLS session
2025-01-01 10:04:06,659 - INFO - [client.py:99] - Generated client_random: 6774f6f64ad116a8d9a72e818025fac3c647dd9cfd4337af7a8aed47e9d74d90
2025-01-01 10:04:06,662 - INFO - [client.py:139] - Client Hello sent from 192.168.1.1
2025-01-01 10:04:06,664 - INFO - [server.py:95] - Generated server_random: 6774f6f6211b7145320d016d6a04347f1a340a538486fa82dffb005e753573da
2025-01-01 10:04:06,669 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2025-01-01 10:04:06,669 - INFO - [cert.py:108] - File exists: True
2025-01-01 10:04:06,670 - INFO - [cert.py:109] - File size: 1915 bytes
2025-01-01 10:04:06,670 - INFO - [cert.py:113] - Read 1915 bytes
2025-01-01 10:04:06,670 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2025-01-01 10:04:06,671 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2025-01-01 10:04:06,671 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 10:04:06,672 - INFO - [client.py:173] - Prepared client certificate
2025-01-01 10:04:06,672 - INFO - [client.py:188] - Encrypted pre_master_secret length: 256
2025-01-01 10:04:06,675 - INFO - [chain.py:185] - Decrypted pre_master_secret: 030377e95a66f57040d731ae505e251bfc48b78f855d02e821705d06fc35e7afcf6654125f2ea54aaad18804695ddc56
2025-01-01 10:04:06,675 - INFO - [chain.py:195] - Generated master secret: 792f0dbf32316e420836c2aaf76bce5a02640c379d4e5682e1102036120a5a83961469a6cae5e66e7ce32af3863d0213
2025-01-01 10:04:06,677 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-01 10:04:06,678 - INFO - [client.py:269] - Pre-master secret validated successfully
2025-01-01 10:04:06,679 - INFO - [client.py:287] - Generated digital signature: 870b34c10fe81d960774d5e94012c410be055c51dffcbce727d1eaa6b9c41c8aff6d55ae18f016d22d4d624a9638d68fdd9df880413732d22564f2b93f38670314a78b2d516895dca779f102ed170c618712a3abbe67a6c51b8b0808da0bf5661ffcd711dd7e300edfae25325e8260bf36662c9a116be15c82cc37c9c348352ba775ddf0026222f88b5a580f34462b6737308da348c395f03fd54fcad41f239d288787d0b8e1dc9cd78c1123a0fe74c681afa323965f0910158af2778c66c3a2ab8fd0042a76160e0e8b93dee8ac5d5f9e597a18a1894cc7ed87d821f9de5b2d135a5abe747cc96e5cd4076ef1f23415908c76e1e4ca8ceb0b167e5bedebe971
2025-01-01 10:04:06,681 - ERROR - [main.py:27] - Session error: Session failed for 192.168.1.1: Session failed: Failed to send ChangeCipherSpec: Failed to create finished messages: type object 'KeyBlock' has no attribute 'client_key'
2025-01-01 10:04:22,604 - INFO - [logging.py:83] - Logging configured successfully
2025-01-01 10:04:22,605 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-01 10:04:22,605 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-01 10:04:22,606 - INFO - [logging.py:92] - Log level: 20
2025-01-01 10:04:22,607 - INFO - [logging.py:93] - Timestamp: 2025-01-01T10:04:22.607053
2025-01-01 10:04:22,607 - INFO - [logging.py:94] - ==========================
2025-01-01 10:04:22,608 - INFO - [main.py:122] - Starting TLS session simulation
2025-01-01 10:04:22,609 - INFO - [main.py:87] - 
--- Client Session (certificate) ---
2025-01-01 10:04:22,611 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-01 10:04:22,611 - INFO - [cert.py:108] - File exists: True
2025-01-01 10:04:22,612 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-01 10:04:22,613 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-01 10:04:22,613 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-01 10:04:22,614 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-01 10:04:22,616 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 10:04:22,616 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-01 10:04:22,617 - INFO - [cert.py:108] - File exists: True
2025-01-01 10:04:22,618 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-01 10:04:22,618 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-01 10:04:22,618 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-01 10:04:22,619 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-01 10:04:22,620 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 10:04:22,656 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-01 10:04:22,657 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-01 10:04:22,657 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-01 10:04:22,658 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-01 10:04:22,661 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-01 10:04:22,662 - INFO - [verify.py:58] - Public key comparison results:
2025-01-01 10:04:22,663 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 10:04:22,664 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 10:04:22,665 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-01 10:04:22,665 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-01 10:04:22,668 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-01 10:04:22,668 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-01 10:04:22,669 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-01 10:04:22,669 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-01 10:04:22,669 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-01 10:04:22,670 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-01 10:04:22,671 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-01 10:04:22,672 - INFO - [session.py:120] - Starting TLS session
2025-01-01 10:04:22,672 - INFO - [client.py:99] - Generated client_random: 6774f706f16ce2bdc2eae1bf879f899eefdc31cfc9866c8cdb9ef5235ca4dc55
2025-01-01 10:04:22,674 - INFO - [client.py:139] - Client Hello sent from 192.168.1.1
2025-01-01 10:04:22,677 - INFO - [server.py:95] - Generated server_random: 6774f706016926b928eda887ef8258394bec4131ba7a88b6495a96f0c089ee8f
2025-01-01 10:04:22,683 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2025-01-01 10:04:22,683 - INFO - [cert.py:108] - File exists: True
2025-01-01 10:04:22,684 - INFO - [cert.py:109] - File size: 1915 bytes
2025-01-01 10:04:22,685 - INFO - [cert.py:113] - Read 1915 bytes
2025-01-01 10:04:22,685 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2025-01-01 10:04:22,685 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2025-01-01 10:04:22,686 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 10:04:22,686 - INFO - [client.py:173] - Prepared client certificate
2025-01-01 10:04:22,687 - INFO - [client.py:188] - Encrypted pre_master_secret length: 256
2025-01-01 10:04:22,689 - INFO - [chain.py:185] - Decrypted pre_master_secret: 03030e4de891419dcf4287f0775206f99a40f6f4107b580caa058e408972a4e20ca064607cc0fceb1fbe5f6f79d71ec5
2025-01-01 10:04:22,690 - INFO - [chain.py:195] - Generated master secret: c4d0cf3ab2ff1e24c7103e3d143230e55dbb899f7ea623654b18f8039cddae6831bcb47bafd863c80e734262e50a868a
2025-01-01 10:04:22,691 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-01 10:04:22,693 - INFO - [client.py:269] - Pre-master secret validated successfully
2025-01-01 10:04:22,694 - INFO - [client.py:287] - Generated digital signature: 5688609251f9701ba2aa9949e2edd2a91e38e4d9e964ad24ed17c94e114140334f16006b93da45c7c858a48095953ac997f31d1a115c27283044e1c8d2031860229e6e4262dea9d1fb46071eb785bcf811fef8eda6f6c5db98bd3a6970a8c23cc4c84338dc79ed3e46fb6a91b0dcace4c63d8159558d6e24e30e8a2d0b7507fd839f9277781a2df0040b0e152ef42e9d40f21bd1d873a6e589eed3efe3d612ecdba8ee83c131b42ff5fafadc17729f61ccea52931aac9fa2c4e2b707a2a09d2b8eeefa8d922c4016d1fff961ab7991c913bd00bcf5bfb7b0c0567387582ff9865421fa3b349b2a9911748f6e9a6bfe559df4880ea05b204a4cb6082d176d5667
2025-01-01 10:04:22,698 - ERROR - [main.py:27] - Session error: Session failed for 192.168.1.1: Session failed: Failed to send ChangeCipherSpec: Failed to create finished messages: type object 'KeyBlock' has no attribute 'client_key'
2025-01-01 10:07:07,505 - INFO - [logging.py:83] - Logging configured successfully
2025-01-01 10:07:07,506 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-01 10:07:07,507 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-01 10:07:07,507 - INFO - [logging.py:92] - Log level: 20
2025-01-01 10:07:07,508 - INFO - [logging.py:93] - Timestamp: 2025-01-01T10:07:07.508071
2025-01-01 10:07:07,508 - INFO - [logging.py:94] - ==========================
2025-01-01 10:07:07,509 - INFO - [main.py:122] - Starting TLS session simulation
2025-01-01 10:07:07,510 - INFO - [main.py:87] - 
--- Client Session (certificate) ---
2025-01-01 10:07:07,511 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-01 10:07:07,512 - INFO - [cert.py:108] - File exists: True
2025-01-01 10:07:07,513 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-01 10:07:07,514 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-01 10:07:07,514 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-01 10:07:07,515 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-01 10:07:07,518 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 10:07:07,518 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-01 10:07:07,519 - INFO - [cert.py:108] - File exists: True
2025-01-01 10:07:07,520 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-01 10:07:07,520 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-01 10:07:07,521 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-01 10:07:07,522 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-01 10:07:07,523 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 10:07:07,559 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-01 10:07:07,560 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-01 10:07:07,560 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-01 10:07:07,560 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-01 10:07:07,562 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-01 10:07:07,562 - INFO - [verify.py:58] - Public key comparison results:
2025-01-01 10:07:07,562 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 10:07:07,563 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 10:07:07,564 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-01 10:07:07,565 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-01 10:07:07,570 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-01 10:07:07,571 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-01 10:07:07,572 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-01 10:07:07,572 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-01 10:07:07,573 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-01 10:07:07,573 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-01 10:07:07,576 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-01 10:07:07,578 - INFO - [session.py:120] - Starting TLS session
2025-01-01 10:07:07,579 - INFO - [client.py:99] - Generated client_random: 6774f7abe46be6767de686f3df35a542e5be3589972516e6d0883a77f721fe55
2025-01-01 10:07:07,584 - INFO - [client.py:139] - Client Hello sent from 192.168.1.1
2025-01-01 10:07:07,590 - INFO - [server.py:95] - Generated server_random: 6774f7abdbfd15b44ffec2b3919071a4592a3f674089f942abe474d31cbf5566
2025-01-01 10:07:07,594 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2025-01-01 10:07:07,595 - INFO - [cert.py:108] - File exists: True
2025-01-01 10:07:07,595 - INFO - [cert.py:109] - File size: 1915 bytes
2025-01-01 10:07:07,596 - INFO - [cert.py:113] - Read 1915 bytes
2025-01-01 10:07:07,596 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2025-01-01 10:07:07,597 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2025-01-01 10:07:07,597 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 10:07:07,598 - INFO - [client.py:173] - Prepared client certificate
2025-01-01 10:07:07,599 - INFO - [client.py:188] - Encrypted pre_master_secret length: 256
2025-01-01 10:07:07,605 - INFO - [chain.py:185] - Decrypted pre_master_secret: 030335ad1ab6f3c3dfd312ef5b16f1d6bef4e73f9555677718468b3c626b22aca344214f2415978fb3bafeeffa47fbd0
2025-01-01 10:07:07,605 - INFO - [chain.py:195] - Generated master secret: f69b23c0faa28c6991060b411192c11d310a4ace0f1e2b65da32631385a6c5deadc1c3732716c8e46a6d46b216229778
2025-01-01 10:07:07,606 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-01 10:07:07,607 - INFO - [client.py:269] - Pre-master secret validated successfully
2025-01-01 10:07:07,608 - INFO - [client.py:287] - Generated digital signature: 785b84a80b906bce2d0bf3d35768dbda116e6018cdbf93f9f859ba8595904ab8b4c38c9dcbdd5cb062797bed738fb8a2a8c56a865d8ce6e4d1d7ea8401f2848cd880130ac432d332446891516f139aafb81e73cc4672b57a838f008ac935903196a99b7767f9666665145ef22ed0e51800f6543e6ec6d076168ed23ed61135f0013d9b2aee9cde9cb3b55bcb56103d802cc5b1f8459d37b9f5562369deb19b1489f02fb53768b941a1a4cc9e2e8a806f352d8ef9e2f40bdb9372c3e54437d61bce082aeb66175c190090da761019654aa6383d5c78f5ad72f8a06c56460c0d7c21fec1403b6bda5bb0507df7fc024b9513404ffff8fb5cebfdae340defc74eef
2025-01-01 10:07:07,609 - ERROR - [main.py:27] - Session error: Session failed for 192.168.1.1: Session failed: Failed to send ChangeCipherSpec: Failed to create finished messages: type object 'KeyBlock' has no attribute 'client_key'
2025-01-01 10:10:37,155 - INFO - [logging.py:83] - Logging configured successfully
2025-01-01 10:10:37,156 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-01 10:10:37,156 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-01 10:10:37,157 - INFO - [logging.py:92] - Log level: 20
2025-01-01 10:10:37,157 - INFO - [logging.py:93] - Timestamp: 2025-01-01T10:10:37.157476
2025-01-01 10:10:37,157 - INFO - [logging.py:94] - ==========================
2025-01-01 10:10:37,158 - INFO - [main.py:122] - Starting TLS session simulation
2025-01-01 10:10:37,159 - INFO - [main.py:87] - 
--- Client Session (certificate) ---
2025-01-01 10:10:37,160 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-01 10:10:37,160 - INFO - [cert.py:108] - File exists: True
2025-01-01 10:10:37,161 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-01 10:10:37,162 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-01 10:10:37,162 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-01 10:10:37,162 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-01 10:10:37,163 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 10:10:37,163 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-01 10:10:37,164 - INFO - [cert.py:108] - File exists: True
2025-01-01 10:10:37,164 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-01 10:10:37,165 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-01 10:10:37,165 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-01 10:10:37,166 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-01 10:10:37,167 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 10:10:37,206 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-01 10:10:37,207 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-01 10:10:37,207 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-01 10:10:37,208 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-01 10:10:37,210 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-01 10:10:37,211 - INFO - [verify.py:58] - Public key comparison results:
2025-01-01 10:10:37,211 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 10:10:37,213 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 10:10:37,214 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-01 10:10:37,215 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-01 10:10:37,218 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-01 10:10:37,219 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-01 10:10:37,219 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-01 10:10:37,220 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-01 10:10:37,220 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-01 10:10:37,221 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-01 10:10:37,222 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-01 10:10:37,223 - INFO - [session.py:120] - Starting TLS session
2025-01-01 10:10:37,223 - INFO - [client.py:99] - Generated client_random: 6774f87dcbe646b5302d6bc5bb085755992300c43c835e34119f8ffda1c18c0b
2025-01-01 10:10:37,226 - INFO - [client.py:139] - Client Hello sent from 192.168.1.1
2025-01-01 10:10:37,230 - INFO - [server.py:95] - Generated server_random: 6774f87d3caf8112183eb41aeb69ea3f248a03b0ad677324e55e32db74ddc9a6
2025-01-01 10:10:37,235 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2025-01-01 10:10:37,236 - INFO - [cert.py:108] - File exists: True
2025-01-01 10:10:37,237 - INFO - [cert.py:109] - File size: 1915 bytes
2025-01-01 10:10:37,237 - INFO - [cert.py:113] - Read 1915 bytes
2025-01-01 10:10:37,238 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2025-01-01 10:10:37,238 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2025-01-01 10:10:37,239 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 10:10:37,240 - INFO - [client.py:173] - Prepared client certificate
2025-01-01 10:10:37,240 - INFO - [client.py:188] - Encrypted pre_master_secret length: 256
2025-01-01 10:10:37,244 - INFO - [chain.py:185] - Decrypted pre_master_secret: 0303c6b034bd8cc2661ff1d0e1d26fe0dd8f574369aacdac3ca1de2cb4b1eb288ad9f74be4e13582a76cccc6c66d7a62
2025-01-01 10:10:37,246 - INFO - [chain.py:195] - Generated master secret: 5b70da0baf212500ed15df1dce37ab679d6a5dae7feefc919efe8ca42e3e66ec8b408798f0dd5fb413312405eb052383
2025-01-01 10:10:37,247 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-01 10:10:37,249 - INFO - [client.py:269] - Pre-master secret validated successfully
2025-01-01 10:10:37,251 - INFO - [client.py:287] - Generated digital signature: 26a6970797932b7a0f25e40a11a9e3e43965abee61d47fd1e27a21237815e99bf1a92892844e7a40f10508d8a53e401cc5823775e70abcfeb0ca28f5eced265191036fff94a8d80c3b6ec51995253fe6bcc8d367096df0e265bc7d7b9d61016e8426ca1e973ade11317514b36ba8e92c3f3a786d0a760d381ecfb4fe004ab990512d2b62be1472ce33dd179a59356019a7e85a3066c15b165228c01564126c94303aea77314fd0b2007b8ea9e4d770dcbec42750491b5f23b4d488514ec3f35119c3124721be49c8b6b94c449a1de90b91d3842430e8b1d21d132b2d8d2fd3f8ebebd7fc58c5cf1617dc8f3a54348c2ee63210b030ed0ed53f5284e12b0310e7
2025-01-01 10:10:37,256 - INFO - [client.py:333] - Client ChangeCipherSpec and Finished messages sent
2025-01-01 10:10:37,259 - INFO - [server.py:256] - Pre-master secret validated successfully
2025-01-01 10:10:37,262 - INFO - [server.py:274] - Generated digital signature: 8d265ba2c98b3cbd39fb7c113cf729bf6d3eab5e11b9466e7ddbc3898c3be4d74a0234c805cccd9e9a37be50f3a9376437562238b5048907acce41a4f670b0aba58fc441877627506aef2e845d734ebc5ff6fd723e5548e7aa45e3f722e0d8cb93140ff27f88849803c07f32ab1971b308b22c58ad8f0c45e577d35a873d36615d0a07a2ea12af83871449046e4f8d2f7b7d0740e8512f772654a3050cc668ced660f37e316190faa5d87b27ae4b36e0b097f73946e87bb8ba9704dbf1bdb9df9b80a7ade175ff01a0ae23ffb9739141734ce3461af4a644a4506a023c47388d44af27b59bb9917690da3ae98ef12252e6403b86bb2930b09e11c58f65054cbc
2025-01-01 10:10:37,265 - INFO - [server.py:320] - Server ChangeCipherSpec and Finished messages sent
2025-01-01 10:10:37,269 - INFO - [keys.py:205] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-01 10:10:37,269 - INFO - [session.py:104] - TLS Handshake completed successfully
2025-01-01 10:10:37,270 - INFO - [session.py:131] - Found file to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 10:10:37,271 - INFO - [session.py:149] - Handshake completed: True
2025-01-01 10:10:37,272 - INFO - [session.py:150] - Use client cert: True
2025-01-01 10:10:37,273 - INFO - [session.py:151] - File to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 10:10:37,273 - INFO - [session.py:154] - Using encrypted exchange
2025-01-01 10:10:37,274 - INFO - [session.py:169] - Sending encrypted request data
2025-01-01 10:10:37,277 - INFO - [keys.py:185] - TLS Application Data sent from 192.168.1.1:12345 to 10.0.0.1:443
2025-01-01 10:10:37,278 - INFO - [session.py:180] - Sending encrypted response data
2025-01-01 10:10:37,280 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-01 10:10:37,281 - INFO - [session.py:192] - Attempting to send file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 10:10:37,282 - INFO - [session.py:203] - Opening file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 10:10:37,284 - INFO - [session.py:210] - Read 1103 bytes from file
2025-01-01 10:10:37,287 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-01 10:10:37,289 - INFO - [session.py:219] - File sent successfully
2025-01-01 10:10:37,289 - INFO - [session.py:194] - File sent successfully
2025-01-01 10:10:37,290 - INFO - [main.py:95] - Session completed successfully for 192.168.1.1
2025-01-01 10:10:37,291 - INFO - [main.py:87] - 
--- Client Session (no certificate) ---
2025-01-01 10:10:37,292 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-01 10:10:37,293 - INFO - [cert.py:108] - File exists: True
2025-01-01 10:10:37,294 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-01 10:10:37,295 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-01 10:10:37,296 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-01 10:10:37,296 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-01 10:10:37,298 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 10:10:37,299 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-01 10:10:37,300 - INFO - [cert.py:108] - File exists: True
2025-01-01 10:10:37,301 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-01 10:10:37,302 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-01 10:10:37,303 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-01 10:10:37,304 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-01 10:10:37,306 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 10:10:37,341 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-01 10:10:37,341 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-01 10:10:37,342 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-01 10:10:37,342 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-01 10:10:37,343 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-01 10:10:37,344 - INFO - [verify.py:58] - Public key comparison results:
2025-01-01 10:10:37,344 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 10:10:37,345 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 10:10:37,346 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-01 10:10:37,347 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-01 10:10:37,347 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-01 10:10:37,348 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-01 10:10:37,348 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-01 10:10:37,349 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-01 10:10:37,349 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-01 10:10:37,349 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-01 10:10:37,350 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-01 10:10:37,350 - INFO - [session.py:120] - Starting TLS session
2025-01-01 10:10:37,350 - INFO - [client.py:99] - Generated client_random: 6774f87d45376931fa4d684782d57483f5caf730ee66272ffa02a4f3f323a763
2025-01-01 10:10:37,352 - INFO - [client.py:139] - Client Hello sent from 192.168.1.2
2025-01-01 10:10:37,354 - INFO - [server.py:95] - Generated server_random: 6774f87d543fe817581c05c3c115ba3ac4e4c2cadac9779b26b2c799d7490f45
2025-01-01 10:10:37,358 - INFO - [client.py:176] - Prepared empty certificate
2025-01-01 10:10:37,358 - INFO - [client.py:188] - Encrypted pre_master_secret length: 256
2025-01-01 10:10:37,361 - INFO - [chain.py:185] - Decrypted pre_master_secret: 03037f65819164b1b247d702524a636aee078ef36cf915780f9aa7791923ddf38f1ec15c54a9d1e7aeb75870a62f1705
2025-01-01 10:10:37,362 - INFO - [chain.py:195] - Generated master secret: 4b0925f30834093981a9f6021e4e48ac2073df7be2b7490ba4a85ac07fdb124f7282b9bd29c4f1b300eed1672b5544bf
2025-01-01 10:10:37,363 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-01 10:10:37,364 - INFO - [client.py:269] - Pre-master secret validated successfully
2025-01-01 10:10:37,365 - INFO - [client.py:287] - Generated digital signature: 5efbc81f2b36a9cc69eff1c822110cf8db30d595dc7a1fd3682a945e9fd6a049de3a745216f1b5dc6a926b85a4b412ce31e773943a6ef940f80530729f5c432cc14997d04ca03398cad5e2aa53fe39d5916eae6c1d147b28341c9bea76adc4620dfaeabf1a5482732df4e67e91ef98895ab9343c2b377a6fa956f624f7d325714f6efa29575fd6bf0060c86aa6e4d256dc7d362923c1271f14f20095b821b798ff9220d8be37ed33f7fc5243610f149fba433ce862a167fa8d22bd1c183c7b486cbe91c8acbea78cd918efb4a6fbffb883072c4fc4d88ed96817a5c2946f6c1dd54b909e5d97a65681fbbdf9b8b125e59a19fc24db58404a32b232a44bb0691a
2025-01-01 10:10:37,367 - INFO - [client.py:333] - Client ChangeCipherSpec and Finished messages sent
2025-01-01 10:10:37,369 - INFO - [server.py:256] - Pre-master secret validated successfully
2025-01-01 10:10:37,370 - INFO - [server.py:274] - Generated digital signature: 9f6ec06b05677d5c37be71de5b6cf60ff0642babafc21f3b1693191160ed7e88d1bb27c5864ea83f4702703fab7ad6f8e3dfea0274638b184d25644380796e25ebd91a4ad367778f470cf1b38213b88c4fdbbe6a3efe1f5baea5596af4aeac9ea3fd600ef7acd079b6b7617d440bec3edf09987200e62d155ee4e89ecee4d2281ba76b1f7fc70c08a654861090afb9e1d34e6ce8185c3c1aff8e922903c91d29461c21c4639cfcdeeb7cb98636347dde63d5d6fc2f9c16ccf245a472e6b8adcf2fa8dfc07d8a0ee92fd7ab3e975baf75e7fe4c009bf698cd81b2a9e6fe55ef26c000e01d4e637dc0dc1d204c4d0c666447991d686df9eaef026e9b4b1320fb6b
2025-01-01 10:10:37,372 - INFO - [server.py:320] - Server ChangeCipherSpec and Finished messages sent
2025-01-01 10:10:37,374 - INFO - [keys.py:205] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-01 10:10:37,375 - INFO - [session.py:104] - TLS Handshake completed successfully
2025-01-01 10:10:37,376 - INFO - [session.py:149] - Handshake completed: True
2025-01-01 10:10:37,376 - INFO - [session.py:150] - Use client cert: False
2025-01-01 10:10:37,377 - INFO - [session.py:151] - File to send: None
2025-01-01 10:10:37,377 - INFO - [session.py:157] - Using unencrypted exchange
2025-01-01 10:10:37,378 - INFO - [session.py:257] - Added request packet
2025-01-01 10:10:37,379 - INFO - [session.py:257] - Added response packet
2025-01-01 10:10:37,380 - WARNING - [session.py:234] - Using unencrypted communication
2025-01-01 10:10:37,380 - INFO - [main.py:95] - Session completed successfully for 192.168.1.2
2025-01-01 10:10:37,382 - INFO - [pcap_writer.py:232] - Packet 13: Valid HTTP message
2025-01-01 10:10:37,382 - INFO - [pcap_writer.py:232] - Packet 14: Valid HTTP message
2025-01-01 10:10:37,390 - INFO - [pcap_writer.py:387] - Saved 15 valid packets to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-01 10:10:37,391 - INFO - [pcap_writer.py:409] - Verifying 15 packets...
2025-01-01 10:10:37,391 - INFO - [pcap_writer.py:413] - Packet 1: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 10:10:37,392 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2025-01-01 10:10:37,393 - INFO - [pcap_writer.py:413] - Packet 2: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 10:10:37,394 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2775
2025-01-01 10:10:37,395 - INFO - [pcap_writer.py:413] - Packet 3: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 10:10:37,396 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 1646
2025-01-01 10:10:37,397 - INFO - [pcap_writer.py:413] - Packet 4: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 10:10:37,397 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-01 10:10:37,398 - INFO - [pcap_writer.py:413] - Packet 5: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 10:10:37,399 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-01 10:10:37,400 - INFO - [pcap_writer.py:413] - Packet 6: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 10:10:37,401 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 160
2025-01-01 10:10:37,402 - INFO - [pcap_writer.py:413] - Packet 7: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 10:10:37,402 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 128
2025-01-01 10:10:37,403 - INFO - [pcap_writer.py:413] - Packet 8: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 10:10:37,404 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 1152
2025-01-01 10:10:37,405 - INFO - [pcap_writer.py:413] - Packet 9: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-01 10:10:37,406 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2025-01-01 10:10:37,406 - INFO - [pcap_writer.py:413] - Packet 10: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-01 10:10:37,407 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2775
2025-01-01 10:10:37,408 - INFO - [pcap_writer.py:413] - Packet 11: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-01 10:10:37,408 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 269
2025-01-01 10:10:37,409 - INFO - [pcap_writer.py:413] - Packet 12: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-01 10:10:37,410 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-01 10:10:37,411 - INFO - [pcap_writer.py:413] - Packet 13: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-01 10:10:37,412 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-01 10:10:37,413 - INFO - [pcap_writer.py:413] - Packet 14: IP / TCP 192.168.1.2:12346 > 10.0.0.1:http PA / Raw
2025-01-01 10:10:37,414 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2025-01-01 10:10:37,416 - INFO - [pcap_writer.py:413] - Packet 15: IP / TCP 10.0.0.1:http > 192.168.1.2:12346 PA / Raw
2025-01-01 10:10:37,417 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2025-01-01 10:10:37,418 - INFO - [pcap_writer.py:427] - Verification complete: 15 valid packets, 15 TLS records
2025-01-01 10:10:37,418 - INFO - [main.py:106] - Results saved to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-01 10:10:37,419 - INFO - [main.py:160] - TLS session simulation completed successfully
2025-01-01 12:41:59,541 - INFO - [logging.py:83] - Logging configured successfully
2025-01-01 12:41:59,542 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-01 12:41:59,542 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-01 12:41:59,543 - INFO - [logging.py:92] - Log level: 20
2025-01-01 12:41:59,543 - INFO - [logging.py:93] - Timestamp: 2025-01-01T12:41:59.543453
2025-01-01 12:41:59,543 - INFO - [logging.py:94] - ==========================
2025-01-01 12:41:59,543 - INFO - [main.py:122] - Starting TLS session simulation
2025-01-01 12:41:59,544 - INFO - [main.py:87] - 
--- Client Session (certificate) ---
2025-01-01 12:41:59,545 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-01 12:41:59,545 - INFO - [cert.py:108] - File exists: True
2025-01-01 12:41:59,546 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-01 12:41:59,546 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-01 12:41:59,546 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-01 12:41:59,547 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-01 12:41:59,551 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 12:41:59,552 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-01 12:41:59,552 - INFO - [cert.py:108] - File exists: True
2025-01-01 12:41:59,553 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-01 12:41:59,553 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-01 12:41:59,553 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-01 12:41:59,554 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-01 12:41:59,555 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 12:41:59,593 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-01 12:41:59,594 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-01 12:41:59,595 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-01 12:41:59,596 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-01 12:41:59,598 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-01 12:41:59,598 - INFO - [verify.py:58] - Public key comparison results:
2025-01-01 12:41:59,598 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 12:41:59,599 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 12:41:59,599 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-01 12:41:59,600 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-01 12:41:59,606 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-01 12:41:59,608 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-01 12:41:59,608 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-01 12:41:59,608 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-01 12:41:59,609 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-01 12:41:59,610 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-01 12:41:59,611 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-01 12:41:59,612 - INFO - [session.py:134] - Starting TLS session
2025-01-01 12:41:59,612 - INFO - [client.py:99] - Generated client_random: 67751bf7541096e74d12090a50d71952bfcc8cae689439d6819936a3c0c5132f
2025-01-01 12:41:59,614 - INFO - [client.py:139] - Client Hello sent from 192.168.1.1
2025-01-01 12:41:59,616 - INFO - [server.py:95] - Generated server_random: 67751bf7e390ffb99ac82a655f1c620cb7b5a1e7598fd7c99f6647d5bb02aafe
2025-01-01 12:41:59,619 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2025-01-01 12:41:59,620 - INFO - [cert.py:108] - File exists: True
2025-01-01 12:41:59,620 - INFO - [cert.py:109] - File size: 1915 bytes
2025-01-01 12:41:59,621 - INFO - [cert.py:113] - Read 1915 bytes
2025-01-01 12:41:59,621 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2025-01-01 12:41:59,621 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2025-01-01 12:41:59,622 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 12:41:59,622 - INFO - [client.py:173] - Prepared client certificate
2025-01-01 12:41:59,623 - INFO - [client.py:188] - Encrypted pre_master_secret length: 256
2025-01-01 12:41:59,626 - INFO - [chain.py:185] - Decrypted pre_master_secret: 03039b572ee00582c5a4241ce405d6b15e705d082a32683023a9e3682fb7de73b4a49453f574fc699a83bd59bf13add8
2025-01-01 12:41:59,627 - INFO - [chain.py:195] - Generated master secret: f85aa61af0e06946ab649cad785029a7f85ba0a5d70d684d6039062b74dcf558c0afeaeba17890f3c06904c202e0b09e
2025-01-01 12:41:59,627 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-01 12:41:59,628 - ERROR - [session.py:121] - TLS Handshake failed: Failed to handle Master Secret
2025-01-01 12:41:59,629 - ERROR - [main.py:27] - Session error: Session failed for 192.168.1.1: Session failed: Handshake failed
2025-01-01 12:45:58,433 - INFO - [logging.py:83] - Logging configured successfully
2025-01-01 12:45:58,434 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-01 12:45:58,435 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-01 12:45:58,435 - INFO - [logging.py:92] - Log level: 20
2025-01-01 12:45:58,435 - INFO - [logging.py:93] - Timestamp: 2025-01-01T12:45:58.435466
2025-01-01 12:45:58,435 - INFO - [logging.py:94] - ==========================
2025-01-01 12:45:58,435 - INFO - [main.py:122] - Starting TLS session simulation
2025-01-01 12:45:58,436 - INFO - [main.py:87] - 
--- Client Session (certificate) ---
2025-01-01 12:45:58,436 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-01 12:45:58,437 - INFO - [cert.py:108] - File exists: True
2025-01-01 12:45:58,437 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-01 12:45:58,437 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-01 12:45:58,437 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-01 12:45:58,438 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-01 12:45:58,438 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 12:45:58,439 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-01 12:45:58,439 - INFO - [cert.py:108] - File exists: True
2025-01-01 12:45:58,439 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-01 12:45:58,440 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-01 12:45:58,440 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-01 12:45:58,440 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-01 12:45:58,441 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 12:45:58,470 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-01 12:45:58,470 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-01 12:45:58,471 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-01 12:45:58,471 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-01 12:45:58,473 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-01 12:45:58,473 - INFO - [verify.py:58] - Public key comparison results:
2025-01-01 12:45:58,473 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 12:45:58,474 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 12:45:58,474 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-01 12:45:58,475 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-01 12:45:58,478 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-01 12:45:58,479 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-01 12:45:58,479 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-01 12:45:58,479 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-01 12:45:58,480 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-01 12:45:58,480 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-01 12:45:58,481 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-01 12:45:58,482 - INFO - [session.py:152] - Starting TLS session
2025-01-01 12:45:58,482 - INFO - [session.py:95] - Starting TLS Handshake...
2025-01-01 12:45:58,483 - INFO - [client.py:99] - Generated client_random: 67751ce6aa8139990c0ba96e6578f4d5763f482475121c15cc04ca52d990486b
2025-01-01 12:45:58,486 - INFO - [client.py:139] - Client Hello sent from 192.168.1.1
2025-01-01 12:45:58,488 - INFO - [session.py:100] - Client Hello sent successfully
2025-01-01 12:45:58,488 - INFO - [server.py:95] - Generated server_random: 67751ce60edd7f6679f6bb539f8398b71d40334c22595eb827933dc62012cd6c
2025-01-01 12:45:58,491 - INFO - [session.py:105] - Server Hello received successfully
2025-01-01 12:45:58,492 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2025-01-01 12:45:58,492 - INFO - [cert.py:108] - File exists: True
2025-01-01 12:45:58,492 - INFO - [cert.py:109] - File size: 1915 bytes
2025-01-01 12:45:58,493 - INFO - [cert.py:113] - Read 1915 bytes
2025-01-01 12:45:58,493 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2025-01-01 12:45:58,493 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2025-01-01 12:45:58,494 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 12:45:58,494 - INFO - [client.py:173] - Prepared client certificate
2025-01-01 12:45:58,495 - INFO - [client.py:188] - Encrypted pre_master_secret length: 256
2025-01-01 12:45:58,496 - INFO - [session.py:110] - Client handshake messages sent successfully
2025-01-01 12:45:58,496 - INFO - [chain.py:227] - Generating Master Secret...
2025-01-01 12:45:58,497 - INFO - [chain.py:185] - Decrypted pre_master_secret: 0303a6751c9fb88b486176be7296fe9b24869f2942774ce0daa8ac89cd7154d2b0ee0d87ad22b7e91a46ea3897bd0961
2025-01-01 12:45:58,498 - INFO - [chain.py:195] - Generated master secret: 4174a7030d9c2d851a8fef62e607c67ac893aac5139d0997a9005bc34bdb93f527a44ba0643e0ac7b595dede0f520d1d
2025-01-01 12:45:58,498 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-01 12:45:58,499 - INFO - [chain.py:241] - Master Secret generated successfully
2025-01-01 12:45:58,499 - ERROR - [session.py:138] - TLS Handshake failed: Failed to handle Master Secret
2025-01-01 12:45:58,499 - ERROR - [main.py:27] - Session error: Session failed for 192.168.1.1: Session failed: Handshake failed
2025-01-01 12:47:33,801 - INFO - [logging.py:83] - Logging configured successfully
2025-01-01 12:47:33,802 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-01 12:47:33,802 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-01 12:47:33,802 - INFO - [logging.py:92] - Log level: 20
2025-01-01 12:47:33,802 - INFO - [logging.py:93] - Timestamp: 2025-01-01T12:47:33.802753
2025-01-01 12:47:33,802 - INFO - [logging.py:94] - ==========================
2025-01-01 12:47:33,803 - INFO - [main.py:132] - Starting TLS session simulation
2025-01-01 12:47:33,803 - INFO - [main.py:87] - 
--- Client Session (certificate) ---
2025-01-01 12:47:33,804 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-01 12:47:33,804 - INFO - [cert.py:108] - File exists: True
2025-01-01 12:47:33,804 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-01 12:47:33,805 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-01 12:47:33,806 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-01 12:47:33,807 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-01 12:47:33,808 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 12:47:33,809 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-01 12:47:33,809 - INFO - [cert.py:108] - File exists: True
2025-01-01 12:47:33,809 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-01 12:47:33,810 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-01 12:47:33,810 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-01 12:47:33,810 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-01 12:47:33,810 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 12:47:33,839 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-01 12:47:33,840 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-01 12:47:33,840 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-01 12:47:33,841 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-01 12:47:33,843 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-01 12:47:33,843 - INFO - [verify.py:58] - Public key comparison results:
2025-01-01 12:47:33,843 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 12:47:33,845 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 12:47:33,845 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-01 12:47:33,846 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-01 12:47:33,854 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-01 12:47:33,854 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-01 12:47:33,855 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-01 12:47:33,855 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-01 12:47:33,855 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-01 12:47:33,857 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-01 12:47:33,857 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-01 12:47:33,857 - ERROR - [main.py:107] - Unexpected error for 192.168.1.1: 'UnifiedTLSSession' object has no attribute 'encrypted_pre_master_secret'
2025-01-01 12:47:33,858 - ERROR - [main.py:27] - Session error: Session failed for 192.168.1.1: 'UnifiedTLSSession' object has no attribute 'encrypted_pre_master_secret'
2025-01-01 12:48:06,398 - INFO - [logging.py:83] - Logging configured successfully
2025-01-01 12:48:06,399 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-01 12:48:06,399 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-01 12:48:06,400 - INFO - [logging.py:92] - Log level: 20
2025-01-01 12:48:06,400 - INFO - [logging.py:93] - Timestamp: 2025-01-01T12:48:06.400435
2025-01-01 12:48:06,400 - INFO - [logging.py:94] - ==========================
2025-01-01 12:48:06,400 - INFO - [main.py:122] - Starting TLS session simulation
2025-01-01 12:48:06,401 - INFO - [main.py:87] - 
--- Client Session (certificate) ---
2025-01-01 12:48:06,401 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-01 12:48:06,402 - INFO - [cert.py:108] - File exists: True
2025-01-01 12:48:06,402 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-01 12:48:06,403 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-01 12:48:06,403 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-01 12:48:06,403 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-01 12:48:06,404 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 12:48:06,405 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-01 12:48:06,405 - INFO - [cert.py:108] - File exists: True
2025-01-01 12:48:06,406 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-01 12:48:06,406 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-01 12:48:06,407 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-01 12:48:06,407 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-01 12:48:06,407 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 12:48:06,437 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-01 12:48:06,439 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-01 12:48:06,440 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-01 12:48:06,440 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-01 12:48:06,441 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-01 12:48:06,442 - INFO - [verify.py:58] - Public key comparison results:
2025-01-01 12:48:06,447 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 12:48:06,448 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 12:48:06,449 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-01 12:48:06,450 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-01 12:48:06,453 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-01 12:48:06,453 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-01 12:48:06,454 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-01 12:48:06,454 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-01 12:48:06,455 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-01 12:48:06,455 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-01 12:48:06,456 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-01 12:48:06,456 - INFO - [session.py:152] - Starting TLS session
2025-01-01 12:48:06,457 - INFO - [session.py:95] - Starting TLS Handshake...
2025-01-01 12:48:06,457 - INFO - [client.py:99] - Generated client_random: 67751d66d403f988851223676ae2e8e9865fb99334296b8a355536200a27defa
2025-01-01 12:48:06,460 - INFO - [client.py:139] - Client Hello sent from 192.168.1.1
2025-01-01 12:48:06,464 - INFO - [session.py:100] - Client Hello sent successfully
2025-01-01 12:48:06,465 - INFO - [server.py:95] - Generated server_random: 67751d6620750b62cf009f3a6db0122a535c355bfe184db37c8eff1eb22ad7e1
2025-01-01 12:48:06,468 - INFO - [session.py:105] - Server Hello received successfully
2025-01-01 12:48:06,469 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2025-01-01 12:48:06,470 - INFO - [cert.py:108] - File exists: True
2025-01-01 12:48:06,470 - INFO - [cert.py:109] - File size: 1915 bytes
2025-01-01 12:48:06,471 - INFO - [cert.py:113] - Read 1915 bytes
2025-01-01 12:48:06,471 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2025-01-01 12:48:06,471 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2025-01-01 12:48:06,472 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 12:48:06,473 - INFO - [client.py:173] - Prepared client certificate
2025-01-01 12:48:06,473 - INFO - [client.py:188] - Encrypted pre_master_secret length: 256
2025-01-01 12:48:06,474 - INFO - [session.py:110] - Client handshake messages sent successfully
2025-01-01 12:48:06,475 - INFO - [chain.py:227] - Generating Master Secret...
2025-01-01 12:48:06,476 - INFO - [chain.py:185] - Decrypted pre_master_secret: 0303e4da534f6b228d6a44acc74daf8638b1cbb04b788a55cf05ff5b723a35ac5a7e31d4e7306ab7c710cfc98ce86f14
2025-01-01 12:48:06,476 - INFO - [chain.py:195] - Generated master secret: 603d2639bfb52d61a6fe7924f6f5cdbc2540aafe5a6b318ba32fa25f775553b75216cb4b6c9fa963c818c28a35449a95
2025-01-01 12:48:06,477 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-01 12:48:06,477 - INFO - [chain.py:241] - Master Secret generated successfully
2025-01-01 12:48:06,478 - ERROR - [session.py:138] - TLS Handshake failed: Failed to handle Master Secret
2025-01-01 12:48:06,478 - ERROR - [main.py:27] - Session error: Session failed for 192.168.1.1: Session failed: Handshake failed
2025-01-01 12:50:49,998 - INFO - [logging.py:83] - Logging configured successfully
2025-01-01 12:50:49,998 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-01 12:50:49,998 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-01 12:50:49,999 - INFO - [logging.py:92] - Log level: 20
2025-01-01 12:50:49,999 - INFO - [logging.py:93] - Timestamp: 2025-01-01T12:50:49.999203
2025-01-01 12:50:49,999 - INFO - [logging.py:94] - ==========================
2025-01-01 12:50:49,999 - INFO - [main.py:122] - Starting TLS session simulation
2025-01-01 12:50:49,999 - INFO - [main.py:87] - 
--- Client Session (certificate) ---
2025-01-01 12:50:50,000 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-01 12:50:50,000 - INFO - [cert.py:108] - File exists: True
2025-01-01 12:50:50,000 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-01 12:50:50,001 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-01 12:50:50,001 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-01 12:50:50,001 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-01 12:50:50,002 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 12:50:50,002 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-01 12:50:50,003 - INFO - [cert.py:108] - File exists: True
2025-01-01 12:50:50,003 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-01 12:50:50,004 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-01 12:50:50,004 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-01 12:50:50,005 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-01 12:50:50,005 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 12:50:50,038 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-01 12:50:50,039 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-01 12:50:50,039 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-01 12:50:50,040 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-01 12:50:50,041 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-01 12:50:50,042 - INFO - [verify.py:58] - Public key comparison results:
2025-01-01 12:50:50,042 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 12:50:50,042 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 12:50:50,043 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-01 12:50:50,043 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-01 12:50:50,046 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-01 12:50:50,047 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-01 12:50:50,047 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-01 12:50:50,047 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-01 12:50:50,047 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-01 12:50:50,048 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-01 12:50:50,049 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-01 12:50:50,049 - INFO - [session.py:152] - Starting TLS session
2025-01-01 12:50:50,049 - INFO - [session.py:95] - Starting TLS Handshake...
2025-01-01 12:50:50,050 - INFO - [client.py:99] - Generated client_random: 67751e0af6ec3e49d265ac8fc42fcd6197275b5d9e77ca82f32b739c9cd97fe6
2025-01-01 12:50:50,052 - INFO - [client.py:139] - Client Hello sent from 192.168.1.1
2025-01-01 12:50:50,054 - INFO - [session.py:100] - Client Hello sent successfully
2025-01-01 12:50:50,055 - INFO - [server.py:95] - Generated server_random: 67751e0abd5fa4dc443a7fe804d4c00e162f2cc70e3813fc199388a83f4f450c
2025-01-01 12:50:50,060 - INFO - [session.py:105] - Server Hello received successfully
2025-01-01 12:50:50,060 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2025-01-01 12:50:50,061 - INFO - [cert.py:108] - File exists: True
2025-01-01 12:50:50,061 - INFO - [cert.py:109] - File size: 1915 bytes
2025-01-01 12:50:50,062 - INFO - [cert.py:113] - Read 1915 bytes
2025-01-01 12:50:50,062 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2025-01-01 12:50:50,062 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2025-01-01 12:50:50,062 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 12:50:50,063 - INFO - [client.py:173] - Prepared client certificate
2025-01-01 12:50:50,063 - INFO - [client.py:188] - Encrypted pre_master_secret length: 256
2025-01-01 12:50:50,064 - INFO - [session.py:110] - Client handshake messages sent successfully
2025-01-01 12:50:50,064 - INFO - [chain.py:231] - Starting Master Secret generation.
2025-01-01 12:50:50,066 - INFO - [chain.py:185] - Decrypted pre_master_secret: 03038b4eb17fc5e02b4a4380798f239c1063e9f67ab79d5a400fe30747effe2e464c9ef19630afbf8331b36117ea32ac
2025-01-01 12:50:50,067 - INFO - [chain.py:195] - Generated master secret: 43a1488b143160d3ed4a1d9b8bada2c4b74df31709a0afff5a4b30490acae034d140ee52144873ec6d9a01e64f6fcb4b
2025-01-01 12:50:50,067 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-01 12:50:50,067 - INFO - [chain.py:245] - Master Secret generation completed successfully.
2025-01-01 12:50:50,068 - ERROR - [session.py:138] - TLS Handshake failed: Failed to handle Master Secret
2025-01-01 12:50:50,068 - ERROR - [main.py:27] - Session error: Session failed for 192.168.1.1: Session failed: Handshake failed
2025-01-01 13:13:13,885 - INFO - [logging.py:83] - Logging configured successfully
2025-01-01 13:13:13,885 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-01 13:13:13,886 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-01 13:13:13,886 - INFO - [logging.py:92] - Log level: 20
2025-01-01 13:13:13,886 - INFO - [logging.py:93] - Timestamp: 2025-01-01T13:13:13.886550
2025-01-01 13:13:13,886 - INFO - [logging.py:94] - ==========================
2025-01-01 13:13:13,887 - INFO - [main.py:122] - Starting TLS session simulation
2025-01-01 13:13:13,887 - INFO - [main.py:87] - 
--- Client Session (certificate) ---
2025-01-01 13:13:13,888 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-01 13:13:13,888 - INFO - [cert.py:108] - File exists: True
2025-01-01 13:13:13,889 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-01 13:13:13,889 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-01 13:13:13,889 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-01 13:13:13,890 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-01 13:13:13,893 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 13:13:13,894 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-01 13:13:13,894 - INFO - [cert.py:108] - File exists: True
2025-01-01 13:13:13,895 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-01 13:13:13,895 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-01 13:13:13,896 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-01 13:13:13,896 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-01 13:13:13,897 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 13:13:13,935 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-01 13:13:13,935 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-01 13:13:13,935 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-01 13:13:13,936 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-01 13:13:13,939 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-01 13:13:13,939 - INFO - [verify.py:58] - Public key comparison results:
2025-01-01 13:13:13,939 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 13:13:13,940 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 13:13:13,941 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-01 13:13:13,941 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-01 13:13:13,945 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-01 13:13:13,945 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-01 13:13:13,946 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-01 13:13:13,946 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-01 13:13:13,946 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-01 13:13:13,947 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-01 13:13:13,947 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-01 13:13:13,948 - INFO - [session.py:152] - Starting TLS session
2025-01-01 13:13:13,948 - INFO - [session.py:95] - Starting TLS Handshake...
2025-01-01 13:13:13,948 - INFO - [client.py:99] - Generated client_random: 677523493fce236c31126f31af4813857a95ab9bead42b875b3d82986ed1fb72
2025-01-01 13:13:13,953 - INFO - [client.py:139] - Client Hello sent from 192.168.1.1
2025-01-01 13:13:13,955 - INFO - [session.py:100] - Client Hello sent successfully
2025-01-01 13:13:13,956 - INFO - [server.py:95] - Generated server_random: 67752349d54398bac9bd89f7dd38e9abd7a78a667213c16c9b86492b5c481b14
2025-01-01 13:13:13,960 - INFO - [session.py:105] - Server Hello received successfully
2025-01-01 13:13:13,960 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2025-01-01 13:13:13,961 - INFO - [cert.py:108] - File exists: True
2025-01-01 13:13:13,961 - INFO - [cert.py:109] - File size: 1915 bytes
2025-01-01 13:13:13,962 - INFO - [cert.py:113] - Read 1915 bytes
2025-01-01 13:13:13,963 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2025-01-01 13:13:13,963 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2025-01-01 13:13:13,963 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 13:13:13,964 - INFO - [client.py:173] - Prepared client certificate
2025-01-01 13:13:13,964 - INFO - [client.py:188] - Encrypted pre_master_secret length: 256
2025-01-01 13:13:13,965 - INFO - [session.py:110] - Client handshake messages sent successfully
2025-01-01 13:13:13,966 - INFO - [chain.py:231] - Starting Master Secret generation.
2025-01-01 13:13:13,967 - INFO - [chain.py:185] - Decrypted pre_master_secret: 0303e8a362a15226d4834584bd7735a13173bbf6519470314e3f57afce6a47214ea8dd59960ce1d8909d527c54a3171c
2025-01-01 13:13:13,968 - INFO - [chain.py:195] - Generated master secret: 0bd86a56b3d5f66db585aea8ef13f82f073a0433625c8f084f15b893a53fd725c6ea28ccda593f72babd3cc65ca4dd65
2025-01-01 13:13:13,968 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-01 13:13:13,968 - INFO - [chain.py:245] - Master Secret generation completed successfully.
2025-01-01 13:13:13,969 - ERROR - [session.py:138] - TLS Handshake failed: Failed to handle Master Secret
2025-01-01 13:13:13,969 - ERROR - [main.py:27] - Session error: Session failed for 192.168.1.1: Session failed: Handshake failed
2025-01-01 13:18:06,176 - INFO - [logging.py:83] - Logging configured successfully
2025-01-01 13:18:06,176 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-01 13:18:06,177 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-01 13:18:06,177 - INFO - [logging.py:92] - Log level: 20
2025-01-01 13:18:06,177 - INFO - [logging.py:93] - Timestamp: 2025-01-01T13:18:06.177700
2025-01-01 13:18:06,178 - INFO - [logging.py:94] - ==========================
2025-01-01 13:18:06,178 - INFO - [main.py:122] - Starting TLS session simulation
2025-01-01 13:18:06,179 - INFO - [main.py:87] - 
--- Client Session (certificate) ---
2025-01-01 13:18:06,180 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-01 13:18:06,180 - INFO - [cert.py:108] - File exists: True
2025-01-01 13:18:06,181 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-01 13:18:06,181 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-01 13:18:06,182 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-01 13:18:06,182 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-01 13:18:06,183 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 13:18:06,184 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-01 13:18:06,185 - INFO - [cert.py:108] - File exists: True
2025-01-01 13:18:06,185 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-01 13:18:06,185 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-01 13:18:06,186 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-01 13:18:06,186 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-01 13:18:06,187 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 13:18:06,244 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-01 13:18:06,247 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-01 13:18:06,257 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-01 13:18:06,262 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-01 13:18:06,268 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-01 13:18:06,270 - INFO - [verify.py:58] - Public key comparison results:
2025-01-01 13:18:06,271 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 13:18:06,272 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 13:18:06,275 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-01 13:18:06,277 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-01 13:18:06,297 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-01 13:18:06,300 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-01 13:18:06,301 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-01 13:18:06,301 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-01 13:18:06,302 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-01 13:18:06,302 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-01 13:18:06,304 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-01 13:18:06,305 - INFO - [session.py:157] - Starting TLS session
2025-01-01 13:18:06,305 - INFO - [session.py:96] - Starting TLS Handshake...
2025-01-01 13:18:06,306 - INFO - [client.py:99] - Generated client_random: 6775246e09354647408a2638902e8f5efc37e387d43b9d7204200838abee3e2b
2025-01-01 13:18:06,309 - INFO - [client.py:139] - Client Hello sent from 192.168.1.1
2025-01-01 13:18:06,313 - INFO - [session.py:101] - Client Hello sent successfully
2025-01-01 13:18:06,314 - INFO - [server.py:95] - Generated server_random: 6775246e68fe14e4d5adec9f67be31ba16db9e7b38fc416659ba632555c04c15
2025-01-01 13:18:06,318 - INFO - [session.py:106] - Server Hello received successfully
2025-01-01 13:18:06,319 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2025-01-01 13:18:06,320 - INFO - [cert.py:108] - File exists: True
2025-01-01 13:18:06,321 - INFO - [cert.py:109] - File size: 1915 bytes
2025-01-01 13:18:06,322 - INFO - [cert.py:113] - Read 1915 bytes
2025-01-01 13:18:06,322 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2025-01-01 13:18:06,323 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2025-01-01 13:18:06,324 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 13:18:06,325 - INFO - [client.py:173] - Prepared client certificate
2025-01-01 13:18:06,333 - INFO - [client.py:188] - Encrypted pre_master_secret length: 256
2025-01-01 13:18:06,340 - INFO - [session.py:111] - Client handshake messages sent successfully
2025-01-01 13:18:06,343 - INFO - [session.py:116] - Server key pair verified successfully
2025-01-01 13:18:06,344 - INFO - [chain.py:231] - Starting Master Secret generation.
2025-01-01 13:18:06,346 - INFO - [chain.py:185] - Decrypted pre_master_secret: 0303121105067b9eaa8b12d73cd9a55dfe6c12a1e6ae81a5be5bdb641a3dc09839b3262d4d1c2f232b7e3635e29c32a7
2025-01-01 13:18:06,346 - INFO - [chain.py:195] - Generated master secret: c12cd1944dfc944196cb8943400faaccbee0feb6283f5c5b03c82741a323a4032ef0fc284afb1371e3aca47721aadc92
2025-01-01 13:18:06,346 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-01 13:18:06,347 - INFO - [chain.py:245] - Master Secret generation completed successfully.
2025-01-01 13:18:06,347 - ERROR - [session.py:143] - TLS Handshake failed: Failed to handle Master Secret
2025-01-01 13:18:06,348 - ERROR - [main.py:27] - Session error: Session failed for 192.168.1.1: Session failed: Handshake failed
2025-01-01 13:24:01,420 - INFO - [logging.py:83] - Logging configured successfully
2025-01-01 13:24:01,420 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-01 13:24:01,421 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-01 13:24:01,421 - INFO - [logging.py:92] - Log level: 20
2025-01-01 13:24:01,422 - INFO - [logging.py:93] - Timestamp: 2025-01-01T13:24:01.422281
2025-01-01 13:24:01,422 - INFO - [logging.py:94] - ==========================
2025-01-01 13:24:01,422 - INFO - [main.py:122] - Starting TLS session simulation
2025-01-01 13:24:01,423 - INFO - [main.py:87] - 
--- Client Session (certificate) ---
2025-01-01 13:24:01,424 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-01 13:24:01,424 - INFO - [cert.py:108] - File exists: True
2025-01-01 13:24:01,425 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-01 13:24:01,425 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-01 13:24:01,425 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-01 13:24:01,426 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-01 13:24:01,430 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 13:24:01,431 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-01 13:24:01,432 - INFO - [cert.py:108] - File exists: True
2025-01-01 13:24:01,432 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-01 13:24:01,433 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-01 13:24:01,433 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-01 13:24:01,433 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-01 13:24:01,434 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 13:24:01,471 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-01 13:24:01,472 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-01 13:24:01,472 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-01 13:24:01,473 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-01 13:24:01,476 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-01 13:24:01,476 - INFO - [verify.py:58] - Public key comparison results:
2025-01-01 13:24:01,476 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 13:24:01,477 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 13:24:01,477 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-01 13:24:01,477 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-01 13:24:01,487 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-01 13:24:01,488 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-01 13:24:01,489 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-01 13:24:01,489 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-01 13:24:01,490 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-01 13:24:01,490 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-01 13:24:01,491 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-01 13:24:01,492 - INFO - [session.py:157] - Starting TLS session
2025-01-01 13:24:01,492 - INFO - [session.py:96] - Starting TLS Handshake...
2025-01-01 13:24:01,492 - INFO - [client.py:99] - Generated client_random: 677525d107bf2d1b79b3ea92f6f8cc5626f153983c18042d2358c7a17132926c
2025-01-01 13:24:01,494 - INFO - [client.py:139] - Client Hello sent from 192.168.1.1
2025-01-01 13:24:01,497 - INFO - [session.py:101] - Client Hello sent successfully
2025-01-01 13:24:01,497 - INFO - [server.py:95] - Generated server_random: 677525d1ef978f32283f25ad0c60c7b6c4f5e634e68a2de25d19c75a2f0f3b85
2025-01-01 13:24:01,503 - INFO - [session.py:106] - Server Hello received successfully
2025-01-01 13:24:01,503 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2025-01-01 13:24:01,504 - INFO - [cert.py:108] - File exists: True
2025-01-01 13:24:01,504 - INFO - [cert.py:109] - File size: 1915 bytes
2025-01-01 13:24:01,505 - INFO - [cert.py:113] - Read 1915 bytes
2025-01-01 13:24:01,505 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2025-01-01 13:24:01,506 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2025-01-01 13:24:01,506 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 13:24:01,507 - INFO - [client.py:173] - Prepared client certificate
2025-01-01 13:24:01,508 - INFO - [client.py:188] - Encrypted pre_master_secret length: 256
2025-01-01 13:24:01,509 - INFO - [session.py:111] - Client handshake messages sent successfully
2025-01-01 13:24:01,510 - INFO - [session.py:116] - Server key pair verified successfully
2025-01-01 13:24:01,510 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-01 13:24:01,511 - INFO - [chain.py:185] - Decrypted pre_master_secret: 030361e7b380a1162489103f4787e5136ed3ece9b73d3998b7e658d657ed29acd3426a0e093f5c6cba7b540778bf4cbf
2025-01-01 13:24:01,512 - INFO - [chain.py:195] - Generated master secret: 69ffc47235c6629abc659df640764b6f9a00f502d5b07aee929bdc0eca9295804d7fa3c8fd30cf25b86f5afa97677bf7
2025-01-01 13:24:01,512 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-01 13:24:01,512 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-01 13:24:01,513 - INFO - [session.py:120] - Master Secret handled successfully
2025-01-01 13:24:01,514 - INFO - [client.py:269] - Pre-master secret validated successfully
2025-01-01 13:24:01,516 - INFO - [client.py:287] - Generated digital signature: 505be67c9375110a5dfeddc127f8fd93b8286f7bce0f69b7a697e1bca6a5a65c22d70d94301fcd2cdf59875c71b5cdb8131f8a42f164ae38adf230916b1fc6182667648896ff416591ec5271a9a329385432a7554093ec8804651b209072d292f05618da8df1bd7a92ba65089440b1754285f3381470682671ddce5eeeec038ea1245b9c2d364dc6d0fb3012cc6d8716115a980d20eedd6ef42f800740bdd87ca9bb4ccafc0be0b13666cda4a3e551323ab278ca3b7e28bce5ca9544699431f9b5f1a22d5c4a1651f6f98144289dbdad649cc699672f046b866f63217b6da1960879241a8c9c550ca39f16b84e16e4de42e0fe3fa58cfb92ea26cedd6b1060cb
2025-01-01 13:24:01,519 - INFO - [client.py:333] - Client ChangeCipherSpec and Finished messages sent
2025-01-01 13:24:01,520 - INFO - [session.py:125] - Client Change Cipher Spec sent successfully
2025-01-01 13:24:01,521 - INFO - [server.py:256] - Pre-master secret validated successfully
2025-01-01 13:24:01,522 - INFO - [server.py:274] - Generated digital signature: 5383f45d6c21f55fd1721811b11c6cb3c6d1899747d09ee3c74e0004296edb710b8e398bad1e2106ff31325ddc72e28511a69cc503ae200cc75baa918432a4afefc902b5eeace09ddf8087a20a7665ddf766863ac5751211703b05e327d141b1263af45653c0c66c0cbc6548e28b9716e9f5471b485235586870eeb25b2c118cbec25e63ebe53edbe439a8084d76617659ce6600fd0ade8c7167436057c10f9335fd19b4fde2f8448421ef7893cf2e22b2635a2f0324e643dd749f2d79244d436a5d014157355a680c5f17fc611b23a0b5c8e824386131df3a8eb3fd63b34aa8cd0d682c6e76711abd701049aad6bb6f7b4b056384a2c115de617d418fb0a245
2025-01-01 13:24:01,523 - INFO - [server.py:320] - Server ChangeCipherSpec and Finished messages sent
2025-01-01 13:24:01,524 - INFO - [session.py:130] - Server Change Cipher Spec received successfully
2025-01-01 13:24:01,525 - INFO - [keys.py:205] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-01 13:24:01,525 - ERROR - [session.py:143] - TLS Handshake failed: Failed to handle SSL Key Log
2025-01-01 13:24:01,526 - ERROR - [main.py:27] - Session error: Session failed for 192.168.1.1: Session failed: Handshake failed
2025-01-01 13:25:59,303 - INFO - [logging.py:83] - Logging configured successfully
2025-01-01 13:25:59,304 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-01 13:25:59,304 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-01 13:25:59,304 - INFO - [logging.py:92] - Log level: 20
2025-01-01 13:25:59,305 - INFO - [logging.py:93] - Timestamp: 2025-01-01T13:25:59.305245
2025-01-01 13:25:59,305 - INFO - [logging.py:94] - ==========================
2025-01-01 13:25:59,305 - INFO - [main.py:122] - Starting TLS session simulation
2025-01-01 13:25:59,306 - INFO - [main.py:87] - 
--- Client Session (certificate) ---
2025-01-01 13:25:59,306 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-01 13:25:59,307 - INFO - [cert.py:108] - File exists: True
2025-01-01 13:25:59,307 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-01 13:25:59,307 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-01 13:25:59,308 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-01 13:25:59,308 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-01 13:25:59,308 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 13:25:59,309 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-01 13:25:59,309 - INFO - [cert.py:108] - File exists: True
2025-01-01 13:25:59,309 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-01 13:25:59,310 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-01 13:25:59,310 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-01 13:25:59,310 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-01 13:25:59,311 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 13:25:59,340 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-01 13:25:59,341 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-01 13:25:59,342 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-01 13:25:59,342 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-01 13:25:59,344 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-01 13:25:59,345 - INFO - [verify.py:58] - Public key comparison results:
2025-01-01 13:25:59,345 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 13:25:59,345 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 13:25:59,346 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-01 13:25:59,347 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-01 13:25:59,354 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-01 13:25:59,355 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-01 13:25:59,355 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-01 13:25:59,355 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-01 13:25:59,356 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-01 13:25:59,356 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-01 13:25:59,356 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-01 13:25:59,357 - INFO - [session.py:157] - Starting TLS session
2025-01-01 13:25:59,357 - INFO - [session.py:96] - Starting TLS Handshake...
2025-01-01 13:25:59,357 - INFO - [client.py:99] - Generated client_random: 67752647098419b68638e1444469e9259269656690d39ad443eec1b8496e1e18
2025-01-01 13:25:59,360 - INFO - [client.py:139] - Client Hello sent from 192.168.1.1
2025-01-01 13:25:59,363 - INFO - [session.py:101] - Client Hello sent successfully
2025-01-01 13:25:59,363 - INFO - [server.py:95] - Generated server_random: 67752647b1842d593504c1d820f40aeb2fdd469bebfa7e108835e01ee53db238
2025-01-01 13:25:59,369 - INFO - [session.py:106] - Server Hello received successfully
2025-01-01 13:25:59,370 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2025-01-01 13:25:59,371 - INFO - [cert.py:108] - File exists: True
2025-01-01 13:25:59,371 - INFO - [cert.py:109] - File size: 1915 bytes
2025-01-01 13:25:59,372 - INFO - [cert.py:113] - Read 1915 bytes
2025-01-01 13:25:59,372 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2025-01-01 13:25:59,372 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2025-01-01 13:25:59,373 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 13:25:59,373 - INFO - [client.py:173] - Prepared client certificate
2025-01-01 13:25:59,374 - INFO - [client.py:188] - Encrypted pre_master_secret length: 256
2025-01-01 13:25:59,375 - INFO - [session.py:111] - Client handshake messages sent successfully
2025-01-01 13:25:59,376 - INFO - [session.py:116] - Server key pair verified successfully
2025-01-01 13:25:59,376 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-01 13:25:59,378 - INFO - [chain.py:185] - Decrypted pre_master_secret: 03039287111dcdbd585fd6bb2a26437fe9644ab73f4cfefbdd5a37fb7e8fa2328dd070a8dfaf17128361c9b30ddde7b6
2025-01-01 13:25:59,378 - INFO - [chain.py:195] - Generated master secret: 615e6cdaa0c22a10d893ece7199e54cf2941340dc910bee5587ce6e5bcc3e437dd0cc0b57d8cde73fba96e2207555689
2025-01-01 13:25:59,379 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-01 13:25:59,379 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-01 13:25:59,379 - INFO - [session.py:120] - Master Secret handled successfully
2025-01-01 13:25:59,380 - INFO - [client.py:269] - Pre-master secret validated successfully
2025-01-01 13:25:59,381 - INFO - [client.py:287] - Generated digital signature: d4ed665e68b9238dde0223759b885e0996e4275c86aaa00583c2be3bf4c31a64ad4157dc5e831321fbc67431cb96b93a2ed0adeb5dd39f4c975d19c53ce03f659b80a2ed5254aa67dcc378a464768ceca453d90b67458d6207f40ce145d39ede30c3a4685731deec19708e8a52608717404bea4491aef7f37949e62ef39c2c42d5dfde3cbd3580040140574f7ee805e66cdeb70dfdfd30a404c2e2cd7a526ecbc1c9b7f638dab182571bb04dd66d9ae1ad14a9086c30bee197f0b51bb6fbf0862ec41d928be3f2cdf69242c475e36d2436ab108238e677156bdc00ae281e595b8f8e610b5d05b65ad3ecccb36cf50668dc08fa1750aee748f31e12295b53f5ca
2025-01-01 13:25:59,385 - INFO - [client.py:333] - Client ChangeCipherSpec and Finished messages sent
2025-01-01 13:25:59,386 - INFO - [session.py:125] - Client Change Cipher Spec sent successfully
2025-01-01 13:25:59,387 - INFO - [server.py:256] - Pre-master secret validated successfully
2025-01-01 13:25:59,388 - INFO - [server.py:274] - Generated digital signature: 7b953073bda1d18d483881b5337db01ce906be6205cb2ba3289d82cd5f978b56ff856a34f1cd5c6dc09b4a7a17b09c234d85addcf2d14a208180e94e751171797a268820a006fabf2bdef197270f7060285d22c37340a2258e211e6ee01efb1afd2d5cd45facb38db9300a5094191c067e5918cc3bb40198d96f291201388cf4672a3580de37403d7d4aa479f2372adbb689c8f48b431aa407f8ea646a161f18dce985c4d4ddf9c316edab01b3a4f13a7bf7c84f504eea7be25a6b34c40436242435b30963c7a92b2583ca1da1ad32ea1499d8783e23392dccf790241ac372c98ff938d30e182f7cf7a573c96b8eedc241e601fb82a2c1ab8bbc262b1d5c8384
2025-01-01 13:25:59,389 - INFO - [server.py:320] - Server ChangeCipherSpec and Finished messages sent
2025-01-01 13:25:59,391 - INFO - [session.py:130] - Server Change Cipher Spec received successfully
2025-01-01 13:25:59,392 - INFO - [keys.py:218] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-01 13:25:59,392 - INFO - [session.py:135] - SSL Key Log handled successfully
2025-01-01 13:25:59,392 - INFO - [session.py:139] - TLS Handshake completed successfully
2025-01-01 13:25:59,393 - INFO - [session.py:168] - Found file to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 13:25:59,393 - INFO - [session.py:186] - Handshake completed: True
2025-01-01 13:25:59,393 - INFO - [session.py:187] - Use client cert: True
2025-01-01 13:25:59,394 - INFO - [session.py:188] - File to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 13:25:59,394 - INFO - [session.py:191] - Using encrypted exchange
2025-01-01 13:25:59,395 - INFO - [session.py:206] - Sending encrypted request data
2025-01-01 13:25:59,397 - INFO - [keys.py:185] - TLS Application Data sent from 192.168.1.1:12345 to 10.0.0.1:443
2025-01-01 13:25:59,398 - INFO - [session.py:217] - Sending encrypted response data
2025-01-01 13:25:59,401 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-01 13:25:59,402 - INFO - [session.py:229] - Attempting to send file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 13:25:59,402 - INFO - [session.py:240] - Opening file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 13:25:59,404 - INFO - [session.py:247] - Read 1103 bytes from file
2025-01-01 13:25:59,405 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-01 13:25:59,405 - INFO - [session.py:256] - File sent successfully
2025-01-01 13:25:59,406 - INFO - [session.py:231] - File sent successfully
2025-01-01 13:25:59,406 - INFO - [main.py:95] - Session completed successfully for 192.168.1.1
2025-01-01 13:25:59,406 - INFO - [main.py:87] - 
--- Client Session (no certificate) ---
2025-01-01 13:25:59,407 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-01 13:25:59,407 - INFO - [cert.py:108] - File exists: True
2025-01-01 13:25:59,407 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-01 13:25:59,407 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-01 13:25:59,408 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-01 13:25:59,408 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-01 13:25:59,408 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 13:25:59,408 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-01 13:25:59,409 - INFO - [cert.py:108] - File exists: True
2025-01-01 13:25:59,409 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-01 13:25:59,409 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-01 13:25:59,410 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-01 13:25:59,410 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-01 13:25:59,411 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 13:25:59,440 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-01 13:25:59,441 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-01 13:25:59,441 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-01 13:25:59,441 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-01 13:25:59,442 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-01 13:25:59,442 - INFO - [verify.py:58] - Public key comparison results:
2025-01-01 13:25:59,442 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 13:25:59,443 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 13:25:59,444 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-01 13:25:59,445 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-01 13:25:59,446 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-01 13:25:59,446 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-01 13:25:59,446 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-01 13:25:59,447 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-01 13:25:59,447 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-01 13:25:59,448 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-01 13:25:59,449 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-01 13:25:59,450 - INFO - [session.py:157] - Starting TLS session
2025-01-01 13:25:59,450 - INFO - [session.py:96] - Starting TLS Handshake...
2025-01-01 13:25:59,450 - INFO - [client.py:99] - Generated client_random: 67752647471cf1c708417880a95abbb5c3bdc30aaa12ddb66540eaa309613ece
2025-01-01 13:25:59,452 - INFO - [client.py:139] - Client Hello sent from 192.168.1.2
2025-01-01 13:25:59,455 - INFO - [session.py:101] - Client Hello sent successfully
2025-01-01 13:25:59,456 - INFO - [server.py:95] - Generated server_random: 67752647cb370f2f18401b421b33758aec478b5366a6ecc378431b4f1dbc64c9
2025-01-01 13:25:59,460 - INFO - [session.py:106] - Server Hello received successfully
2025-01-01 13:25:59,461 - INFO - [client.py:176] - Prepared empty certificate
2025-01-01 13:25:59,461 - INFO - [client.py:188] - Encrypted pre_master_secret length: 256
2025-01-01 13:25:59,463 - INFO - [session.py:111] - Client handshake messages sent successfully
2025-01-01 13:25:59,464 - INFO - [session.py:116] - Server key pair verified successfully
2025-01-01 13:25:59,465 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-01 13:25:59,467 - INFO - [chain.py:185] - Decrypted pre_master_secret: 0303c4ffc1f1905576a3af9d4470f1a73de5e9dd92bdd517a375da73186606eb84b4cc22723b22a28ae0cb42191863e5
2025-01-01 13:25:59,468 - INFO - [chain.py:195] - Generated master secret: c89320888bd5da13b21367c3743b8c61d743995d9f4bfe4e1186033d8b70c669308e13b94ea41b661ed28a2a402ad9d6
2025-01-01 13:25:59,469 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-01 13:25:59,469 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-01 13:25:59,470 - INFO - [session.py:120] - Master Secret handled successfully
2025-01-01 13:25:59,471 - INFO - [client.py:269] - Pre-master secret validated successfully
2025-01-01 13:25:59,471 - INFO - [client.py:287] - Generated digital signature: 20944a5c46d6d97c9317162d87137cae8c2c0c2bc0fd68fb6724cffed3ff4da91008b4d442518183d1ac244782a3218878be3af365290a75b126903c1b54d2c2f142391afccb79a9e41db98a14280cf2fd89b9aef00e5ae1d9a780388cb363a8f74bc33093f9709beb43aa83fb017c1ba6fc29af6203ce3be36573b8bca0613e875c8c8a3f55806bb4cde6a02fc51ee27041cbc5d5fa3f232f5ba881b18313951cab27cc390ee5cc9312d95416cce582f5d3c5d3aea3dd71c4639a2bbab3d7a4e9599b64ede5224e329103bedd9b001fe0849618b104e8e94e2ba01b9d4b680a49b238044f6aa7e25987e7f53f16f2d214d51b9d1484bd9c8649cf8f808dc954
2025-01-01 13:25:59,473 - INFO - [client.py:333] - Client ChangeCipherSpec and Finished messages sent
2025-01-01 13:25:59,474 - INFO - [session.py:125] - Client Change Cipher Spec sent successfully
2025-01-01 13:25:59,475 - INFO - [server.py:256] - Pre-master secret validated successfully
2025-01-01 13:25:59,476 - INFO - [server.py:274] - Generated digital signature: 550f0839030e99e41157965d80462c7d4d13a39882ec3f46cd1de4aa598ff5867f15eea2aa0e5cbb1f33cd4f2692a7b52871f7e958f7431f2e1f575db5e9cfac413d1922b989559fb9120d4a9ec1211755260f3b4af46ffcddfb658779cd583e01d4e4dda9c8c96432e15ddd3ee13758e602d06f328efc1cfac74cb56b72325333c8bf95c1ff5e67f76ea49e0439656db03d63d62296ecfab7f3af6dac838d1fba1cf7b50302d0f7060f258ad98f37442da77ef95368bba323ca86de604b6b6e6275a7181feb64aca22d8a46e8610442cc5c8b05417cac7e14994246325f2e7a2afa71652020bca19efcd455a5418b86e6eaef29d2d5539df7d9338620670bef
2025-01-01 13:25:59,478 - INFO - [server.py:320] - Server ChangeCipherSpec and Finished messages sent
2025-01-01 13:25:59,479 - INFO - [session.py:130] - Server Change Cipher Spec received successfully
2025-01-01 13:25:59,480 - INFO - [keys.py:218] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-01 13:25:59,480 - INFO - [session.py:135] - SSL Key Log handled successfully
2025-01-01 13:25:59,481 - INFO - [session.py:139] - TLS Handshake completed successfully
2025-01-01 13:25:59,481 - INFO - [session.py:186] - Handshake completed: True
2025-01-01 13:25:59,481 - INFO - [session.py:187] - Use client cert: False
2025-01-01 13:25:59,482 - INFO - [session.py:188] - File to send: None
2025-01-01 13:25:59,482 - INFO - [session.py:194] - Using unencrypted exchange
2025-01-01 13:25:59,483 - INFO - [session.py:294] - Added request packet
2025-01-01 13:25:59,484 - INFO - [session.py:294] - Added response packet
2025-01-01 13:25:59,485 - WARNING - [session.py:271] - Using unencrypted communication
2025-01-01 13:25:59,485 - INFO - [main.py:95] - Session completed successfully for 192.168.1.2
2025-01-01 13:25:59,486 - INFO - [pcap_writer.py:232] - Packet 13: Valid HTTP message
2025-01-01 13:25:59,486 - INFO - [pcap_writer.py:232] - Packet 14: Valid HTTP message
2025-01-01 13:25:59,492 - INFO - [pcap_writer.py:387] - Saved 15 valid packets to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-01 13:25:59,493 - INFO - [pcap_writer.py:409] - Verifying 15 packets...
2025-01-01 13:25:59,494 - INFO - [pcap_writer.py:413] - Packet 1: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 13:25:59,494 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2025-01-01 13:25:59,495 - INFO - [pcap_writer.py:413] - Packet 2: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 13:25:59,495 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2775
2025-01-01 13:25:59,495 - INFO - [pcap_writer.py:413] - Packet 3: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 13:25:59,496 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 1646
2025-01-01 13:25:59,496 - INFO - [pcap_writer.py:413] - Packet 4: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 13:25:59,497 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-01 13:25:59,497 - INFO - [pcap_writer.py:413] - Packet 5: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 13:25:59,497 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-01 13:25:59,498 - INFO - [pcap_writer.py:413] - Packet 6: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 13:25:59,498 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 160
2025-01-01 13:25:59,499 - INFO - [pcap_writer.py:413] - Packet 7: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 13:25:59,499 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 128
2025-01-01 13:25:59,500 - INFO - [pcap_writer.py:413] - Packet 8: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 13:25:59,500 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 1152
2025-01-01 13:25:59,500 - INFO - [pcap_writer.py:413] - Packet 9: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-01 13:25:59,501 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2025-01-01 13:25:59,501 - INFO - [pcap_writer.py:413] - Packet 10: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-01 13:25:59,501 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2775
2025-01-01 13:25:59,501 - INFO - [pcap_writer.py:413] - Packet 11: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-01 13:25:59,501 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 269
2025-01-01 13:25:59,502 - INFO - [pcap_writer.py:413] - Packet 12: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-01 13:25:59,502 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-01 13:25:59,502 - INFO - [pcap_writer.py:413] - Packet 13: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-01 13:25:59,503 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-01 13:25:59,503 - INFO - [pcap_writer.py:413] - Packet 14: IP / TCP 192.168.1.2:12346 > 10.0.0.1:http PA / Raw
2025-01-01 13:25:59,503 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2025-01-01 13:25:59,504 - INFO - [pcap_writer.py:413] - Packet 15: IP / TCP 10.0.0.1:http > 192.168.1.2:12346 PA / Raw
2025-01-01 13:25:59,504 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2025-01-01 13:25:59,504 - INFO - [pcap_writer.py:427] - Verification complete: 15 valid packets, 15 TLS records
2025-01-01 13:25:59,504 - INFO - [main.py:106] - Results saved to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-01 13:25:59,505 - INFO - [main.py:160] - TLS session simulation completed successfully
2025-01-01 13:31:30,147 - INFO - [logging.py:83] - Logging configured successfully
2025-01-01 13:31:30,148 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-01 13:31:30,149 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-01 13:31:30,149 - INFO - [logging.py:92] - Log level: 20
2025-01-01 13:31:30,149 - INFO - [logging.py:93] - Timestamp: 2025-01-01T13:31:30.149721
2025-01-01 13:31:30,149 - INFO - [logging.py:94] - ==========================
2025-01-01 13:31:30,150 - INFO - [main.py:122] - Starting TLS session simulation
2025-01-01 13:31:30,150 - INFO - [main.py:87] - 
--- Client Session (certificate) ---
2025-01-01 13:31:30,151 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-01 13:31:30,152 - INFO - [cert.py:108] - File exists: True
2025-01-01 13:31:30,152 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-01 13:31:30,153 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-01 13:31:30,153 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-01 13:31:30,154 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-01 13:31:30,158 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 13:31:30,158 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-01 13:31:30,159 - INFO - [cert.py:108] - File exists: True
2025-01-01 13:31:30,159 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-01 13:31:30,160 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-01 13:31:30,160 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-01 13:31:30,160 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-01 13:31:30,161 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 13:31:30,199 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-01 13:31:30,200 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-01 13:31:30,200 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-01 13:31:30,202 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-01 13:31:30,205 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-01 13:31:30,206 - INFO - [verify.py:58] - Public key comparison results:
2025-01-01 13:31:30,206 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 13:31:30,206 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 13:31:30,207 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-01 13:31:30,207 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-01 13:31:30,213 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-01 13:31:30,214 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-01 13:31:30,215 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-01 13:31:30,215 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-01 13:31:30,216 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-01 13:31:30,216 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-01 13:31:30,217 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-01 13:31:30,218 - INFO - [session.py:157] - Starting TLS session
2025-01-01 13:31:30,219 - INFO - [session.py:96] - Starting TLS Handshake...
2025-01-01 13:31:30,219 - INFO - [client.py:99] - Generated client_random: 677527923801c73c1e8fc25845dde3a71f2c2f995bcab1062f008ce697c748d1
2025-01-01 13:31:30,222 - INFO - [client.py:139] - Client Hello sent from 192.168.1.1
2025-01-01 13:31:30,224 - INFO - [session.py:101] - Client Hello sent successfully
2025-01-01 13:31:30,225 - INFO - [server.py:95] - Generated server_random: 6775279241c728cbb788cc4b34bed16279a32144ff9ea7357dc7830af56008a7
2025-01-01 13:31:30,229 - INFO - [session.py:106] - Server Hello received successfully
2025-01-01 13:31:30,229 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2025-01-01 13:31:30,230 - INFO - [cert.py:108] - File exists: True
2025-01-01 13:31:30,230 - INFO - [cert.py:109] - File size: 1915 bytes
2025-01-01 13:31:30,231 - INFO - [cert.py:113] - Read 1915 bytes
2025-01-01 13:31:30,231 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2025-01-01 13:31:30,232 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2025-01-01 13:31:30,233 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 13:31:30,233 - INFO - [client.py:173] - Prepared client certificate
2025-01-01 13:31:30,234 - INFO - [client.py:188] - Encrypted pre_master_secret length: 256
2025-01-01 13:31:30,236 - INFO - [session.py:111] - Client handshake messages sent successfully
2025-01-01 13:31:30,237 - INFO - [session.py:116] - Server key pair verified successfully
2025-01-01 13:31:30,237 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-01 13:31:30,238 - INFO - [chain.py:185] - Decrypted pre_master_secret: 0303b7b69c1fc229c4031929f7997b3766435a1054d972641689cb4fc1c02bbef42ec01a28f24c6404d8588d43a981d9
2025-01-01 13:31:30,238 - INFO - [chain.py:195] - Generated master secret: 15aca1b8198d2c61ba9c5e58657d45aae94b3c42b67157da6fe363f370794cdc984e969d2ff849e907a5d703549d3d3f
2025-01-01 13:31:30,239 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-01 13:31:30,239 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-01 13:31:30,239 - INFO - [session.py:120] - Master Secret handled successfully
2025-01-01 13:31:30,240 - INFO - [client.py:269] - Pre-master secret validated successfully
2025-01-01 13:31:30,241 - INFO - [client.py:287] - Generated digital signature: c0fb289cd79e48ad7cde7eb7d7b6c78244bab1073b58331e888c5d1bd2de6647a7a53224fec77eadae83dda5da934b4cbe1980fe9a10a056d187f9d8571029cbdcd788e1d9c45ff39339eb539f95cde1e88569f9e804b20abda70d11689619400ad813a5d6dbc90c474877a50b2c0319d12bcea2b082de03b0596f8419f80d6f24602ad5cc2e21ea6182954cccfebb57c020af798f562001406b75e0e7479e8b7047442c0845fabdb6432ba6a3ed581945207e9f4f06c57b129f87b0243b800c7860988cb800d825e0aa1a1ecd42efa1966effd7a7a3eac8981cd1182a98940fbac222c6a9a36e1803c3fd36e9f20c5872b59254632a8fbd08dcff5d3a7d7d4c
2025-01-01 13:31:30,242 - INFO - [client.py:333] - Client ChangeCipherSpec and Finished messages sent
2025-01-01 13:31:30,243 - INFO - [session.py:125] - Client Change Cipher Spec sent successfully
2025-01-01 13:31:30,244 - INFO - [server.py:256] - Pre-master secret validated successfully
2025-01-01 13:31:30,245 - INFO - [server.py:274] - Generated digital signature: 4d7ca3d6b0706f262f2fe1db4b12dd7bb9341be362ebfc26b37d534ddca725b32274a00fb0d637c027a42d5d80adf05e2273dd6d6e93c89bd41d22c00f0b7c3d9200d0050686fd370b4457c87a2e072615480831581e62e8dcbe334b308db55a4740a312fcd68001f377a8fc3e006d6c32c79cad31af3af64aaf2c75eda20aec2f575ae7ee00f031e519dd5d9aac05207fd97e7589f54a2247de01b6aafdc064ee309e991ebf0454cb65af310f0acbe4399eea713af8ec64baba5222c112764ba09810afa818bb32aba330f7b0196a9473926e0f26bf4efb9f9c9d2bb44b779942fcf3a80402619c2f1260bf2d7b2b572487ba6ad5c7e63a85b757872294c0dc
2025-01-01 13:31:30,246 - INFO - [server.py:320] - Server ChangeCipherSpec and Finished messages sent
2025-01-01 13:31:30,247 - INFO - [session.py:130] - Server Change Cipher Spec received successfully
2025-01-01 13:31:30,248 - INFO - [keys.py:212] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-01 13:31:30,249 - INFO - [session.py:135] - SSL Key Log handled successfully
2025-01-01 13:31:30,249 - INFO - [session.py:139] - TLS Handshake completed successfully
2025-01-01 13:31:30,250 - INFO - [session.py:168] - Found file to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 13:31:30,250 - INFO - [session.py:186] - Handshake completed: True
2025-01-01 13:31:30,250 - INFO - [session.py:187] - Use client cert: True
2025-01-01 13:31:30,251 - INFO - [session.py:188] - File to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 13:31:30,251 - INFO - [session.py:191] - Using encrypted exchange
2025-01-01 13:31:30,252 - INFO - [session.py:206] - Sending encrypted request data
2025-01-01 13:31:30,254 - INFO - [keys.py:185] - TLS Application Data sent from 192.168.1.1:12345 to 10.0.0.1:443
2025-01-01 13:31:30,255 - INFO - [session.py:217] - Sending encrypted response data
2025-01-01 13:31:30,256 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-01 13:31:30,256 - INFO - [session.py:229] - Attempting to send file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 13:31:30,257 - INFO - [session.py:240] - Opening file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 13:31:30,257 - INFO - [session.py:247] - Read 1103 bytes from file
2025-01-01 13:31:30,258 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-01 13:31:30,259 - INFO - [session.py:256] - File sent successfully
2025-01-01 13:31:30,259 - INFO - [session.py:231] - File sent successfully
2025-01-01 13:31:30,259 - INFO - [main.py:95] - Session completed successfully for 192.168.1.1
2025-01-01 13:31:30,259 - INFO - [main.py:87] - 
--- Client Session (no certificate) ---
2025-01-01 13:31:30,260 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-01 13:31:30,260 - INFO - [cert.py:108] - File exists: True
2025-01-01 13:31:30,260 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-01 13:31:30,261 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-01 13:31:30,261 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-01 13:31:30,261 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-01 13:31:30,262 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 13:31:30,262 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-01 13:31:30,263 - INFO - [cert.py:108] - File exists: True
2025-01-01 13:31:30,263 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-01 13:31:30,263 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-01 13:31:30,264 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-01 13:31:30,264 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-01 13:31:30,265 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 13:31:30,294 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-01 13:31:30,295 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-01 13:31:30,296 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-01 13:31:30,296 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-01 13:31:30,297 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-01 13:31:30,297 - INFO - [verify.py:58] - Public key comparison results:
2025-01-01 13:31:30,297 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 13:31:30,298 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 13:31:30,299 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-01 13:31:30,299 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-01 13:31:30,300 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-01 13:31:30,300 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-01 13:31:30,300 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-01 13:31:30,301 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-01 13:31:30,301 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-01 13:31:30,302 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-01 13:31:30,302 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-01 13:31:30,303 - INFO - [session.py:157] - Starting TLS session
2025-01-01 13:31:30,303 - INFO - [session.py:96] - Starting TLS Handshake...
2025-01-01 13:31:30,303 - INFO - [client.py:99] - Generated client_random: 6775279203bec3d344b278bfd4a32581d2a45087a200a443296f588104397a4a
2025-01-01 13:31:30,305 - INFO - [client.py:139] - Client Hello sent from 192.168.1.2
2025-01-01 13:31:30,307 - INFO - [session.py:101] - Client Hello sent successfully
2025-01-01 13:31:30,308 - INFO - [server.py:95] - Generated server_random: 67752792a4f03e64253841bd65aee3fe9ce10de410243e1cfe03a3ad1603a178
2025-01-01 13:31:30,311 - INFO - [session.py:106] - Server Hello received successfully
2025-01-01 13:31:30,311 - INFO - [client.py:176] - Prepared empty certificate
2025-01-01 13:31:30,311 - INFO - [client.py:188] - Encrypted pre_master_secret length: 256
2025-01-01 13:31:30,312 - INFO - [session.py:111] - Client handshake messages sent successfully
2025-01-01 13:31:30,314 - INFO - [session.py:116] - Server key pair verified successfully
2025-01-01 13:31:30,314 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-01 13:31:30,315 - INFO - [chain.py:185] - Decrypted pre_master_secret: 0303004846b0690c191977827f1cdb6da1919241080e71a8d6cf2939ee163c7e136e0c38489b4a78df00a3f3a64d1871
2025-01-01 13:31:30,316 - INFO - [chain.py:195] - Generated master secret: d8eedc484e613c1ecf33e5192de5696f97943da1b3d377a66c88a5956ce61d18505be7b05ea84c918d47182e4eb26c27
2025-01-01 13:31:30,316 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-01 13:31:30,316 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-01 13:31:30,317 - INFO - [session.py:120] - Master Secret handled successfully
2025-01-01 13:31:30,318 - INFO - [client.py:269] - Pre-master secret validated successfully
2025-01-01 13:31:30,319 - INFO - [client.py:287] - Generated digital signature: 08829e217feb4c778b8d3ec7ad804f52659366e836b718cdd072c5c740ad09a4ebfd1d8aa83563827cc4238ec2c8f700210915d76d61b0e8a94a1348bcf9b54eb45dd8605338272686ba47550dd982393a2a279e1fa59fce0af11276b10edab4c93a72b386d9d6ad5a9a05fdda792629ffd77eb7c74d1c74afad2197424bfd561db49e88f61cc83926c30e1aad349c1da6f0ad2245d28609a8926842554234210ebd56301f220a8fcb76f8023df2b41929eb89c7c6e17de248e68189973dfc8c7da25db91618bddff916a62f5155b87c0d71fc6d7ab47382a985b0055fb372afabdb07fca263057580379a2eeaed6453fd4bf08c3308c892e2629756a06bc5dd
2025-01-01 13:31:30,320 - INFO - [client.py:333] - Client ChangeCipherSpec and Finished messages sent
2025-01-01 13:31:30,321 - INFO - [session.py:125] - Client Change Cipher Spec sent successfully
2025-01-01 13:31:30,322 - INFO - [server.py:256] - Pre-master secret validated successfully
2025-01-01 13:31:30,322 - INFO - [server.py:274] - Generated digital signature: 9a4f63748ab5ca658a3806b1f825abac28a830df8466c0820c8829ed136c823d17261f83b8f72fa7f6bfb52788963a336bcc23d8e98cbaf2f39dfaef1f92134890366667a92b3c006f9ed4288145ea95d9718bc276c3a79c305ae7aa756262cc843768aad6b439421daaf6b5d0ec099e2f1dd06cc57b3c44aa2d64ec6ff9d9f1b55e0e695a682d099d4215ce16be2df7fd9539448cb35f1dc60eace923bc06536b3a9fb0da4ce052b8e4b0f952d5c3d45b7f8e57cc9a9183c6ca27c2ca0c965dd68a9f56a08e6cf2355fada60c3a2383ca57d159b3cd2826437864a547ccc954d29fb874b221c97c2f03eebedeec221547f07cf019d25df6998d9716d05192cb
2025-01-01 13:31:30,323 - INFO - [server.py:320] - Server ChangeCipherSpec and Finished messages sent
2025-01-01 13:31:30,324 - INFO - [session.py:130] - Server Change Cipher Spec received successfully
2025-01-01 13:31:30,325 - INFO - [keys.py:212] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-01 13:31:30,325 - INFO - [session.py:135] - SSL Key Log handled successfully
2025-01-01 13:31:30,326 - INFO - [session.py:139] - TLS Handshake completed successfully
2025-01-01 13:31:30,326 - INFO - [session.py:186] - Handshake completed: True
2025-01-01 13:31:30,326 - INFO - [session.py:187] - Use client cert: False
2025-01-01 13:31:30,326 - INFO - [session.py:188] - File to send: None
2025-01-01 13:31:30,327 - INFO - [session.py:194] - Using unencrypted exchange
2025-01-01 13:31:30,327 - INFO - [session.py:294] - Added request packet
2025-01-01 13:31:30,328 - INFO - [session.py:294] - Added response packet
2025-01-01 13:31:30,328 - WARNING - [session.py:271] - Using unencrypted communication
2025-01-01 13:31:30,328 - INFO - [main.py:95] - Session completed successfully for 192.168.1.2
2025-01-01 13:31:30,328 - INFO - [pcap_writer.py:232] - Packet 13: Valid HTTP message
2025-01-01 13:31:30,329 - INFO - [pcap_writer.py:232] - Packet 14: Valid HTTP message
2025-01-01 13:31:30,333 - INFO - [pcap_writer.py:387] - Saved 15 valid packets to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-01 13:31:30,334 - INFO - [pcap_writer.py:409] - Verifying 15 packets...
2025-01-01 13:31:30,335 - INFO - [pcap_writer.py:413] - Packet 1: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 13:31:30,335 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2025-01-01 13:31:30,336 - INFO - [pcap_writer.py:413] - Packet 2: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 13:31:30,336 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2775
2025-01-01 13:31:30,336 - INFO - [pcap_writer.py:413] - Packet 3: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 13:31:30,337 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 1646
2025-01-01 13:31:30,337 - INFO - [pcap_writer.py:413] - Packet 4: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 13:31:30,337 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-01 13:31:30,337 - INFO - [pcap_writer.py:413] - Packet 5: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 13:31:30,338 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-01 13:31:30,338 - INFO - [pcap_writer.py:413] - Packet 6: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 13:31:30,338 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 160
2025-01-01 13:31:30,338 - INFO - [pcap_writer.py:413] - Packet 7: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 13:31:30,338 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 128
2025-01-01 13:31:30,339 - INFO - [pcap_writer.py:413] - Packet 8: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 13:31:30,339 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 1152
2025-01-01 13:31:30,339 - INFO - [pcap_writer.py:413] - Packet 9: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-01 13:31:30,339 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2025-01-01 13:31:30,340 - INFO - [pcap_writer.py:413] - Packet 10: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-01 13:31:30,340 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2775
2025-01-01 13:31:30,340 - INFO - [pcap_writer.py:413] - Packet 11: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-01 13:31:30,340 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 269
2025-01-01 13:31:30,341 - INFO - [pcap_writer.py:413] - Packet 12: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-01 13:31:30,341 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-01 13:31:30,341 - INFO - [pcap_writer.py:413] - Packet 13: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-01 13:31:30,342 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-01 13:31:30,342 - INFO - [pcap_writer.py:413] - Packet 14: IP / TCP 192.168.1.2:12346 > 10.0.0.1:http PA / Raw
2025-01-01 13:31:30,342 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2025-01-01 13:31:30,342 - INFO - [pcap_writer.py:413] - Packet 15: IP / TCP 10.0.0.1:http > 192.168.1.2:12346 PA / Raw
2025-01-01 13:31:30,343 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2025-01-01 13:31:30,343 - INFO - [pcap_writer.py:427] - Verification complete: 15 valid packets, 15 TLS records
2025-01-01 13:31:30,343 - INFO - [main.py:106] - Results saved to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-01 13:31:30,344 - INFO - [main.py:160] - TLS session simulation completed successfully
2025-01-01 14:15:52,983 - INFO - [logging.py:83] - Logging configured successfully
2025-01-01 14:15:52,983 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-01 14:15:52,984 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-01 14:15:52,984 - INFO - [logging.py:92] - Log level: 20
2025-01-01 14:15:52,984 - INFO - [logging.py:93] - Timestamp: 2025-01-01T14:15:52.984546
2025-01-01 14:15:52,984 - INFO - [logging.py:94] - ==========================
2025-01-01 14:15:52,984 - INFO - [main.py:122] - Starting TLS session simulation
2025-01-01 14:15:52,985 - INFO - [main.py:87] - 
--- Client Session (certificate) ---
2025-01-01 14:15:52,986 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-01 14:15:52,986 - INFO - [cert.py:108] - File exists: True
2025-01-01 14:15:52,987 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-01 14:15:52,987 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-01 14:15:52,988 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-01 14:15:52,988 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-01 14:15:52,993 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 14:15:52,993 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-01 14:15:52,994 - INFO - [cert.py:108] - File exists: True
2025-01-01 14:15:52,994 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-01 14:15:52,995 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-01 14:15:52,995 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-01 14:15:52,996 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-01 14:15:52,997 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 14:15:53,037 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-01 14:15:53,038 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-01 14:15:53,039 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-01 14:15:53,039 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-01 14:15:53,042 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-01 14:15:53,042 - INFO - [verify.py:58] - Public key comparison results:
2025-01-01 14:15:53,043 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 14:15:53,044 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 14:15:53,045 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-01 14:15:53,045 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-01 14:15:53,052 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-01 14:15:53,053 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-01 14:15:53,053 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-01 14:15:53,054 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-01 14:15:53,054 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-01 14:15:53,055 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-01 14:15:53,056 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-01 14:15:53,056 - INFO - [session.py:157] - Starting TLS session
2025-01-01 14:15:53,057 - INFO - [session.py:96] - Starting TLS Handshake...
2025-01-01 14:15:53,057 - INFO - [client.py:99] - Generated client_random: 677531f9fcf815aa4bcb6aa27a61ea00688344378a9f3073bf487da10356fee0
2025-01-01 14:15:53,059 - INFO - [client.py:139] - Client Hello sent from 192.168.1.1
2025-01-01 14:15:53,061 - INFO - [session.py:101] - Client Hello sent successfully
2025-01-01 14:15:53,061 - INFO - [server.py:95] - Generated server_random: 677531f9873854c153d6862546b4ff0d0b7d2c3ef41c70fdcad73fcd14bf80fb
2025-01-01 14:15:53,064 - INFO - [session.py:106] - Server Hello received successfully
2025-01-01 14:15:53,065 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2025-01-01 14:15:53,065 - INFO - [cert.py:108] - File exists: True
2025-01-01 14:15:53,066 - INFO - [cert.py:109] - File size: 1915 bytes
2025-01-01 14:15:53,066 - INFO - [cert.py:113] - Read 1915 bytes
2025-01-01 14:15:53,067 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2025-01-01 14:15:53,067 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2025-01-01 14:15:53,068 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 14:15:53,068 - INFO - [client.py:173] - Prepared client certificate
2025-01-01 14:15:53,069 - INFO - [client.py:188] - Encrypted pre_master_secret length: 256
2025-01-01 14:15:53,071 - INFO - [session.py:111] - Client handshake messages sent successfully
2025-01-01 14:15:53,072 - INFO - [session.py:116] - Server key pair verified successfully
2025-01-01 14:15:53,073 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-01 14:15:53,074 - INFO - [chain.py:185] - Decrypted pre_master_secret: 03031f0c394638c06adce1aa302fb16670c5034e603a406968e7798d087fb60b143ed04a7049910698f3a822184fa816
2025-01-01 14:15:53,074 - INFO - [chain.py:195] - Generated master secret: 32f06c56d71cde7bda5380ad3861ff0d2b9d03f5c54cd960c63e8821a2cc58edeaba10b55ebca4c46ef3e9fcad99ee64
2025-01-01 14:15:53,075 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-01 14:15:53,075 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-01 14:15:53,075 - INFO - [session.py:120] - Master Secret handled successfully
2025-01-01 14:15:53,076 - INFO - [client.py:269] - Pre-master secret validated successfully
2025-01-01 14:15:53,077 - INFO - [client.py:287] - Generated digital signature: 29dece04c6e534e676996ce6f6691fbdcdad4be54cdfa9dd5ac92c15c449f23c4249349163933084146b4a16dc8d51f0367021af1bc0f36a1ae07d46763ac67e640df145a0cdfdef140fcd4208867fd25043427a343efa5a93097b0b5fed129c839e66efec8ee67b173a4970e29a4ce0d9617f8c8b3c77e275c98d86ece3eeedac77baad6051e5bd81e928536ad6bb8ed1781b160713c607200614e71e9fc011731b725c969003d05738073734915a0ae19cd686ae6dae14d950c919e8bad21b9a8f4d48f4c4f4b4b7ab810cbf5cde5f8c8531ba22866e55f0409527aee01201de475d15b59a1acd3d52a4caad730b417eaab843c63fc833fae4debaaeda5335
2025-01-01 14:15:53,088 - INFO - [client.py:333] - Client ChangeCipherSpec and Finished messages sent
2025-01-01 14:15:53,089 - INFO - [session.py:125] - Client Change Cipher Spec sent successfully
2025-01-01 14:15:53,090 - INFO - [server.py:257] - Pre-master secret validated successfully
2025-01-01 14:15:53,091 - INFO - [server.py:275] - Generated digital signature: 0c31636464a36fe220f34e5ac9d7bc63358736c5fee9adfebea5edd68bb44fa71149050923ac8b4ffb129796bcfe8348cc88411b85b2f0173b1ebd28090bdc3413ccbda4d52b53186e85515b40ca546b226737360ca835e825e64e80a7f6d68caaad782bf3495d19b11148ce4db4219ef79fb26e9fab96063884b1142af47d6b44cc138a64a2279ed302f6f0d2b19f8bd3e25d50039857fb34547cfbe84ec65a4396322a9cfe84fa49dac45af94a08eddd873eb4bd1090b6687ab61777d092f8d654f440178de86d802c090ae583a495376b194e2ca590b56eca272c83cd989f5346bd3c2e380f0f3f6117d46430415eae19113d653bba2c56fcb9661cf64e75
2025-01-01 14:15:53,092 - INFO - [server.py:321] - Server ChangeCipherSpec and Finished messages sent
2025-01-01 14:15:53,093 - INFO - [session.py:130] - Server Change Cipher Spec received successfully
2025-01-01 14:15:53,094 - INFO - [keys.py:212] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-01 14:15:53,094 - INFO - [session.py:135] - SSL Key Log handled successfully
2025-01-01 14:15:53,095 - INFO - [session.py:139] - TLS Handshake completed successfully
2025-01-01 14:15:53,095 - INFO - [session.py:168] - Found file to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 14:15:53,095 - INFO - [session.py:186] - Handshake completed: True
2025-01-01 14:15:53,096 - INFO - [session.py:187] - Use client cert: True
2025-01-01 14:15:53,096 - INFO - [session.py:188] - File to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 14:15:53,096 - INFO - [session.py:191] - Using encrypted exchange
2025-01-01 14:15:53,096 - INFO - [session.py:206] - Sending encrypted request data
2025-01-01 14:15:53,098 - INFO - [keys.py:185] - TLS Application Data sent from 192.168.1.1:12345 to 10.0.0.1:443
2025-01-01 14:15:53,099 - INFO - [session.py:217] - Sending encrypted response data
2025-01-01 14:15:53,100 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-01 14:15:53,100 - INFO - [session.py:229] - Attempting to send file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 14:15:53,101 - INFO - [session.py:240] - Opening file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 14:15:53,102 - INFO - [session.py:247] - Read 1103 bytes from file
2025-01-01 14:15:53,103 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-01 14:15:53,104 - INFO - [session.py:256] - File sent successfully
2025-01-01 14:15:53,105 - INFO - [session.py:231] - File sent successfully
2025-01-01 14:15:53,105 - INFO - [main.py:95] - Session completed successfully for 192.168.1.1
2025-01-01 14:15:53,106 - INFO - [main.py:87] - 
--- Client Session (no certificate) ---
2025-01-01 14:15:53,106 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-01 14:15:53,107 - INFO - [cert.py:108] - File exists: True
2025-01-01 14:15:53,107 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-01 14:15:53,108 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-01 14:15:53,108 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-01 14:15:53,108 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-01 14:15:53,108 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 14:15:53,109 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-01 14:15:53,109 - INFO - [cert.py:108] - File exists: True
2025-01-01 14:15:53,109 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-01 14:15:53,109 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-01 14:15:53,109 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-01 14:15:53,110 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-01 14:15:53,110 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 14:15:53,138 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-01 14:15:53,138 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-01 14:15:53,139 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-01 14:15:53,139 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-01 14:15:53,139 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-01 14:15:53,139 - INFO - [verify.py:58] - Public key comparison results:
2025-01-01 14:15:53,139 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 14:15:53,140 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 14:15:53,140 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-01 14:15:53,141 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-01 14:15:53,141 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-01 14:15:53,142 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-01 14:15:53,142 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-01 14:15:53,142 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-01 14:15:53,142 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-01 14:15:53,143 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-01 14:15:53,143 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-01 14:15:53,144 - INFO - [session.py:157] - Starting TLS session
2025-01-01 14:15:53,144 - INFO - [session.py:96] - Starting TLS Handshake...
2025-01-01 14:15:53,144 - INFO - [client.py:99] - Generated client_random: 677531f9f6b9bbda42e4caedf1389e669b2f8aebdbfb1ba20df342157e1b0b4b
2025-01-01 14:15:53,146 - INFO - [client.py:139] - Client Hello sent from 192.168.1.2
2025-01-01 14:15:53,148 - INFO - [session.py:101] - Client Hello sent successfully
2025-01-01 14:15:53,148 - INFO - [server.py:95] - Generated server_random: 677531f9153b4e99916070889fea966d83db4175514187dc23588de51597d8fd
2025-01-01 14:15:53,152 - INFO - [session.py:106] - Server Hello received successfully
2025-01-01 14:15:53,153 - INFO - [client.py:176] - Prepared empty certificate
2025-01-01 14:15:53,154 - INFO - [client.py:188] - Encrypted pre_master_secret length: 256
2025-01-01 14:15:53,156 - INFO - [session.py:111] - Client handshake messages sent successfully
2025-01-01 14:15:53,158 - INFO - [session.py:116] - Server key pair verified successfully
2025-01-01 14:15:53,158 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-01 14:15:53,159 - INFO - [chain.py:185] - Decrypted pre_master_secret: 03031f62b8e337739fb6be6978cc9daf459ab729f87e81762ae7c31d7085e2b97cd4fd7c78a3bcf073d9e68a835e3cb0
2025-01-01 14:15:53,160 - INFO - [chain.py:195] - Generated master secret: cea5f75b23cbf710874bc436002d98772ec4d00650ed4348f5e96200dc5b984a4d20b45dd4508218b4150d53bf48e244
2025-01-01 14:15:53,160 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-01 14:15:53,160 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-01 14:15:53,160 - INFO - [session.py:120] - Master Secret handled successfully
2025-01-01 14:15:53,161 - INFO - [client.py:269] - Pre-master secret validated successfully
2025-01-01 14:15:53,162 - INFO - [client.py:287] - Generated digital signature: 1b04be9840356e780d5b2794cf92f9566745341adcc120ee97b3383833c1e3cd1f91e78062a757c4c0390e574ca485a88d8b7a19e73a4f40fb3c926182cdff08078221d0cdc3ec21ecbc925f3775c26fe5c7941ac5f4dab50b47ca8f78028e3ad02f9131a1635b65d171b9ad5ebc6d7284a6ce2d81aeec3f9eda2eb9860512427406d84ac1570ceaad726a43a943f51a1210ede3163f7c2af9e2786709fc604a45108adf8de26d3768de6eaef29e88fa33ff71d1e3877f4b2b42a4d2f4e1bccc0533277a1fd5025e89f48b5b2d0138441d2f181975f84cb3a04afd85bcc7bd1b0b8d6ef48f853c479819321bffdeae4d6e9f2456960ebf7d23da57d1a9e7d56b
2025-01-01 14:15:53,163 - INFO - [client.py:333] - Client ChangeCipherSpec and Finished messages sent
2025-01-01 14:15:53,164 - INFO - [session.py:125] - Client Change Cipher Spec sent successfully
2025-01-01 14:15:53,165 - INFO - [server.py:257] - Pre-master secret validated successfully
2025-01-01 14:15:53,165 - INFO - [server.py:275] - Generated digital signature: 6a0efb6a5df104dbd5e93a4f42f265b79c553077e8433e111a7fa0249133f32a9e0fe011b76b2c32669bcc22c8a001bd8c23a72c8358ae530ccb69605602aba237628460321f2cae85ec3803e19a0a3fe92a175b284afc7307fb8f8b3ca5814dff5cdf9f58e4672e51cc4a78b2156867a5f7f510d56a7c2e9b908442449a7c2d5a7838db9e5d01084e5b8fc2d1cbd318fa766156ac75e84f6542073f974806d4477cbec89a4db3d2906560bd6f6ad0b29e8a820d513eff99b5400d974d8539e707b5fbec5ccd57e2eb99b8a6d48c36c1215636b3257bcea86101a6c551534997a99a08e759e426779505d8e099e80ba3aeda96e3d09f0596c25011b10808dc28
2025-01-01 14:15:53,166 - INFO - [server.py:321] - Server ChangeCipherSpec and Finished messages sent
2025-01-01 14:15:53,168 - INFO - [session.py:130] - Server Change Cipher Spec received successfully
2025-01-01 14:15:53,169 - INFO - [keys.py:212] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-01 14:15:53,169 - INFO - [session.py:135] - SSL Key Log handled successfully
2025-01-01 14:15:53,169 - INFO - [session.py:139] - TLS Handshake completed successfully
2025-01-01 14:15:53,170 - INFO - [session.py:186] - Handshake completed: True
2025-01-01 14:15:53,170 - INFO - [session.py:187] - Use client cert: False
2025-01-01 14:15:53,171 - INFO - [session.py:188] - File to send: None
2025-01-01 14:15:53,171 - INFO - [session.py:194] - Using unencrypted exchange
2025-01-01 14:15:53,171 - INFO - [session.py:294] - Added request packet
2025-01-01 14:15:53,172 - INFO - [session.py:294] - Added response packet
2025-01-01 14:15:53,172 - WARNING - [session.py:271] - Using unencrypted communication
2025-01-01 14:15:53,172 - INFO - [main.py:95] - Session completed successfully for 192.168.1.2
2025-01-01 14:15:53,173 - INFO - [pcap_writer.py:232] - Packet 13: Valid HTTP message
2025-01-01 14:15:53,173 - INFO - [pcap_writer.py:232] - Packet 14: Valid HTTP message
2025-01-01 14:15:53,177 - INFO - [pcap_writer.py:387] - Saved 15 valid packets to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-01 14:15:53,177 - INFO - [pcap_writer.py:409] - Verifying 15 packets...
2025-01-01 14:15:53,178 - INFO - [pcap_writer.py:413] - Packet 1: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 14:15:53,178 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2025-01-01 14:15:53,179 - INFO - [pcap_writer.py:413] - Packet 2: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 14:15:53,179 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2775
2025-01-01 14:15:53,179 - INFO - [pcap_writer.py:413] - Packet 3: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 14:15:53,179 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 1646
2025-01-01 14:15:53,179 - INFO - [pcap_writer.py:413] - Packet 4: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 14:15:53,180 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-01 14:15:53,180 - INFO - [pcap_writer.py:413] - Packet 5: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 14:15:53,180 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-01 14:15:53,180 - INFO - [pcap_writer.py:413] - Packet 6: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 14:15:53,181 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 160
2025-01-01 14:15:53,181 - INFO - [pcap_writer.py:413] - Packet 7: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 14:15:53,181 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 128
2025-01-01 14:15:53,181 - INFO - [pcap_writer.py:413] - Packet 8: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 14:15:53,181 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 1152
2025-01-01 14:15:53,181 - INFO - [pcap_writer.py:413] - Packet 9: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-01 14:15:53,182 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2025-01-01 14:15:53,182 - INFO - [pcap_writer.py:413] - Packet 10: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-01 14:15:53,182 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2775
2025-01-01 14:15:53,182 - INFO - [pcap_writer.py:413] - Packet 11: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-01 14:15:53,182 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 269
2025-01-01 14:15:53,183 - INFO - [pcap_writer.py:413] - Packet 12: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-01 14:15:53,183 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-01 14:15:53,183 - INFO - [pcap_writer.py:413] - Packet 13: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-01 14:15:53,183 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-01 14:15:53,184 - INFO - [pcap_writer.py:413] - Packet 14: IP / TCP 192.168.1.2:12346 > 10.0.0.1:http PA / Raw
2025-01-01 14:15:53,184 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2025-01-01 14:15:53,185 - INFO - [pcap_writer.py:413] - Packet 15: IP / TCP 10.0.0.1:http > 192.168.1.2:12346 PA / Raw
2025-01-01 14:15:53,185 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2025-01-01 14:15:53,185 - INFO - [pcap_writer.py:427] - Verification complete: 15 valid packets, 15 TLS records
2025-01-01 14:15:53,186 - INFO - [main.py:106] - Results saved to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-01 14:15:53,186 - INFO - [main.py:160] - TLS session simulation completed successfully
2025-01-01 14:23:42,247 - INFO - [logging.py:83] - Logging configured successfully
2025-01-01 14:23:42,248 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-01 14:23:42,248 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-01 14:23:42,248 - INFO - [logging.py:92] - Log level: 20
2025-01-01 14:23:42,249 - INFO - [logging.py:93] - Timestamp: 2025-01-01T14:23:42.249010
2025-01-01 14:23:42,249 - INFO - [logging.py:94] - ==========================
2025-01-01 14:23:42,249 - INFO - [main.py:122] - Starting TLS session simulation
2025-01-01 14:23:42,249 - INFO - [main.py:87] - 
--- Client Session (certificate) ---
2025-01-01 14:23:42,250 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-01 14:23:42,251 - INFO - [cert.py:108] - File exists: True
2025-01-01 14:23:42,251 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-01 14:23:42,251 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-01 14:23:42,252 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-01 14:23:42,252 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-01 14:23:42,252 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 14:23:42,253 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-01 14:23:42,253 - INFO - [cert.py:108] - File exists: True
2025-01-01 14:23:42,253 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-01 14:23:42,254 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-01 14:23:42,254 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-01 14:23:42,254 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-01 14:23:42,255 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 14:23:42,283 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-01 14:23:42,284 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-01 14:23:42,285 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-01 14:23:42,285 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-01 14:23:42,287 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-01 14:23:42,287 - INFO - [verify.py:58] - Public key comparison results:
2025-01-01 14:23:42,287 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 14:23:42,288 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 14:23:42,288 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-01 14:23:42,288 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-01 14:23:42,292 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-01 14:23:42,293 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-01 14:23:42,293 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-01 14:23:42,293 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-01 14:23:42,294 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-01 14:23:42,294 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-01 14:23:42,294 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-01 14:23:42,295 - INFO - [session.py:157] - Starting TLS session
2025-01-01 14:23:42,295 - INFO - [session.py:96] - Starting TLS Handshake...
2025-01-01 14:23:42,295 - INFO - [client.py:99] - Generated client_random: 677533cef8b19303b2701b356b723bcfa069fff482bd41cb442114d982cb0c26
2025-01-01 14:23:42,297 - INFO - [client.py:139] - Client Hello sent from 192.168.1.1
2025-01-01 14:23:42,299 - INFO - [session.py:101] - Client Hello sent successfully
2025-01-01 14:23:42,299 - INFO - [server.py:95] - Generated server_random: 677533ce09de028fb3eb8ca93555fe322f060fb9f9594dfce4645cabaae6bab1
2025-01-01 14:23:42,304 - INFO - [session.py:106] - Server Hello received successfully
2025-01-01 14:23:42,305 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2025-01-01 14:23:42,305 - INFO - [cert.py:108] - File exists: True
2025-01-01 14:23:42,306 - INFO - [cert.py:109] - File size: 1915 bytes
2025-01-01 14:23:42,306 - INFO - [cert.py:113] - Read 1915 bytes
2025-01-01 14:23:42,306 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2025-01-01 14:23:42,307 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2025-01-01 14:23:42,307 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 14:23:42,307 - INFO - [client.py:173] - Prepared client certificate
2025-01-01 14:23:42,308 - INFO - [client.py:188] - Encrypted pre_master_secret length: 256
2025-01-01 14:23:42,309 - INFO - [session.py:111] - Client handshake messages sent successfully
2025-01-01 14:23:42,310 - INFO - [session.py:116] - Server key pair verified successfully
2025-01-01 14:23:42,311 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-01 14:23:42,311 - INFO - [chain.py:185] - Decrypted pre_master_secret: 03037abbe048e0ec6503e626b1bc813cdbabd509d8f0749ff888546b83c511c47261c50cd1c2b3f3e931545e0a797a18
2025-01-01 14:23:42,311 - INFO - [chain.py:195] - Generated master secret: 45649cdad42ee772e30b182c8aaee566990f37530892abab1d41645c2ddee8eae246857bafe8bca335f0f3aafab7b27e
2025-01-01 14:23:42,312 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-01 14:23:42,312 - ERROR - [chain.py:266] - Unexpected error during Master Secret handling.
Traceback (most recent call last):
  File "C:\my-CTF\pcap_creator\tls\certificates\chain.py", line 253, in handle_master_secret
    raise MasterSecretError(f"Invalid master secret length: {len(session.master_secret)}")
tls.certificates.chain.MasterSecretError: Invalid master secret length: 96
2025-01-01 14:23:42,314 - ERROR - [session.py:143] - TLS Handshake failed: Failed to handle Master Secret
2025-01-01 14:23:42,315 - ERROR - [main.py:27] - Session error: Session failed for 192.168.1.1: Session failed: Handshake failed
2025-01-01 14:47:06,532 - INFO - [logging.py:83] - Logging configured successfully
2025-01-01 14:47:06,533 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-01 14:47:06,533 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-01 14:47:06,534 - INFO - [logging.py:92] - Log level: 20
2025-01-01 14:47:06,534 - INFO - [logging.py:93] - Timestamp: 2025-01-01T14:47:06.534284
2025-01-01 14:47:06,534 - INFO - [logging.py:94] - ==========================
2025-01-01 14:47:06,534 - INFO - [main.py:122] - Starting TLS session simulation
2025-01-01 14:47:06,535 - INFO - [main.py:87] - 
--- Client Session (certificate) ---
2025-01-01 14:47:06,536 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-01 14:47:06,536 - INFO - [cert.py:108] - File exists: True
2025-01-01 14:47:06,537 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-01 14:47:06,537 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-01 14:47:06,538 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-01 14:47:06,538 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-01 14:47:06,543 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 14:47:06,544 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-01 14:47:06,545 - INFO - [cert.py:108] - File exists: True
2025-01-01 14:47:06,545 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-01 14:47:06,546 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-01 14:47:06,547 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-01 14:47:06,547 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-01 14:47:06,548 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 14:47:06,587 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-01 14:47:06,587 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-01 14:47:06,588 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-01 14:47:06,588 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-01 14:47:06,591 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-01 14:47:06,591 - INFO - [verify.py:58] - Public key comparison results:
2025-01-01 14:47:06,591 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 14:47:06,592 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 14:47:06,593 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-01 14:47:06,593 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-01 14:47:06,604 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-01 14:47:06,605 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-01 14:47:06,605 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-01 14:47:06,605 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-01 14:47:06,606 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-01 14:47:06,607 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-01 14:47:06,608 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-01 14:47:06,608 - INFO - [session.py:157] - Starting TLS session
2025-01-01 14:47:06,609 - INFO - [session.py:96] - Starting TLS Handshake...
2025-01-01 14:47:06,609 - INFO - [client.py:99] - Generated client_random: 6775394ad92ea0b77090d1e09aece717689bb850daef7777a9ba9b0367c7151b
2025-01-01 14:47:06,611 - INFO - [client.py:139] - Client Hello sent from 192.168.1.1
2025-01-01 14:47:06,613 - INFO - [session.py:101] - Client Hello sent successfully
2025-01-01 14:47:06,614 - INFO - [server.py:95] - Generated server_random: 6775394a93e363952d7986903801b5eb4f46d6cd166892b5c2f59e49a03de3b9
2025-01-01 14:47:06,621 - INFO - [session.py:106] - Server Hello received successfully
2025-01-01 14:47:06,622 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2025-01-01 14:47:06,622 - INFO - [cert.py:108] - File exists: True
2025-01-01 14:47:06,623 - INFO - [cert.py:109] - File size: 1915 bytes
2025-01-01 14:47:06,623 - INFO - [cert.py:113] - Read 1915 bytes
2025-01-01 14:47:06,624 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2025-01-01 14:47:06,624 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2025-01-01 14:47:06,625 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 14:47:06,626 - INFO - [client.py:173] - Prepared client certificate
2025-01-01 14:47:06,626 - INFO - [client.py:188] - Encrypted pre_master_secret length: 256
2025-01-01 14:47:06,628 - INFO - [session.py:111] - Client handshake messages sent successfully
2025-01-01 14:47:06,630 - INFO - [session.py:116] - Server key pair verified successfully
2025-01-01 14:47:06,630 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-01 14:47:06,632 - INFO - [chain.py:185] - Decrypted pre_master_secret: 03034cdf3cc8477aaf85744b472d79e39ab3d0de8d2ecf57aee0076050049d12c4b3b886b0fdc821b4ce612f6ec85b4c
2025-01-01 14:47:06,633 - INFO - [chain.py:195] - Generated master secret: 0e212461ebb94f34c7b9aa1e46efc391008442933af86df989a4310cb4e9c3b85a61094417c3cd4e2c8079e686a2364b
2025-01-01 14:47:06,633 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-01 14:47:06,634 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-01 14:47:06,634 - INFO - [session.py:120] - Master Secret handled successfully
2025-01-01 14:47:06,636 - INFO - [client.py:269] - Pre-master secret validated successfully
2025-01-01 14:47:06,637 - INFO - [client.py:287] - Generated digital signature: 362ee346e8fa288ffc95a1f55fa316a8b7953d5d6dfc3b179ddf0b0a395afe9f938ebd2c7eaa20b8338c803bcc1e7a736678eaf202ad1cbf031d934c4877b91b409a5e2b0efbf1ad5dd4ea567d71468fa70cc03841d7e67a7ee40cc2e31704df2037c9c013ca31a32318794fe9ceadb013b2fe5ba6d6ba6c77dea0a8f7c5c016d0f3beaf4836ac5fa1dafeb5dcdc14238479f375b32a2b661c7a5351f823bca0922303c837d09cb7d51518a2c4c970b5ac316fcf6850e76e6517b3f241cbbc9643838def4801c7a02c7556fcc8e983bca88152b5229391ff63fc5913b5223cacada291819dbec7b32738ce59fa7587f422f6dfa7fc82ac95147d7c258647cf89
2025-01-01 14:47:06,639 - ERROR - [main.py:27] - Session error: Session failed for 192.168.1.1: Session failed: Failed to send ChangeCipherSpec: Failed to create finished messages: Failed to derive key block: PRF.derive_key_block() missing 1 required positional argument: 'req_len'
2025-01-01 14:49:58,906 - INFO - [logging.py:83] - Logging configured successfully
2025-01-01 14:49:58,907 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-01 14:49:58,907 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-01 14:49:58,907 - INFO - [logging.py:92] - Log level: 20
2025-01-01 14:49:58,907 - INFO - [logging.py:93] - Timestamp: 2025-01-01T14:49:58.907920
2025-01-01 14:49:58,908 - INFO - [logging.py:94] - ==========================
2025-01-01 14:49:58,908 - INFO - [main.py:122] - Starting TLS session simulation
2025-01-01 14:49:58,909 - INFO - [main.py:87] - 
--- Client Session (certificate) ---
2025-01-01 14:49:58,910 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-01 14:49:58,910 - INFO - [cert.py:108] - File exists: True
2025-01-01 14:49:58,910 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-01 14:49:58,911 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-01 14:49:58,911 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-01 14:49:58,912 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-01 14:49:58,912 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 14:49:58,913 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-01 14:49:58,913 - INFO - [cert.py:108] - File exists: True
2025-01-01 14:49:58,913 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-01 14:49:58,914 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-01 14:49:58,914 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-01 14:49:58,914 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-01 14:49:58,915 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 14:49:58,943 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-01 14:49:58,944 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-01 14:49:58,945 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-01 14:49:58,945 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-01 14:49:58,947 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-01 14:49:58,947 - INFO - [verify.py:58] - Public key comparison results:
2025-01-01 14:49:58,947 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 14:49:58,948 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 14:49:58,950 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-01 14:49:58,950 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-01 14:49:58,957 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-01 14:49:58,957 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-01 14:49:58,958 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-01 14:49:58,958 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-01 14:49:58,958 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-01 14:49:58,959 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-01 14:49:58,960 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-01 14:49:58,960 - INFO - [session.py:157] - Starting TLS session
2025-01-01 14:49:58,961 - INFO - [session.py:96] - Starting TLS Handshake...
2025-01-01 14:49:58,961 - INFO - [client.py:99] - Generated client_random: 677539f66ce324a4b55eb737770d23191c08c1322bcccf27ac8d6d2a117b85c6
2025-01-01 14:49:58,964 - INFO - [client.py:139] - Client Hello sent from 192.168.1.1
2025-01-01 14:49:58,968 - INFO - [session.py:101] - Client Hello sent successfully
2025-01-01 14:49:58,968 - INFO - [server.py:95] - Generated server_random: 677539f6a026e73c635645223ccd8e1debd3e4604de8784c39c97354db3961eb
2025-01-01 14:49:58,972 - INFO - [session.py:106] - Server Hello received successfully
2025-01-01 14:49:58,973 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2025-01-01 14:49:58,973 - INFO - [cert.py:108] - File exists: True
2025-01-01 14:49:58,974 - INFO - [cert.py:109] - File size: 1915 bytes
2025-01-01 14:49:58,974 - INFO - [cert.py:113] - Read 1915 bytes
2025-01-01 14:49:58,974 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2025-01-01 14:49:58,975 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2025-01-01 14:49:58,976 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 14:49:58,977 - INFO - [client.py:173] - Prepared client certificate
2025-01-01 14:49:58,977 - INFO - [client.py:188] - Encrypted pre_master_secret length: 256
2025-01-01 14:49:58,979 - INFO - [session.py:111] - Client handshake messages sent successfully
2025-01-01 14:49:58,982 - INFO - [session.py:116] - Server key pair verified successfully
2025-01-01 14:49:58,983 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-01 14:49:58,984 - INFO - [chain.py:185] - Decrypted pre_master_secret: 030330829be6d1b785f164128554223c639d943fd6fdef0f60bdcb74eca643c58c675392c53b07b80b6e0155ac238918
2025-01-01 14:49:58,985 - INFO - [chain.py:195] - Generated master secret: 899f4b94a5f977e1a32026c83de8292d35d0872ef6ad7973d88b274d294f9255594cb97e7c711334224eebf91fb97b85
2025-01-01 14:49:58,985 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-01 14:49:58,985 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-01 14:49:58,985 - INFO - [session.py:120] - Master Secret handled successfully
2025-01-01 14:49:58,986 - INFO - [client.py:269] - Pre-master secret validated successfully
2025-01-01 14:49:58,987 - INFO - [client.py:287] - Generated digital signature: ce17c6d1a4acaa2809a07d3eb296b23bcb2c7c2acff0c20b45ce7efa921b83d1e2f8d14fa90c1222667bfdc216e899ef560bef377cb9b8e364c7b95b82f1ac29e6e380eabd7178a3bbc0c734227a2b845a51c24a2dd2c960b0524d1ccc8a96fe18d05590c5a8f86b4da5ea4f5d7c4bdd9b3d0918e3a6895256c6e4eef42150f3be0cf3477ddf01b482715046d6ee38ccf037c8ed6f4ed7927adc963deb7c611cb1ba11dcdc8584ec9b0e230e587e1a2c84800ac3d53028b331893a2c64a8bf8db55e35f607cdce6f01029b1579ac51cb98009d3003044569b42d2d216f5b297003edddcdd7edb835018173bc263465d7e562951b911b3638ce5ad61bcf18be32
2025-01-01 14:49:58,991 - INFO - [client.py:333] - Client ChangeCipherSpec and Finished messages sent
2025-01-01 14:49:58,992 - INFO - [session.py:125] - Client Change Cipher Spec sent successfully
2025-01-01 14:49:58,993 - INFO - [server.py:257] - Pre-master secret validated successfully
2025-01-01 14:49:58,994 - INFO - [server.py:275] - Generated digital signature: 01b8617458abcbca1f5df34fb12ae78930c5f675f24cb8bc3916a2deaec93793dad3e60fe1372363e1da6df8cbfabbf84179c45e5e82d0b11af3200fff47da7ac5986cd668bdde8791166024738afed0b192f67594c5d7dd48ed68b7879f4b7d55a5bb712bd5a67bf932043f41d3dd002ce42cc00eecdbe3c14d3cfa5f85ceaaefc1e5f17e9785d3799596e8d920e446a10b11ad8830cef24f136fe4d24bfa7979dd4b789b3949c4f53380789f627736b92469a93713923165c94143f437733f56ba34503226c334bd6c259b5bbedc54161b685589d6c0c127c6891d97673006a1970e0f79e173b748a57c479925735de8ecaa8dde274bc6daaab7ccde198a57
2025-01-01 14:49:58,996 - INFO - [server.py:321] - Server ChangeCipherSpec and Finished messages sent
2025-01-01 14:49:58,998 - INFO - [session.py:130] - Server Change Cipher Spec received successfully
2025-01-01 14:49:59,000 - INFO - [keys.py:212] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-01 14:49:59,000 - INFO - [session.py:135] - SSL Key Log handled successfully
2025-01-01 14:49:59,001 - INFO - [session.py:139] - TLS Handshake completed successfully
2025-01-01 14:49:59,001 - INFO - [session.py:168] - Found file to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 14:49:59,001 - INFO - [session.py:186] - Handshake completed: True
2025-01-01 14:49:59,002 - INFO - [session.py:187] - Use client cert: True
2025-01-01 14:49:59,002 - INFO - [session.py:188] - File to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 14:49:59,002 - INFO - [session.py:191] - Using encrypted exchange
2025-01-01 14:49:59,003 - INFO - [session.py:206] - Sending encrypted request data
2025-01-01 14:49:59,004 - INFO - [keys.py:185] - TLS Application Data sent from 192.168.1.1:12345 to 10.0.0.1:443
2025-01-01 14:49:59,005 - INFO - [session.py:217] - Sending encrypted response data
2025-01-01 14:49:59,006 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-01 14:49:59,006 - INFO - [session.py:229] - Attempting to send file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 14:49:59,007 - INFO - [session.py:240] - Opening file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 14:49:59,007 - INFO - [session.py:247] - Read 1103 bytes from file
2025-01-01 14:49:59,008 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-01 14:49:59,009 - INFO - [session.py:256] - File sent successfully
2025-01-01 14:49:59,010 - INFO - [session.py:231] - File sent successfully
2025-01-01 14:49:59,010 - INFO - [main.py:95] - Session completed successfully for 192.168.1.1
2025-01-01 14:49:59,010 - INFO - [main.py:87] - 
--- Client Session (no certificate) ---
2025-01-01 14:49:59,011 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-01 14:49:59,012 - INFO - [cert.py:108] - File exists: True
2025-01-01 14:49:59,012 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-01 14:49:59,013 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-01 14:49:59,014 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-01 14:49:59,015 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-01 14:49:59,016 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 14:49:59,017 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-01 14:49:59,017 - INFO - [cert.py:108] - File exists: True
2025-01-01 14:49:59,017 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-01 14:49:59,018 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-01 14:49:59,018 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-01 14:49:59,018 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-01 14:49:59,019 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 14:49:59,047 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-01 14:49:59,050 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-01 14:49:59,050 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-01 14:49:59,051 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-01 14:49:59,051 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-01 14:49:59,052 - INFO - [verify.py:58] - Public key comparison results:
2025-01-01 14:49:59,052 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 14:49:59,052 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 14:49:59,053 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-01 14:49:59,053 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-01 14:49:59,053 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-01 14:49:59,054 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-01 14:49:59,054 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-01 14:49:59,054 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-01 14:49:59,054 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-01 14:49:59,055 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-01 14:49:59,055 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-01 14:49:59,056 - INFO - [session.py:157] - Starting TLS session
2025-01-01 14:49:59,056 - INFO - [session.py:96] - Starting TLS Handshake...
2025-01-01 14:49:59,056 - INFO - [client.py:99] - Generated client_random: 677539f77ea62ff300863b15ffb4c078c9e78388f29c4a623c9c52c0e342e8e9
2025-01-01 14:49:59,058 - INFO - [client.py:139] - Client Hello sent from 192.168.1.2
2025-01-01 14:49:59,061 - INFO - [session.py:101] - Client Hello sent successfully
2025-01-01 14:49:59,062 - INFO - [server.py:95] - Generated server_random: 677539f7d44dc6f512b975fc2b559d64bf4c37012ca3ecf95c7f9a093b193f35
2025-01-01 14:49:59,067 - INFO - [session.py:106] - Server Hello received successfully
2025-01-01 14:49:59,068 - INFO - [client.py:176] - Prepared empty certificate
2025-01-01 14:49:59,068 - INFO - [client.py:188] - Encrypted pre_master_secret length: 256
2025-01-01 14:49:59,070 - INFO - [session.py:111] - Client handshake messages sent successfully
2025-01-01 14:49:59,071 - INFO - [session.py:116] - Server key pair verified successfully
2025-01-01 14:49:59,071 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-01 14:49:59,072 - INFO - [chain.py:185] - Decrypted pre_master_secret: 0303a07ce740eeaffc22fab81b07268dffc3d0f893c3071543516bf2775e63935be0e6a3cf187b9e0e6a7fc33d7b34ac
2025-01-01 14:49:59,072 - INFO - [chain.py:195] - Generated master secret: e3667586a51d82a14922ef3782c05d24096d88091e3167f70156408f1eb618b3fc849f70ab2320ae3c672fabe17db3eb
2025-01-01 14:49:59,072 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-01 14:49:59,073 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-01 14:49:59,073 - INFO - [session.py:120] - Master Secret handled successfully
2025-01-01 14:49:59,073 - INFO - [client.py:269] - Pre-master secret validated successfully
2025-01-01 14:49:59,074 - INFO - [client.py:287] - Generated digital signature: 81e450cb9a50530d9dc0d94eb6cb2a92fedf20c9405bccb61c40b12251079e6e149bead19505293f4f6de5c393d525b6c89b5545c91f42671c10dd562e948884b19c28c8004a3ce1511f1d0375091a6e29fc6d782fb693fe8e4f46cdb30abed76ea9d0e9756b950507ecd63153e99019bdd4d66dab4d65cc927d5fc66efad0a9dc1e66e3d6cfa4ffdb810f16acde9ff8f3d331f23cee3074bd41d097191bca8f1823c681eb224885261373c8eb5f0469c7456fb6f88b5bf93f473d76d289fa78110e296992d5ec390046878a84f03eaa53eb88541911c8d5c703cdc5a36cf7be101f7146954d74c5457bcb000c4d7f1d533e935e676d2498789fd214216242b6
2025-01-01 14:49:59,076 - INFO - [client.py:333] - Client ChangeCipherSpec and Finished messages sent
2025-01-01 14:49:59,077 - INFO - [session.py:125] - Client Change Cipher Spec sent successfully
2025-01-01 14:49:59,079 - INFO - [server.py:257] - Pre-master secret validated successfully
2025-01-01 14:49:59,080 - INFO - [server.py:275] - Generated digital signature: 32defb0f2991e35c7fc61bcfd8b587ef4adcc8ba9c1c010454fa0751927b576cc734c50f3593f5aba7e55b69911bb9dc105c5bb090b1f0b1233bc5a7ee2fd0274273fe3dacb1cdddd2d674bd7e0c339784726150f0ccbd3d6945045d9a3945c080bfe48ee367ee67eae937b2ee6aed1b1347eee8001903d8e834531e5c6126d70aaa7cb4a0e9cc3ffca565878a3e788ba674261df4ca7cf7619f9c434a923dbdfe865acc8a40e28dbe578bec5c3694b0eb8774248c813c30e1db6e547d53b5509dfe80c8095cf831b5d8009c0b42e3aa9160cacb783b3cd443cdd7715841c80658b3cbfaea3919d59c99ca82075215a55cef612094fbc97652a7f11b83d0bc83
2025-01-01 14:49:59,083 - INFO - [server.py:321] - Server ChangeCipherSpec and Finished messages sent
2025-01-01 14:49:59,084 - INFO - [session.py:130] - Server Change Cipher Spec received successfully
2025-01-01 14:49:59,085 - INFO - [keys.py:212] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-01 14:49:59,085 - INFO - [session.py:135] - SSL Key Log handled successfully
2025-01-01 14:49:59,086 - INFO - [session.py:139] - TLS Handshake completed successfully
2025-01-01 14:49:59,086 - INFO - [session.py:186] - Handshake completed: True
2025-01-01 14:49:59,086 - INFO - [session.py:187] - Use client cert: False
2025-01-01 14:49:59,087 - INFO - [session.py:188] - File to send: None
2025-01-01 14:49:59,087 - INFO - [session.py:194] - Using unencrypted exchange
2025-01-01 14:49:59,087 - INFO - [session.py:294] - Added request packet
2025-01-01 14:49:59,088 - INFO - [session.py:294] - Added response packet
2025-01-01 14:49:59,088 - WARNING - [session.py:271] - Using unencrypted communication
2025-01-01 14:49:59,089 - INFO - [main.py:95] - Session completed successfully for 192.168.1.2
2025-01-01 14:49:59,089 - INFO - [pcap_writer.py:232] - Packet 13: Valid HTTP message
2025-01-01 14:49:59,089 - INFO - [pcap_writer.py:232] - Packet 14: Valid HTTP message
2025-01-01 14:49:59,094 - INFO - [pcap_writer.py:387] - Saved 15 valid packets to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-01 14:49:59,095 - INFO - [pcap_writer.py:409] - Verifying 15 packets...
2025-01-01 14:49:59,096 - INFO - [pcap_writer.py:413] - Packet 1: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 14:49:59,096 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2025-01-01 14:49:59,096 - INFO - [pcap_writer.py:413] - Packet 2: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 14:49:59,097 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2775
2025-01-01 14:49:59,098 - INFO - [pcap_writer.py:413] - Packet 3: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 14:49:59,098 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 1646
2025-01-01 14:49:59,099 - INFO - [pcap_writer.py:413] - Packet 4: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 14:49:59,099 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-01 14:49:59,100 - INFO - [pcap_writer.py:413] - Packet 5: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 14:49:59,100 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-01 14:49:59,101 - INFO - [pcap_writer.py:413] - Packet 6: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 14:49:59,101 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 160
2025-01-01 14:49:59,101 - INFO - [pcap_writer.py:413] - Packet 7: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 14:49:59,102 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 128
2025-01-01 14:49:59,102 - INFO - [pcap_writer.py:413] - Packet 8: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 14:49:59,102 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 1152
2025-01-01 14:49:59,103 - INFO - [pcap_writer.py:413] - Packet 9: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-01 14:49:59,103 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2025-01-01 14:49:59,103 - INFO - [pcap_writer.py:413] - Packet 10: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-01 14:49:59,103 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2775
2025-01-01 14:49:59,103 - INFO - [pcap_writer.py:413] - Packet 11: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-01 14:49:59,104 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 269
2025-01-01 14:49:59,104 - INFO - [pcap_writer.py:413] - Packet 12: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-01 14:49:59,104 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-01 14:49:59,104 - INFO - [pcap_writer.py:413] - Packet 13: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-01 14:49:59,104 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-01 14:49:59,105 - INFO - [pcap_writer.py:413] - Packet 14: IP / TCP 192.168.1.2:12346 > 10.0.0.1:http PA / Raw
2025-01-01 14:49:59,105 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2025-01-01 14:49:59,105 - INFO - [pcap_writer.py:413] - Packet 15: IP / TCP 10.0.0.1:http > 192.168.1.2:12346 PA / Raw
2025-01-01 14:49:59,105 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2025-01-01 14:49:59,105 - INFO - [pcap_writer.py:427] - Verification complete: 15 valid packets, 15 TLS records
2025-01-01 14:49:59,106 - INFO - [main.py:106] - Results saved to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-01 14:49:59,106 - INFO - [main.py:160] - TLS session simulation completed successfully
2025-01-01 15:30:04,697 - INFO - [logging.py:83] - Logging configured successfully
2025-01-01 15:30:04,701 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-01 15:30:04,701 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-01 15:30:04,702 - INFO - [logging.py:92] - Log level: 20
2025-01-01 15:30:04,702 - INFO - [logging.py:93] - Timestamp: 2025-01-01T15:30:04.702726
2025-01-01 15:30:04,702 - INFO - [logging.py:94] - ==========================
2025-01-01 15:30:04,703 - INFO - [main.py:129] - Starting TLS session simulation
2025-01-01 15:30:04,703 - INFO - [main.py:94] - 
--- Client Session (certificate) ---
2025-01-01 15:30:04,705 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-01 15:30:04,705 - INFO - [cert.py:108] - File exists: True
2025-01-01 15:30:04,705 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-01 15:30:04,706 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-01 15:30:04,706 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-01 15:30:04,707 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-01 15:30:04,712 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 15:30:04,712 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-01 15:30:04,713 - INFO - [cert.py:108] - File exists: True
2025-01-01 15:30:04,714 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-01 15:30:04,715 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-01 15:30:04,715 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-01 15:30:04,716 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-01 15:30:04,717 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 15:30:04,755 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-01 15:30:04,756 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-01 15:30:04,756 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-01 15:30:04,758 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-01 15:30:04,760 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-01 15:30:04,760 - INFO - [verify.py:58] - Public key comparison results:
2025-01-01 15:30:04,760 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 15:30:04,761 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 15:30:04,762 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-01 15:30:04,762 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-01 15:30:04,767 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-01 15:30:04,767 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-01 15:30:04,768 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-01 15:30:04,768 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-01 15:30:04,769 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-01 15:30:04,769 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-01 15:30:04,770 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-01 15:30:04,771 - INFO - [session.py:157] - Starting TLS session
2025-01-01 15:30:04,771 - INFO - [session.py:96] - Starting TLS Handshake...
2025-01-01 15:30:04,771 - INFO - [client.py:99] - Generated client_random: 6775435cf91d505f1877c423c273f7b5724b0bcfdc58850e0450ba8ee3e4cb2c
2025-01-01 15:30:04,777 - INFO - [client.py:139] - Client Hello sent from 192.168.1.1
2025-01-01 15:30:04,782 - INFO - [session.py:101] - Client Hello sent successfully
2025-01-01 15:30:04,783 - INFO - [server.py:95] - Generated server_random: 6775435c244b4a5c176902c26b9fc3f1668b3360f7368658a731b849bc655fec
2025-01-01 15:30:04,794 - INFO - [session.py:106] - Server Hello received successfully
2025-01-01 15:30:04,796 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2025-01-01 15:30:04,798 - INFO - [cert.py:108] - File exists: True
2025-01-01 15:30:04,800 - INFO - [cert.py:109] - File size: 1915 bytes
2025-01-01 15:30:04,801 - INFO - [cert.py:113] - Read 1915 bytes
2025-01-01 15:30:04,802 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2025-01-01 15:30:04,803 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2025-01-01 15:30:04,804 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 15:30:04,805 - INFO - [client.py:173] - Prepared client certificate
2025-01-01 15:30:04,807 - INFO - [client.py:188] - Encrypted pre_master_secret length: 256
2025-01-01 15:30:04,810 - INFO - [session.py:111] - Client handshake messages sent successfully
2025-01-01 15:30:04,813 - INFO - [session.py:116] - Server key pair verified successfully
2025-01-01 15:30:04,813 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-01 15:30:04,815 - INFO - [chain.py:185] - Decrypted pre_master_secret: 0303f53559d27d6e795944c64e7316ac5b238710dc146cc860b0cb37b5f1270a6837e11114f5ee8f833dd71d061a95d1
2025-01-01 15:30:04,816 - INFO - [chain.py:195] - Generated master secret: cd583bcd317605f36ba51d218075aa20a31900f576bae8f81d52b4590959e3f154dbe8d84699feabab60fc4b8d381529
2025-01-01 15:30:04,816 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-01 15:30:04,817 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-01 15:30:04,818 - INFO - [session.py:120] - Master Secret handled successfully
2025-01-01 15:30:04,821 - INFO - [client.py:269] - Pre-master secret validated successfully
2025-01-01 15:30:04,825 - INFO - [client.py:287] - Generated digital signature: 41595360053332c103503b5cbe305de459a7093f735917a765ca34443b666a42117e8b8eb1266276b1db306859437cbfd13e98d25030d8d47e7ebb06ba7f21f4a6fabe2949e9f6ce01688904bc213226f412a9d542e89b6cde8280c2c7641cf2f80c2d72e9e1757894243a1e1cbd0a49eaa9aa38a48ea160fc809ce9f06c4c393644902702054b91f50bacfacdcfa1e3a170fe207c8a401f82fd556714a9cda280afa66bfe39710b4fe757cd826e2c0a4697f15d077ce70232e36d26fadefc75748a63bbacc40fc4e1edb91d75f65b4b3e98fe746b1e739e25c2d960b22f3e99f4794992a1e1c8f2f4263bbe5c58b713cf5fa95c8c615a4fe3cf4ea749698ea6
2025-01-01 15:30:04,831 - INFO - [client.py:333] - Client ChangeCipherSpec and Finished messages sent
2025-01-01 15:30:04,834 - INFO - [session.py:125] - Client Change Cipher Spec sent successfully
2025-01-01 15:30:04,836 - INFO - [server.py:257] - Pre-master secret validated successfully
2025-01-01 15:30:04,839 - INFO - [server.py:275] - Generated digital signature: 78d9ded3148927101b50585b68202873957c08ac6e4ffd598a8a37f6093e5dffd0c03b057c621bf04bebc1ac87c93a4d86631480312b6644cb3541c5c153cea2c2709d90c95a7fe36a793cf71a91f455baf6a09d9056e05ecd1c225c020279c1c8f4eaa20b6436896c5447311ce401fbe90079433eb36d812e9b896f8f61b1b320f373763366468417da64220af3c1dd4fe23954f6fc580ca54160574e260dc67efdd1420f19cf897957d22bf43eb1001546c06d2dd2fec911c8fa6935eb15a1d1fc6aea78fa148f016f128a05b4e342482e09014898717db0fa70d9f90dfadebfb15bfcd8db9368fcdb99c990d863a2c00ff1d37801386d20433721b2546282
2025-01-01 15:30:04,843 - INFO - [server.py:321] - Server ChangeCipherSpec and Finished messages sent
2025-01-01 15:30:04,845 - INFO - [session.py:130] - Server Change Cipher Spec received successfully
2025-01-01 15:30:04,847 - INFO - [keys.py:212] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-01 15:30:04,848 - INFO - [session.py:135] - SSL Key Log handled successfully
2025-01-01 15:30:04,848 - INFO - [session.py:139] - TLS Handshake completed successfully
2025-01-01 15:30:04,849 - INFO - [session.py:168] - Found file to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 15:30:04,850 - INFO - [session.py:186] - Handshake completed: True
2025-01-01 15:30:04,850 - INFO - [session.py:187] - Use client cert: True
2025-01-01 15:30:04,850 - INFO - [session.py:188] - File to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 15:30:04,851 - INFO - [session.py:191] - Using encrypted exchange
2025-01-01 15:30:04,851 - INFO - [session.py:206] - Sending encrypted request data
2025-01-01 15:30:04,856 - INFO - [keys.py:185] - TLS Application Data sent from 192.168.1.1:12345 to 10.0.0.1:443
2025-01-01 15:30:04,857 - INFO - [session.py:217] - Sending encrypted response data
2025-01-01 15:30:04,860 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-01 15:30:04,863 - INFO - [session.py:229] - Attempting to send file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 15:30:04,864 - INFO - [session.py:240] - Opening file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 15:30:04,865 - INFO - [session.py:247] - Read 1103 bytes from file
2025-01-01 15:30:04,867 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-01 15:30:04,867 - INFO - [session.py:256] - File sent successfully
2025-01-01 15:30:04,868 - INFO - [session.py:231] - File sent successfully
2025-01-01 15:30:04,868 - INFO - [main.py:102] - Session completed successfully for 192.168.1.1
2025-01-01 15:30:04,868 - INFO - [main.py:94] - 
--- Client Session (no certificate) ---
2025-01-01 15:30:04,869 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-01 15:30:04,870 - INFO - [cert.py:108] - File exists: True
2025-01-01 15:30:04,870 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-01 15:30:04,871 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-01 15:30:04,871 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-01 15:30:04,872 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-01 15:30:04,873 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 15:30:04,874 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-01 15:30:04,874 - INFO - [cert.py:108] - File exists: True
2025-01-01 15:30:04,875 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-01 15:30:04,875 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-01 15:30:04,875 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-01 15:30:04,876 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-01 15:30:04,876 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 15:30:04,909 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-01 15:30:04,911 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-01 15:30:04,911 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-01 15:30:04,911 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-01 15:30:04,912 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-01 15:30:04,912 - INFO - [verify.py:58] - Public key comparison results:
2025-01-01 15:30:04,913 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 15:30:04,913 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 15:30:04,914 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-01 15:30:04,914 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-01 15:30:04,915 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-01 15:30:04,916 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-01 15:30:04,916 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-01 15:30:04,916 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-01 15:30:04,917 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-01 15:30:04,917 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-01 15:30:04,918 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-01 15:30:04,919 - INFO - [session.py:157] - Starting TLS session
2025-01-01 15:30:04,919 - INFO - [session.py:96] - Starting TLS Handshake...
2025-01-01 15:30:04,919 - INFO - [client.py:99] - Generated client_random: 6775435c8420c057a0bc93a8ab0d20a568581689c9b99e34a45b125a8288fa2e
2025-01-01 15:30:04,924 - INFO - [client.py:139] - Client Hello sent from 192.168.1.2
2025-01-01 15:30:04,928 - INFO - [session.py:101] - Client Hello sent successfully
2025-01-01 15:30:04,928 - INFO - [server.py:95] - Generated server_random: 6775435cde91e7d8cd442c7d21967887cfaaf5a625cef99f57054cfc8ac7960a
2025-01-01 15:30:04,931 - INFO - [session.py:106] - Server Hello received successfully
2025-01-01 15:30:04,932 - INFO - [client.py:176] - Prepared empty certificate
2025-01-01 15:30:04,932 - INFO - [client.py:188] - Encrypted pre_master_secret length: 256
2025-01-01 15:30:04,933 - INFO - [session.py:111] - Client handshake messages sent successfully
2025-01-01 15:30:04,934 - INFO - [session.py:116] - Server key pair verified successfully
2025-01-01 15:30:04,935 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-01 15:30:04,935 - INFO - [chain.py:185] - Decrypted pre_master_secret: 0303d1a0d89fe8c15e1d3e087473c4f9db7fb5d76eb383eae543747fb224e8bf1daef94cd4bf42b61743aada4d23c488
2025-01-01 15:30:04,936 - INFO - [chain.py:195] - Generated master secret: ba3af66328ceb4342024eb39192428f460c0f8902e82600b3c583d484527b3c0a636be1e5b1a813fc81f905394d0600e
2025-01-01 15:30:04,936 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-01 15:30:04,936 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-01 15:30:04,936 - INFO - [session.py:120] - Master Secret handled successfully
2025-01-01 15:30:04,937 - INFO - [client.py:269] - Pre-master secret validated successfully
2025-01-01 15:30:04,938 - INFO - [client.py:287] - Generated digital signature: cd1f9437dec98e810627bdedc2dc262b7cff6d473134526d3db6592cf8f6b5615d88751aac4c6d3bd51e3a0403f938e6c74651525ef7accc807da5f40519aa2b01023fcfd23735263c13a2fcb881bb5d54ae7c7508df91a70a48ee0448a5b2366fdfd0f18257f70f2a3a570037bbb714c4ed75fd04873e72bbd03b74f771cd7f656c1b9eb1feb191137e0d2d87be2b846dc927e5e659faa7ff9369e1b3c3f50d0dcbd0bff4eff44abe7e5d4f1860705ef2eb7c839be52a2c5ce1a340e87c9d493cacc7fb809ed859590c832f2f8b4264a46e64dd43ab49ddc879e551230749af83beea2bd85f801887f07149d33476754964e09116fa0924179b24cba0f98d45
2025-01-01 15:30:04,941 - INFO - [client.py:333] - Client ChangeCipherSpec and Finished messages sent
2025-01-01 15:30:04,942 - INFO - [session.py:125] - Client Change Cipher Spec sent successfully
2025-01-01 15:30:04,942 - INFO - [server.py:257] - Pre-master secret validated successfully
2025-01-01 15:30:04,943 - INFO - [server.py:275] - Generated digital signature: 9b33807fc60d09de3f7be37990f19ed242b0dbca5bd198d880a21e4377d653516f7723e55b20e46f65dda15b9dd790e24077ead0c62867a143be79e79a010e44387e96245a96d4a55a7bb01e71363be19848e61208b2dffd5425e8e6d1763da79b4466c7effea6e85419cc91ccba20e2220c3d96ff9b68c6bb3e4683ecf449d5d91bbedd05c2060c3087f1d535367bd06f0c3d11e1cbe0d1f5ca40e146e77a7b2b15d0ee1f0fd80648eed51375a745c20f4d203ad0e9f0b6dd89a68570c368c694b797e0178dc9b002ca0e8b565d5b28739876e34eb56bf6d580bb4a00d03f63bfa4d518bd880473f102f4b96459107d285ac65fb6e2c0490ac8b1c87e3a2c89
2025-01-01 15:30:04,944 - INFO - [server.py:321] - Server ChangeCipherSpec and Finished messages sent
2025-01-01 15:30:04,945 - INFO - [session.py:130] - Server Change Cipher Spec received successfully
2025-01-01 15:30:04,946 - INFO - [keys.py:212] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-01 15:30:04,946 - INFO - [session.py:135] - SSL Key Log handled successfully
2025-01-01 15:30:04,947 - INFO - [session.py:139] - TLS Handshake completed successfully
2025-01-01 15:30:04,947 - INFO - [session.py:186] - Handshake completed: True
2025-01-01 15:30:04,947 - INFO - [session.py:187] - Use client cert: False
2025-01-01 15:30:04,947 - INFO - [session.py:188] - File to send: None
2025-01-01 15:30:04,947 - INFO - [session.py:194] - Using unencrypted exchange
2025-01-01 15:30:04,948 - INFO - [session.py:294] - Added request packet
2025-01-01 15:30:04,948 - INFO - [session.py:294] - Added response packet
2025-01-01 15:30:04,948 - WARNING - [session.py:271] - Using unencrypted communication
2025-01-01 15:30:04,949 - INFO - [main.py:102] - Session completed successfully for 192.168.1.2
2025-01-01 15:30:04,949 - INFO - [pcap_writer.py:232] - Packet 13: Valid HTTP message
2025-01-01 15:30:04,949 - INFO - [pcap_writer.py:232] - Packet 14: Valid HTTP message
2025-01-01 15:30:04,955 - INFO - [pcap_writer.py:387] - Saved 15 valid packets to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-01 15:30:04,955 - INFO - [pcap_writer.py:409] - Verifying 15 packets...
2025-01-01 15:30:04,957 - INFO - [pcap_writer.py:413] - Packet 1: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 15:30:04,957 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2025-01-01 15:30:04,958 - INFO - [pcap_writer.py:413] - Packet 2: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 15:30:04,958 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2775
2025-01-01 15:30:04,958 - INFO - [pcap_writer.py:413] - Packet 3: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 15:30:04,958 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 1646
2025-01-01 15:30:04,959 - INFO - [pcap_writer.py:413] - Packet 4: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 15:30:04,959 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-01 15:30:04,959 - INFO - [pcap_writer.py:413] - Packet 5: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 15:30:04,959 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-01 15:30:04,960 - INFO - [pcap_writer.py:413] - Packet 6: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 15:30:04,960 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 160
2025-01-01 15:30:04,960 - INFO - [pcap_writer.py:413] - Packet 7: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 15:30:04,960 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 128
2025-01-01 15:30:04,960 - INFO - [pcap_writer.py:413] - Packet 8: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 15:30:04,960 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 1152
2025-01-01 15:30:04,961 - INFO - [pcap_writer.py:413] - Packet 9: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-01 15:30:04,961 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2025-01-01 15:30:04,961 - INFO - [pcap_writer.py:413] - Packet 10: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-01 15:30:04,961 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2775
2025-01-01 15:30:04,962 - INFO - [pcap_writer.py:413] - Packet 11: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-01 15:30:04,962 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 269
2025-01-01 15:30:04,962 - INFO - [pcap_writer.py:413] - Packet 12: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-01 15:30:04,962 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-01 15:30:04,963 - INFO - [pcap_writer.py:413] - Packet 13: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-01 15:30:04,963 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-01 15:30:04,963 - INFO - [pcap_writer.py:413] - Packet 14: IP / TCP 192.168.1.2:12346 > 10.0.0.1:http PA / Raw
2025-01-01 15:30:04,963 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2025-01-01 15:30:04,964 - INFO - [pcap_writer.py:413] - Packet 15: IP / TCP 10.0.0.1:http > 192.168.1.2:12346 PA / Raw
2025-01-01 15:30:04,964 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2025-01-01 15:30:04,964 - INFO - [pcap_writer.py:427] - Verification complete: 15 valid packets, 15 TLS records
2025-01-01 15:30:04,964 - INFO - [main.py:113] - Results saved to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-01 15:30:04,965 - INFO - [main.py:167] - TLS session simulation completed successfully
2025-01-01 15:47:03,286 - INFO - [logging.py:83] - Logging configured successfully
2025-01-01 15:47:03,287 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-01 15:47:03,287 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-01 15:47:03,287 - INFO - [logging.py:92] - Log level: 20
2025-01-01 15:47:03,287 - INFO - [logging.py:93] - Timestamp: 2025-01-01T15:47:03.287563
2025-01-01 15:47:03,287 - INFO - [logging.py:94] - ==========================
2025-01-01 15:47:03,287 - INFO - [main.py:129] - Starting TLS session simulation
2025-01-01 15:47:03,288 - INFO - [main.py:94] - 
--- Client Session (certificate) ---
2025-01-01 15:47:03,292 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-01 15:47:03,292 - INFO - [cert.py:108] - File exists: True
2025-01-01 15:47:03,292 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-01 15:47:03,293 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-01 15:47:03,293 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-01 15:47:03,294 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-01 15:47:03,299 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 15:47:03,300 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-01 15:47:03,301 - INFO - [cert.py:108] - File exists: True
2025-01-01 15:47:03,302 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-01 15:47:03,304 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-01 15:47:03,304 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-01 15:47:03,305 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-01 15:47:03,305 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 15:47:03,342 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-01 15:47:03,343 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-01 15:47:03,343 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-01 15:47:03,345 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-01 15:47:03,348 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-01 15:47:03,348 - INFO - [verify.py:58] - Public key comparison results:
2025-01-01 15:47:03,349 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 15:47:03,349 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 15:47:03,350 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-01 15:47:03,350 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-01 15:47:03,356 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-01 15:47:03,357 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-01 15:47:03,357 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-01 15:47:03,358 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-01 15:47:03,358 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-01 15:47:03,359 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-01 15:47:03,360 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-01 15:47:03,361 - INFO - [session.py:157] - Starting TLS session
2025-01-01 15:47:03,361 - INFO - [session.py:96] - Starting TLS Handshake...
2025-01-01 15:47:03,361 - INFO - [client.py:99] - Generated client_random: 67754757acd82f5b9b1a4eb4a17a2b61cd09ee1b19f262b64d9c82e31d32832b
2025-01-01 15:47:03,363 - INFO - [client.py:139] - Client Hello sent from 192.168.1.1
2025-01-01 15:47:03,365 - INFO - [session.py:101] - Client Hello sent successfully
2025-01-01 15:47:03,366 - INFO - [server.py:95] - Generated server_random: 6775475708e552a182a9257d9ccd3704a7ed57bbcc564683976ad6f88005eef8
2025-01-01 15:47:03,373 - INFO - [session.py:106] - Server Hello received successfully
2025-01-01 15:47:03,373 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2025-01-01 15:47:03,374 - INFO - [cert.py:108] - File exists: True
2025-01-01 15:47:03,375 - INFO - [cert.py:109] - File size: 1915 bytes
2025-01-01 15:47:03,376 - INFO - [cert.py:113] - Read 1915 bytes
2025-01-01 15:47:03,376 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2025-01-01 15:47:03,377 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2025-01-01 15:47:03,377 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 15:47:03,378 - INFO - [client.py:173] - Prepared client certificate
2025-01-01 15:47:03,379 - INFO - [client.py:188] - Encrypted pre_master_secret length: 256
2025-01-01 15:47:03,380 - INFO - [session.py:111] - Client handshake messages sent successfully
2025-01-01 15:47:03,382 - INFO - [session.py:116] - Server key pair verified successfully
2025-01-01 15:47:03,382 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-01 15:47:03,384 - INFO - [chain.py:185] - Decrypted pre_master_secret: 0303a59d4fbaa735567da0607028d283b7bfd956502e6a7b5804517dda131e08784b7f815739c3325695f08f9b75eb49
2025-01-01 15:47:03,386 - INFO - [chain.py:195] - Generated master secret: c986655737e72887b7e8d638d3111796ffebc565636527e34a8747c39e652ba972c98c240be106c8bf2e82b825dbbaa3
2025-01-01 15:47:03,387 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-01 15:47:03,387 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-01 15:47:03,388 - INFO - [session.py:120] - Master Secret handled successfully
2025-01-01 15:47:03,390 - INFO - [client.py:269] - Pre-master secret validated successfully
2025-01-01 15:47:03,392 - INFO - [client.py:287] - Generated digital signature: cfff0565478d6a0401294c18b9ab1bf892c8a63a5becf95f453fd86204568946758838330a01f637bf87d805b21dd01ed92fef1f7b14530d11c287c944fab01358a6d20b2e68f9516501db950a89d5bdab5812a5e07b7eddd050eafd2df6df8e79741cab2bb87e9a44bd9c5eea6480abb1efa17731df782ba1a6539ed03e63e69e5fc656b411ef5e8c583bb8339e5565c1b2a40810bbd988569937b8064f6c5a7bf0e61b1fa88ca8516d04ce700069cc35ac9e7a04db7411ed93bf6d5f3c4135defa46a083d3902a3d2aa2da072e8d835b31cd251c02aedc6e9246da25f8a40c650c6b8a3be51bba1b6e30efe183cf87747d90a322ab6b53f4c56816db603045
2025-01-01 15:47:03,394 - INFO - [client.py:333] - Client ChangeCipherSpec and Finished messages sent
2025-01-01 15:47:03,395 - INFO - [session.py:125] - Client Change Cipher Spec sent successfully
2025-01-01 15:47:03,396 - INFO - [server.py:257] - Pre-master secret validated successfully
2025-01-01 15:47:03,397 - INFO - [server.py:275] - Generated digital signature: 76f86612320e18dc8cc16c0e9c3ab48a9a9247a173030a168ca00522b51bd3ec6e807c409b6b3b27ce103aac77d69b978637a62aba0c62c5862cc0d6460e39e2f28d51f67bc8b07a534895bd9da063cd9e9d39a5ca3ceff7540a4403904e44522f76dc2ee87d151511dfb1087f3d5b5984ae74573826ca77a2eb0c3af77c2a3df02957a0a668f07bf557d3d776fbcda6e32476ac0a86e21f6ea35f6632cff141095435f6173b7bb1638cf184049206a0692bf238db45c9418a3b043721a9707424a671aa9398ba3e170860495906868cd9de9ce9adb83c24b47d0fbfc2524575376950071e5f5d6e8618de8f06869af0f0f28a02c9be2bb8b9af1bd16d93f0f8
2025-01-01 15:47:03,399 - INFO - [server.py:321] - Server ChangeCipherSpec and Finished messages sent
2025-01-01 15:47:03,400 - INFO - [session.py:130] - Server Change Cipher Spec received successfully
2025-01-01 15:47:03,403 - INFO - [keys.py:212] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-01 15:47:03,403 - INFO - [session.py:135] - SSL Key Log handled successfully
2025-01-01 15:47:03,404 - INFO - [session.py:139] - TLS Handshake completed successfully
2025-01-01 15:47:03,405 - INFO - [session.py:168] - Found file to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 15:47:03,405 - INFO - [session.py:186] - Handshake completed: True
2025-01-01 15:47:03,405 - INFO - [session.py:187] - Use client cert: True
2025-01-01 15:47:03,406 - INFO - [session.py:188] - File to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 15:47:03,406 - INFO - [session.py:191] - Using encrypted exchange
2025-01-01 15:47:03,406 - INFO - [session.py:206] - Sending encrypted request data
2025-01-01 15:47:03,408 - INFO - [keys.py:185] - TLS Application Data sent from 192.168.1.1:12345 to 10.0.0.1:443
2025-01-01 15:47:03,409 - INFO - [session.py:217] - Sending encrypted response data
2025-01-01 15:47:03,410 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-01 15:47:03,410 - INFO - [session.py:229] - Attempting to send file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 15:47:03,411 - INFO - [session.py:240] - Opening file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 15:47:03,411 - INFO - [session.py:247] - Read 1103 bytes from file
2025-01-01 15:47:03,413 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-01 15:47:03,413 - INFO - [session.py:256] - File sent successfully
2025-01-01 15:47:03,413 - INFO - [session.py:231] - File sent successfully
2025-01-01 15:47:03,414 - INFO - [main.py:102] - Session completed successfully for 192.168.1.1
2025-01-01 15:47:03,414 - INFO - [main.py:94] - 
--- Client Session (no certificate) ---
2025-01-01 15:47:03,415 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-01 15:47:03,415 - INFO - [cert.py:108] - File exists: True
2025-01-01 15:47:03,415 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-01 15:47:03,416 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-01 15:47:03,416 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-01 15:47:03,416 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-01 15:47:03,417 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 15:47:03,418 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-01 15:47:03,419 - INFO - [cert.py:108] - File exists: True
2025-01-01 15:47:03,420 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-01 15:47:03,420 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-01 15:47:03,420 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-01 15:47:03,421 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-01 15:47:03,421 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 15:47:03,454 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-01 15:47:03,455 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-01 15:47:03,455 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-01 15:47:03,455 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-01 15:47:03,456 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-01 15:47:03,456 - INFO - [verify.py:58] - Public key comparison results:
2025-01-01 15:47:03,456 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 15:47:03,457 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 15:47:03,457 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-01 15:47:03,458 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-01 15:47:03,458 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-01 15:47:03,459 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-01 15:47:03,459 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-01 15:47:03,459 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-01 15:47:03,460 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-01 15:47:03,460 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-01 15:47:03,461 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-01 15:47:03,461 - INFO - [session.py:157] - Starting TLS session
2025-01-01 15:47:03,462 - INFO - [session.py:96] - Starting TLS Handshake...
2025-01-01 15:47:03,462 - INFO - [client.py:99] - Generated client_random: 67754757c3a8907bd3d4d00103ce6dc1245dfb8001004f0e7a147f3c1a345e23
2025-01-01 15:47:03,464 - INFO - [client.py:139] - Client Hello sent from 192.168.1.2
2025-01-01 15:47:03,465 - INFO - [session.py:101] - Client Hello sent successfully
2025-01-01 15:47:03,466 - INFO - [server.py:95] - Generated server_random: 677547579d7534138cf97c45f61bd70fd514a783fd4288c09dd28e7b49c12d98
2025-01-01 15:47:03,471 - INFO - [session.py:106] - Server Hello received successfully
2025-01-01 15:47:03,472 - INFO - [client.py:176] - Prepared empty certificate
2025-01-01 15:47:03,473 - INFO - [client.py:188] - Encrypted pre_master_secret length: 256
2025-01-01 15:47:03,474 - INFO - [session.py:111] - Client handshake messages sent successfully
2025-01-01 15:47:03,475 - INFO - [session.py:116] - Server key pair verified successfully
2025-01-01 15:47:03,475 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-01 15:47:03,476 - INFO - [chain.py:185] - Decrypted pre_master_secret: 0303fb6f7f59475be96902ba559ce9d9feeece9d8820b17b79877f5b3ca134e9209b23378f1814e0422b156b92c82b89
2025-01-01 15:47:03,476 - INFO - [chain.py:195] - Generated master secret: a24ef50c9a4fbe6f15cdd6ea533717658706adb71c29eec886d1e03c8b33f2350e045fa73894df6045c73acbd98c38e3
2025-01-01 15:47:03,477 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-01 15:47:03,477 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-01 15:47:03,478 - INFO - [session.py:120] - Master Secret handled successfully
2025-01-01 15:47:03,478 - INFO - [client.py:269] - Pre-master secret validated successfully
2025-01-01 15:47:03,479 - INFO - [client.py:287] - Generated digital signature: 84d5fe9f086eff734901bf3769a0bf00ae4db9e7150dc4bdbcf987a2e0f3d6bfd26c4f61e61a0ad52e5722f1dde56403237a41882fc80c0e7da14a33f7b45c15ba70396682230215938ca415a859c45badc49a55721af84a0aa2b5bae7ca6709bca691885161b22946e6214aacb3444243d8cdd5fd6e756de25675ce7fd67b0ccba02152e7ada016f7130ad8fb40bf72457dbfd90872bba4b7c1d7cf17498dbccdb74bf1dcfca31f606b4f03b22621db9ed257ecda88598a12019eef08e6b1623fc80141e0c40bd057b5da631f586e8ff3ade9617dc8a87f8ad2021bd75a4809163dcaf23667e16ae4f8cfcb762bb70b4c0769b11dc99ef35a68b302258eced2
2025-01-01 15:47:03,480 - INFO - [client.py:333] - Client ChangeCipherSpec and Finished messages sent
2025-01-01 15:47:03,481 - INFO - [session.py:125] - Client Change Cipher Spec sent successfully
2025-01-01 15:47:03,482 - INFO - [server.py:257] - Pre-master secret validated successfully
2025-01-01 15:47:03,484 - INFO - [server.py:275] - Generated digital signature: cc2eb5cc9199f22e948983b0c5f625151cf8bc1e373ecf9d563fdb8de266ddccfbaefdcf898e04c72d061d2c1ecaab6d50ead31bf63d356fd0e577d44d41cc502fab9da58f7501b6a24f0520bab342881e8a9182917e0abb9c43b8ea8def30460d809b6d54f09be9f900388ae7be820a979164303530c4ab47b33d034788b6330c616ecb0ebcb00aa5dba0dcbec42ca14a036e7d159691b00ea0fa1875092bc98467588acd330fa99339d5bc0ce9a31d2b505989ba7e4bd4fa2874fd6980460fdc9c6b0270365cc7eb15a65c4a34278f45a767d3be705918c359ecac4de8ed406fd9a5f7d5eeea33815915c64cd75c85fec0372f8f0ce412d6789a901a2b7b1e
2025-01-01 15:47:03,487 - INFO - [server.py:321] - Server ChangeCipherSpec and Finished messages sent
2025-01-01 15:47:03,488 - INFO - [session.py:130] - Server Change Cipher Spec received successfully
2025-01-01 15:47:03,489 - INFO - [keys.py:212] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-01 15:47:03,489 - INFO - [session.py:135] - SSL Key Log handled successfully
2025-01-01 15:47:03,489 - INFO - [session.py:139] - TLS Handshake completed successfully
2025-01-01 15:47:03,490 - INFO - [session.py:186] - Handshake completed: True
2025-01-01 15:47:03,490 - INFO - [session.py:187] - Use client cert: False
2025-01-01 15:47:03,490 - INFO - [session.py:188] - File to send: None
2025-01-01 15:47:03,490 - INFO - [session.py:194] - Using unencrypted exchange
2025-01-01 15:47:03,491 - INFO - [session.py:294] - Added request packet
2025-01-01 15:47:03,491 - INFO - [session.py:294] - Added response packet
2025-01-01 15:47:03,491 - WARNING - [session.py:271] - Using unencrypted communication
2025-01-01 15:47:03,492 - INFO - [main.py:102] - Session completed successfully for 192.168.1.2
2025-01-01 15:47:03,492 - INFO - [pcap_writer.py:232] - Packet 13: Valid HTTP message
2025-01-01 15:47:03,493 - INFO - [pcap_writer.py:232] - Packet 14: Valid HTTP message
2025-01-01 15:47:03,498 - INFO - [pcap_writer.py:387] - Saved 15 valid packets to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-01 15:47:03,498 - INFO - [pcap_writer.py:409] - Verifying 15 packets...
2025-01-01 15:47:03,499 - INFO - [pcap_writer.py:413] - Packet 1: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 15:47:03,499 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2025-01-01 15:47:03,500 - INFO - [pcap_writer.py:413] - Packet 2: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 15:47:03,500 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2775
2025-01-01 15:47:03,501 - INFO - [pcap_writer.py:413] - Packet 3: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 15:47:03,502 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 1646
2025-01-01 15:47:03,503 - INFO - [pcap_writer.py:413] - Packet 4: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 15:47:03,503 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-01 15:47:03,504 - INFO - [pcap_writer.py:413] - Packet 5: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 15:47:03,504 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-01 15:47:03,505 - INFO - [pcap_writer.py:413] - Packet 6: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 15:47:03,505 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 160
2025-01-01 15:47:03,505 - INFO - [pcap_writer.py:413] - Packet 7: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 15:47:03,506 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 128
2025-01-01 15:47:03,506 - INFO - [pcap_writer.py:413] - Packet 8: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 15:47:03,506 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 1152
2025-01-01 15:47:03,506 - INFO - [pcap_writer.py:413] - Packet 9: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-01 15:47:03,507 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2025-01-01 15:47:03,507 - INFO - [pcap_writer.py:413] - Packet 10: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-01 15:47:03,507 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2775
2025-01-01 15:47:03,507 - INFO - [pcap_writer.py:413] - Packet 11: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-01 15:47:03,508 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 269
2025-01-01 15:47:03,508 - INFO - [pcap_writer.py:413] - Packet 12: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-01 15:47:03,508 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-01 15:47:03,509 - INFO - [pcap_writer.py:413] - Packet 13: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-01 15:47:03,509 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-01 15:47:03,509 - INFO - [pcap_writer.py:413] - Packet 14: IP / TCP 192.168.1.2:12346 > 10.0.0.1:http PA / Raw
2025-01-01 15:47:03,510 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2025-01-01 15:47:03,510 - INFO - [pcap_writer.py:413] - Packet 15: IP / TCP 10.0.0.1:http > 192.168.1.2:12346 PA / Raw
2025-01-01 15:47:03,510 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2025-01-01 15:47:03,511 - INFO - [pcap_writer.py:427] - Verification complete: 15 valid packets, 15 TLS records
2025-01-01 15:47:03,511 - INFO - [main.py:113] - Results saved to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-01 15:47:03,511 - INFO - [main.py:167] - TLS session simulation completed successfully
2025-01-01 15:50:52,430 - INFO - [logging.py:83] - Logging configured successfully
2025-01-01 15:50:52,431 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-01 15:50:52,431 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-01 15:50:52,431 - INFO - [logging.py:92] - Log level: 20
2025-01-01 15:50:52,431 - INFO - [logging.py:93] - Timestamp: 2025-01-01T15:50:52.431869
2025-01-01 15:50:52,432 - INFO - [logging.py:94] - ==========================
2025-01-01 15:50:52,432 - INFO - [main.py:129] - Starting TLS session simulation
2025-01-01 15:50:52,432 - INFO - [main.py:94] - 
--- Client Session (certificate) ---
2025-01-01 15:50:52,437 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-01 15:50:52,437 - INFO - [cert.py:108] - File exists: True
2025-01-01 15:50:52,438 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-01 15:50:52,438 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-01 15:50:52,438 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-01 15:50:52,439 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-01 15:50:52,444 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 15:50:52,445 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-01 15:50:52,446 - INFO - [cert.py:108] - File exists: True
2025-01-01 15:50:52,446 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-01 15:50:52,447 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-01 15:50:52,447 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-01 15:50:52,448 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-01 15:50:52,449 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 15:50:52,488 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-01 15:50:52,489 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-01 15:50:52,489 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-01 15:50:52,490 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-01 15:50:52,496 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-01 15:50:52,497 - INFO - [verify.py:58] - Public key comparison results:
2025-01-01 15:50:52,498 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 15:50:52,498 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 15:50:52,499 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-01 15:50:52,500 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-01 15:50:52,504 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-01 15:50:52,504 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-01 15:50:52,504 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-01 15:50:52,505 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-01 15:50:52,505 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-01 15:50:52,505 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-01 15:50:52,506 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-01 15:50:52,507 - INFO - [session.py:157] - Starting TLS session
2025-01-01 15:50:52,507 - INFO - [session.py:96] - Starting TLS Handshake...
2025-01-01 15:50:52,507 - INFO - [client.py:99] - Generated client_random: 6775483c25fe983e11f5ae22ff3990a3e34b660a37702e9e74e6ad1c364199be
2025-01-01 15:50:52,510 - INFO - [client.py:139] - Client Hello sent from 192.168.1.1
2025-01-01 15:50:52,513 - INFO - [session.py:101] - Client Hello sent successfully
2025-01-01 15:50:52,514 - INFO - [server.py:95] - Generated server_random: 6775483c2469d6b84f3fc69cb6700a062b8b4eac63f37c13b06aba1f538b0d41
2025-01-01 15:50:52,517 - INFO - [session.py:106] - Server Hello received successfully
2025-01-01 15:50:52,517 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2025-01-01 15:50:52,518 - INFO - [cert.py:108] - File exists: True
2025-01-01 15:50:52,518 - INFO - [cert.py:109] - File size: 1915 bytes
2025-01-01 15:50:52,519 - INFO - [cert.py:113] - Read 1915 bytes
2025-01-01 15:50:52,519 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2025-01-01 15:50:52,519 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2025-01-01 15:50:52,520 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 15:50:52,520 - INFO - [client.py:173] - Prepared client certificate
2025-01-01 15:50:52,521 - INFO - [client.py:188] - Encrypted pre_master_secret length: 256
2025-01-01 15:50:52,522 - INFO - [session.py:111] - Client handshake messages sent successfully
2025-01-01 15:50:52,523 - INFO - [session.py:116] - Server key pair verified successfully
2025-01-01 15:50:52,524 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-01 15:50:52,525 - INFO - [chain.py:185] - Decrypted pre_master_secret: 03031f9766c24ad494ff308dabcf0e4df091dd5b53c618b72c9502bcae23384eecbf2e07aee84d77ed450b16b7bcd6d5
2025-01-01 15:50:52,527 - INFO - [chain.py:195] - Generated master secret: 1035d92713854c4ff5740f57c48c99c818d2e84a24f0ffb09761811e654abb6cecccfdb25bab457be673d67b5e5e9a1f
2025-01-01 15:50:52,527 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-01 15:50:52,528 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-01 15:50:52,528 - INFO - [session.py:120] - Master Secret handled successfully
2025-01-01 15:50:52,529 - INFO - [client.py:269] - Pre-master secret validated successfully
2025-01-01 15:50:52,530 - INFO - [client.py:287] - Generated digital signature: d9bbd99e64ccd362662d7119d43d82240bc15987565942f533548af9e35c128a7dad171449c7cc87c9799f2a940b33cadd8ee0f01fd7c96b685db22c2464f92c42b05325c542463efb520561640883af884fb105347b5084cc4844a3fdf6da11b5b038a40812a3c758011555e19ef01305cba1f029801e8405a410a6b5a00059041259c9e16824e6b443395eed61f758d79823bdb60a9a501dd7951312e86e094348a9b74c15e7a03ccc2975de5651ed4b1f2e9af04e8958874d8098483e76c40205b8cf753533c79ec0d90d86dde0a1e18d07fc500d0ea0c1bd17ad9b880dfd73ba837354b1e731a89a3f5b9fbf32b805d25365e264fe66bf43a72ee78302ca
2025-01-01 15:50:52,532 - INFO - [client.py:333] - Client ChangeCipherSpec and Finished messages sent
2025-01-01 15:50:52,533 - INFO - [session.py:125] - Client Change Cipher Spec sent successfully
2025-01-01 15:50:52,534 - INFO - [server.py:257] - Pre-master secret validated successfully
2025-01-01 15:50:52,535 - INFO - [server.py:275] - Generated digital signature: 2999cb4b900e8434ac1e1de52a665265db3ba0a33bcabd24c753da96367297714705ca1ea1e1a154c7bdcad28283614689088d99969a18b568c63afb4ba545c4a6809268de8bba6d06ae5beaee84b3b9a2e4190cbb096cbc980cdec655222f937e51d13d98bf957c59eace7ede9fdfb4b58ce2cb8ea905a3c46ac91c0d2375179419bdc7e7d65399f3a0575ce6a15bd667a52b758757badf1f671bf01f0cf5889cd49f49aad3241b2a3271e221812afa49eff2b5783749ab642a1cb4803fe385929fbf425f0282c6f5641c5e137feba130666d84469f506461979ada5d2fefe65732a72e090da1ba43a2871b3cacf34e0d7ec8c91e5dd2647eb047b405e2384c
2025-01-01 15:50:52,536 - INFO - [server.py:321] - Server ChangeCipherSpec and Finished messages sent
2025-01-01 15:50:52,537 - INFO - [session.py:130] - Server Change Cipher Spec received successfully
2025-01-01 15:50:52,538 - INFO - [keys.py:212] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-01 15:50:52,538 - INFO - [session.py:135] - SSL Key Log handled successfully
2025-01-01 15:50:52,538 - INFO - [session.py:139] - TLS Handshake completed successfully
2025-01-01 15:50:52,538 - INFO - [session.py:168] - Found file to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 15:50:52,539 - INFO - [session.py:186] - Handshake completed: True
2025-01-01 15:50:52,539 - INFO - [session.py:187] - Use client cert: True
2025-01-01 15:50:52,540 - INFO - [session.py:188] - File to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 15:50:52,540 - INFO - [session.py:191] - Using encrypted exchange
2025-01-01 15:50:52,540 - INFO - [session.py:206] - Sending encrypted request data
2025-01-01 15:50:52,543 - INFO - [keys.py:185] - TLS Application Data sent from 192.168.1.1:12345 to 10.0.0.1:443
2025-01-01 15:50:52,544 - INFO - [session.py:217] - Sending encrypted response data
2025-01-01 15:50:52,545 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-01 15:50:52,546 - INFO - [session.py:229] - Attempting to send file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 15:50:52,547 - INFO - [session.py:240] - Opening file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 15:50:52,548 - INFO - [session.py:247] - Read 1103 bytes from file
2025-01-01 15:50:52,548 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-01 15:50:52,549 - INFO - [session.py:256] - File sent successfully
2025-01-01 15:50:52,549 - INFO - [session.py:231] - File sent successfully
2025-01-01 15:50:52,549 - INFO - [main.py:102] - Session completed successfully for 192.168.1.1
2025-01-01 15:50:52,549 - INFO - [main.py:94] - 
--- Client Session (no certificate) ---
2025-01-01 15:50:52,550 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-01 15:50:52,550 - INFO - [cert.py:108] - File exists: True
2025-01-01 15:50:52,550 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-01 15:50:52,551 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-01 15:50:52,551 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-01 15:50:52,551 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-01 15:50:52,552 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 15:50:52,552 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-01 15:50:52,553 - INFO - [cert.py:108] - File exists: True
2025-01-01 15:50:52,553 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-01 15:50:52,553 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-01 15:50:52,554 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-01 15:50:52,554 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-01 15:50:52,554 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 15:50:52,585 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-01 15:50:52,585 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-01 15:50:52,586 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-01 15:50:52,586 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-01 15:50:52,586 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-01 15:50:52,587 - INFO - [verify.py:58] - Public key comparison results:
2025-01-01 15:50:52,587 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 15:50:52,587 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 15:50:52,588 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-01 15:50:52,588 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-01 15:50:52,589 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-01 15:50:52,589 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-01 15:50:52,589 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-01 15:50:52,589 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-01 15:50:52,589 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-01 15:50:52,590 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-01 15:50:52,590 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-01 15:50:52,591 - INFO - [session.py:157] - Starting TLS session
2025-01-01 15:50:52,591 - INFO - [session.py:96] - Starting TLS Handshake...
2025-01-01 15:50:52,592 - INFO - [client.py:99] - Generated client_random: 6775483cf8d36958e5c2f93eb5ea4785b7ae7db99ea089348bebcf8adcd24991
2025-01-01 15:50:52,595 - INFO - [client.py:139] - Client Hello sent from 192.168.1.2
2025-01-01 15:50:52,597 - INFO - [session.py:101] - Client Hello sent successfully
2025-01-01 15:50:52,597 - INFO - [server.py:95] - Generated server_random: 6775483c4f1226d8b2253f1c37c396137c8f406828f00212ae24acaa21bb8c08
2025-01-01 15:50:52,601 - INFO - [session.py:106] - Server Hello received successfully
2025-01-01 15:50:52,601 - INFO - [client.py:176] - Prepared empty certificate
2025-01-01 15:50:52,602 - INFO - [client.py:188] - Encrypted pre_master_secret length: 256
2025-01-01 15:50:52,603 - INFO - [session.py:111] - Client handshake messages sent successfully
2025-01-01 15:50:52,604 - INFO - [session.py:116] - Server key pair verified successfully
2025-01-01 15:50:52,604 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-01 15:50:52,605 - INFO - [chain.py:185] - Decrypted pre_master_secret: 030385fc1ee9148c7628e31dd04f69ba7699325c9b1e9df724c080ca2ea287cc75a99782daa14e99c0f424af9c0ebf07
2025-01-01 15:50:52,606 - INFO - [chain.py:195] - Generated master secret: 9754faea57232b8962d110b67cd5bffa87d9615f87fdf78e12b1e6587cd5e867a2095e1f184db6a278066912deeac965
2025-01-01 15:50:52,606 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-01 15:50:52,606 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-01 15:50:52,606 - INFO - [session.py:120] - Master Secret handled successfully
2025-01-01 15:50:52,607 - INFO - [client.py:269] - Pre-master secret validated successfully
2025-01-01 15:50:52,609 - INFO - [client.py:287] - Generated digital signature: 4487ba7a3909d3ef693d07f824715463b1e20cc4d1f8d05ecf27fdcf6aade833d5d288c961d1ac04cfe4c8003e746790dae8686d82ff7f5359b4e97d9ba868fdc751058d97322844f5556f05198d9bbf693cff49f047ee8f271374bca5394870806071f8851ea33dcc47cf8f1e59a085243a720b88e9c4aa2e8709f4430b0345fdee0ac013abe09f47971dd75a2a2749efc14019abacdce9e31be4137b5267d7fd55a7a329bb25058d1462a19563235f25ece74b0fa3847422223d1a82d2da8777fcf7b84e5a9efcc3b626009f4bb23d6f9d6f2ccc173692a10440d79ad56ab4b3149d023488121d894921d2db1ab772d25b1e98e0f063ac283b30eb26075fbb
2025-01-01 15:50:52,611 - INFO - [client.py:333] - Client ChangeCipherSpec and Finished messages sent
2025-01-01 15:50:52,612 - INFO - [session.py:125] - Client Change Cipher Spec sent successfully
2025-01-01 15:50:52,613 - INFO - [server.py:257] - Pre-master secret validated successfully
2025-01-01 15:50:52,614 - INFO - [server.py:275] - Generated digital signature: 3d6f5fcf3f04e53a6e1813829e5c0444c51a7f3b045113f51d24fe639004d1c7278072d0df1cea5415e30d48158c64ad868bee8be1abafe90b2be8d68a1d693c93db97ab5cd044674abef770b451b10a32ce63d43708171a37b5ca3bfa1afc1c788328aa474201d0dc33e349d632a59d9f9cdd868d9ef927ef23ed7ef96fb348ad8508c2de4bb3ab7659c7b59759948b8222070085ccb76b0c219859f933be75c63610befda87d91f895668115731f75ae9d09ab5e32a58bc7b5a43e28721b445a28c30cece6a083447aa16b685b85a9f9b9408cccf3cf06e9897bba3453ba655d4928ca205dbfb52c448c5c91639e6c8532a30e1d43f379f06badc22054278e
2025-01-01 15:50:52,615 - INFO - [server.py:321] - Server ChangeCipherSpec and Finished messages sent
2025-01-01 15:50:52,616 - INFO - [session.py:130] - Server Change Cipher Spec received successfully
2025-01-01 15:50:52,617 - INFO - [keys.py:212] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-01 15:50:52,618 - INFO - [session.py:135] - SSL Key Log handled successfully
2025-01-01 15:50:52,618 - INFO - [session.py:139] - TLS Handshake completed successfully
2025-01-01 15:50:52,618 - INFO - [session.py:186] - Handshake completed: True
2025-01-01 15:50:52,619 - INFO - [session.py:187] - Use client cert: False
2025-01-01 15:50:52,619 - INFO - [session.py:188] - File to send: None
2025-01-01 15:50:52,619 - INFO - [session.py:194] - Using unencrypted exchange
2025-01-01 15:50:52,620 - INFO - [session.py:294] - Added request packet
2025-01-01 15:50:52,620 - INFO - [session.py:294] - Added response packet
2025-01-01 15:50:52,620 - WARNING - [session.py:271] - Using unencrypted communication
2025-01-01 15:50:52,621 - INFO - [main.py:102] - Session completed successfully for 192.168.1.2
2025-01-01 15:50:52,621 - INFO - [pcap_writer.py:232] - Packet 13: Valid HTTP message
2025-01-01 15:50:52,621 - INFO - [pcap_writer.py:232] - Packet 14: Valid HTTP message
2025-01-01 15:50:52,628 - INFO - [pcap_writer.py:387] - Saved 15 valid packets to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-01 15:50:52,629 - INFO - [pcap_writer.py:409] - Verifying 15 packets...
2025-01-01 15:50:52,629 - INFO - [pcap_writer.py:413] - Packet 1: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 15:50:52,630 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2025-01-01 15:50:52,630 - INFO - [pcap_writer.py:413] - Packet 2: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 15:50:52,630 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2775
2025-01-01 15:50:52,631 - INFO - [pcap_writer.py:413] - Packet 3: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 15:50:52,631 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 1646
2025-01-01 15:50:52,631 - INFO - [pcap_writer.py:413] - Packet 4: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 15:50:52,631 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-01 15:50:52,632 - INFO - [pcap_writer.py:413] - Packet 5: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 15:50:52,632 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-01 15:50:52,632 - INFO - [pcap_writer.py:413] - Packet 6: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 15:50:52,632 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 160
2025-01-01 15:50:52,633 - INFO - [pcap_writer.py:413] - Packet 7: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 15:50:52,633 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 128
2025-01-01 15:50:52,633 - INFO - [pcap_writer.py:413] - Packet 8: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 15:50:52,633 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 1152
2025-01-01 15:50:52,633 - INFO - [pcap_writer.py:413] - Packet 9: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-01 15:50:52,634 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2025-01-01 15:50:52,634 - INFO - [pcap_writer.py:413] - Packet 10: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-01 15:50:52,634 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2775
2025-01-01 15:50:52,635 - INFO - [pcap_writer.py:413] - Packet 11: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-01 15:50:52,635 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 269
2025-01-01 15:50:52,635 - INFO - [pcap_writer.py:413] - Packet 12: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-01 15:50:52,636 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-01 15:50:52,636 - INFO - [pcap_writer.py:413] - Packet 13: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-01 15:50:52,636 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-01 15:50:52,636 - INFO - [pcap_writer.py:413] - Packet 14: IP / TCP 192.168.1.2:12346 > 10.0.0.1:http PA / Raw
2025-01-01 15:50:52,636 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2025-01-01 15:50:52,637 - INFO - [pcap_writer.py:413] - Packet 15: IP / TCP 10.0.0.1:http > 192.168.1.2:12346 PA / Raw
2025-01-01 15:50:52,637 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2025-01-01 15:50:52,637 - INFO - [pcap_writer.py:427] - Verification complete: 15 valid packets, 15 TLS records
2025-01-01 15:50:52,637 - INFO - [main.py:113] - Results saved to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-01 15:50:52,637 - INFO - [main.py:167] - TLS session simulation completed successfully
2025-01-01 16:13:55,643 - INFO - [logging.py:83] - Logging configured successfully
2025-01-01 16:13:55,644 - INFO - [logging.py:90] - === Logging Configuration ===
2025-01-01 16:13:55,645 - INFO - [logging.py:91] - Log file: C:\my-CTF\pcap_creator\tls\logs\tls_session.log
2025-01-01 16:13:55,645 - INFO - [logging.py:92] - Log level: 20
2025-01-01 16:13:55,645 - INFO - [logging.py:93] - Timestamp: 2025-01-01T16:13:55.645906
2025-01-01 16:13:55,646 - INFO - [logging.py:94] - ==========================
2025-01-01 16:13:55,646 - INFO - [main.py:129] - Starting TLS session simulation
2025-01-01 16:13:55,647 - INFO - [main.py:94] - 
--- Client Session (certificate) ---
2025-01-01 16:13:55,648 - INFO - [session.py:92] - Initialized cipher suite: TLS_AES-128_CBC_SHA256
2025-01-01 16:13:55,649 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-01 16:13:55,649 - INFO - [cert.py:108] - File exists: True
2025-01-01 16:13:55,649 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-01 16:13:55,650 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-01 16:13:55,650 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-01 16:13:55,651 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-01 16:13:55,655 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 16:13:55,655 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-01 16:13:55,655 - INFO - [cert.py:108] - File exists: True
2025-01-01 16:13:55,656 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-01 16:13:55,656 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-01 16:13:55,657 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-01 16:13:55,657 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-01 16:13:55,658 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 16:13:55,700 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-01 16:13:55,701 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-01 16:13:55,702 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-01 16:13:55,703 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-01 16:13:55,705 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-01 16:13:55,705 - INFO - [verify.py:58] - Public key comparison results:
2025-01-01 16:13:55,705 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 16:13:55,706 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 16:13:55,708 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-01 16:13:55,708 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-01 16:13:55,718 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-01 16:13:55,719 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-01 16:13:55,719 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-01 16:13:55,720 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-01 16:13:55,720 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-01 16:13:55,720 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-01 16:13:55,721 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-01 16:13:55,722 - INFO - [session.py:169] - Starting TLS session
2025-01-01 16:13:55,722 - INFO - [session.py:108] - Starting TLS Handshake...
2025-01-01 16:13:55,722 - INFO - [client.py:99] - Generated client_random: 67754da3b57aad5c55855a75a9d2f60756c9311668192153c85fee10b6b77638
2025-01-01 16:13:55,726 - INFO - [client.py:139] - Client Hello sent from 192.168.1.1
2025-01-01 16:13:55,729 - INFO - [session.py:113] - Client Hello sent successfully
2025-01-01 16:13:55,729 - INFO - [server.py:95] - Generated server_random: 67754da36ebfc6b24e79e8527531402f6b9a1db3d0275524f7588496438065e3
2025-01-01 16:13:55,735 - INFO - [session.py:118] - Server Hello received successfully
2025-01-01 16:13:55,736 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\client.crt
2025-01-01 16:13:55,737 - INFO - [cert.py:108] - File exists: True
2025-01-01 16:13:55,737 - INFO - [cert.py:109] - File size: 1915 bytes
2025-01-01 16:13:55,738 - INFO - [cert.py:113] - Read 1915 bytes
2025-01-01 16:13:55,739 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA0'
2025-01-01 16:13:55,739 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIFWjCCA0ICCQDOoMV5YsO5TDANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATBg
2025-01-01 16:13:55,740 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 16:13:55,740 - INFO - [client.py:173] - Prepared client certificate
2025-01-01 16:13:55,741 - INFO - [client.py:188] - Encrypted pre_master_secret length: 256
2025-01-01 16:13:55,744 - INFO - [session.py:123] - Client handshake messages sent successfully
2025-01-01 16:13:55,745 - INFO - [session.py:128] - Server key pair verified successfully
2025-01-01 16:13:55,746 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-01 16:13:55,747 - INFO - [chain.py:185] - Decrypted pre_master_secret: 03031038d195623ba6968f2aa247cb54b4b6ad12016f75ee231025ac2ac281643f58d6e3f435155047fdc255275fca9c
2025-01-01 16:13:55,747 - INFO - [chain.py:195] - Generated master secret: 0d78c29688180cdcadfdc44136802281ae03470e6d1230be34e96e5717afc74a6f462e491b1c55864070bd16181671fe
2025-01-01 16:13:55,747 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-01 16:13:55,748 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-01 16:13:55,748 - INFO - [session.py:132] - Master Secret handled successfully
2025-01-01 16:13:55,749 - INFO - [client.py:269] - Pre-master secret validated successfully
2025-01-01 16:13:55,750 - INFO - [client.py:287] - Generated digital signature: 0ebee739e379ce83d78737972a7e76bb3989cec783aaf6d22fa90b6df07baf04b6ddb041548ee88753b1f08f3240a41002c86c52a99e76b20fcbe5d368651b7ae66b18ba1c962d2397657dfcbec5b0543d14c8003cbb5da9f9e4346b631995594399ac5833a9ebe3b571b124b6968d9c845920185b37a3b3f45f310461180ee719e5944b5b146264a630e9ddeb1350eedef7c3c80c570fed89d2e2210927f33da0172e0d973e62e9975f470b775e4fc1ce53684f00e7e2494351b095b61bebe03b1af9f8af29ffae67e309addf349592d2cb058cb66089b0ff0a74958ff52ae51835ee994ecee7c4d785da1a1a460b1c837f0720d2b27254792ef014cc682e2a
2025-01-01 16:13:55,752 - INFO - [client.py:333] - Client ChangeCipherSpec and Finished messages sent
2025-01-01 16:13:55,753 - INFO - [session.py:137] - Client Change Cipher Spec sent successfully
2025-01-01 16:13:55,754 - INFO - [server.py:257] - Pre-master secret validated successfully
2025-01-01 16:13:55,755 - INFO - [server.py:275] - Generated digital signature: bc81400574526537e0f1c1295cc54c3f2b9819df2398cbad07b245790efbc21ed1b0f66a9d87202483f64dd0c82bf24264c5f4ff58fc0ffe32a42c13723a6c048d32da55d01a9e0d6c980d82f897aeb484daf842d494e50607c1e759c7d5f33f0aa2f6bece13a38cc4bb4bf1759711fe922ac772e3910d8b788be806a6bc71380877b4c10b0730894c500d823e6a9e76fa0e9018e0743d28317b4c6419e470a707594d912232476ccc642e2b567c98d7c16960890bbf637966795cfaa2a2e8e94db3966e24707149c75fa9b17c6a14269e1820fefc8d94065b2b68f1088d64e68dde9b3e945a73ecc2e74993859ef38653b5014b8aa0bc374d9a88a2527ee405
2025-01-01 16:13:55,756 - INFO - [server.py:321] - Server ChangeCipherSpec and Finished messages sent
2025-01-01 16:13:55,758 - INFO - [session.py:142] - Server Change Cipher Spec received successfully
2025-01-01 16:13:55,759 - INFO - [keys.py:209] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-01 16:13:55,759 - INFO - [session.py:147] - SSL Key Log handled successfully
2025-01-01 16:13:55,759 - INFO - [session.py:151] - TLS Handshake completed successfully
2025-01-01 16:13:55,760 - INFO - [session.py:180] - Found file to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 16:13:55,760 - INFO - [session.py:198] - Handshake completed: True
2025-01-01 16:13:55,761 - INFO - [session.py:199] - Use client cert: True
2025-01-01 16:13:55,761 - INFO - [session.py:200] - File to send: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 16:13:55,761 - INFO - [session.py:203] - Using encrypted exchange
2025-01-01 16:13:55,761 - INFO - [session.py:218] - Sending encrypted request data
2025-01-01 16:13:55,764 - INFO - [keys.py:185] - TLS Application Data sent from 192.168.1.1:12345 to 10.0.0.1:443
2025-01-01 16:13:55,764 - INFO - [session.py:229] - Sending encrypted response data
2025-01-01 16:13:55,766 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-01 16:13:55,766 - INFO - [session.py:241] - Attempting to send file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 16:13:55,766 - INFO - [session.py:252] - Opening file: C:\my-CTF\pcap_creator\tls\documents\ctf_challenge.gif
2025-01-01 16:13:55,767 - INFO - [session.py:259] - Read 1103 bytes from file
2025-01-01 16:13:55,768 - INFO - [keys.py:185] - TLS Application Data sent from 10.0.0.1:443 to 192.168.1.1:12345
2025-01-01 16:13:55,769 - INFO - [session.py:268] - File sent successfully
2025-01-01 16:13:55,769 - INFO - [session.py:243] - File sent successfully
2025-01-01 16:13:55,769 - INFO - [main.py:102] - Session completed successfully for 192.168.1.1
2025-01-01 16:13:55,769 - INFO - [main.py:94] - 
--- Client Session (no certificate) ---
2025-01-01 16:13:55,770 - INFO - [session.py:92] - Initialized cipher suite: TLS_AES-128_CBC_SHA256
2025-01-01 16:13:55,770 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\ca.crt
2025-01-01 16:13:55,771 - INFO - [cert.py:108] - File exists: True
2025-01-01 16:13:55,771 - INFO - [cert.py:109] - File size: 1912 bytes
2025-01-01 16:13:55,771 - INFO - [cert.py:113] - Read 1912 bytes
2025-01-01 16:13:55,772 - INFO - [cert.py:117] - First 100 bytes: b'\n-----BEGIN CERTIFICATE-----\nMIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ\nUjEPMA'
2025-01-01 16:13:55,772 - INFO - [cert.py:120] - File content as text: 
-----BEGIN CERTIFICATE-----
MIIFVjCCAz4CCQDZlfjV/jlm3jANBgkqhkiG9w0BAQ0FADBtMQswCQYDVQQGEwJJ
UjEPMA0GA1UECAwGVGVocmFuMQ8wDQYDVQQHDAZUZWhyYW4xDTALBgNVBAoMBElS
R0MxFjAUBgNVBAsMDUN5YmVyc2VjdXJpdHkxFTATB
2025-01-01 16:13:55,772 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 16:13:55,773 - INFO - [cert.py:107] - Loading certificate from: C:\my-CTF\pcap_creator\tls\certificates\certs\server.crt
2025-01-01 16:13:55,773 - INFO - [cert.py:108] - File exists: True
2025-01-01 16:13:55,773 - INFO - [cert.py:109] - File size: 1643 bytes
2025-01-01 16:13:55,773 - INFO - [cert.py:113] - Read 1643 bytes
2025-01-01 16:13:55,774 - INFO - [cert.py:117] - First 100 bytes: b'-----BEGIN CERTIFICATE-----\nMIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x\nCzAJBgN'
2025-01-01 16:13:55,774 - INFO - [cert.py:120] - File content as text: -----BEGIN CERTIFICATE-----
MIIEjzCCAncCFCTAuN/v92YqzLPMORcinlGx86nWMA0GCSqGSIb3DQEBCwUAMG0x
CzAJBgNVBAYTAklSMQ8wDQYDVQQIDAZUZWhyYW4xDzANBgNVBAcMBlRlaHJhbjEN
MAsGA1UECgwESVJHQzEWMBQGA1UECwwNQ3liZXJzZW
2025-01-01 16:13:55,775 - INFO - [cert.py:130] - Successfully loaded as PEM
2025-01-01 16:13:55,804 - INFO - [cert.py:213] - Successfully loaded private key from C:\my-CTF\pcap_creator\tls\certificates\certs\server.key
2025-01-01 16:13:55,805 - INFO - [cert.py:214] - Key type: RSAPrivateKey
2025-01-01 16:13:55,805 - INFO - [cert.py:215] - Key size: 2048 bits
2025-01-01 16:13:55,806 - INFO - [cert.py:217] - Public exponent: 65537
2025-01-01 16:13:55,806 - INFO - [cert.py:246] - Certificate and keys loaded and validated successfully
2025-01-01 16:13:55,807 - INFO - [verify.py:58] - Public key comparison results:
2025-01-01 16:13:55,807 - INFO - [verify.py:59] - Certificate modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 16:13:55,809 - INFO - [verify.py:60] - Loaded key modulus (n): 0xdb8d24fa298358ec6a55b74c127eddafe1c5d51db0bdae576735f6d21cbde938dc691a0cacb39c0a97ff3d00f544fe971cd81924a9a4cd0a316ae79d57608f6353826f9e12203f1f41fbcaa0a6d3c4d373d4191da7495b71d2d22a087eae48f216e87d87a3554bb0c63fea8902ca6c16fe7b0646f68cfbdcff200463728f68fefd7e865776b59decc6608448145cef528db2e24f71aa507c08c27220e079d67f3ae0c73fb999d06b5c55672252b75686b3a4aef0513e7899425f8de018a54c680b50331fdf84d68f2f1d38d326558b0086e186067f7bc885ed64f4229ff96890c9977cb34f5ba64f487469ce438abacafc250cc667fd530fe1a940a21265bbef
2025-01-01 16:13:55,810 - INFO - [verify.py:61] - Certificate exponent (e): 0x10001
2025-01-01 16:13:55,810 - INFO - [verify.py:62] - Loaded key exponent (e): 0x10001
2025-01-01 16:13:55,812 - INFO - [verify.py:136] - Certificate chain verification successful
2025-01-01 16:13:55,813 - INFO - [verify.py:188] - Server name 'Pasdaran.local' verified successfully.
2025-01-01 16:13:55,813 - INFO - [chain.py:110] - Certificate chain verification passed
2025-01-01 16:13:55,813 - INFO - [chain.py:117] - Certificate chain loaded successfully
2025-01-01 16:13:55,814 - INFO - [chain.py:118] - Server cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=Pasdaran,OU=Cybersecurity,CN=Pasdaran.local,1.2.840.113549.1.9.1=server-ctf@example.com)>
2025-01-01 16:13:55,814 - INFO - [chain.py:119] - Server public key modulus (n): 27715789706063429807557606224995599859500290360318746177887351772584930700767922060265236908225326034069499061360415721333197892250480074686217368392578391301159860963548062819987980192117154285346649743193735554410844424979329819561349555165843655319142309437602325619944960532107668642823205088719004451766785584250375602116664746909990082155815187624898337966421103740799583791159146718040738723787975829478664380188405278530204082653290083478390920045586534051947651758952646967903767271859712523843899436041916810100575135597588004406500203895849926956188138294164569460185397378003955721604444173706240738049007
2025-01-01 16:13:55,815 - INFO - [chain.py:123] - CA cert subject: <Name(C=IR,ST=Tehran,L=Tehran,O=IRGC,OU=Cybersecurity,CN=IRGC Root CA)>
2025-01-01 16:13:55,815 - INFO - [session.py:169] - Starting TLS session
2025-01-01 16:13:55,815 - INFO - [session.py:108] - Starting TLS Handshake...
2025-01-01 16:13:55,815 - INFO - [client.py:99] - Generated client_random: 67754da3b21c2fd2a963cbaf2ce10a827b7f61395bc73cb12b518370cd95a987
2025-01-01 16:13:55,817 - INFO - [client.py:139] - Client Hello sent from 192.168.1.2
2025-01-01 16:13:55,819 - INFO - [session.py:113] - Client Hello sent successfully
2025-01-01 16:13:55,819 - INFO - [server.py:95] - Generated server_random: 67754da3d5b974e1f6702df0939e87dbee83891fcc020c7aa1be8d5e9a7071e2
2025-01-01 16:13:55,825 - INFO - [session.py:118] - Server Hello received successfully
2025-01-01 16:13:55,826 - INFO - [client.py:176] - Prepared empty certificate
2025-01-01 16:13:55,826 - INFO - [client.py:188] - Encrypted pre_master_secret length: 256
2025-01-01 16:13:55,828 - INFO - [session.py:123] - Client handshake messages sent successfully
2025-01-01 16:13:55,830 - INFO - [session.py:128] - Server key pair verified successfully
2025-01-01 16:13:55,830 - INFO - [chain.py:234] - Starting Master Secret generation.
2025-01-01 16:13:55,831 - INFO - [chain.py:185] - Decrypted pre_master_secret: 03035a5b4d3b5726a3f163ec929d84d6558e426fd5317a9e43e29b0a772e1664dd5777bcaa78a54af3377e3b181495ce
2025-01-01 16:13:55,832 - INFO - [chain.py:195] - Generated master secret: d99afcb2857b9540b19e6fbaef38c8419438141011bdccb838c0dc8c0d479d586c0954df64037fb9a752b41e3ddcf1bd
2025-01-01 16:13:55,832 - INFO - [chain.py:196] - Master secret length: 48 bytes
2025-01-01 16:13:55,832 - INFO - [chain.py:255] - Master Secret generation completed successfully.
2025-01-01 16:13:55,833 - INFO - [session.py:132] - Master Secret handled successfully
2025-01-01 16:13:55,834 - INFO - [client.py:269] - Pre-master secret validated successfully
2025-01-01 16:13:55,835 - INFO - [client.py:287] - Generated digital signature: 1e28d33fbc05b3c8dc28281a4f47b3245970984ec6a217d557779782ff35d1a1d55c0a9b36d44cdfedb61427bcce5b3efaf15ba4c5f25f65cd7e285c98e570ae104308bb4cc9b79572373c9671c0d383f79f8bea91a5a51a528d80b6fdf10f16080e30b12803b429aad8eac8654108caf58883833f197147a81c3c175a80ab77d4a911aa0f14f9f3a5a110654d9702909c613aa312f4378979ef95d2bbfe45fe2af1d8b0a5fde268b293d10a2bb1408a7eee6f6bb2eb7d4a902d5b5df12b573f88a26c613cb9cfd37846e47b377ac509819257e84063d4f433659701b8d8c1cdaee3ff140cc3171195ded871c8864b0298772e219103d5b107b2dad96dd383cc
2025-01-01 16:13:55,836 - INFO - [client.py:333] - Client ChangeCipherSpec and Finished messages sent
2025-01-01 16:13:55,837 - INFO - [session.py:137] - Client Change Cipher Spec sent successfully
2025-01-01 16:13:55,838 - INFO - [server.py:257] - Pre-master secret validated successfully
2025-01-01 16:13:55,838 - INFO - [server.py:275] - Generated digital signature: 7b369e16ca17f806e690f92324937d5b5480ef1b95597140958132e06b6be76452ae3324c08fd3ac5a7b997b2198acb562ea16ef6abde112bf71e2d345e82091938545f5c733e3da03f0e6074cc78211c2400539caa2f5f775406ac18bf86fc71ede12bedb7ccbad73d808932147d16df4468f8acd4e307c7b19f5fc3e09eb65c39623afc3068a76028f8ae299d59ad701baa3372a91a1690af94ab4c125c0943f3c89ec62ace48e57c5326dcd5ff7da0c3e0b4997e54147cdd5b1e801de6a40c3f383fc36e2f0f98e4bb5cd896c6decc834dee8b3106428d9309b0cd891e17f9b3dade0afe2039f84a52ed6b885c0a4296c87b929811cf08483f37f7b46df01
2025-01-01 16:13:55,840 - INFO - [server.py:321] - Server ChangeCipherSpec and Finished messages sent
2025-01-01 16:13:55,842 - INFO - [session.py:142] - Server Change Cipher Spec received successfully
2025-01-01 16:13:55,843 - INFO - [keys.py:209] - SSL keys logged to C:\my-CTF\pcap_creator\tls\logs\ssl_key_log.log
2025-01-01 16:13:55,843 - INFO - [session.py:147] - SSL Key Log handled successfully
2025-01-01 16:13:55,844 - INFO - [session.py:151] - TLS Handshake completed successfully
2025-01-01 16:13:55,844 - INFO - [session.py:198] - Handshake completed: True
2025-01-01 16:13:55,845 - INFO - [session.py:199] - Use client cert: False
2025-01-01 16:13:55,845 - INFO - [session.py:200] - File to send: None
2025-01-01 16:13:55,846 - INFO - [session.py:206] - Using unencrypted exchange
2025-01-01 16:13:55,846 - INFO - [session.py:306] - Added request packet
2025-01-01 16:13:55,847 - INFO - [session.py:306] - Added response packet
2025-01-01 16:13:55,847 - WARNING - [session.py:283] - Using unencrypted communication
2025-01-01 16:13:55,847 - INFO - [main.py:102] - Session completed successfully for 192.168.1.2
2025-01-01 16:13:55,848 - INFO - [pcap_writer.py:232] - Packet 13: Valid HTTP message
2025-01-01 16:13:55,848 - INFO - [pcap_writer.py:232] - Packet 14: Valid HTTP message
2025-01-01 16:13:55,853 - INFO - [pcap_writer.py:387] - Saved 15 valid packets to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-01 16:13:55,853 - INFO - [pcap_writer.py:409] - Verifying 15 packets...
2025-01-01 16:13:55,854 - INFO - [pcap_writer.py:413] - Packet 1: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 16:13:55,854 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2025-01-01 16:13:55,855 - INFO - [pcap_writer.py:413] - Packet 2: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 16:13:55,855 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2775
2025-01-01 16:13:55,855 - INFO - [pcap_writer.py:413] - Packet 3: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 16:13:55,855 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 1646
2025-01-01 16:13:55,856 - INFO - [pcap_writer.py:413] - Packet 4: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 16:13:55,856 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-01 16:13:55,856 - INFO - [pcap_writer.py:413] - Packet 5: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 16:13:55,856 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-01 16:13:55,857 - INFO - [pcap_writer.py:413] - Packet 6: IP / TCP 192.168.1.1:12345 > 10.0.0.1:https PA / Raw
2025-01-01 16:13:55,857 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 160
2025-01-01 16:13:55,858 - INFO - [pcap_writer.py:413] - Packet 7: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 16:13:55,858 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 128
2025-01-01 16:13:55,858 - INFO - [pcap_writer.py:413] - Packet 8: IP / TCP 10.0.0.1:https > 192.168.1.1:12345 PA / Raw
2025-01-01 16:13:55,859 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x17, Version: 0x303, Length: 1152
2025-01-01 16:13:55,859 - INFO - [pcap_writer.py:413] - Packet 9: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-01 16:13:55,859 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 90
2025-01-01 16:13:55,860 - INFO - [pcap_writer.py:413] - Packet 10: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-01 16:13:55,860 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 2775
2025-01-01 16:13:55,861 - INFO - [pcap_writer.py:413] - Packet 11: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-01 16:13:55,861 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x16, Version: 0x303, Length: 269
2025-01-01 16:13:55,861 - INFO - [pcap_writer.py:413] - Packet 12: IP / TCP 192.168.1.2:12346 > 10.0.0.1:https PA / Raw
2025-01-01 16:13:55,862 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-01 16:13:55,863 - INFO - [pcap_writer.py:413] - Packet 13: IP / TCP 10.0.0.1:https > 192.168.1.2:12346 PA / Raw
2025-01-01 16:13:55,863 - INFO - [pcap_writer.py:420] - TLS Record: Record Type: 0x14, Version: 0x303, Length: 21
2025-01-01 16:13:55,864 - INFO - [pcap_writer.py:413] - Packet 14: IP / TCP 192.168.1.2:12346 > 10.0.0.1:http PA / Raw
2025-01-01 16:13:55,864 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2025-01-01 16:13:55,865 - INFO - [pcap_writer.py:413] - Packet 15: IP / TCP 10.0.0.1:http > 192.168.1.2:12346 PA / Raw
2025-01-01 16:13:55,865 - INFO - [pcap_writer.py:420] - TLS Record: HTTP message
2025-01-01 16:13:55,865 - INFO - [pcap_writer.py:427] - Verification complete: 15 valid packets, 15 TLS records
2025-01-01 16:13:55,865 - INFO - [main.py:113] - Results saved to C:\my-CTF\pcap_creator\tls\output\capture.pcap
2025-01-01 16:13:55,866 - INFO - [main.py:167] - TLS session simulation completed successfully
